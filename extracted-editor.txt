
>  */function writeBatch(s){return ensureFirestoreConfigured(s=__PRIVATE_cast(s,Firestore)),new 
WriteBatch(s,e=>executeWrite(s,e))}(function(e,i=!0){(function(o){S=o})(SDK_VERSION),_registerComponent(new 
Component("firestore",(a,{instanceIdentifier:o,options:c})=>{const d=a.getProvider("app").getImmediate(),h=new 
Firestore(new __PRIVATE_FirebaseAuthCredentialsProvider(a.getProvider("auth-internal")),new __PRIVATE_FirebaseAppCheckT
okenProvider(a.getProvider("app-check-internal")),function(_,$){if(!Object.prototype.hasOwnProperty.apply(_.options,["p
rojectId"]))throw new FirestoreError(D.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return 
new DatabaseId(_.options.projectId,$)}(d,o),d);return c=Object.assign({useFetchStreams:i},c),h._setSettings(c),h},"PUBL
IC").setMultipleInstances(!0)),registerVersion(w,"4.7.3",e),registerVersion(w,"4.7.3","esm2017")})();const firebaseConf
ig={apiKey:"AIzaSyBPBoP1Ex7mE0OYLVlqEBeybR0_o6xC2Xc",authDomain:"speccon-crm.firebaseapp.com",projectId:"speccon-crm",s
torageBucket:"speccon-crm.firebasestorage.app",messagingSenderId:"529478412334",appId:"1:529478412334:web:1b6bfbc8b9246
6063157bf"},app=initializeApp(firebaseConfig),secondaryApp=initializeApp(firebaseConfig,"Secondary"),db=getFirestore(ap
p),auth=getAuth(app),secondaryAuth=getAuth(secondaryApp),createOrUpdateUser=async s=>{var e,i;if(s)try{const 
a=s.uid||s.id;if(!a)return;const o=doc(db,"users",a),c=await getDoc(o),d=c.exists()?c.data():{},h={email:s.email||d.ema
il||"",displayName:s.displayName||d.displayName||"",photoURL:s.photoURL||d.photoURL||"",provider:((i=(e=s.providerData)
==null?void 0:e[0])==null?void 0:i.providerId)||s.provider||d.provider||"email",lastLogin:serverTimestamp(),updatedAt:s
erverTimestamp()},j=s.email||d.email||"",_=j.toLowerCase()==="admin@speccon.co.za",$=j.toLowerCase()==="admin@speccon.c
o.za",rt=_?"admin":s.role||"salesperson";if(!c.exists())await setDoc(o,{...h,phone:s.phone||"",title:s.title||"",depart
ment:s.department||"",bio:s.bio||"",role:rt,customPermissions:[],isSystemAdmin:$,tenantId:null,createdAt:serverTimestam
p()},{merge:!0});else{const tt=_?"admin":d.role||rt,mt=$||d.isSystemAdmin||!1;await setDoc(o,{...d,...h,role:tt,customP
ermissions:d.customPermissions||[],phone:d.phone||s.phone||"",title:d.title||s.title||"",department:d.department||s.dep
artment||"",bio:d.bio||s.bio||"",isSystemAdmin:mt,tenantId:d.tenantId||null},{merge:!0})}}catch(a){throw 
console.error("Error creating/updating user document:",a),a}},getUserData=async s=>{try{const 
e=doc(db,"users",s),i=await getDoc(e);return i.exists()?{id:i.id,...i.data()}:null}catch(e){throw console.error("Error 
getting user data:",e),e}},getUsers$1=async()=>{try{const s=collection(db,"users");return(await 
getDocs(s)).docs.map(i=>({id:i.id,...i.data()}))}catch(s){throw console.error("Error getting 
users:",s),s}},updateUserRole=async(s,e)=>{try{const i=doc(db,"users",s);await 
updateDoc(i,{role:e,updatedAt:serverTimestamp()})}catch(i){throw console.error("Error updating user 
role:",i),i}},getUsersByTenant=async s=>{try{const e=collection(db,"users");let i;return 
s?i=query(e,where("tenantId","==",s)):i=e,(await getDocs(i)).docs.map(o=>({id:o.id,...o.data()}))}catch(e){throw 
console.error("Error getting users by tenant:",e),e}},updateUserHierarchy=async(s,e)=>{try{const 
i=doc(db,"users",s),a=await getDoc(i);if(!a.exists())throw new Error("User not found");const 
o={updatedAt:serverTimestamp()};if(e.managerId!==void 0){if(e.managerId===s)throw new Error("User cannot be their own 
manager");o.managerId=e.managerId}if(e.salesLevel!==void 
0){if(!["salesperson","sales_manager","sales_head",null].includes(e.salesLevel))throw new Error("Invalid sales 
level");o.salesLevel=e.salesLevel}if(e.assignedProductLineIds!==void 
0&&(o.assignedProductLineIds=e.assignedProductLineIds||[]),await updateDoc(i,o),e.managerId!==void 0){const 
d=a.data().managerId;d&&d!==e.managerId&&await removeFromManagerTeam(d,s),e.managerId&&await 
addToManagerTeam(e.managerId,s)}}catch(i){throw console.error("Error updating user 
hierarchy:",i),i}},assignSalespersonToManager=async(s,e)=>{try{if(e){const i=doc(db,"users",e),a=await 
getDoc(i);if(!a.exists())throw new Error("Manager not found");const o=a.data(),c=doc(db,"users",s),d=await 
getDoc(c),h=d.exists()?d.data():{};let 
j=[];if(h.role==="salesperson"?j=["manager"]:h.role==="manager"&&(j=["group-sales-manager"]),!j.includes(o.role))throw 
new Error("Selected user is not a valid manager for this role")}await 
updateUserHierarchy(s,{managerId:e})}catch(i){throw console.error("Error assigning salesperson to 
manager:",i),i}},removeSalespersonFromManager=async s=>{try{const e=doc(db,"users",s),i=await 
getDoc(e);if(!i.exists())throw new Error("User not found");const o=i.data().managerId;await 
updateDoc(e,{managerId:null,updatedAt:serverTimestamp()}),o&&await removeFromManagerTeam(o,s)}catch(e){throw 
console.error("Error removing salesperson from manager:",e),e}},addToManagerTeam=async(s,e)=>{try{const 
i=doc(db,"users",s),a=await getDoc(i);if(a.exists()){const c=a.data().teamLeadOf||[];c.includes(e)||await 
updateDoc(i,{teamLeadOf:[...c,e],updatedAt:serverTimestamp()})}}catch(i){console.error("Error adding to manager 
team:",i)}},removeFromManagerTeam=async(s,e)=>{try{const i=doc(db,"users",s),a=await getDoc(i);if(a.exists()){const 
c=a.data().teamLeadOf||[];c.includes(e)&&await 
updateDoc(i,{teamLeadOf:c.filter(d=>d!==e),updatedAt:serverTimestamp()})}}catch(i){console.error("Error removing from 
manager team:",i)}},getDirectReports=async s=>{try{const 
e=collection(db,"users"),i=query(e,where("managerId","==",s));return(await 
getDocs(i)).docs.map(o=>({id:o.id,...o.data()}))}catch(e){throw console.error("Error getting direct 
reports:",e),e}},getTeamMembers=async s=>{try{const e=[],i=await getDirectReports(s);for(const a of i){e.push(a);const 
o=await getTeamMembers(a.id);e.push(...o)}return e}catch(e){throw console.error("Error getting team 
members:",e),e}},getAccessibleUserIds=async(s,e=null)=>{try{const i=[s];if(e||(e=await getUserData(s)),!e)return 
i;const a=e.salesLevel||null,c=(e.role||"salesperson").toLowerCase().replace(/[\s_-]/g,"");if(a==="sales_head"||c==="sa
leshead"||c==="groupsalesmanager"||c==="groupsalesmanagers"||c==="admin")return(await getUsersByTenant(e.tenantId)).map
(_=>_.id);if(a==="sales_manager"||c==="salesmanager"||c==="salesmanagers"||c==="manager"||c==="managers"){const 
j=await getTeamMembers(s);return[...i,...j.map(_=>_.id)]}return i}catch(i){return console.error("Error getting 
accessible user IDs:",i),[s]}},getManagersInTenant=async(s,e="salesperson")=>{try{if(!s)return 
console.warn("getManagersInTenant called without tenantId - returning empty array"),[];const i=await 
getUsersByTenant(s);let a=[];return e==="salesperson"?a=["manager"]:e==="manager"&&(a=["group-sales-manager"]),i.filter
(o=>a.includes(o.role))}catch(i){throw console.error("Error getting 
managers:",i),i}},assignProductLinesToManager=async(s,e)=>{try{const i=doc(db,"users",s);await 
updateDoc(i,{assignedProductLineIds:e||[],updatedAt:serverTimestamp()})}catch(i){throw console.error("Error assigning 
product lines to manager:",i),i}},getEffectiveProductLineIds=async s=>{var e,i;try{const a=await 
getUserData(s);if(!a)return[];if(((e=a.assignedProductLineIds)==null?void 0:e.length)>0)return 
a.assignedProductLineIds;if(a.managerId){const o=await getUserData(a.managerId);if(((i=o==null?void 
0:o.assignedProductLineIds)==null?void 0:i.length)>0)return o.assignedProductLineIds}return[]}catch(a){return 
console.error("Error getting effective product lines:",a),[]}},getTenants=async()=>{try{const 
s=collection(db,"tenants");return(await getDocs(s)).docs.map(i=>({id:i.id,...i.data()})).filter(i=>!i.deleted).sort((i,
a)=>(i.name||"").localeCompare(a.name||""))}catch(s){throw console.error("Error getting 
tenants:",s),s}},getTenant=async s=>{try{const e=doc(db,"tenants",s),i=await getDoc(e);return 
i.exists()?{id:i.id,...i.data()}:null}catch(e){throw console.error("Error getting 
tenant:",e),e}},createTenant=async(s,e=null)=>{try{const 
i=s.id||s.name.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,"");if(await getTenant(i))throw new Error("A 
tenant with this ID already exists");const o=doc(db,"tenants",i);return await setDoc(o,{name:s.name,description:s.descr
iption||"",status:"active",settings:{currencySymbol:s.currencySymbol||"R",financialYearStart:s.financialYearStart||"Mar
ch",financialYearEnd:s.financialYearEnd||"February",...s.settings},createdAt:serverTimestamp(),updatedAt:serverTimestam
p()}),{tenantId:i}}catch(i){throw console.error("Error creating tenant:",i),i}},updateTenant=async(s,e)=>{try{const 
i=doc(db,"tenants",s);await updateDoc(i,{...e,updatedAt:serverTimestamp()})}catch(i){throw console.error("Error 
updating tenant:",i),i}},deleteTenant=async s=>{try{const e=doc(db,"tenants",s);await 
updateDoc(e,{deleted:!0,deletedAt:serverTimestamp(),updatedAt:serverTimestamp()})}catch(e){throw console.error("Error 
deleting tenant:",e),e}},getTenantStats=async s=>{try{const 
e=collection(db,"users"),i=query(e,where("tenantId","==",s)),a=await 
getDocs(i),o=collection(db,"clients"),c=query(o,where("tenantId","==",s)),d=await 
getDocs(c);return{userCount:a.size,clientCount:d.size}}catch(e){return console.error("Error getting tenant 
stats:",e),{userCount:0,clientCount:0}}},assignUserToTenant=async(s,e,i="salesperson")=>{try{const 
a=doc(db,"users",s);await updateDoc(a,{tenantId:e,role:i,updatedAt:serverTimestamp()})}catch(a){throw 
console.error("Error assigning user to tenant:",a),a}},removeUserFromTenant=async s=>{try{const 
e=doc(db,"users",s);await updateDoc(e,{tenantId:null,updatedAt:serverTimestamp()})}catch(e){throw console.error("Error 
removing user from tenant:",e),e}},getTenantUsers=async s=>{try{const 
e=collection(db,"users"),i=query(e,where("tenantId","==",s));return(await 
getDocs(i)).docs.map(o=>({id:o.id,...o.data()}))}catch(e){throw console.error("Error getting tenant 
users:",e),e}},migrateDataToTenant=async s=>{try{const e=writeBatch(db);let i=0;const a=400,o=["clients","deals","follo
wUpTasks","messages","quotes","invoices","forecasts","feedback","clientFinancials","budgets","skillsPartners","products
","productLines"];for(const _ of o){const $=collection(db,_),rt=await getDocs($);for(const tt of 
rt.docs)tt.data().tenantId||(e.update(tt.ref,{tenantId:s,updatedAt:serverTimestamp()}),i++,i>=a&&(await 
e.commit(),i=0))}const c=collection(db,"users"),d=await getDocs(c);for(const _ of d.docs){const 
$=_.data();!$.tenantId&&!$.isSystemAdmin&&(e.update(_.ref,{tenantId:s,updatedAt:serverTimestamp()}),i++,i>=a&&(await 
e.commit(),i=0))}const h=collection(db,"systemSettings"),j=await getDocs(h);for(const _ of 
j.docs)_.data().tenantId||(e.update(_.ref,{tenantId:s,updatedAt:serverTimestamp()}),i++);return i>0&&await 
e.commit(),console.log("Data migration completed for tenant:",s),{success:!0}}catch(e){throw console.error("Error 
migrating data to tenant:",e),e}},initializeSpecconTenant=async()=>{try{return await getTenant("speccon")||(await 
createTenant({id:"speccon",name:"Speccon",description:"Speccon Holdings - Primary 
tenant",currencySymbol:"R",financialYearStart:"March",financialYearEnd:"February"}),console.log("Speccon tenant 
created")),{tenantId:"speccon"}}catch(s){throw console.error("Error initializing Speccon 
tenant:",s),s}},SYSTEM_FEATURES=[{id:"view_dashboard",name:"View 
Dashboard",category:"Dashboard"},{id:"edit_financial_dashboard",name:"Edit Financial 
Dashboard",category:"Dashboard"},{id:"view_clients",name:"View 
Clients",category:"Clients"},{id:"create_clients",name:"Create 
Clients",category:"Clients"},{id:"edit_clients",name:"Edit 
Clients",category:"Clients"},{id:"delete_clients",name:"Delete 
Clients",category:"Clients"},{id:"view_sales_pipeline",name:"View Sales Pipeline",category:"Sales 
Pipeline"},{id:"create_deals",name:"Create Deals",category:"Sales Pipeline"},{id:"edit_deals",name:"Edit 
Deals",category:"Sales Pipeline"},{id:"view_follow_up_tasks",name:"View Follow-Up Tasks",category:"Follow-Up 
Tasks"},{id:"create_follow_up_tasks",name:"Create Follow-Up Tasks",category:"Follow-Up 
Tasks"},{id:"view_reports",name:"View Reports",category:"Reports"},{id:"view_messages",name:"View 
Messages",category:"Messages"},{id:"create_messages",name:"Create 
Messages",category:"Messages"},{id:"view_accounting",name:"View Accounting 
Data",category:"Accounting"},{id:"edit_accounting",name:"Edit Accounting 
Data",category:"Accounting"},{id:"manage_team",name:"Manage Own Team",category:"Team 
Management"},{id:"view_team_reports",name:"View Team Reports",category:"Team 
Management"},{id:"view_all_teams",name:"View All Teams",category:"Team 
Management"},{id:"manage_all_teams",name:"Manage All Teams",category:"Team 
Management"},{id:"manage_users",name:"Manage Users",category:"Administration"},{id:"manage_roles",name:"Manage 
Roles",category:"Administration"},{id:"manage_financial_year",name:"Manage Financial Year 
End",category:"Administration"},{id:"manage_clients",name:"Manage Client Budgets & 
Allocations",category:"Administration"},{id:"manage_tenants",name:"Manage Tenants",category:"System 
Administration"},{id:"view_all_tenants",name:"View All Tenants",category:"System 
Administration"},{id:"manage_system_admins",name:"Manage System Admins",category:"System 
Administration"}],getFeatureCategories=()=>[...new 
Set(SYSTEM_FEATURES.map(e=>e.category))],DEFAULT_ROLES={admin:{name:"Admin",description:"Full system 
access",permissions:SYSTEM_FEATURES.map(s=>s.id)},accountant:{name:"Accountant",description:"Financial and accounting a
ccess",permissions:["view_dashboard","edit_financial_dashboard","view_clients","view_sales_pipeline","view_reports","vi
ew_messages","manage_financial_year","view_accounting","edit_accounting"]},salesperson:{name:"Salesperson",description:
"Sales and client management",permissions:["view_dashboard","view_clients","create_clients","edit_clients","view_sales_
pipeline","create_deals","edit_deals","view_follow_up_tasks","create_follow_up_tasks","view_messages","create_messages"
]},manager:{name:"Manager",description:"Management and oversight",permissions:["view_dashboard","view_clients","create_
clients","edit_clients","view_sales_pipeline","create_deals","edit_deals","view_follow_up_tasks","create_follow_up_task
s","view_reports","view_messages","create_messages","manage_users","manage_clients"]},sales_manager:{name:"Sales 
Manager",description:"Manages a team of salespeople and specific product lines",salesLevel:"sales_manager",permissions:
["view_dashboard","view_clients","create_clients","edit_clients","view_sales_pipeline","create_deals","edit_deals","vie
w_follow_up_tasks","create_follow_up_tasks","view_reports","view_messages","create_messages","manage_team","view_team_r
eports"]},sales_head:{name:"Sales Head",description:"Global view of all sales teams and products within the tenant",sal
esLevel:"sales_head",permissions:["view_dashboard","view_clients","create_clients","edit_clients","delete_clients","vie
w_sales_pipeline","create_deals","edit_deals","view_follow_up_tasks","create_follow_up_tasks","view_reports","view_mess
ages","create_messages","manage_team","view_team_reports","view_all_teams","manage_all_teams","manage_clients"]}},initi
alizeDefaultRoles=async()=>{try{const s=collection(db,"roles");if((await getDocs(s)).empty){const 
i=[];for(const[a,o]of Object.entries(DEFAULT_ROLES)){const 
c=doc(db,"roles",a);i.push(setDoc(c,{...o,id:a,createdAt:serverTimestamp(),updatedAt:serverTimestamp()}))}await 
Promise.all(i),console.log("Default roles initialized")}}catch(s){throw console.error("Error initializing default 
roles:",s),s}},getRoles=async()=>{try{const s=collection(db,"roles");return(await 
getDocs(s)).docs.map(i=>({id:i.id,...i.data()}))}catch(s){throw console.error("Error getting 
roles:",s),s}},getRole=async s=>{try{const e=doc(db,"roles",s),i=await getDoc(e);return i.exists()?{id:i.id,...i.data()
}:DEFAULT_ROLES[s]?{id:s,...DEFAULT_ROLES[s]}:{id:"salesperson",...DEFAULT_ROLES.salesperson}}catch(e){return 
console.error("Error getting role:",e),DEFAULT_ROLES[s]?{id:s,...DEFAULT_ROLES[s]}:{id:"salesperson",...DEFAULT_ROLES.s
alesperson}}},saveRole=async(s,e)=>{try{const i=doc(db,"roles",s),a=await 
getDoc(i),o={...e,id:s,updatedAt:serverTimestamp()};return a.exists()||(o.createdAt=serverTimestamp()),await 
setDoc(i,o,{merge:!0}),s}catch(i){throw console.error("Error saving role:",i),i}},deleteRole=async 
s=>{try{if(Object.keys(DEFAULT_ROLES).includes(s))throw new Error("Cannot delete default roles");const 
e=doc(db,"roles",s);await updateDoc(e,{deleted:!0,updatedAt:serverTimestamp()})}catch(e){throw console.error("Error 
deleting role:",e),e}},TenantContext=reactExports.createContext(null),useTenant=()=>{const 
s=reactExports.useContext(TenantContext);if(!s)throw new Error("useTenant must be used within a 
TenantProvider");return s},TenantProvider=({children:s})=>{const[e,i]=reactExports.useState(null),[a,o]=reactExports.us
eState(null),[c,d]=reactExports.useState(null),[h,j]=reactExports.useState(!1),[_,$]=reactExports.useState(null),[rt,tt
]=reactExports.useState(!0),mt=getAuth(app),[vt,_t]=reactExports.useState([]),[wt,ht]=reactExports.useState([]),[dt,jt]
=reactExports.useState([]),[bt,ut]=reactExports.useState(!1);reactExports.useEffect(()=>{const 
Yt=onAuthStateChanged(mt,async Mt=>{Mt?(i(Mt),await 
Rt(Mt.uid)):(i(null),o(null),d(null),j(!1),$(null)),tt(!1)});return()=>Yt()},[mt]);const Rt=async Yt=>{try{const 
Mt=doc(db,"users",Yt),Gt=await getDoc(Mt);if(Gt.exists()){const Wt={id:Gt.id,...Gt.data()};o(Wt);const 
ms=Wt.isSystemAdmin===!0;if(j(ms),Wt.role){const ss=await getRole(Wt.role);d(ss)}if(Wt.tenantId){const ss=await 
getTenant(Wt.tenantId);$(ss)}else $(null);await st(Yt,Wt)}else 
o(null),d(null),j(!1),$(null),_t([]),ht([]),jt([])}catch(Mt){console.error("Error loading user 
data:",Mt)}},st=async(Yt,Mt)=>{try{ut(!0);const Gt=await getAccessibleUserIds(Yt,Mt);_t(Gt);const Wt=Mt.salesLevel,ms=(
Mt.role||"").toLowerCase().replace(/[\s_-]/g,"");if(Wt==="sales_manager"||Wt==="sales_head"||ms==="salesmanager"||ms===
"salesmanagers"||ms==="saleshead"||ms==="groupsalesmanager"||ms==="groupsalesmanagers"||ms==="manager"||ms==="managers"
||ms==="admin"){const Et=await getDirectReports(Yt);ht(Et)}else ht([]);const ys=await 
getEffectiveProductLineIds(Yt);jt(ys)}catch(Gt){console.error("Error loading hierarchy 
data:",Gt),_t([Yt]),ht([]),jt([])}finally{ut(!1)}},it=async Yt=>{if(!h)throw new Error("Only system admins can switch 
tenants");if(Yt){const Mt=await getTenant(Yt);$(Mt)}else $(null)},nt=async()=>{e&&await Rt(e.uid)},ct=()=>{const 
Yt=(_==null?void 0:_.id)||(a==null?void 0:a.tenantId)||null;return 
Yt==="null"||Yt==="undefined"||Yt===""||Yt===null||Yt===void 0?(console.warn("Invalid tenantId detected:",Yt,"- user 
may not have a tenant assigned"),null):Yt},xt=Yt=>{var Mt;return h?!0:((Mt=c==null?void 0:c.permissions)==null?void 
0:Mt.includes(Yt))||!1},yt=()=>h||!!_,Tt=reactExports.useCallback(()=>{if(!a)return!1;const 
Yt=a.salesLevel,Mt=(a.role||"").toLowerCase().replace(/[\s_-]/g,"");return Yt==="sales_manager"||Yt==="sales_head"||Mt=
=="salesmanager"||Mt==="salesmanagers"||Mt==="saleshead"||Mt==="groupsalesmanager"||Mt==="groupsalesmanagers"||Mt==="ma
nager"||Mt==="managers"||Mt==="admin"},[a]),fs=reactExports.useCallback(()=>{if(!a)return!1;if(h)return!0;const 
Yt=(a.role||"").toLowerCase().replace(/[\s_-]/g,"");return a.salesLevel==="sales_head"||Yt==="saleshead"||Yt==="groupsa
lesmanager"||Yt==="groupsalesmanagers"||Yt==="admin"},[a,h]),cs=reactExports.useCallback(Yt=>h?!0:Yt?vt.includes(Yt):!1
,[h,vt]),Es=reactExports.useCallback(async()=>{e&&a&&await st(e.uid,a)},[e,a]),ls={currentUser:e,userData:a,userRole:c,
isSystemAdmin:h,currentTenant:_,loading:rt,switchTenant:it,refreshUserData:nt,getTenantId:ct,hasPermission:xt,hasTenant
Access:yt,accessibleUserIds:vt,teamMembers:wt,effectiveProductLineIds:dt,hierarchyLoading:bt,isTeamManager:Tt,isSalesHe
ad:fs,canAccessUserData:cs,refreshHierarchyData:Es};return 
jsxRuntimeExports.jsx(TenantContext.Provider,{value:ls,children:s})},getUsers=async()=>{try{const 
s=collection(db,"users");return(await getDocs(s)).docs.map(i=>({id:i.id,...i.data()}))}catch(s){throw 
console.error("Error getting users:",s),s}},getClients=async(s={},e=null)=>{try{const i=collection(db,"clients");let 
a=query(i);return e&&(a=query(a,where("tenantId","==",e))),s.status&&(a=query(a,where("status","==",s.status))),s.type&
&(a=query(a,where("type","==",s.type))),a=query(a,orderBy("lastContact","desc")),(await 
getDocs(a)).docs.map(c=>({id:c.id,...c.data()}))}catch(i){throw console.error("Error getting 
clients:",i),i}},getClient=async s=>{try{const e=doc(db,"clients",s),i=await getDoc(e);return 
i.exists()?{id:i.id,...i.data()}:null}catch(e){throw console.error("Error getting 
client:",e),e}},createClient=async(s,e=null)=>{try{const i=collection(db,"clients"),a={...s,tenantId:e||s.tenantId,crea
tedAt:serverTimestamp(),updatedAt:serverTimestamp(),lastContact:s.lastContact||serverTimestamp()};return(await 
addDoc(i,a)).id}catch(i){throw console.error("Error creating client:",i),i}},updateClient=async(s,e)=>{try{const 
i=doc(db,"clients",s);await updateDoc(i,{...e,updatedAt:serverTimestamp()})}catch(i){throw console.error("Error 
updating client:",i),i}},DEFAULT_PIPELINE_STATUSES=[{id:"new-lead",name:"New Lead",color:"#e3f2fd",order:1},{id:"qualif
ying",name:"Qualifying",color:"#fff3e0",order:2},{id:"proposal-sent",name:"Proposal 
Sent",color:"#e8f5e9",order:3},{id:"awaiting-decision",name:"Awaiting Decision",color:"#e1bee7",order:4},{id:"negotiati
on",name:"Negotiation",color:"#fff9c4",order:5},{id:"won",name:"Won",color:"#c8e6c9",order:6,isWon:!0},{id:"lost",name:
"Lost",color:"#ffcdd2",order:7,isLost:!0}],getPipelineStatuses=async(s=null)=>{try{if(s){const 
a=doc(db,"systemSettings",`pipelineStatuses_${s}`),o=await getDoc(a);if(o.exists()){const 
c=o.data();if(c.statuses&&Array.isArray(c.statuses)&&c.statuses.length>0)return 
c.statuses.sort((d,h)=>d.order-h.order)}}const e=doc(db,"systemSettings","pipelineStatuses"),i=await 
getDoc(e);if(i.exists()){const a=i.data();if(a.statuses&&Array.isArray(a.statuses)&&a.statuses.length>0)return 
a.statuses.sort((o,c)=>o.order-c.order)}return DEFAULT_PIPELINE_STATUSES}catch(e){return console.error("Error getting 
pipeline statuses:",e),DEFAULT_PIPELINE_STATUSES}},savePipelineStatuses=async(s,e=null)=>{try{const 
i=e?`pipelineStatuses_${e}`:"pipelineStatuses",a=doc(db,"systemSettings",i);return await 
setDoc(a,{statuses:s,tenantId:e,updatedAt:serverTimestamp()}),!0}catch(i){throw console.error("Error saving pipeline 
statuses:",i),i}},updateClientPipelineStatus=async(s,e,i="system")=>{try{const a=doc(db,"clients",s),o=await 
getDoc(a);if(!o.exists())throw new Error("Client not found");const c=o.data(),d=c.pipelineStatus||null,h=new 
Date,j=c.pipelineStatusHistory||[];if(j.length>0&&!j[j.length-1].endDate){j[j.length-1].endDate=h.toISOString();const 
_=new Date(j[j.length-1].startDate);j[j.length-1].durationDays=Math.floor((h-_)/(1e3*60*60*24))}return 
j.push({status:e,previousStatus:d,startDate:h.toISOString(),endDate:null,durationDays:null,changedBy:i}),await 
updateDoc(a,{pipelineStatus:e,pipelineStatusHistory:j,updatedAt:serverTimestamp()}),j}catch(a){throw 
console.error("Error updating pipeline status:",a),a}},getPipelineStatusAnalytics=async()=>{try{const 
s=collection(db,"clients"),e=await getDocs(s),i={byStatus:{},avgTimeInStatus:{},statusTransitions:[]};return 
e.docs.forEach(a=>{const o=a.data(),c=o.pipelineStatus||"not-set";i.byStatus[c]=(i.byStatus[c]||0)+1,o.pipelineStatusHi
story&&Array.isArray(o.pipelineStatusHistory)&&o.pipelineStatusHistory.forEach(d=>{d.status&&d.durationDays!==null&&(i.
avgTimeInStatus[d.status]||(i.avgTimeInStatus[d.status]={total:0,count:0}),i.avgTimeInStatus[d.status].total+=d.duratio
nDays,i.avgTimeInStatus[d.status].count+=1)})}),Object.keys(i.avgTimeInStatus).forEach(a=>{const{total:o,count:c}=i.avg
TimeInStatus[a];i.avgTimeInStatus[a]=c>0?Math.round(o/c):0}),i}catch(s){throw console.error("Error getting pipeline 
analytics:",s),s}},getClientActivities=async s=>{try{const 
e=collection(db,"clients",s,"activities"),i=query(e,orderBy("timestamp","desc"));return(await 
getDocs(i)).docs.map(o=>({id:o.id,...o.data()}))}catch(e){throw console.error("Error getting client 
activities:",e),e}},addClientActivity=async(s,e)=>{try{const i=collection(db,"clients",s,"activities");await 
addDoc(i,{...e,timestamp:serverTimestamp()})}catch(i){throw console.error("Error adding 
activity:",i),i}},getClientInteractions=async(s,e={})=>{try{const i=collection(db,"clients",s,"interactions");let 
a=query(i,orderBy("timestamp","desc"));return 
e.type&&(a=query(a,where("type","==",e.type))),e.userId&&(a=query(a,where("userId","==",e.userId))),(await 
getDocs(a)).docs.map(c=>({id:c.id,...c.data()}))}catch(i){throw console.error("Error getting 
interactions:",i),i}},createInteraction=async(s,e)=>{try{const i=collection(db,"clients",s,"interactions"),a={...e,time
stamp:e.timestamp||serverTimestamp(),createdAt:serverTimestamp()},o=await 
addDoc(i,a),c={lastContact:e.timestamp||serverTimestamp()};return e.followUpDate&&(c.nextFollowUpDate=e.followUpDate,c.
nextFollowUpReason=e.followUpReason||"",c.nextFollowUpType=e.followUpType||"call",c.nextFollowUpCreatedBy=e.userId,c.ne
xtFollowUpCreatedAt=serverTimestamp()),await updateClient(s,c),o.id}catch(i){throw console.error("Error creating 
interaction:",i),i}},getFollowUpTasks=async(s={})=>{try{const e=collection(db,"followUpTasks");let 
i=query(e,orderBy("dueDate","asc"));return s.userId&&(i=query(i,where("assignedTo","==",s.userId))),s.status&&(i=query(
i,where("status","==",s.status))),s.clientId&&(i=query(i,where("clientId","==",s.clientId))),(await 
getDocs(i)).docs.map(o=>({id:o.id,...o.data()}))}catch(e){throw console.error("Error getting follow-up 
tasks:",e),e}},createFollowUpTask=async s=>{try{const e=collection(db,"followUpTasks"),i={...s,status:"pending",created
At:serverTimestamp(),updatedAt:serverTimestamp()};return(await addDoc(e,i)).id}catch(e){throw console.error("Error 
creating follow-up task:",e),e}},completeFollowUpTask=async(s,e="")=>{try{const i=doc(db,"followUpTasks",s),a=await 
getDoc(i);if(a.exists()){const o=a.data();await updateDoc(i,{status:"completed",completedAt:serverTimestamp(),completed
Notes:e,updatedAt:serverTimestamp()}),o.clientId&&await 
createInteraction(o.clientId,{type:"task_completed",summary:`Follow-up task completed: 
${o.description}`,notes:e,userId:o.assignedTo,relatedTaskId:s})}}catch(i){throw console.error("Error completing 
follow-up task:",i),i}},getDeals=async(s=null,e={})=>{try{const i=collection(db,"deals");let a;e.clientId?a=query(i,whe
re("clientId","==",e.clientId)):s?a=query(i,where("stage","==",s)):e.userId?a=query(i,where("assignedTo","==",e.userId)
):a=query(i,orderBy("lastContact","desc"));let c=(await getDocs(a)).docs.map(d=>({id:d.id,...d.data()}));return 
s&&e.clientId&&(c=c.filter(d=>d.stage===s)),c.sort((d,h)=>{var $,rt,tt,mt;const j=((rt=($=d.lastContact)==null?void 
0:$.toDate)==null?void 0:rt.call($))||new Date(0);return(((mt=(tt=h.lastContact)==null?void 0:tt.toDate)==null?void 
0:mt.call(tt))||new Date(0))-j}),c}catch(i){return console.error("Error getting deals:",i),[]}},createDeal=async 
s=>{try{const e=collection(db,"deals"),i={...s,createdAt:serverTimestamp(),updatedAt:serverTimestamp(),lastContact:s.la
stContact||serverTimestamp(),stage:s.stage||"new-lead"};return(await addDoc(e,i)).id}catch(e){throw 
console.error("Error creating deal:",e),e}},updateDeal=async(s,e)=>{try{const i=doc(db,"deals",s);await 
updateDoc(i,{...e,updatedAt:serverTimestamp()})}catch(i){throw console.error("Error updating 
deal:",i),i}},moveDealStage=async(s,e)=>{try{await updateDeal(s,{stage:e})}catch(i){throw console.error("Error moving 
deal stage:",i),i}},getQuotes=async(s=null)=>{try{const e=collection(db,"quotes");let 
i=query(e,orderBy("date","desc"));return s&&(i=query(i,where("clientId","==",s))),(await 
getDocs(i)).docs.map(o=>({id:o.id,...o.data()}))}catch(e){throw console.error("Error getting 
quotes:",e),e}},getInvoices=async(s=null)=>{try{const e=collection(db,"invoices");let 
i=query(e,orderBy("issueDate","desc"));return s&&(i=query(i,where("clientId","==",s))),(await 
getDocs(i)).docs.map(o=>({id:o.id,...o.data()}))}catch(e){throw console.error("Error getting 
invoices:",e),e}},getContracts=async s=>{try{const e=collection(db,"clients",s,"contracts");return(await 
getDocs(e)).docs.map(a=>({id:a.id,...a.data()}))}catch(e){return console.error("Error getting 
contracts:",e),[]}},getMessages=async(s=null)=>{try{const e=collection(db,"messages");let 
i=query(e,orderBy("createdAt","desc"));return s&&(i=query(i,where("status","==",s))),(await 
getDocs(i)).docs.map(o=>({id:o.id,...o.data()}))}catch(e){throw console.error("Error getting 
messages:",e),e}},createMessage=async s=>{try{const e=collection(db,"messages"),i={...s,status:s.status||"unread",creat
edAt:serverTimestamp(),updatedAt:serverTimestamp()};return(await addDoc(e,i)).id}catch(e){throw console.error("Error 
creating message:",e),e}},getFeedback=async(s=null)=>{try{const e=collection(db,"feedback");let 
i;s?i=query(e,where("clientId","==",s)):i=query(e,orderBy("date","desc"));let o=(await 
getDocs(i)).docs.map(c=>({id:c.id,...c.data()}));return s&&o.sort((c,d)=>{var _,$,rt,tt,mt,vt,_t,wt;const 
h=(($=(_=c.date)==null?void 0:_.toDate)==null?void 0:$.call(_))||((tt=(rt=c.createdAt)==null?void 
0:rt.toDate)==null?void 0:tt.call(rt))||new Date(0);return(((vt=(mt=d.date)==null?void 0:mt.toDate)==null?void 
0:vt.call(mt))||((wt=(_t=d.createdAt)==null?void 0:_t.toDate)==null?void 0:wt.call(_t))||new 
Date(0))-h}),o}catch(e){return console.error("Error getting feedback:",e),[]}},createFeedback=async s=>{try{const 
e=collection(db,"feedback"),i={...s,createdAt:serverTimestamp(),updatedAt:serverTimestamp()};return(await 
addDoc(e,i)).id}catch(e){throw console.error("Error creating feedback:",e),e}},getBudgets=async(s=null)=>{try{const 
e=collection(db,"budgets");let i=e;return s&&(i=query(e,where("financialYear","==",s))),(await 
getDocs(i)).docs.map(o=>({id:o.id,...o.data()}))}catch(e){return console.error("Error getting 
budgets:",e),[]}},saveBudget=async(s,e,i,a,o)=>{try{const 
c=`${s}_${i.replace("/","-")}_${e.replace(/\s+/g,"_")}`,d=doc(db,"budgets",c),h=await getDoc(d),j={salespersonId:s,prod
uctLine:e,financialYear:i,budgetAmount:parseFloat(a)||0,updatedBy:o,updatedAt:serverTimestamp()};return 
h.exists()||(j.createdAt=serverTimestamp()),await setDoc(d,j,{merge:!0}),c}catch(c){throw console.error("Error saving 
budget:",c),c}},normalizeProductLine=s=>{if(!s)return"Other";const e=s.toLowerCase().replace(/\s+/g,"");return 
e.includes("learnership")?"Learnerships":e.includes("tap")||e==="tapbusiness"?"TAP 
Business":e.includes("compliance")?"Compliance Training":e.includes("othercourse")||e==="othercourses"?"Other 
Courses":e==="other"?"Other":s},getBudgetVsForecast=async s=>{try{const[e,i,a,o]=await 
Promise.all([getBudgets(s),getClientFinancials(),getClients(),getUsers()]),c=i.filter(_=>{const 
$=String(_.financialYear||""),rt=String(s||"");if($===rt)return!0;if(rt.includes("/")){const tt=rt.split("/")[1];if($==
=tt)return!0}return!!($.includes("/")&&$.split("/")[1]===rt)}),d={},h=["general","consulting","conculting"];return 
c.forEach(_=>{const $=a.find(_t=>_t.id===_.clientId);if(!$||!$.assignedSalesPerson)return;const 
rt=(_.productLine||"").toLowerCase().replace(/\s+/g,"");if(h.includes(rt)||rt.includes("consult"))return;const 
tt=$.assignedSalesPerson;d[tt]||(d[tt]={});const 
mt=normalizeProductLine(_.productLine);d[tt][mt]||(d[tt][mt]={forecast:0});const 
vt=_.fullYearForecast||0;d[tt][mt].forecast+=vt}),o.map(_=>{const 
$=e.filter(wt=>wt.salespersonId===_.id),rt=d[_.id]||{},tt=new 
Set([...$.map(wt=>wt.productLine),...Object.keys(rt)]),mt={};let vt=0,_t=0;return tt.forEach(wt=>{var jt,bt;const 
ht=((jt=$.find(ut=>ut.productLine===wt))==null?void 0:jt.budgetAmount)||0,dt=((bt=rt[wt])==null?void 0:bt.forecast)||0;
mt[wt]={budget:ht,forecast:dt},vt+=ht,_t+=dt}),{userId:_.id,userName:_.displayName||_.email||"Unknown",productData:mt,t
otalBudget:vt,totalForecast:_t,variance:_t-vt,variancePercent:vt>0?(_t-vt)/vt*100:0}}).filter(_=>_.totalBudget>0||_.tot
alForecast>0)}catch(e){return console.error("Error getting budget vs 
forecast:",e),[]}},getFinancialYearSettings=async(s=null)=>{try{const e={currentFinancialYear:"2024/2025",financialYear
Start:"March",financialYearEnd:"February",reportingMonth:"February",currencySymbol:"R"};if(s){const 
o=doc(db,"systemSettings",`financialYear_${s}`),c=await getDoc(o);if(c.exists()){const d=c.data();return{currentFinanci
alYear:d.currentFinancialYear||e.currentFinancialYear,financialYearStart:d.financialYearStart||e.financialYearStart,fin
ancialYearEnd:d.financialYearEnd||e.financialYearEnd,reportingMonth:d.reportingMonth||d.financialYearEnd||e.reportingMo
nth,currencySymbol:d.currencySymbol||e.currencySymbol,tenantId:s,isSystemWide:!1}}}const 
i=doc(db,"systemSettings","financialYear"),a=await getDoc(i);if(a.exists()){const o=a.data();return{currentFinancialYea
r:o.currentFinancialYear||e.currentFinancialYear,financialYearStart:o.financialYearStart||e.financialYearStart,financia
lYearEnd:o.financialYearEnd||e.financialYearEnd,reportingMonth:o.reportingMonth||o.financialYearEnd||e.reportingMonth,c
urrencySymbol:o.currencySymbol||e.currencySymbol,tenantId:null,isSystemWide:!0}}return{...e,tenantId:null,isSystemWide:
!0}}catch(e){throw console.error("Error getting financial year 
settings:",e),e}},saveFinancialYearSettings=async(s,e=null)=>{try{const 
i=e?`financialYear_${e}`:"financialYear",a=doc(db,"systemSettings",i);return await 
setDoc(a,{...s,tenantId:e||null,updatedAt:serverTimestamp()},{merge:!0}),{success:!0,docId:i}}catch(i){throw 
console.error("Error saving financial year settings:",i),i}},getMonthNumber=s=>({January:0,February:1,March:2,April:3,M
ay:4,June:5,July:6,August:7,September:8,October:9,November:10,December:11})[s]??2,getMonthName=s=>["January","February"
,"March","April","May","June","July","August","September","October","November","December"][s]??"March",calculateFinanci
alYearMonths=async(s=null)=>{try{const e=await getFinancialYearSettings(s),i=getMonthNumber(e.financialYearStart||"Marc
h"),a=getMonthNumber(e.financialYearEnd||"February"),o=getMonthNumber(e.reportingMonth||e.financialYearEnd||"February")
;let c=new Date().getFullYear();if(typeof e.currentFinancialYear=="string"){const 
$=e.currentFinancialYear.split("/"),rt=$[1]||$[0],tt=parseInt(rt,10);isNaN(tt)||(c=tt)}const d=[];let 
h=i,j=i>a?c-1:c;for(let $=0;$<12;$++){const rt=getMonthName(h);d.push({name:rt,calendarMonth:h,calendarMonthName:rt,yea
r:j,fyMonthNumber:$+1,isYTD:!1,isRemaining:!1}),h++,h>11&&(h=0,j++)}let _=0;for(let 
$=0;$<d.length;$++)if(d[$].calendarMonth===o){_=$+1;break}if(_>0){for(let $=0;$<_;$++)d[$].isYTD=!0;for(let 
$=_;$<d.length;$++)d[$].isRemaining=!0}return console.log("calculateFinancialYearMonths:",{fyStartMonth:getMonthName(i)
,reportingMonth:e.reportingMonth,reportingFyMonth:_,ytdMonthCount:d.filter($=>$.isYTD).length,ytdMonthNames:d.filter($=
>$.isYTD).map($=>$.name)}),{currentFinancialYear:e.currentFinancialYear,fyEndYear:c,fyStartMonth:i,fyEndMonth:a,reporti
ngMonth:o,reportingMonthName:e.reportingMonth,reportingFyMonth:_,months:d,ytdMonths:d.filter($=>$.isYTD),remainingMonth
s:d.filter($=>$.isRemaining)}}catch(e){throw console.error("Error calculating financial year 
months:",e),e}},getClientFinancialsByYear=async(s,e={})=>{try{const i=collection(db,"clientFinancials");let 
a;e.clientId?a=query(i,where("clientId","==",e.clientId)):a=query(i,where("financialYear","==",s));let c=(await 
getDocs(a)).docs.map(d=>({id:d.id,...d.data()}));return e.clientId&&s&&(c=c.filter(d=>d.financialYear===s)),e.productLi
ne&&(c=c.filter(d=>d.productLine===e.productLine)),c}catch(i){return console.error("Error getting client financials by 
year:",i),[]}},calculateFullYearForecast=s=>{var o;const e=((o=s.history)==null?void 
0:o.currentYearYTD)||0,i=s.months||{},a=Object.values(i).reduce((c,d)=>c+(parseFloat(d)||0),0);return 
e+a},saveClientFinancial=async(s,e,i,a,o,c)=>{try{const 
d=`${s}_${i}_${a.replace(/\s+/g,"_")}`,h=doc(db,"clientFinancials",d),j=await 
getDoc(h),_=calculateFullYearForecast(o),$=o.fullYearForecast!==void 0?o.fullYearForecast:_,rt={clientId:s,clientName:e
,financialYear:i,productLine:a,history:o.history||{yearMinus1:0,yearMinus2:0,yearMinus3:0,currentYearYTD:0},months:o.mo
nths||{},fullYearForecast:$,comments:o.comments||"",learnershipDetails:o.learnershipDetails||[],tapBusinessDetails:o.ta
pBusinessDetails||[],complianceDetails:o.complianceDetails||[],otherCoursesDetails:o.otherCoursesDetails||[],lastUpdate
dBy:c,lastUpdatedAt:serverTimestamp()};return j.exists()||(rt.createdAt=serverTimestamp()),await 
setDoc(h,rt,{merge:!0}),d}catch(d){throw console.error("Error saving client 
financial:",d),d}},getClientFinancials=async(s=null)=>{try{if(Array.isArray(s)&&s.length===0)return[];const 
e=collection(db,"clientFinancials"),a=(await getDocs(e)).docs.map(o=>({id:o.id,...o.data()}));return 
s&&s.length>0?a.filter(o=>s.includes(o.clientId)):a}catch(e){return console.error("Error getting client 
financials:",e),[]}},getSkillsPartners$1=async(s=null)=>{try{const e=collection(db,"skillsPartners");let i;if(s){const 
o=query(e,where("tenantId","==",s));i=await getDocs(o)}else i=await getDocs(e);return 
i.docs.map(o=>({id:o.id,...o.data()})).sort((o,c)=>(o.name||"").localeCompare(c.name||""))}catch(e){return 
console.error("Error getting skills partners:",e),[]}},createSkillsPartner=async s=>{try{const e=collection(db,"skillsP
artners"),i={...s,tenantId:s.tenantId||null,status:s.status||"Active",createdAt:serverTimestamp(),updatedAt:serverTimes
tamp()};return(await addDoc(e,i)).id}catch(e){throw console.error("Error creating skills 
partner:",e),e}},updateSkillsPartner=async(s,e)=>{try{const i=doc(db,"skillsPartners",s);await 
updateDoc(i,{...e,updatedAt:serverTimestamp()})}catch(i){throw console.error("Error updating skills 
partner:",i),i}},deleteSkillsPartner=async s=>{try{const 
e=collection(db,"clients"),i=query(e,where("skillsPartnerId","==",s)),a=await getDocs(i),o=writeBatch(db);a.docs.forEac
h(d=>{o.update(d.ref,{skillsPartnerId:null,updatedAt:serverTimestamp()})});const c=doc(db,"skillsPartners",s);return 
o.delete(c),await o.commit(),{deletedPartnerId:s,clientsUpdated:a.docs.length}}catch(e){throw console.error("Error 
deleting skills partner:",e),e}},getClientsWithAllocationStatus=async(s=null)=>{try{const 
e=collection(db,"clients");let i;if(s){const j=query(e,where("tenantId","==",s));i=await getDocs(j)}else i=await 
getDocs(e);const a=i.docs.map(j=>({id:j.id,...j.data()})),o=await 
getDocs(collection(db,"users")),c={};o.docs.forEach(j=>{c[j.id]=j.data()});const d=await 
getDocs(collection(db,"skillsPartners")),h={};return d.docs.forEach(j=>{h[j.id]=j.data()}),a.map(j=>{var 
_,$,rt;return{...j,salesPersonName:j.assignedSalesPerson?((_=c[j.assignedSalesPerson])==null?void 
0:_.displayName)||(($=c[j.assignedSalesPerson])==null?void 
0:$.email)||"Unknown":null,skillsPartnerName:j.skillsPartnerId?((rt=h[j.skillsPartnerId])==null?void 0:rt.name)||"Unkno
wn":null,hasUnallocatedSalesPerson:!j.assignedSalesPerson,hasUnallocatedSkillsPartner:!j.skillsPartnerId}})}catch(e){th
row console.error("Error getting clients with allocation 
status:",e),e}},assignSalesPersonToClient=async(s,e)=>{try{const i=doc(db,"clients",s);await 
updateDoc(i,{assignedSalesPerson:e,updatedAt:serverTimestamp()})}catch(i){throw console.error("Error assigning sales 
person:",i),i}},assignSkillsPartnerToClient=async(s,e)=>{try{const i=doc(db,"clients",s);await 
updateDoc(i,{skillsPartnerId:e,updatedAt:serverTimestamp()})}catch(i){throw console.error("Error assigning skills 
partner:",i),i}},getProductLines=async()=>{try{const s=collection(db,"productLines");return(await 
getDocs(s)).docs.map(a=>({id:a.id,...a.data()})).sort((a,o)=>(a.order||0)-(o.order||0))}catch(s){return 
console.error("Error getting product lines:",s),[]}},updateProductLine=async(s,e)=>{try{const 
i=doc(db,"productLines",s);return await updateDoc(i,{...e,updatedAt:serverTimestamp()}),s}catch(i){throw 
console.error("Error updating product line:",i),i}},getProducts=async(s=null)=>{try{const 
e=collection(db,"products");let i=query(e);return s&&(i=query(e,where("productLineId","==",s))),(await 
getDocs(i)).docs.map(c=>({id:c.id,...c.data()})).sort((c,d)=>(c.name||"").localeCompare(d.name||""))}catch(e){return 
console.error("Error getting products:",e),[]}},initializeProductCatalog=async()=>{try{const s=writeBatch(db),e=[{id:"l
earnerships",name:"Learnerships",calculationMethodId:"learnerships",order:1,status:"active"},{id:"tapBusiness",name:"TA
P Business",calculationMethodId:"tapBusiness",order:2,status:"active"},{id:"compliance",name:"Compliance 
Training",calculationMethodId:"compliance",order:3,status:"active"},{id:"otherCourses",name:"Other 
Courses",calculationMethodId:"otherCourses",order:4,status:"active"}];for(const o of e){const 
c=doc(db,"productLines",o.id);s.set(c,{...o,createdAt:serverTimestamp(),updatedAt:serverTimestamp()})}const 
i=[{name:"NQF4 Business Administration 
Learnership",productLineId:"learnerships",defaultCostPerLearner:35e3,status:"active"},{name:"NQF4 Generic Management 
Learnership",productLineId:"learnerships",defaultCostPerLearner:38e3,status:"active"},{name:"NQF2 Contact Centre 
Learnership",productLineId:"learnerships",defaultCostPerLearner:25e3,status:"active"},{name:"NQF3 IT Support 
Learnership",productLineId:"learnerships",defaultCostPerLearner:32e3,status:"active"},{name:"TAP Basic 
Package",productLineId:"tapBusiness",defaultMonthlyFee:150,status:"active"},{name:"TAP Standard 
Package",productLineId:"tapBusiness",defaultMonthlyFee:250,status:"active"},{name:"TAP Premium 
Package",productLineId:"tapBusiness",defaultMonthlyFee:400,status:"active"},{name:"TAP Enterprise 
Package",productLineId:"tapBusiness",defaultMonthlyFee:600,status:"active"},{name:"First Aid Level 
1",productLineId:"compliance",defaultCostPerTrainee:1200,status:"active"},{name:"First Aid Level 
2",productLineId:"compliance",defaultCostPerTrainee:1800,status:"active"},{name:"First Aid Level 
3",productLineId:"compliance",defaultCostPerTrainee:2500,status:"active"},{name:"Fire Safety 
Training",productLineId:"compliance",defaultCostPerTrainee:950,status:"active"},{name:"OHS Representative 
Training",productLineId:"compliance",defaultCostPerTrainee:3500,status:"active"},{name:"Excel Advanced 
Training",productLineId:"otherCourses",defaultDailyRate:2500,defaultDuration:2,status:"active"},{name:"Excel Basic 
Training",productLineId:"otherCourses",defaultDailyRate:2e3,defaultDuration:1,status:"active"},{name:"Project 
Management 
Fundamentals",productLineId:"otherCourses",defaultDailyRate:3500,defaultDuration:3,status:"active"},{name:"Leadership 
Development Workshop",productLineId:"otherCourses",defaultDailyRate:4e3,defaultDuration:2,status:"active"}];for(const 
o of i){const 
c=doc(collection(db,"products"));s.set(c,{...o,createdAt:serverTimestamp(),updatedAt:serverTimestamp()})}const 
a=doc(db,"systemSettings","calculationOptions");s.set(a,{nqfLevels:[{id:"nqf1",name:"NQF Level 
1",value:1},{id:"nqf2",name:"NQF Level 2",value:2},{id:"nqf3",name:"NQF Level 3",value:3},{id:"nqf4",name:"NQF Level 
4",value:4},{id:"nqf5",name:"NQF Level 5",value:5},{id:"nqf6",name:"NQF Level 
6",value:6}],tapPackages:[{id:"basic",name:"Basic Package",value:"basic"},{id:"standard",name:"Standard 
Package",value:"standard"},{id:"premium",name:"Premium Package",value:"premium"},{id:"enterprise",name:"Enterprise 
Package",value:"enterprise"}],complianceCourses:[{id:"first-aid-1",name:"First Aid Level 
1",value:"first-aid-1"},{id:"first-aid-2",name:"First Aid Level 2",value:"first-aid-2"},{id:"first-aid-3",name:"First 
Aid Level 3",value:"first-aid-3"},{id:"fire-safety",name:"Fire 
Safety",value:"fire-safety"},{id:"ohs",name:"Occupational Health & Safety",value:"ohs"},{id:"hazmat",name:"Hazardous 
Materials Handling",value:"hazmat"},{id:"food-safety",name:"Food Safety & 
Hygiene",value:"food-safety"}],generalCourses:[{id:"excel-basic",name:"Excel 
Basic",value:"excel-basic"},{id:"excel-advanced",name:"Excel 
Advanced",value:"excel-advanced"},{id:"word",name:"Microsoft 
Word",value:"word"},{id:"powerpoint",name:"PowerPoint",value:"powerpoint"},{id:"project-mgmt",name:"Project 
Management",value:"project-mgmt"},{id:"leadership",name:"Leadership 
Skills",value:"leadership"},{id:"communication",name:"Business 
Communication",value:"communication"},{id:"time-mgmt",name:"Time 
Management",value:"time-mgmt"}],createdAt:serverTimestamp(),updatedAt:serverTimestamp()}),await 
s.commit(),console.log("Product catalog initialized successfully with default product lines, products, and calculation 
options")}catch(s){throw console.error("Error initializing product 
catalog:",s),s}},updateClientFollowUp=async(s,e,i)=>{try{const a=doc(db,"clients",s);await updateDoc(a,{nextFollowUpDat
e:e.date,nextFollowUpReason:e.reason||"",nextFollowUpType:e.type||"call",nextFollowUpCreatedBy:i,nextFollowUpCreatedAt:
serverTimestamp(),updatedAt:serverTimestamp()})}catch(a){throw console.error("Error updating client 
follow-up:",a),a}},getFollowUpStats=async(s=null)=>{try{const e=collection(db,"clients");let 
i=query(e);s&&(i=query(e,where("assignedSalesPerson","==",s)));const a=await getDocs(i),o=new 
Date;o.setHours(0,0,0,0);const c=new Date(o);c.setDate(c.getDate()+1);const d=new Date(o);d.setDate(d.getDate()+7);let 
h=0,j=0,_=0,$=0,rt=0;return a.docs.forEach(tt=>{const mt={id:tt.id,...tt.data()},vt=(mt.pipelineStatus||"").toLowerCase
();if(vt==="won"||vt==="lost")return;if(rt++,!mt.nextFollowUpDate){h++;return}const 
_t=mt.nextFollowUpDate.toDate?mt.nextFollowUpDate.toDate():new Date(mt.nextFollowUpDate);_t.setHours(0,0,0,0),_t<o?j++:
_t.getTime()===o.getTime()?_++:_t<d&&$++}),{noFollowUp:h,overdue:j,dueToday:_,dueThisWeek:$,totalActive:rt,needsAttenti
on:h+j}}catch(e){return console.error("Error getting follow-up stats:",e),{noFollowUp:0,overdue:0,dueToday:0,dueThisWee
k:0,totalActive:0,needsAttention:0}}},getClientsForFollowUpManagement=async(s=null,e="all")=>{try{const 
i=collection(db,"clients");let 
a=query(i,orderBy("name","asc"));s&&(a=query(i,where("assignedSalesPerson","==",s),orderBy("name","asc")));const 
o=await getDocs(a),c=new Date;c.setHours(0,0,0,0);const d=new Date(c);d.setDate(d.getDate()+1);const h=new 
Date(c);h.setDate(h.getDate()+7);let j=o.docs.map(_=>{const $={id:_.id,..._.data()};let 
rt="none",tt=null;if($.nextFollowUpDate){const mt=$.nextFollowUpDate.toDate?$.nextFollowUpDate.toDate():new 
Date($.nextFollowUpDate);mt.setHours(0,0,0,0);const vt=mt-c;tt=Math.ceil(vt/(1e3*60*60*24)),mt<c?rt="overdue":mt.getTim
e()===c.getTime()?rt="due-today":mt<h?rt="due-this-week":rt="scheduled"}return{...$,followUpStatus:rt,daysUntilFollowUp
:tt}});return j=j.filter(_=>{const $=(_.pipelineStatus||"").toLowerCase();return $!=="won"&&$!=="lost"}),e==="no-follow
up"?j=j.filter(_=>_.followUpStatus==="none"):e==="overdue"?j=j.filter(_=>_.followUpStatus==="overdue"):e==="due-today"?
j=j.filter(_=>_.followUpStatus==="due-today"):e==="due-this-week"?j=j.filter(_=>_.followUpStatus==="due-this-week"):e==
="needs-attention"&&(j=j.filter(_=>_.followUpStatus==="none"||_.followUpStatus==="overdue")),j.sort((_,$)=>{const 
rt={overdue:0,none:1,"due-today":2,"due-this-week":3,scheduled:4},tt=rt[_.followUpStatus]-rt[$.followUpStatus];return t
t!==0?tt:_.daysUntilFollowUp!==null&&$.daysUntilFollowUp!==null?_.daysUntilFollowUp-$.daysUntilFollowUp:(_.name||"").lo
caleCompare($.name||"")}),j}catch(i){throw console.error("Error getting clients for follow-up 
management:",i),i}},DEFAULT_LEGAL_DOCUMENT_TYPES=[{key:"serviceAgreement",label:"Service Agreement 
Signed",required:!0,order:1},{key:"companyRegistration",label:"Company Registration 
Documents",required:!0,order:2},{key:"bbbee",label:"B-BBEE 
Certificate",required:!1,order:3},{key:"taxClearance",label:"Tax Clearance 
Certificate",required:!1,order:4},{key:"bankingDetails",label:"Banking Details 
Received",required:!0,order:5},{key:"contactList",label:"Contact List 
Provided",required:!1,order:6},{key:"orgChart",label:"Organogram / Org 
Chart",required:!1,order:7},{key:"wspdocs",label:"WSP/ATR 
Documents",required:!1,order:8}],getLegalDocumentTypes=async(s=null)=>{try{if(s){const 
a=doc(db,"systemSettings",`legalDocuments_${s}`),o=await getDoc(a);if(o.exists()){const 
c=o.data();if(c.documentTypes&&Array.isArray(c.documentTypes)&&c.documentTypes.length>0)return 
c.documentTypes.sort((d,h)=>(d.order||0)-(h.order||0))}}const e=doc(db,"systemSettings","legalDocuments"),i=await 
getDoc(e);if(i.exists()){const 
a=i.data();if(a.documentTypes&&Array.isArray(a.documentTypes)&&a.documentTypes.length>0)return 
a.documentTypes.sort((o,c)=>(o.order||0)-(c.order||0))}return DEFAULT_LEGAL_DOCUMENT_TYPES}catch(e){return 
console.error("Error getting legal document 
types:",e),DEFAULT_LEGAL_DOCUMENT_TYPES}},saveLegalDocumentTypes=async(s,e=null)=>{try{const 
i=e?`legalDocuments_${e}`:"legalDocuments",a=doc(db,"systemSettings",i);return await 
setDoc(a,{documentTypes:s,tenantId:e,updatedAt:serverTimestamp()}),!0}catch(i){throw console.error("Error saving legal 
document types:",i),i}},UPLOAD_TYPES={YTD_3:"ytd-3",YTD_2:"ytd-2",YTD_1:"ytd-1",BUDGET:"budget",YTD_ACTUAL:"ytd-actual"
},MONTHS=["January","February","March","April","May","June","July","August","September","October","November","December"
],SHORT_MONTHS=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],parseCSV=s=>{var h,j;const 
e=s.trim().split(/\r?\n/);if(e.length<2)throw new Error("CSV must have at least a header row and one data row");const 
i=parseCSVLine(e[0]),a=i.findIndex(_=>_.toLowerCase().includes("client")||_.toLowerCase()==="client 
name"),o=i.findIndex(_=>_.toLowerCase().includes("product")||_.toLowerCase()==="product name");if(a===-1)throw new 
Error('CSV must have a "Client Name" column');if(o===-1)throw new Error('CSV must have a "Product Name" column');const 
c=[];if(i.forEach((_,$)=>{if($<=1)return;const 
rt=_.toLowerCase().trim(),tt=rt.match(/^(?:month\s*)?(\d{1,2})$|^m(\d{1,2})$/);if(tt){const 
_t=parseInt(tt[1]||tt[2],10);if(_t>=1&&_t<=12){c.push({index:$,month:`Month ${_t}`,monthNumber:_t-1});return}}const 
mt=SHORT_MONTHS.findIndex(_t=>rt.startsWith(_t.toLowerCase()));if(mt!==-1){const 
_t=c.length+1;c.push({index:$,month:`Month ${_t}`,monthNumber:_t-1,legacyName:MONTHS[mt]});return}const 
vt=MONTHS.findIndex(_t=>rt.startsWith(_t.toLowerCase()));if(vt!==-1){const _t=c.length+1;c.push({index:$,month:`Month 
${_t}`,monthNumber:_t-1,legacyName:MONTHS[vt]})}}),c.length===0)throw new Error('CSV must have month columns. Use 
"Month 1", "Month 2", ... "Month 12" format (or legacy: Jan, Feb, March, etc.)');c.length!==12&&console.warn(`CSV has 
${c.length} month columns. Expected 12 for a full financial year.`);const d=[];for(let _=1;_<e.length;_++){const 
$=e[_].trim();if(!$)continue;const rt=parseCSVLine($),tt=(h=rt[a])==null?void 0:h.trim(),mt=(j=rt[o])==null?void 
0:j.trim();if(!tt||!mt)continue;const vt={};let _t=0;c.forEach(({index:wt,month:ht})=>{var jt;const 
dt=parseFloat(((jt=rt[wt])==null?void 0:jt.replace(/[^\d.-]/g,""))||"0");vt[ht]=dt,_t+=dt}),d.push({clientName:tt,produ
ctName:mt,monthlyData:vt,total:_t})}return{headers:i,monthColumns:c.map(_=>_.month),rows:d,totalAmount:d.reduce((_,$)=>
_+$.total,0)}},parseCSVLine=s=>{const e=[];let i="",a=!1;for(let o=0;o<s.length;o++){const 
c=s[o];c==='"'?a=!a:c===","&&!a?(e.push(i.trim()),i=""):i+=c}return 
e.push(i.trim()),e},validateUploadData=(s,e,i)=>{const a=[],o=[],c=[],d=[],h=new Set,j=new Map;e.forEach(tt=>{const 
mt=normalizeString(tt.name||tt.companyName||"");mt&&j.set(mt,tt)});const _=new Map;i.forEach(tt=>{const 
mt=normalizeString(tt.name);mt&&_.set(mt,tt)}),s.forEach((tt,mt)=>{const vt=normalizeString(tt.clientName),_t=normalize
String(tt.productName),wt=`${vt}|${_t}`;if(h.has(wt)){d.push({...tt,rowIndex:mt+2,reason:"Duplicate client/product 
combination"});return}h.add(wt);const ht=j.get(vt),dt=_.get(_t);ht||o.push({clientName:tt.clientName,productName:tt.pro
ductName,total:tt.total,rowIndex:mt+2}),dt||c.find(jt=>normalizeString(jt.productName)===_t)||c.push({productName:tt.pr
oductName,rowIndex:mt+2}),ht&&dt&&a.push({...tt,clientId:ht.id,clientName:ht.name||ht.companyName,productId:dt.id,produ
ctLine:dt.name,rowIndex:mt+2})});const $=a.reduce((tt,mt)=>tt+mt.total,0),rt=o.reduce((tt,mt)=>tt+mt.total,0);return{ma
tchedRows:a,unmatchedClients:o,unmatchedProducts:c,duplicateRows:d,summary:{totalRows:s.length,matchedCount:a.length,un
matchedClientCount:o.length,unmatchedProductCount:c.length,duplicateCount:d.length,totalAmount:s.reduce((tt,mt)=>tt+mt.
total,0),matchedAmount:$,unmatchedAmount:rt}}},normalizeString=s=>s?s.toLowerCase().replace(/\s+/g," 
").replace(/[^\w\s]/g,"").trim():"",saveFinancialUpload=async(s,e,i,a,o)=>{const c=writeBatch(db),d=[];let h=0;const j=
`${o}_${e}_${i.replace("/","-")}_${Date.now()}`,_=doc(db,"financialUploads",j);c.set(_,{tenantId:o,uploadType:e,financi
alYear:i,uploadedBy:a,uploadedAt:serverTimestamp(),rowCount:s.length,totalAmount:s.reduce(($,rt)=>$+rt.total,0),status:
"processing"});for(const $ of s)try{const rt=`${o}_${e}_${i.replace("/","-")}_${$.clientId}_${$.productId}`,tt=doc(db,"
financialData",rt);c.set(tt,{tenantId:o,uploadType:e,financialYear:i,clientId:$.clientId,clientName:$.clientName,produc
tId:$.productId,productLine:$.productLine,monthlyData:$.monthlyData,total:$.total,uploadId:j,uploadedBy:a,updatedAt:ser
verTimestamp()}),h++}catch(rt){d.push({row:$,error:rt.message})}return await c.commit(),await setDoc(_,{status:"complet
ed",successCount:h,errorCount:d.length,completedAt:serverTimestamp()},{merge:!0}),{uploadId:j,successCount:h,errorCount
:d.length,errors:d}},getFinancialData=async(s,e,i)=>{try{console.log("getFinancialData 
query:",{uploadType:s,financialYear:e,tenantId:i});const 
a=collection(db,"financialData"),o=query(a,where("tenantId","==",i)),d=(await 
getDocs(o)).docs.map($=>({id:$.id,...$.data()}));console.log("DEBUG - All tenant financial 
data:",{tenantId:i,totalCount:d.length,uploadTypes:[...new Set(d.map($=>$.uploadType))],financialYears:[...new 
Set(d.map($=>$.financialYear))],sampleDoc:d[0]});const 
h=query(a,where("tenantId","==",i),where("uploadType","==",s),where("financialYear","==",e)),_=(await 
getDocs(h)).docs.map($=>({id:$.id,...$.data()}));return console.log("getFinancialData 
results:",{uploadType:s,financialYear:e,count:_.length,firstDoc:_[0]}),_}catch(a){throw console.error("Error getting 
financial data:",a),a}},getFinancialDataByClient=async(s,e)=>{try{const 
i=collection(db,"financialData"),a=query(i,where("tenantId","==",e),where("clientId","==",s));return(await 
getDocs(a)).docs.map(c=>({id:c.id,...c.data()}))}catch(i){throw console.error("Error getting financial data by 
client:",i),i}},getUploadHistory=async s=>{try{const 
e=collection(db,"financialUploads"),i=query(e,where("tenantId","==",s));return(await 
getDocs(i)).docs.map(o=>({id:o.id,...o.data()})).sort((o,c)=>{var j,_,$,rt;const d=((_=(j=o.uploadedAt)==null?void 
0:j.toDate)==null?void 0:_.call(j))||new Date(0);return(((rt=($=c.uploadedAt)==null?void 0:$.toDate)==null?void 
0:rt.call($))||new Date(0))-d})}catch(e){throw console.error("Error getting upload 
history:",e),e}},deleteFinancialUpload=async(s,e)=>{try{const 
i=collection(db,"financialData"),a=query(i,where("uploadId","==",s),where("tenantId","==",e)),o=await 
getDocs(a),c=writeBatch(db);o.docs.forEach(h=>{c.delete(h.ref)});const d=doc(db,"financialUploads",s);return 
c.delete(d),await c.commit(),{deletedCount:o.docs.length}}catch(i){throw console.error("Error deleting financial 
upload:",i),i}},calculateFinancialYear=(s,e)=>{if(!s)return"";const i=s.split("/");if(i.length!==2)return s;const 
a=parseInt(i[0],10)+e,o=parseInt(i[1],10)+e;return`${a}/${o}`},Dashboard=()=>{var ks,Ln,hn,Jn,nr,Ls,Vn,Yn,Kn,$n,Cn,zs,X
s,mn,On,As;const[s,e]=reactExports.useState({learnerships:{previousYear:0,ytd:0,forecast:0,fullYear:0,budget:0},tapBusi
ness:{previousYear:0,ytd:0,forecast:0,fullYear:0,budget:0},compliance:{previousYear:0,ytd:0,forecast:0,fullYear:0,budge
t:0},otherCourses:{previousYear:0,ytd:0,forecast:0,fullYear:0,budget:0},other:{previousYear:0,ytd:0,forecast:0,fullYear
:0,budget:0}}),[i,a]=reactExports.useState({leadGeneration:0,initialContact:0,needsAssessment:0,proposalSent:0,negotiat
ion:0,dealClosed:0}),[o,c]=reactExports.useState({unread:0,assigned:0,inProgress:0,resolved:0}),[d,h]=reactExports.useS
tate([]),[j,_]=reactExports.useState(!0),[$,rt]=reactExports.useState([]),[tt,mt]=reactExports.useState([]),[vt,_t]=rea
ctExports.useState([]),[wt,ht]=reactExports.useState({totalClients:0,unallocatedSalesPerson:0,unallocatedSkillsPartner:
0}),[dt,jt]=reactExports.useState(!1),[bt,ut]=reactExports.useState("all"),[Rt,st]=reactExports.useState(!1),[it,nt]=re
actExports.useState(null),[ct,xt]=reactExports.useState(!1),[yt,Tt]=reactExports.useState(!1),[fs,cs]=reactExports.useS
tate({noFollowUp:0,overdue:0,dueToday:0,dueThisWeek:0,needsAttention:0}),[Es,ls]=reactExports.useState(!1),[Yt,Mt]=reac
tExports.useState([]),[Gt,Wt]=reactExports.useState("needs-attention"),[ms,ss]=reactExports.useState(!1),[ys,Et]=reactE
xports.useState(null),gt=[{value:"call",label:"Call"},{value:"email",label:"Send 
Email"},{value:"meeting",label:"Schedule Meeting"},{value:"proposal",label:"Send 
Proposal"},{value:"quote",label:"Follow Up on Quote"},{value:"demo",label:"Schedule 
Demo"},{value:"contract",label:"Contract 
Discussion"},{value:"other",label:"Other"}],[ft,zt]=reactExports.useState([{id:"",name:"Not in Pipeline",color:"#f5f5f5
"}]),{getTenantId:Ct,currentUser:Pt,isSystemAdmin:$t,accessibleUserIds:Bt,isTeamManager:Lt,isSalesHead:Xt,hierarchyLoad
ing:Dt}=useTenant(),Ht=$t||Lt()||Xt(),os=Pt==null?void 
0:Pt.uid,Qt=Ct();reactExports.useEffect(()=>{!Dt&&Pt&&Ft()},[Dt,Pt,Bt,Qt]);const Ft=async()=>{try{Ht?(await Cs(),await 
gs()):await xs(),await Os(),await Tn()}catch(Zt){console.error("Error loading dashboard 
data:",Zt),_(!1)}},xs=async()=>{try{const ns=(await getClientsWithAllocationStatus($t?null:Qt)).filter(ts=>Bt.includes(
ts.assignedSalesPerson)||Bt.includes(ts.createdBy));rt(ns)}catch(Zt){console.error("Error loading salesperson 
clients:",Zt)}},Cs=async()=>{try{const Zt=$t?null:Qt,[Is,ns,ts]=await Promise.all([getClientsWithAllocationStatus(Zt),g
etUsersByTenant(Zt),getSkillsPartners$1(Zt)]);rt(Is),mt(ns),_t(ts);const _s=Is.filter(Gs=>!Gs.assignedSalesPerson).leng
th,Ns=Is.filter(Gs=>!Gs.skillsPartnerId||Gs.skillsPartnerId==="not-allocated").length;ht({totalClients:Is.length,unallo
catedSalesPerson:_s,unallocatedSkillsPartner:Ns})}catch(Zt){console.error("Error loading allocation 
data:",Zt)}},gs=async()=>{try{const Zt=await getPipelineStatusAnalytics();nt(Zt)}catch(Zt){console.error("Error 
loading pipeline analytics:",Zt)}},Os=async()=>{try{const Is=await 
getFollowUpStats(Ht?null:os);cs(Is)}catch(Zt){console.error("Error loading follow-up 
stats:",Zt)}},qt=async(Zt="needs-attention")=>{Wt(Zt),ls(!0);try{let ns=await getClientsForFollowUpManagement(Ht?null:o
s,Zt);Lt()&&!Xt()&&!$t&&(ns=ns.filter(ts=>Bt.includes(ts.assignedSalesPerson)||Bt.includes(ts.createdBy))),Mt(ns)}catch
(Is){console.error("Error loading follow-up clients:",Is)}},js=async Zt=>{Wt(Zt);try{let ns=await getClientsForFollowUp
Management(Ht?null:os,Zt);Lt()&&!Xt()&&!$t&&(ns=ns.filter(ts=>Bt.includes(ts.assignedSalesPerson)||Bt.includes(ts.creat
edBy))),Mt(ns)}catch(Is){console.error("Error loading follow-up clients:",Is)}},es=async(Zt,Is)=>{ss(!0);try{const 
ns=new Date(`${Is.date}T09:00:00`),ts=Timestamp.fromDate(ns);await 
updateClientFollowUp(Zt,{date:ts,reason:Is.reason,type:Is.type},os),await Os();let Ns=await getClientsForFollowUpManage
ment(Ht?null:os,Gt);Lt()&&!Xt()&&!$t&&(Ns=Ns.filter(Gs=>Bt.includes(Gs.assignedSalesPerson)||Bt.includes(Gs.createdBy))
),Mt(Ns),Et(null)}catch(ns){console.error("Error saving follow-up:",ns),alert("Failed to save follow-up. Please try 
again.")}finally{ss(!1)}},vs=Zt=>Zt?(Zt.toDate?Zt.toDate():new 
Date(Zt)).toLocaleDateString("en-ZA",{day:"numeric",month:"short",year:"numeric"}):"Not 
set",Rs=(Zt,Is)=>{switch(Zt){case"overdue":return jsxRuntimeExports.jsxs("span",{className:"followup-badge 
overdue",children:["Overdue by ",Math.abs(Is)," days"]});case"due-today":return 
jsxRuntimeExports.jsx("span",{className:"followup-badge due-today",children:"Due Today"});case"due-this-week":return 
jsxRuntimeExports.jsxs("span",{className:"followup-badge due-soon",children:[Is," days"]});case"scheduled":return 
jsxRuntimeExports.jsxs("span",{className:"followup-badge scheduled",children:[Is," days"]});case"none":default:return 
jsxRuntimeExports.jsx("span",{className:"followup-badge none",children:"No follow-up"})}},Tn=async()=>{try{const 
Zt=await getPipelineStatuses();zt([{id:"",name:"Not in Pipeline",color:"#f5f5f5"},...Zt]);const ns=await 
getClientsWithAllocationStatus($t?null:Qt);let 
ts=ns;!$t&&!Xt()&&(ts=ns.filter(Us=>Bt.includes(Us.assignedSalesPerson)||Bt.includes(Us.createdBy)));const Ns=(await ge
tFinancialYearSettings(Qt)).currentFinancialYear,Gs=calculateFinancialYear(Ns,-1),Qs=Ns&&Ns.includes("/")?parseInt(Ns.s
plit("/")[0]):parseInt(Ns)||new Date().getFullYear(),qs=await calculateFinancialYearMonths(Qt),sn=((qs==null?void 
0:qs.ytdMonths)||[]).map(Us=>Us.name),[tn,Dn,Un]=await Promise.all([getFinancialData(UPLOAD_TYPES.YTD_ACTUAL,Ns,Qt),get
FinancialData(UPLOAD_TYPES.YTD_1,Gs,Qt),getFinancialData(UPLOAD_TYPES.BUDGET,Ns,Qt)]);console.log("Dashboard - 
Financial data loaded:",{currentFY:Ns,fy1:Gs,ytdActualCount:tn==null?void 0:tn.length,ytd1Count:Dn==null?void 
0:Dn.length,budgetCount:Un==null?void 0:Un.length,ytdMonthNames:sn,allMonthNames:((qs==null?void 
0:qs.months)||[]).map(Us=>Us.name),sampleYtdActual:tn==null?void 0:tn[0],sampleBudget:Un==null?void 0:Un[0]});const 
Zn=new Map;ts.forEach(Us=>{Us.name&&Zn.set(Us.name.toLowerCase().trim(),Us.id)});const gr=ts.map(Us=>Us.id),hr=Us=>Us!=
null&&Us.length?Us.filter(rn=>!!(gr.includes(rn.clientId)||rn.clientName&&Zn.has(rn.clientName.toLowerCase().trim()))):
[],Er=hr(tn),yr=hr(Dn),wr=hr(Un),Pr=Us=>{let rn=0;return Us.forEach(Ms=>{const 
ur=Ms.monthlyData||Ms.monthlyValues||{};sn.forEach(fn=>{rn+=ur[fn]||0})}),rn},Rr=Us=>{let rn=0;const 
Ms=((qs==null?void 0:qs.months)||[]).map(ur=>ur.name);return Us.forEach(ur=>{const 
fn=ur.monthlyData||ur.monthlyValues||{};Ms.forEach(Nn=>{rn+=fn[Nn]||0})}),rn},ar=["general","consulting"];if(Ht){const 
rn=ts.map(Ys=>Ys.id),Ms={learnerships:{previousYear:0,ytd:0,forecast:0,budget:0},tapBusiness:{previousYear:0,ytd:0,fore
cast:0,budget:0},compliance:{previousYear:0,ytd:0,forecast:0,budget:0},otherCourses:{previousYear:0,ytd:0,forecast:0,bu
dget:0},other:{previousYear:0,ytd:0,forecast:0,budget:0}},fn=(await getClientFinancials(rn)).filter(Ys=>{const 
bs=Ys.financialYear;if(!bs)return!1;const yn=String(bs);return 
yn.includes("/")?parseInt(yn.split("/")[0])===Qs:parseInt(yn)===Qs}),Nn={};Er.forEach(Ys=>{const bs=(Ys.productLine||""
).toLowerCase().replace(/\s+/g,"");ar.includes(bs)||(Nn[bs]||(Nn[bs]={ytdActual:[],ytd1:[],budget:[]}),Nn[bs].ytdActual
.push(Ys))}),yr.forEach(Ys=>{const bs=(Ys.productLine||"").toLowerCase().replace(/\s+/g,"");ar.includes(bs)||(Nn[bs]||(
Nn[bs]={ytdActual:[],ytd1:[],budget:[]}),Nn[bs].ytd1.push(Ys))}),wr.forEach(Ys=>{const bs=(Ys.productLine||"").toLowerC
ase().replace(/\s+/g,"");ar.includes(bs)||(Nn[bs]||(Nn[bs]={ytdActual:[],ytd1:[],budget:[]}),Nn[bs].budget.push(Ys))}),
Object.entries(Nn).forEach(([Ys,bs])=>{const yn=Pr(bs.ytdActual),jn=Rr(bs.ytd1),Mn=Rr(bs.budget);Ys==="learnerships"?(M
s.learnerships.ytd+=yn,Ms.learnerships.previousYear+=jn,Ms.learnerships.budget+=Mn):Ys==="tapbusiness"?(Ms.tapBusiness.
ytd+=yn,Ms.tapBusiness.previousYear+=jn,Ms.tapBusiness.budget+=Mn):Ys==="compliancetraining"?(Ms.compliance.ytd+=yn,Ms.
compliance.previousYear+=jn,Ms.compliance.budget+=Mn):Ys==="othercourses"?(Ms.otherCourses.ytd+=yn,Ms.otherCourses.prev
iousYear+=jn,Ms.otherCourses.budget+=Mn):(Ms.other.ytd+=yn,Ms.other.previousYear+=jn,Ms.other.budget+=Mn)}),fn.forEach(
Ys=>{var Mn;const bs=(Ys.productLine||"").toLowerCase().replace(/\s+/g,"");if(ar.includes(bs))return;const 
yn=Ys.fullYearForecast||0,jn=Math.max(0,yn-(((Mn=Ys.history)==null?void 0:Mn.currentYearYTD)||0));bs==="learnerships"?M
s.learnerships.forecast+=jn:bs==="tapbusiness"?Ms.tapBusiness.forecast+=jn:bs==="compliancetraining"?Ms.compliance.fore
cast+=jn:bs==="othercourses"?Ms.otherCourses.forecast+=jn:Ms.other.forecast+=jn}),e(Ms)}else{const rn=ts.map(Ys=>Ys.id)
,Ms={learnerships:{previousYear:0,ytd:0,forecast:0,budget:0},tapBusiness:{previousYear:0,ytd:0,forecast:0,budget:0},com
pliance:{previousYear:0,ytd:0,forecast:0,budget:0},otherCourses:{previousYear:0,ytd:0,forecast:0,budget:0},other:{previ
ousYear:0,ytd:0,forecast:0,budget:0}},fn=(await getClientFinancials(rn)).filter(Ys=>{const 
bs=Ys.financialYear;if(!bs)return!1;const yn=String(bs);return 
yn.includes("/")?parseInt(yn.split("/")[0])===Qs:parseInt(yn)===Qs}),Nn={};Er.forEach(Ys=>{const bs=(Ys.productLine||""
).toLowerCase().replace(/\s+/g,"");ar.includes(bs)||(Nn[bs]||(Nn[bs]={ytdActual:[],ytd1:[],budget:[]}),Nn[bs].ytdActual
.push(Ys))}),yr.forEach(Ys=>{const bs=(Ys.productLine||"").toLowerCase().replace(/\s+/g,"");ar.includes(bs)||(Nn[bs]||(
Nn[bs]={ytdActual:[],ytd1:[],budget:[]}),Nn[bs].ytd1.push(Ys))}),wr.forEach(Ys=>{const bs=(Ys.productLine||"").toLowerC
ase().replace(/\s+/g,"");ar.includes(bs)||(Nn[bs]||(Nn[bs]={ytdActual:[],ytd1:[],budget:[]}),Nn[bs].budget.push(Ys))}),
Object.entries(Nn).forEach(([Ys,bs])=>{const yn=Pr(bs.ytdActual),jn=Rr(bs.ytd1),Mn=Rr(bs.budget);Ys==="learnerships"?(M
s.learnerships.ytd+=yn,Ms.learnerships.previousYear+=jn,Ms.learnerships.budget+=Mn):Ys==="tapbusiness"?(Ms.tapBusiness.
ytd+=yn,Ms.tapBusiness.previousYear+=jn,Ms.tapBusiness.budget+=Mn):Ys==="compliancetraining"?(Ms.compliance.ytd+=yn,Ms.
compliance.previousYear+=jn,Ms.compliance.budget+=Mn):Ys==="othercourses"?(Ms.otherCourses.ytd+=yn,Ms.otherCourses.prev
iousYear+=jn,Ms.otherCourses.budget+=Mn):(Ms.other.ytd+=yn,Ms.other.previousYear+=jn,Ms.other.budget+=Mn)}),fn.forEach(
Ys=>{var _r;const bs=(Ys.productLine||"").toLowerCase().replace(/\s+/g,"");if(ar.includes(bs))return;const 
yn=Ys.fullYearForecast||0;let jn=0;bs==="learnerships"?jn=Ms.learnerships.ytd:bs==="tapbusiness"?jn=Ms.tapBusiness.ytd:
bs==="compliancetraining"?jn=Ms.compliance.ytd:bs==="othercourses"?jn=Ms.otherCourses.ytd:jn=Ms.other.ytd;const 
Mn=Math.max(0,yn-(((_r=Ys.history)==null?void 0:_r.currentYearYTD)||0));bs==="learnerships"?Ms.learnerships.forecast+=M
n:bs==="tapbusiness"?Ms.tapBusiness.forecast+=Mn:bs==="compliancetraining"?Ms.compliance.forecast+=Mn:bs==="othercourse
s"?Ms.otherCourses.forecast+=Mn:Ms.other.forecast+=Mn}),e(Ms)}const Rn={leadGeneration:ts.filter(Us=>Us.pipelineStatus=
=="new-lead").length,initialContact:ts.filter(Us=>Us.pipelineStatus==="qualifying").length,needsAssessment:ts.filter(Us
=>Us.pipelineStatus==="qualifying").length,proposalSent:ts.filter(Us=>Us.pipelineStatus==="proposal-sent").length,negot
iation:ts.filter(Us=>Us.pipelineStatus==="negotiation"||Us.pipelineStatus==="awaiting-decision").length,dealClosed:ts.f
ilter(Us=>Us.pipelineStatus==="won").length};a(Rn);const fr=await getMessages(),cr=!$t&&!Xt()?fr.filter(Us=>Bt.includes
(Us.assignedTo)||Bt.includes(Us.createdBy)):fr;c({unread:cr.filter(Us=>Us.status==="unread").length,assigned:cr.filter(
Us=>Us.status==="assigned").length,inProgress:cr.filter(Us=>Us.status==="in-progress").length,resolved:cr.filter(Us=>Us
.status==="resolved").length});const Gn=await getFeedback(),Dr=!$t&&!Xt()?Gn.filter(Us=>Bt.includes(Us.createdBy)||Bt.i
ncludes(Us.salesPersonId)):Gn;h(Dr.slice(0,5)),_(!1)}catch(Zt){console.error("Error loading dashboard 
data:",Zt),_(!1)}},Hs=Zt=>new Intl.NumberFormat("en-ZA",{style:"currency",currency:"ZAR",minimumFractionDigits:0}).form
at(Zt),En=async(Zt,Is)=>{st(!0);try{await assignSalesPersonToClient(Zt,Is||null),await 
Cs()}catch(ns){console.error("Error assigning sales person:",ns)}finally{st(!1)}},Hn=async(Zt,Is)=>{st(!0);try{await 
assignSkillsPartnerToClient(Zt,Is||null),await Cs()}catch(ns){console.error("Error assigning skills 
partner:",ns)}finally{st(!1)}},Ps=async(Zt,Is)=>{Tt(!0);try{await 
updateClientPipelineStatus(Zt,Is),rt(ns=>ns.map(ts=>ts.id===Zt?{...ts,pipelineStatus:Is}:ts)),await 
gs()}catch(ns){console.error("Error updating pipeline 
status:",ns)}finally{Tt(!1)}},Ts=()=>$.filter(Zt=>!Zt.pipelineStatus);return j?jsxRuntimeExports.jsxs("div",{className:
"dashboard",children:[jsxRuntimeExports.jsx("h1",{children:"Dashboard"}),jsxRuntimeExports.jsx("div",{className:"dashbo
ard-content",children:jsxRuntimeExports.jsx("p",{children:"Loading..."})})]}):jsxRuntimeExports.jsxs("div",{className:"
dashboard",children:[jsxRuntimeExports.jsxs("h1",{children:["Dashboard 
",!Ht&&jsxRuntimeExports.jsx("span",{className:"dashboard-subtitle",children:"(My Performance)"})]}),Ht&&(wt.unallocate
dSalesPerson>0||wt.unallocatedSkillsPartner>0)&&jsxRuntimeExports.jsxs("div",{className:"manager-alert-bar",children:[j
sxRuntimeExports.jsxs("div",{className:"alert-content",children:[jsxRuntimeExports.jsx("span",{className:"alert-icon",c
hildren:"âšï¸"}),jsxRuntimeExports.jsxs("span",{className:"alert-text",children:[wt.unallocatedSalesPerson>0&&jsxRunti
meExports.jsxs("span",{className:"alert-stat clickable",onClick:()=>{ut("sales"),jt(!0)},children:[jsxRuntimeExports.js
x("strong",{children:wt.unallocatedSalesPerson})," clients without sales 
person"]}),wt.unallocatedSalesPerson>0&&wt.unallocatedSkillsPartner>0&&" | 
",wt.unallocatedSkillsPartner>0&&jsxRuntimeExports.jsxs("span",{className:"alert-stat clickable",onClick:()=>{ut("skill
s"),jt(!0)},children:[jsxRuntimeExports.jsx("strong",{children:wt.unallocatedSkillsPartner})," clients without skills p
artner"]})]})]}),jsxRuntimeExports.jsx("button",{className:"allocate-btn",onClick:()=>{ut("all"),jt(!0)},children:"Mana
ge Allocations"})]}),Ts().length>0&&jsxRuntimeExports.jsxs("div",{className:"manager-alert-bar pipeline-alert",children
:[jsxRuntimeExports.jsxs("div",{className:"alert-content",children:[jsxRuntimeExports.jsx("span",{className:"alert-icon
",children:"ðŸ“Š"}),jsxRuntimeExports.jsx("span",{className:"alert-text",children:jsxRuntimeExports.jsxs("span",{classN
ame:"alert-stat clickable",onClick:()=>xt(!0),children:[jsxRuntimeExports.jsx("strong",{children:Ts().length})," 
",Ht?"clients":"of your clients"," without pipeline 
status"]})})]}),jsxRuntimeExports.jsx("button",{className:"allocate-btn",onClick:()=>xt(!0),children:"Manage 
Pipeline"})]}),fs.needsAttention>0&&jsxRuntimeExports.jsxs("div",{className:"manager-alert-bar followup-alert",children
:[jsxRuntimeExports.jsxs("div",{className:"alert-content",children:[jsxRuntimeExports.jsx("span",{className:"alert-icon
",children:"ðŸ“…"}),jsxRuntimeExports.jsxs("span",{className:"alert-text",children:[fs.overdue>0&&jsxRuntimeExports.jsx
s("span",{className:"alert-stat 
clickable",onClick:()=>qt("overdue"),children:[jsxRuntimeExports.jsx("strong",{children:fs.overdue})," overdue 
follow-ups"]}),fs.overdue>0&&fs.noFollowUp>0&&" | 
",fs.noFollowUp>0&&jsxRuntimeExports.jsxs("span",{className:"alert-stat 
clickable",onClick:()=>qt("no-followup"),children:[jsxRuntimeExports.jsx("strong",{children:fs.noFollowUp})," 
",Ht?"clients":"of your clients"," without 
follow-up"]}),fs.dueToday>0&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[" | 
",jsxRuntimeExports.jsxs("span",{className:"alert-stat 
clickable",onClick:()=>qt("due-today"),children:[jsxRuntimeExports.jsx("strong",{children:fs.dueToday})," due today"]})
]})]})]}),jsxRuntimeExports.jsx("button",{className:"allocate-btn",onClick:()=>qt("needs-attention"),children:"Manage F
ollow-Ups"})]}),jsxRuntimeExports.jsxs("div",{className:"dashboard-grid",children:[jsxRuntimeExports.jsxs("div",{classN
ame:"dashboard-widget financial-dashboard",children:[jsxRuntimeExports.jsxs("div",{className:"widget-header",children:[
jsxRuntimeExports.jsx("h2",{children:Ht?"Financial Dashboard":"My Financial 
Performance"}),jsxRuntimeExports.jsx(Link,{to:"/dashboard/edit-financial",className:"edit-link",children:Ht?"Edit 
All":"Edit My Forecasts"})]}),jsxRuntimeExports.jsx("div",{className:"financial-table",children:jsxRuntimeExports.jsxs(
"table",{children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx
("th",{children:"Product 
Line"}),!Ht&&jsxRuntimeExports.jsx("th",{children:"Budget"}),jsxRuntimeExports.jsx("th",{children:"Previous Year"}),jsx
RuntimeExports.jsx("th",{children:"YTD"}),jsxRuntimeExports.jsx("th",{children:"Forecast"}),jsxRuntimeExports.jsx("th",
{children:"Full Year Forecast"})]})}),jsxRuntimeExports.jsxs("tbody",{children:[jsxRuntimeExports.jsxs("tr",{children:[
jsxRuntimeExports.jsx("td",{children:"Learnerships"}),!Ht&&jsxRuntimeExports.jsx("td",{children:Hs(s.learnerships.budge
t)}),jsxRuntimeExports.jsx("td",{children:Hs(s.learnerships.previousYear)}),jsxRuntimeExports.jsx("td",{children:Hs(s.l
earnerships.ytd)}),jsxRuntimeExports.jsx("td",{children:Hs(s.learnerships.forecast)}),jsxRuntimeExports.jsx("td",{child
ren:Hs(s.learnerships.ytd+s.learnerships.forecast)})]}),jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("t
d",{children:"TAP Business"}),!Ht&&jsxRuntimeExports.jsx("td",{children:Hs(s.tapBusiness.budget)}),jsxRuntimeExports.js
x("td",{children:Hs(s.tapBusiness.previousYear)}),jsxRuntimeExports.jsx("td",{children:Hs(s.tapBusiness.ytd)}),jsxRunti
meExports.jsx("td",{children:Hs(s.tapBusiness.forecast)}),jsxRuntimeExports.jsx("td",{children:Hs(s.tapBusiness.ytd+s.t
apBusiness.forecast)})]}),jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("td",{children:"Compliance"}),!H
t&&jsxRuntimeExports.jsx("td",{children:Hs(s.compliance.budget)}),jsxRuntimeExports.jsx("td",{children:Hs(s.compliance.
previousYear)}),jsxRuntimeExports.jsx("td",{children:Hs(s.compliance.ytd)}),jsxRuntimeExports.jsx("td",{children:Hs(s.c
ompliance.forecast)}),jsxRuntimeExports.jsx("td",{children:Hs(s.compliance.ytd+s.compliance.forecast)})]}),jsxRuntimeEx
ports.jsxs("tr",{children:[jsxRuntimeExports.jsx("td",{children:"Other Courses"}),!Ht&&jsxRuntimeExports.jsx("td",{chil
dren:Hs(s.otherCourses.budget)}),jsxRuntimeExports.jsx("td",{children:Hs(s.otherCourses.previousYear)}),jsxRuntimeExpor
ts.jsx("td",{children:Hs(s.otherCourses.ytd)}),jsxRuntimeExports.jsx("td",{children:Hs(s.otherCourses.forecast)}),jsxRu
ntimeExports.jsx("td",{children:Hs(s.otherCourses.ytd+s.otherCourses.forecast)})]}),(((ks=s.other)==null?void 
0:ks.previousYear)>0||((Ln=s.other)==null?void 0:Ln.ytd)>0||((hn=s.other)==null?void 
0:hn.forecast)>0||((Jn=s.other)==null?void 0:Jn.budget)>0)&&jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.js
x("td",{children:"Other"}),!Ht&&jsxRuntimeExports.jsx("td",{children:Hs(((nr=s.other)==null?void 
0:nr.budget)||0)}),jsxRuntimeExports.jsx("td",{children:Hs(((Ls=s.other)==null?void 
0:Ls.previousYear)||0)}),jsxRuntimeExports.jsx("td",{children:Hs(((Vn=s.other)==null?void 
0:Vn.ytd)||0)}),jsxRuntimeExports.jsx("td",{children:Hs(((Yn=s.other)==null?void 
0:Yn.forecast)||0)}),jsxRuntimeExports.jsx("td",{children:Hs((((Kn=s.other)==null?void 
0:Kn.ytd)||0)+((($n=s.other)==null?void 0:$n.forecast)||0))})]})]}),jsxRuntimeExports.jsx("tfoot",{children:jsxRuntimeE
xports.jsxs("tr",{className:"totals-row",children:[jsxRuntimeExports.jsx("td",{children:jsxRuntimeExports.jsx("strong",
{children:"Total"})}),!Ht&&jsxRuntimeExports.jsx("td",{children:jsxRuntimeExports.jsx("strong",{children:Hs(s.learnersh
ips.budget+s.tapBusiness.budget+s.compliance.budget+s.otherCourses.budget+(((Cn=s.other)==null?void 0:Cn.budget)||0))})
}),jsxRuntimeExports.jsx("td",{children:jsxRuntimeExports.jsx("strong",{children:Hs(s.learnerships.previousYear+s.tapBu
siness.previousYear+s.compliance.previousYear+s.otherCourses.previousYear+(((zs=s.other)==null?void 0:zs.previousYear)|
|0))})}),jsxRuntimeExports.jsx("td",{children:jsxRuntimeExports.jsx("strong",{children:Hs(s.learnerships.ytd+s.tapBusin
ess.ytd+s.compliance.ytd+s.otherCourses.ytd+(((Xs=s.other)==null?void 0:Xs.ytd)||0))})}),jsxRuntimeExports.jsx("td",{ch
ildren:jsxRuntimeExports.jsx("strong",{children:Hs(s.learnerships.forecast+s.tapBusiness.forecast+s.compliance.forecast
+s.otherCourses.forecast+(((mn=s.other)==null?void 0:mn.forecast)||0))})}),jsxRuntimeExports.jsx("td",{children:jsxRunt
imeExports.jsx("strong",{children:Hs(s.learnerships.ytd+s.learnerships.forecast+(s.tapBusiness.ytd+s.tapBusiness.foreca
st)+(s.compliance.ytd+s.compliance.forecast)+(s.otherCourses.ytd+s.otherCourses.forecast)+((((On=s.other)==null?void 
0:On.ytd)||0)+(((As=s.other)==null?void 
0:As.forecast)||0)))})})]})})]})})]}),jsxRuntimeExports.jsxs("div",{className:"dashboard-widget pipeline-widget",childr
en:[jsxRuntimeExports.jsxs("div",{className:"widget-header",children:[jsxRuntimeExports.jsx("h2",{children:Ht?"Sales 
Pipeline":"My Pipeline"}),jsxRuntimeExports.jsx(Link,{to:"/sales-pipeline",className:"view-all-link",children:"View 
All"})]}),jsxRuntimeExports.jsx("div",{className:"pipeline-chart",children:(()=>{const Zt=[{name:"Lead Gen",count:i.lea
dGeneration,color:"#64B5F6"},{name:"Contact",count:i.initialContact,color:"#4FC3F7"},{name:"Assessment",count:i.needsAs
sessment,color:"#4DD0E1"},{name:"Proposal",count:i.proposalSent,color:"#FFA600"},{name:"Negotiation",count:i.negotiatio
n,color:"#FFB74D"},{name:"Closed",count:i.dealClosed,color:"#81C784"}],Is=Math.max(...Zt.map(ts=>ts.count),1),ns=Zt.red
uce((ts,_s)=>ts+_s.count,0);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs(
"div",{className:"pipeline-total",children:[jsxRuntimeExports.jsx("span",{className:"total-number",children:ns}),jsxRun
timeExports.jsx("span",{className:"total-label",children:"Total Clients in Pipeline"})]}),jsxRuntimeExports.jsx("div",{
className:"pipeline-bars",children:Zt.map((ts,_s)=>jsxRuntimeExports.jsxs("div",{className:"pipeline-bar-item",children
:[jsxRuntimeExports.jsx("div",{className:"bar-label",children:ts.name}),jsxRuntimeExports.jsx("div",{className:"bar-con
tainer",children:jsxRuntimeExports.jsx("div",{className:"bar-fill",style:{width:`${ts.count/Is*100}%`,backgroundColor:t
s.color}})}),jsxRuntimeExports.jsx("div",{className:"bar-count",children:ts.count})]},_s))})]})})()})]}),jsxRuntimeExpo
rts.jsxs("div",{className:"dashboard-widget messages-widget",children:[jsxRuntimeExports.jsxs("div",{className:"widget-
header",children:[jsxRuntimeExports.jsx("h2",{children:Ht?"Messages":"My 
Messages"}),jsxRuntimeExports.jsx(Link,{to:"/messages",className:"view-all-link",children:"View All"})]}),jsxRuntimeExp
orts.jsxs("div",{className:"message-stats",children:[jsxRuntimeExports.jsxs("div",{className:"stat-item",children:[jsxR
untimeExports.jsx("span",{className:"stat-label",children:"Unread"}),jsxRuntimeExports.jsx("span",{className:"stat-valu
e",children:o.unread})]}),jsxRuntimeExports.jsxs("div",{className:"stat-item",children:[jsxRuntimeExports.jsx("span",{c
lassName:"stat-label",children:"In Progress"}),jsxRuntimeExports.jsx("span",{className:"stat-value",children:o.inProgre
ss})]}),jsxRuntimeExports.jsxs("div",{className:"stat-item",children:[jsxRuntimeExports.jsx("span",{className:"stat-lab
el",children:"Assigned"}),jsxRuntimeExports.jsx("span",{className:"stat-value",children:o.assigned})]}),jsxRuntimeExpor
ts.jsxs("div",{className:"stat-item",children:[jsxRuntimeExports.jsx("span",{className:"stat-label",children:"Resolved"
}),jsxRuntimeExports.jsx("span",{className:"stat-value",children:o.resolved})]})]})]}),jsxRuntimeExports.jsxs("div",{cl
assName:"dashboard-widget feedback-widget",children:[jsxRuntimeExports.jsx("div",{className:"widget-header",children:js
xRuntimeExports.jsx("h2",{children:Ht?"Recent Client Feedback":"My Client Feedback"})}),jsxRuntimeExports.jsx("div",{cl
assName:"feedback-list",children:d.length>0?d.map(Zt=>jsxRuntimeExports.jsxs("div",{className:"feedback-item",children:
[jsxRuntimeExports.jsxs("div",{className:"feedback-header-row",children:[jsxRuntimeExports.jsx("div",{className:"feedba
ck-company",children:Zt.companyName||Zt.clientName}),jsxRuntimeExports.jsx("div",{className:"feedback-rating",children:
"â˜…".repeat(Zt.overallRating||0)})]}),Zt.content&&jsxRuntimeExports.jsx("div",{className:"feedback-content",children:Z
t.content}),jsxRuntimeExports.jsxs("div",{className:"feedback-meta",children:[jsxRuntimeExports.jsx("span",{className:"
feedback-user",children:Zt.userName||"Unknown 
User"}),jsxRuntimeExports.jsx("span",{className:"feedback-date",children:Zt.date?(Zt.date.toDate?Zt.date.toDate():new 
Date(Zt.date)).toLocaleDateString("en-ZA",{day:"numeric",month:"short",year:"numeric"}):"No 
date"})]}),Zt.followUpRequired&&jsxRuntimeExports.jsx("span",{className:"follow-up-badge",children:"Follow-Up 
Required"})]},Zt.id)):jsxRuntimeExports.jsx("p",{className:"no-feedback",children:"No recent feedback"})})]})]}),dt&&Ht
&&jsxRuntimeExports.jsx("div",{className:"allocation-modal-backdrop",onClick:()=>jt(!1),children:jsxRuntimeExports.jsxs
("div",{className:"allocation-modal",onClick:Zt=>Zt.stopPropagation(),children:[jsxRuntimeExports.jsxs("div",{className
:"allocation-modal-header",children:[jsxRuntimeExports.jsx("h3",{children:"Client Allocations"}),jsxRuntimeExports.jsx(
"button",{className:"close-btn",onClick:()=>jt(!1),children:"Ã—"})]}),jsxRuntimeExports.jsxs("div",{className:"allocati
on-filter-tabs",children:[jsxRuntimeExports.jsxs("button",{className:`filter-tab 
${bt==="all"?"active":""}`,onClick:()=>ut("all"),children:["All Clients 
(",wt.totalClients,")"]}),jsxRuntimeExports.jsxs("button",{className:`filter-tab 
${bt==="sales"?"active":""}`,onClick:()=>ut("sales"),children:["No Sales Person 
(",wt.unallocatedSalesPerson,")"]}),jsxRuntimeExports.jsxs("button",{className:`filter-tab 
${bt==="skills"?"active":""}`,onClick:()=>ut("skills"),children:["No Skills Partner (",wt.unallocatedSkillsPartner,")"]
})]}),jsxRuntimeExports.jsxs("div",{className:"allocation-modal-content",children:[Rt&&jsxRuntimeExports.jsx("div",{cla
ssName:"saving-overlay",children:"Saving..."}),jsxRuntimeExports.jsxs("table",{className:"allocation-table",children:[j
sxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("th",{children:"Cli
ent"}),jsxRuntimeExports.jsx("th",{children:"Type"}),jsxRuntimeExports.jsx("th",{children:"Sales 
Person"}),jsxRuntimeExports.jsx("th",{children:"Skills Partner"})]})}),jsxRuntimeExports.jsx("tbody",{children:$.filter
(Zt=>bt==="sales"?!Zt.assignedSalesPerson:bt==="skills"?!Zt.skillsPartnerId||Zt.skillsPartnerId==="not-allocated":!0).m
ap(Zt=>{const Is=!Zt.skillsPartnerId||Zt.skillsPartnerId==="not-allocated",ns=!Zt.assignedSalesPerson;return jsxRuntime
Exports.jsxs("tr",{className:ns||Is?"unallocated-row":"",children:[jsxRuntimeExports.jsx("td",{children:jsxRuntimeExpor
ts.jsx(Link,{to:`/clients/${Zt.id}`,className:"client-link",children:Zt.name})}),jsxRuntimeExports.jsx("td",{children:Z
t.type}),jsxRuntimeExports.jsx("td",{children:jsxRuntimeExports.jsxs("select",{value:Zt.assignedSalesPerson||"",onChang
e:ts=>En(Zt.id,ts.target.value),className:ns?"unallocated-select":"",children:[jsxRuntimeExports.jsx("option",{value:""
,children:"-- Select --"}),tt.map(ts=>jsxRuntimeExports.jsx("option",{value:ts.id,children:ts.displayName||ts.email},ts
.id))]})}),jsxRuntimeExports.jsx("td",{children:jsxRuntimeExports.jsxs("select",{value:Zt.skillsPartnerId||"not-allocat
ed",onChange:ts=>Hn(Zt.id,ts.target.value),className:Is?"unallocated-select":"",children:[jsxRuntimeExports.jsx("option
",{value:"not-allocated",children:"-- Not Allocated --"}),jsxRuntimeExports.jsx("option",{value:"none",children:"No 
Skills Partner"}),vt.map(ts=>jsxRuntimeExports.jsx("option",{value:ts.id,children:ts.name},ts.id))]})})]},Zt.id)})})]})
,vt.length===0&&jsxRuntimeExports.jsxs("div",{className:"no-partners-notice",children:[jsxRuntimeExports.jsx("p",{child
ren:"No skills partners have been created 
yet."}),jsxRuntimeExports.jsx(Link,{to:"/skills-partners",className:"create-partner-link",children:"Create Skills 
Partners â†’"})]})]}),jsxRuntimeExports.jsx("div",{className:"allocation-modal-footer",children:jsxRuntimeExports.jsx("
button",{className:"close-modal-btn",onClick:()=>jt(!1),children:"Close"})})]})}),ct&&jsxRuntimeExports.jsx("div",{clas
sName:"allocation-modal-backdrop",onClick:()=>xt(!1),children:jsxRuntimeExports.jsxs("div",{className:"allocation-modal
",onClick:Zt=>Zt.stopPropagation(),children:[jsxRuntimeExports.jsxs("div",{className:"allocation-modal-header",children
:[jsxRuntimeExports.jsx("h3",{children:"Manage Pipeline Status"}),jsxRuntimeExports.jsx("button",{className:"close-btn"
,onClick:()=>xt(!1),children:"Ã—"})]}),jsxRuntimeExports.jsx("div",{className:"pipeline-modal-info",children:jsxRuntime
Exports.jsxs("p",{children:["Assign pipeline stages to ",Ht?"clients":"your clients"," that don't have a status set."]}
)}),jsxRuntimeExports.jsxs("div",{className:"allocation-modal-content",children:[yt&&jsxRuntimeExports.jsx("div",{class
Name:"saving-overlay",children:"Saving..."}),jsxRuntimeExports.jsxs("table",{className:"allocation-table",children:[jsx
RuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("th",{children:"Clien
t"}),jsxRuntimeExports.jsx("th",{children:"Type"}),jsxRuntimeExports.jsx("th",{children:"Current 
Status"}),jsxRuntimeExports.jsx("th",{children:"Pipeline 
Stage"})]})}),jsxRuntimeExports.jsx("tbody",{children:Ts().map(Zt=>{var Is,ns;return jsxRuntimeExports.jsxs("tr",{class
Name:"unallocated-row",children:[jsxRuntimeExports.jsx("td",{children:jsxRuntimeExports.jsx(Link,{to:`/clients/${Zt.id}
`,className:"client-link",children:Zt.name})}),jsxRuntimeExports.jsx("td",{children:Zt.type}),jsxRuntimeExports.jsx("td
",{children:jsxRuntimeExports.jsx("span",{className:`status-badge status-${(Is=Zt.status)==null?void 0:Is.toLowerCase()
}`,children:Zt.status||"N/A"})}),jsxRuntimeExports.jsx("td",{children:jsxRuntimeExports.jsx("select",{value:Zt.pipeline
Status||"",onChange:ts=>Ps(Zt.id,ts.target.value),className:"pipeline-select 
unallocated-select",style:{backgroundColor:((ns=ft.find(ts=>ts.id===Zt.pipelineStatus))==null?void 0:ns.color)||"#f5f5f
5"},children:ft.map(ts=>jsxRuntimeExports.jsx("option",{value:ts.id,children:ts.name},ts.id))})})]},Zt.id)})})]}),Ts().
length===0&&jsxRuntimeExports.jsx("div",{className:"no-partners-notice",children:jsxRuntimeExports.jsxs("p",{children:[
"All ",Ht?"clients":"your clients"," have been assigned a pipeline status!"]})})]}),jsxRuntimeExports.jsx("div",{classN
ame:"allocation-modal-footer",children:jsxRuntimeExports.jsx("button",{className:"close-modal-btn",onClick:()=>xt(!1),c
hildren:"Close"})})]})}),Es&&jsxRuntimeExports.jsx("div",{className:"allocation-modal-backdrop",onClick:()=>{ls(!1),Et(
null)},children:jsxRuntimeExports.jsxs("div",{className:"allocation-modal followup-modal",onClick:Zt=>Zt.stopPropagatio
n(),children:[jsxRuntimeExports.jsxs("div",{className:"allocation-modal-header",children:[jsxRuntimeExports.jsx("h3",{c
hildren:"Manage Client Follow-Ups"}),jsxRuntimeExports.jsx("button",{className:"close-btn",onClick:()=>{ls(!1),Et(null)
},children:"Ã—"})]}),jsxRuntimeExports.jsxs("div",{className:"followup-filter-tabs",children:[jsxRuntimeExports.jsxs("b
utton",{className:`filter-tab 
${Gt==="needs-attention"?"active":""}`,onClick:()=>js("needs-attention"),children:["Needs Attention 
(",fs.noFollowUp+fs.overdue,")"]}),jsxRuntimeExports.jsxs("button",{className:`filter-tab 
${Gt==="overdue"?"active":""}`,onClick:()=>js("overdue"),children:["Overdue 
(",fs.overdue,")"]}),jsxRuntimeExports.jsxs("button",{className:`filter-tab 
${Gt==="no-followup"?"active":""}`,onClick:()=>js("no-followup"),children:["No Follow-Up 
(",fs.noFollowUp,")"]}),jsxRuntimeExports.jsxs("button",{className:`filter-tab 
${Gt==="due-today"?"active":""}`,onClick:()=>js("due-today"),children:["Due Today 
(",fs.dueToday,")"]}),jsxRuntimeExports.jsx("button",{className:`filter-tab ${Gt==="all"?"active":""}`,onClick:()=>js("
all"),children:"All"})]}),jsxRuntimeExports.jsxs("div",{className:"allocation-modal-content",children:[ms&&jsxRuntimeEx
ports.jsx("div",{className:"saving-overlay",children:"Saving..."}),Yt.length>0?jsxRuntimeExports.jsx("div",{className:"
followup-clients-list",children:Yt.map(Zt=>{var Is;return 
jsxRuntimeExports.jsxs("div",{className:`followup-client-card ${Zt.followUpStatus}`,children:[jsxRuntimeExports.jsxs("d
iv",{className:"followup-client-header",children:[jsxRuntimeExports.jsx(Link,{to:`/clients/${Zt.id}`,className:"client-
link",children:Zt.name}),Rs(Zt.followUpStatus,Zt.daysUntilFollowUp)]}),Zt.nextFollowUpDate&&jsxRuntimeExports.jsxs("div
",{className:"followup-current-info",children:[jsxRuntimeExports.jsx("span",{className:"followup-date",children:vs(Zt.n
extFollowUpDate)}),Zt.nextFollowUpType&&jsxRuntimeExports.jsx("span",{className:"followup-type",children:((Is=gt.find(n
s=>ns.value===Zt.nextFollowUpType))==null?void 0:Is.label)||Zt.nextFollowUpType}),Zt.nextFollowUpReason&&jsxRuntimeExpo
rts.jsx("span",{className:"followup-reason",children:Zt.nextFollowUpReason})]}),ys===Zt.id?jsxRuntimeExports.jsxs("div"
,{className:"followup-edit-form",children:[jsxRuntimeExports.jsxs("div",{className:"form-row",children:[jsxRuntimeExpor
ts.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Follow-Up Date 
*"}),jsxRuntimeExports.jsx("input",{type:"date",id:`followup-date-${Zt.id}`,defaultValue:(()=>{const ns=new 
Date;return ns.setDate(ns.getDate()+7),ns.toISOString().split("T")[0]})(),min:new Date().toISOString().split("T")[0]})]
}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Action Type 
*"}),jsxRuntimeExports.jsx("select",{id:`followup-type-${Zt.id}`,defaultValue:"call",children:gt.map(ns=>jsxRuntimeExpo
rts.jsx("option",{value:ns.value,children:ns.label},ns.value))})]})]}),jsxRuntimeExports.jsxs("div",{className:"form-gr
oup",children:[jsxRuntimeExports.jsx("label",{children:"Reason 
*"}),jsxRuntimeExports.jsx("input",{type:"text",id:`followup-reason-${Zt.id}`,placeholder:"E.g., Follow up on 
proposal, Schedule demo..."})]}),jsxRuntimeExports.jsxs("div",{className:"followup-edit-actions",children:[jsxRuntimeEx
ports.jsx("button",{className:"cancel-btn",onClick:()=>Et(null),children:"Cancel"}),jsxRuntimeExports.jsx("button",{cla
ssName:"save-btn",onClick:()=>{const ns=document.getElementById(`followup-date-${Zt.id}`).value,ts=document.getElementB
yId(`followup-type-${Zt.id}`).value,_s=document.getElementById(`followup-reason-${Zt.id}`).value;ns&&_s?es(Zt.id,{date:
ns,type:ts,reason:_s}):alert("Please fill in all required fields")},children:"Save Follow-Up"})]})]}):jsxRuntimeExports
.jsxs("div",{className:"followup-client-actions",children:[jsxRuntimeExports.jsx("button",{className:"set-followup-btn"
,onClick:()=>Et(Zt.id),children:Zt.nextFollowUpDate?"Update Follow-Up":"Set 
Follow-Up"}),jsxRuntimeExports.jsx(Link,{to:`/clients/${Zt.id}`,className:"view-client-btn",children:"View Client"})]})
]},Zt.id)})}):jsxRuntimeExports.jsx("div",{className:"no-partners-notice",children:jsxRuntimeExports.jsx("p",{children:
"No clients match this filter. Great job staying on top of your follow-ups!"})})]}),jsxRuntimeExports.jsx("div",{classN
ame:"allocation-modal-footer",children:jsxRuntimeExports.jsx("button",{className:"close-modal-btn",onClick:()=>{ls(!1),
Et(null)},children:"Close"})})]})})]})},getCalculationTemplates=async()=>{try{const s=collection(db,"calculationTemplat
es"),e=query(s,where("status","!=","deleted"),orderBy("status"),orderBy("name"));return(await 
getDocs(e)).docs.map(a=>({id:a.id,...a.data()}))}catch(s){console.error("Error getting calculation 
templates:",s);try{const e=collection(db,"calculationTemplates");return(await getDocs(e)).docs.map(a=>({id:a.id,...a.da
ta()})).filter(a=>a.status!=="deleted").sort((a,o)=>(a.name||"").localeCompare(o.name||""))}catch(e){return 
console.error("Fallback query also failed:",e),[]}}},getCalculationTemplate=async s=>{try{const 
e=doc(db,"calculationTemplates",s),i=await getDoc(e);return i.exists()?{id:i.id,...i.data()}:null}catch(e){throw 
console.error("Error getting calculation template:",e),e}},createCalculationTemplateWithId=async(s,e)=>{try{const 
i=doc(db,"calculationTemplates",s);return await setDoc(i,{...e,status:e.status||"active",version:e.version||"1.0",creat
edAt:serverTimestamp(),updatedAt:serverTimestamp()}),s}catch(i){throw console.error("Error creating calculation 
template with ID:",i),i}},updateCalculationTemplate=async(s,e)=>{try{const i=doc(db,"calculationTemplates",s);await 
updateDoc(i,{...e,updatedAt:serverTimestamp()})}catch(i){throw console.error("Error updating calculation 
template:",i),i}},archiveCalculationTemplate=async s=>{try{const e=doc(db,"calculationTemplates",s);await 
updateDoc(e,{status:"archived",updatedAt:serverTimestamp()})}catch(e){throw console.error("Error archiving calculation 
template:",e),e}},DEFAULT_CALCULATION_TEMPLATES={learnership:{id:"learnership",name:"Learnership 
Program",description:"For learnership programs with monthly income distribution over the program 
duration",version:"1.0",status:"active",fields:[{id:"dealName",name:"Deal Name",type:"text",required:!0,helpText:"A 
descriptive name for this learnership deal"},{id:"certaintyPercentage",name:"Certainty 
%",type:"percentage",required:!0,default:100,validation:{min:0,max:100},helpText:"Probability of this deal closing 
(affects forecast calculations)"},{id:"learnerCount",name:"Number of 
Learners",type:"number",required:!0,validation:{min:1},helpText:"Total number of learners in this 
program"},{id:"costPerLearner",name:"Income per Learner (R)",type:"currency",required:!0,helpText:"Revenue amount per 
learner"},{id:"fundingType",name:"Funding 
Type",type:"select",required:!0,listKey:"fundingTypes",listType:"tenant-configurable"},{id:"duration",name:"Duration 
(Months)",type:"number",required:!0,default:12,validation:{min:1,max:36},helpText:"Length of the learnership 
program"},{id:"paymentStartDate",name:"Payment Start Date",type:"date",required:!0,helpText:"When income payments 
begin"},{id:"paymentFrequency",name:"Payment Frequency",type:"select",required:!0,default:"Monthly",listKey:"paymentFre
quencies",listType:"system"}],costFields:[{id:"facilitatorCost",name:"Facilitator 
Cost",type:"currency",hasFrequency:!0,frequencyOptions:["Monthly","Once-off","With Income","End of Learnership"]},{id:"
commissionPercentage",name:"Commission",type:"percentage",isPercentage:!0,percentageOf:"totalAmount",hasFrequency:!0,fr
equencyOptions:["Monthly","Once-off","With Income","End of Learnership"]},{id:"travelCost",name:"Travel 
Cost",type:"currency",hasFrequency:!0,frequencyOptions:["Monthly","Once-off","With Income","End of 
Learnership"]},{id:"assessorCost",name:"Assessor 
Cost",type:"currency",hasFrequency:!0,frequencyOptions:["Monthly","Once-off","With Income","End of 
Learnership"]},{id:"moderatorCost",name:"Moderator 
Cost",type:"currency",hasFrequency:!0,frequencyOptions:["Monthly","Once-off","With Income","End of 
Learnership"]},{id:"customCost",name:"Other 
Cost",type:"currency",hasFrequency:!0,frequencyOptions:["Monthly","Once-off","With Income","End of 
Learnership"],hasCustomLabel:!0}],formula:{type:"simple",expression:"learnerCount * 
costPerLearner",description:"Number of Learners Ã— Income per Learner"},distributionType:"monthly",hasPaymentFrequency:
!0,hasCertaintyPercentage:!0,hasContractDuration:!0,modalWidth:"wide",showBreakdownPreview:!0,systemLists:{paymentFrequ
encies:[{id:"monthly",name:"Monthly",value:"Monthly"},{id:"once-off",name:"Once-off",value:"Once-off"}]},defaultCustomL
ists:{fundingTypes:[{id:"seta",name:"SETA Funded",value:"seta"},{id:"self",name:"Self 
Funded",value:"self"},{id:"tax",name:"Tax 
Rebate",value:"tax"}],learnershipTypes:[{id:"generic-management",name:"Generic Management NQF 
4",value:"generic-management"},{id:"business-admin",name:"Business Administration NQF 
3",value:"business-admin"},{id:"business-admin-nqf4",name:"Business Administration NQF 
4",value:"business-admin-nqf4"},{id:"human-resources",name:"Human Resources NQF 
4",value:"human-resources"},{id:"project-management",name:"Project Management NQF 
4",value:"project-management"},{id:"contact-centre",name:"Contact Centre NQF 
3",value:"contact-centre"},{id:"wholesale-retail",name:"Wholesale & Retail NQF 
3",value:"wholesale-retail"},{id:"wholesale-retail-nqf4",name:"Wholesale & Retail NQF 
4",value:"wholesale-retail-nqf4"},{id:"new-venture-creation",name:"New Venture Creation NQF 
4",value:"new-venture-creation"},{id:"it-end-user",name:"IT End User Computing NQF 
3",value:"it-end-user"},{id:"other",name:"Other",value:"other"}]}},compliance:{id:"compliance",name:"Compliance 
Training",description:"For compliance courses like First Aid, Fire Safety, OHS",version:"1.0",status:"active",inheritsF
rom:"once-off-training",defaultCustomLists:{courseOptions:[{id:"first-aid-1",name:"First Aid Level 1",value:"First Aid 
Level 1"},{id:"first-aid-2",name:"First Aid Level 2",value:"First Aid Level 2"},{id:"first-aid-3",name:"First Aid 
Level 3",value:"First Aid Level 3"},{id:"fire-fighting",name:"Fire Fighting",value:"Fire 
Fighting"},{id:"fire-marshal",name:"Fire Marshal",value:"Fire Marshal"},{id:"health-safety-rep",name:"Health & Safety 
Rep",value:"Health & Safety Rep"},{id:"evacuation-marshal",name:"Evacuation Marshal",value:"Evacuation 
Marshal"},{id:"ohs-act",name:"OHS Act Training",value:"OHS Act Training"},{id:"incident-investigation",name:"Incident 
Investigation",value:"Incident Investigation"},{id:"working-at-heights",name:"Working at Heights",value:"Working at 
Heights"},{id:"confined-spaces",name:"Confined Spaces",value:"Confined 
Spaces"},{id:"forklift-operation",name:"Forklift Operation",value:"Forklift 
Operation"},{id:"other",name:"Other",value:"Other"}]}},otherCourses:{id:"otherCourses",name:"Other 
Courses",description:"For workshops and soft skills training",version:"1.0",status:"active",inheritsFrom:"once-off-trai
ning",defaultCustomLists:{courseOptions:[{id:"leadership-workshop",name:"Leadership Workshop",value:"Leadership 
Workshop"},{id:"communication-skills",name:"Communication Skills",value:"Communication 
Skills"},{id:"project-management",name:"Project Management",value:"Project 
Management"},{id:"time-management",name:"Time Management",value:"Time Management"},{id:"team-building",name:"Team 
Building",value:"Team Building"},{id:"excel-basic",name:"Excel Basic",value:"Excel 
Basic"},{id:"excel-intermediate",name:"Excel Intermediate",value:"Excel 
Intermediate"},{id:"excel-advanced",name:"Excel Advanced",value:"Excel Advanced"},{id:"word-processing",name:"Word 
Processing",value:"Word 
Processing"},{id:"powerpoint",name:"PowerPoint",value:"PowerPoint"},{id:"customer-service",name:"Customer 
Service",value:"Customer Service"},{id:"sales-training",name:"Sales Training",value:"Sales 
Training"},{id:"other",name:"Other",value:"Other"}]}},subscription:{id:"subscription",name:"Subscription 
Service",description:"For recurring subscription-based products like TAP 
Business",version:"1.0",status:"active",fields:[{id:"dealName",name:"Deal 
Name",type:"text",required:!0},{id:"certaintyPercentage",name:"Certainty 
%",type:"percentage",required:!0,default:100,validation:{min:0,max:100}},{id:"employeeCount",name:"Number of 
Employees",type:"number",required:!0,validation:{min:1}},{id:"costPerEmployee",name:"Cost per Employee/Month 
(R)",type:"currency",required:!0},{id:"packageType",name:"Package Type",type:"select",required:!1,listKey:"packageTypes
",listType:"tenant-configurable"},{id:"paymentStartDate",name:"Start 
Date",type:"date",required:!0},{id:"paymentType",name:"Payment Type",type:"select",required:!0,default:"Monthly",listKe
y:"subscriptionPaymentTypes",listType:"system"},{id:"contractMonths",name:"Contract Duration (Months)",type:"number",re
quired:!0,default:12,validation:{min:1,max:60}}],costFields:[{id:"commissionPercentage",name:"Commission",type:"percent
age",isPercentage:!0,percentageOf:"totalAmount",hasFrequency:!0,frequencyOptions:["Monthly","Once-off","With 
Income"]},{id:"customCost",name:"Other 
Cost",type:"currency",hasFrequency:!0,frequencyOptions:["Monthly","Once-off","With 
Income"],hasCustomLabel:!0}],formula:{type:"simple",expression:"employeeCount * costPerEmployee * 
contractMonths",description:"Employees Ã— Monthly Fee Ã— Contract Months"},distributionType:"monthly",hasPaymentFrequen
cy:!0,hasCertaintyPercentage:!0,hasContractDuration:!0,modalWidth:"wide",showBreakdownPreview:!0,systemLists:{subscript
ionPaymentTypes:[{id:"monthly",name:"Monthly",value:"Monthly"},{id:"annual",name:"Annual",value:"Annual"}]},defaultCust
omLists:{packageTypes:[{id:"basic",name:"Basic Package",value:"basic"},{id:"standard",name:"Standard 
Package",value:"standard"},{id:"premium",name:"Premium Package",value:"premium"},{id:"enterprise",name:"Enterprise 
Package",value:"enterprise"}]}},"once-off-training":{id:"once-off-training",name:"Once-Off Training",description:"For 
single training events like compliance courses or 
workshops",version:"1.0",status:"active",fields:[{id:"dealName",name:"Deal 
Name",type:"text",required:!0},{id:"certaintyPercentage",name:"Certainty %",type:"percentage",required:!0,default:100,v
alidation:{min:0,max:100}},{id:"courseName",name:"Course",type:"select",required:!0,listKey:"courseOptions",listType:"t
enant-configurable",allowCustom:!0},{id:"traineeCount",name:"Number of 
Trainees",type:"number",required:!0,validation:{min:1}},{id:"pricePerPerson",name:"Price per Person 
(R)",type:"currency",required:!0},{id:"trainingDate",name:"Training Date",type:"date",required:!0}],costFields:[{id:"co
mmissionPercentage",name:"Commission",type:"percentage",isPercentage:!0,percentageOf:"totalAmount",hasFrequency:!0,freq
uencyOptions:["Once-off","With Income"]},{id:"travelCost",name:"Travel 
Cost",type:"currency",hasFrequency:!0,frequencyOptions:["Once-off","With Income"]},{id:"manualsCost",name:"Manuals/Mate
rials",type:"currency",hasFrequency:!0,frequencyOptions:["Once-off","With Income"]},{id:"accommodationCost",name:"Accom
modation",type:"currency",hasFrequency:!0,frequencyOptions:["Once-off","With Income"]},{id:"accreditationCost",name:"Ac
creditation",type:"currency",hasFrequency:!0,frequencyOptions:["Once-off","With Income"]},{id:"customCost",name:"Other 
Cost",type:"currency",hasFrequency:!0,frequencyOptions:["Once-off","With 
Income"],hasCustomLabel:!0}],formula:{type:"simple",expression:"traineeCount * pricePerPerson",description:"Number of 
Trainees Ã— Price per Person"},distributionType:"once-off",hasPaymentFrequency:!1,hasCertaintyPercentage:!0,hasContract
Duration:!1,modalWidth:"wide",showBreakdownPreview:!0,systemLists:{},defaultCustomLists:{courseOptions:[{id:"first-aid-
1",name:"First Aid Level 1",value:"first-aid-1"},{id:"first-aid-2",name:"First Aid Level 
2",value:"first-aid-2"},{id:"first-aid-3",name:"First Aid Level 3",value:"first-aid-3"},{id:"fire-safety",name:"Fire 
Safety",value:"fire-safety"},{id:"ohs",name:"Occupational Health & 
Safety",value:"ohs"}]}},consulting:{id:"consulting",name:"Consulting Service",description:"For consulting engagements 
billed by hours or days",version:"1.0",status:"active",fields:[{id:"dealName",name:"Engagement 
Name",type:"text",required:!0},{id:"certaintyPercentage",name:"Certainty 
%",type:"percentage",required:!0,default:100,validation:{min:0,max:100}},{id:"consultationType",name:"Consultation Type
",type:"select",required:!0,listKey:"consultationTypes",listType:"tenant-configurable"},{id:"billingUnit",name:"Billing
 Unit",type:"select",required:!0,default:"hours",listKey:"billingUnits",listType:"system"},{id:"quantity",name:"Hours/D
ays",type:"number",required:!0,validation:{min:.5}},{id:"ratePerUnit",name:"Rate 
(R)",type:"currency",required:!0},{id:"serviceDate",name:"Service 
Date",type:"date",required:!0}],costFields:[{id:"travelCost",name:"Travel Cost",type:"currency",hasFrequency:!1},{id:"m
aterialsCost",name:"Materials/Resources",type:"currency",hasFrequency:!1},{id:"subcontractorCost",name:"Subcontractor 
Cost",type:"currency",hasFrequency:!1},{id:"customCost",name:"Other 
Cost",type:"currency",hasFrequency:!1,hasCustomLabel:!0}],formula:{type:"simple",expression:"quantity * 
ratePerUnit",description:"Hours/Days Ã— Rate"},distributionType:"once-off",hasPaymentFrequency:!1,hasCertaintyPercentag
e:!0,hasContractDuration:!1,modalWidth:"standard",showBreakdownPreview:!0,systemLists:{billingUnits:[{id:"hours",name:"
Hours",value:"hours"},{id:"days",name:"Days",value:"days"}]},defaultCustomLists:{consultationTypes:[{id:"strategy",name
:"Strategic Planning",value:"strategy"},{id:"hr",name:"HR Consulting",value:"hr"},{id:"training-needs",name:"Training 
Needs Analysis",value:"training-needs"},{id:"compliance",name:"Compliance 
Advisory",value:"compliance"},{id:"general",name:"General 
Consulting",value:"general"}]}}},initializeCalculationTemplates=async()=>{try{const s=writeBatch(db),e=await 
getCalculationTemplates(),i=new Set(e.map(o=>o.id));let a=0;for(const[o,c]of 
Object.entries(DEFAULT_CALCULATION_TEMPLATES))if(!i.has(o)){const 
d=doc(db,"calculationTemplates",o);s.set(d,{...c,createdAt:serverTimestamp(),updatedAt:serverTimestamp()}),a++}return 
a>0&&(await s.commit(),console.log(`Initialized ${a} calculation templates`)),a}catch(s){throw console.error("Error 
initializing calculation templates:",s),s}},executeFormula=(expression,fieldValues)=>{try{let 
evaluableExpression=expression;const fieldNames=expression.match(/[a-zA-Z_][a-zA-Z0-9_]*/g)||[];for(const s of 
fieldNames){const e=parseFloat(fieldValues[s])||0;evaluableExpression=evaluableExpression.replace(new 
RegExp(`\\b${s}\\b`,"g"),e.toString())}if(!/^[\d\s+\-*/().]+$/.test(evaluableExpression))return console.error("Invalid 
formula expression:",evaluableExpression),0;const result=eval(evaluableExpression);return 
isNaN(result)?0:result}catch(s){return console.error("Error executing formula:",s),0}},calculateTemplateTotal=(s,e)=>!s
||!s.formula?0:s.formula.type==="simple"?executeFormula(s.formula.expression,e):0,calculateTemplateCosts=(s,e,i)=>{if(!
s||!s.costFields)return{totalCosts:0,breakdown:{}};let a=0;const o={};for(const c of s.costFields){let 
d=0;if(c.isPercentage){const h=parseFloat(e[c.id])||0;d=i*h/100}else d=parseFloat(e[c.id])||0;o[c.id]={amount:d,frequen
cy:e[`${c.id}Frequency`]||"Once-off",label:e[`${c.id}Label`]||c.name},a+=d}return{totalCosts:a,breakdown:o}},getTenantP
roductConfig=async s=>{if(!s)return null;try{const e=doc(db,"tenantProductConfigs",s),i=await getDoc(e);return i.exists
()?{id:i.id,...i.data()}:{tenantId:s,enabledProducts:[],listOverrides:{},defaultValueOverrides:{}}}catch(e){return 
console.error("Error getting tenant product config:",e),null}},saveTenantProductConfig=async(s,e)=>{if(!s)throw new 
Error("Tenant ID is required");try{const i=doc(db,"tenantProductConfigs",s);await 
setDoc(i,{tenantId:s,...e,updatedAt:serverTimestamp()},{merge:!0})}catch(i){throw console.error("Error saving tenant 
product config:",i),i}},enableProductForTenant=async(s,e,i)=>{if(!s||!e)throw new Error("Tenant ID and Product ID are 
required");try{const a=await getTenantProductConfig(s),o=(a==null?void 
0:a.enabledProducts)||[],c=o.findIndex(d=>d.productId===e);c>=0?o[c]={...o[c],enabled:!0,enabledAt:new 
Date().toISOString(),enabledBy:i}:o.push({productId:e,enabled:!0,enabledAt:new 
Date().toISOString(),enabledBy:i}),await saveTenantProductConfig(s,{enabledProducts:o})}catch(a){throw 
console.error("Error enabling product for tenant:",a),a}},disableProductForTenant=async(s,e)=>{if(!s||!e)throw new 
Error("Tenant ID and Product ID are required");try{const i=await getTenantProductConfig(s),a=(i==null?void 
0:i.enabledProducts)||[],o=a.findIndex(c=>c.productId===e);o>=0&&(a[o]={...a[o],enabled:!1,disabledAt:new 
Date().toISOString()}),await saveTenantProductConfig(s,{enabledProducts:a})}catch(i){throw console.error("Error 
disabling product for tenant:",i),i}},saveTenantListOverride=async(s,e,i,a)=>{if(!s||!e||!i)throw new Error("Tenant 
ID, Product ID, and List Key are required");try{const o=await getTenantProductConfig(s),c=(o==null?void 
0:o.listOverrides)||{};c[e]||(c[e]={}),c[e][i]=a,await saveTenantProductConfig(s,{listOverrides:c})}catch(o){throw 
console.error("Error saving tenant list override:",o),o}},removeTenantListOverride=async(s,e,i)=>{if(!s||!e||!i)throw 
new Error("Tenant ID, Product ID, and List Key are required");try{const a=await 
getTenantProductConfig(s),o=(a==null?void 0:a.listOverrides)||{};o[e]&&o[e][i]&&(delete 
o[e][i],Object.keys(o[e]).length===0&&delete o[e],await saveTenantProductConfig(s,{listOverrides:o}))}catch(a){throw 
console.error("Error removing tenant list override:",a),a}},getAllProductsWithEnabledStatus=async 
s=>{try{const[e,i,a]=await Promise.all([getProducts(),getProductLines(),getTenantProductConfig(s)]),o=new 
Map;if(a!=null&&a.enabledProducts)for(const c of a.enabledProducts)o.set(c.productId,c);return 
e.filter(c=>c.status==="active").map(c=>{var j,_;const 
d=o.get(c.id),h=i.find($=>$.id===c.productLineId);return{...c,productLineName:(h==null?void 
0:h.name)||c.productLineId,isEnabled:(d==null?void 
0:d.enabled)??!0,enabledConfig:d||null,hasListOverrides:!!((j=a==null?void 
0:a.listOverrides)!=null&&j[c.id]),hasDefaultOverrides:!!((_=a==null?void 0:a.defaultValueOverrides)!=null&&_[c.id])}})
.sort((c,d)=>c.productLineId!==d.productLineId?(c.productLineName||"").localeCompare(d.productLineName||""):(c.name||""
).localeCompare(d.name||""))}catch(e){return console.error("Error getting all products with enabled 
status:",e),[]}},SKILLS_PARTNERS_COLLECTION="skillsPartners",getSkillsPartners=async()=>{var s;try{const 
e=collection(db,SKILLS_PARTNERS_COLLECTION);return(await getDocs(e)).docs.map(o=>({id:o.id,...o.data()})).sort((o,c)=>(
o.name||"").localeCompare(c.name||""))}catch(e){if(console.error("Error getting skills 
partners:",e),e.code==="permission-denied"||(s=e.message)!=null&&s.includes("collection"))return console.log("Skills 
partners collection may not exist yet"),[];throw e}},ClientFinancialEditor=({preselectedClientId:s,preselectedProductLi
ne:e})=>{useNavigate();const{getTenantId:i}=useTenant(),a=i(),[o,c]=reactExports.useState(!0),[d,h]=reactExports.useSta
te(!1),[j,_]=reactExports.useState(""),[$,rt]=reactExports.useState(null),[tt,mt]=reactExports.useState(null),[vt,_t]=r
eactExports.useState(""),[wt,ht]=reactExports.useState(""),[dt,jt]=reactExports.useState([]),[bt,ut]=reactExports.useSt
ate("all"),[Rt,st]=reactExports.useState(""),[it,nt]=reactExports.useState([]),[ct,xt]=reactExports.useState("clientNam
e"),[yt,Tt]=reactExports.useState("asc"),[fs,cs]=reactExports.useState([]),[Es,ls]=reactExports.useState([]),[Yt,Mt]=re
actExports.useState([]),[Gt,Wt]=reactExports.useState([]),[ms,ss]=reactExports.useState(null),[ys,Et]=reactExports.useS
tate(null),[gt,ft]=reactExports.useState([]),[zt,Ct]=reactExports.useState("all"),[Pt,$t]=reactExports.useState([]),[Bt
,Lt]=reactExports.useState([]),[Xt,Dt]=reactExports.useState(!1),[Ht,os]=reactExports.useState(null),[Qt,Ft]=reactExpor
ts.useState([]),[xs,Cs]=reactExports.useState(!1),[gs,Os]=reactExports.useState(null),[qt,js]=reactExports.useState(0),
[es,vs]=reactExports.useState(!1),[Rs,Tn]=reactExports.useState(null),[Hs,En]=reactExports.useState(0),[Hn,Ps]=reactExp
orts.useState(!1),[Ts,ks]=reactExports.useState(null),[Ln,hn]=reactExports.useState(0),[Jn,nr]=reactExports.useState(!1
),[Ls,Vn]=reactExports.useState(null),[Yn,Kn]=reactExports.useState(0),[$n,Cn]=reactExports.useState({fundingTypes:[{id
:"seta",name:"SETA Funded",value:"SETA"},{id:"self",name:"Self Funded",value:"Self Funded"},{id:"tax",name:"Tax 
Rebate",value:"Tax Rebate"}],learnershipTypes:[]}),[zs,Xs]=reactExports.useState(["First Aid Level 1","First Aid Level 
2","First Aid Level 3","Fire Fighter","Fire Marshal","OHS Representative","HIRA (Hazard Identification & Risk 
Assessment)","Incident Investigation","SHE Representative","Working at Heights","Confined Spaces","Forklift 
Operation","Other"]),[mn,On]=reactExports.useState(["Excel Basic","Excel Intermediate","Excel Advanced","Word 
Processing","PowerPoint","Project Management","Leadership Development","Communication Skills","Time 
Management","Customer Service","Sales Training","Other"]);reactExports.useEffect(()=>{(async()=>{try{c(!0),_("");const 
pt=auth.currentUser;if(pt){ss(pt.uid);try{const Fs=await getUserData(pt.uid);Et((Fs==null?void 
0:Fs.role)||null)}catch(Fs){console.error("Error loading user data for financial editor:",Fs)}}const St=await 
calculateFinancialYearMonths(a);rt(St),mt(St.currentFinancialYear);const 
Ot=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];if(typeof 
St.reportingMonth=="number"){const Fs=Ot[St.reportingMonth]||"";_t(Fs)}St.currentFinancialYear&&ht(St.currentFinancialY
ear.toString());const[Vt,Kt,It,rs,Ut,At]=await Promise.all([getClients({}),getUsers(),getProductLines(),getProducts(),g
etSkillsPartners(),a?getTenantProductConfig(a):Promise.resolve(null)]);if(jt(Vt),ft(Kt),Lt(It),$t(Ut),a&&St.currentFina
ncialYear){const Fs=St.currentFinancialYear,Pn=calculateFinancialYear(Fs,-1),bn=calculateFinancialYear(Fs,-2),An=calcul
ateFinancialYear(Fs,-3),[dn,Ds,Sn,Zs]=await Promise.all([getFinancialData(UPLOAD_TYPES.YTD_ACTUAL,Fs,a),getFinancialDat
a(UPLOAD_TYPES.YTD_1,Pn,a),getFinancialData(UPLOAD_TYPES.YTD_2,bn,a),getFinancialData(UPLOAD_TYPES.YTD_3,An,a)]);cs(dn)
,ls(Ds),Mt(Sn),Wt(Zs)}const hs=Fs=>Fs?Array.isArray(Fs)?Fs:typeof 
Fs=="object"?Object.values(Fs):[]:[],ps=Fs=>rs.filter(bn=>{var An,dn;return 
bn.calculationTemplateId===Fs||bn.calculationMethodId===Fs||((An=bn.name)==null?void 
0:An.toLowerCase())===Fs.toLowerCase()||((dn=bn.name)==null?void 
0:dn.toLowerCase().includes(Fs.toLowerCase()))||bn.id===Fs}),Ss=Fs=>It.filter(bn=>{var An;return 
bn.id===Fs||bn.calculationMethodId===Fs||bn.calculationTemplateId===Fs||((An=bn.name)==null?void 
0:An.toLowerCase().includes(Fs.toLowerCase()))}),on=(Fs,Pn,bn)=>{var Sn,Zs,zn,en,nn,xn;const 
An=ps(Fs),dn=Ss(Fs);if(At!=null&&At.listOverrides){for(const $s of 
An)if((Sn=At.listOverrides[$s.id])!=null&&Sn[Pn]){const Vs=hs(At.listOverrides[$s.id][Pn]);if(Vs.length>0)return 
Vs}for(const $s of dn)if((Zs=At.listOverrides[$s.id])!=null&&Zs[Pn]){const 
Vs=hs(At.listOverrides[$s.id][Pn]);if(Vs.length>0)return Vs}}for(const $s of An)if((zn=$s==null?void 
0:$s.customLists)!=null&&zn[Pn]){const 
Vs=$s.customLists[Pn],gn=hs(Vs.defaultOptions||Vs.options||Vs);if(gn.length>0)return gn}for(const $s of 
dn)if((en=$s==null?void 0:$s.customLists)!=null&&en[Pn]){const 
Vs=$s.customLists[Pn],gn=hs(Vs.defaultOptions||Vs.options||Vs);if(gn.length>0)return gn}const 
Ds=(xn=(nn=DEFAULT_CALCULATION_TEMPLATES[bn])==null?void 0:nn.defaultCustomLists)==null?void 0:xn[Pn];return hs(Ds)},ln
=on("learnership","fundingTypes","learnership"),qn=on("learnership","learnershipTypes","learnership");Cn({fundingTypes:
ln.length>0?ln:[{id:"seta",name:"SETA Funded",value:"SETA"},{id:"self",name:"Self Funded",value:"Self 
Funded"},{id:"tax",name:"Tax Rebate",value:"Tax Rebate"}],learnershipTypes:qn});const 
er=on("compliance","courseOptions","compliance");er.length>0&&Xs(er.map(Fs=>typeof 
Fs=="string"?Fs:Fs.value||Fs.name));const 
kn=on("otherCourses","courseOptions","otherCourses");kn.length>0&&On(kn.map(Fs=>typeof 
Fs=="string"?Fs:Fs.value||Fs.name));const Wn=await 
getClientFinancialsByYear(St.currentFinancialYear);nt(Wn)}catch(pt){console.error("Error loading client financial 
data:",pt),_("Failed to load client financial data. Please try 
again.")}finally{c(!1)}})()},[a]),reactExports.useEffect(()=>{if(s&&!o&&dt.length>0&&it.length>=0){const 
lt=dt.find(pt=>pt.id===s);lt&&hr(s,lt.name||lt.legalName||"Unknown 
Client")}},[s,o,dt,it]),reactExports.useEffect(()=>{const 
lt=pt=>{Xt&&Ht&&Qt.length>0&&(pt.preventDefault(),pt.returnValue="You have unsaved changes. Are you sure you want to 
leave?")};return window.addEventListener("beforeunload",lt),()=>window.removeEventListener("beforeunload",lt)},[Xt,Ht,Q
t]),reactExports.useEffect(()=>{var lt;if(e&&Xt&&Qt.length>0){const pt=Qt.findIndex(St=>{var 
Ot;return((Ot=St.productLine)==null?void 0:Ot.toLowerCase())===e.toLowerCase()});if(pt!==-1){const 
St=((lt=Qt[pt].productLine)==null?void 0:lt.toLowerCase())||"";St.includes("learnership")?(Os(pt),Cs(!0)):St.includes("
tap")||St.includes("business")?(Tn(pt),vs(!0)):St.includes("compliance")?(ks(pt),Ps(!0)):(St.includes("course")||St.inc
ludes("training")||St.includes("other"))&&(Vn(pt),nr(!0))}}},[e,Xt,Qt]);const 
As=reactExports.useMemo(()=>($==null?void 0:$.remainingMonths)||[],[$]),Zt=reactExports.useMemo(()=>{const 
pt=(($==null?void 
0:$.ytdMonths)||[]).map(St=>St.name);return(St,Ot,Vt)=>{if(!(Vt!=null&&Vt.length)||pt.length===0)return 0;let 
Kt=Vt.filter(It=>It.clientId===St);if(Kt.length===0&&Ot){const 
It=Ot.toLowerCase().trim();Kt=Vt.filter(rs=>rs.clientName&&rs.clientName.toLowerCase().trim()===It)}return 
Kt.length===0?0:Kt.reduce((It,rs)=>{const Ut=rs.monthlyData||rs.monthlyValues||{};let At=0;return pt.forEach(hs=>{At+=U
t[hs]||0}),It+At},0)}},[$]),Is=reactExports.useMemo(()=>(lt,pt,St)=>{if(!(St!=null&&St.length))return 0;let 
Ot=St.filter(Vt=>Vt.clientId===lt);if(Ot.length===0&&pt){const 
Vt=pt.toLowerCase().trim();Ot=St.filter(Kt=>Kt.clientName&&Kt.clientName.toLowerCase().trim()===Vt)}return 
Ot.reduce((Vt,Kt)=>Vt+(Kt.total||0),0)},[]),ns=reactExports.useMemo(()=>{const pt=(($==null?void 
0:$.ytdMonths)||[]).map(St=>St.name);return(St,Ot,Vt,Kt)=>{if(!(Kt!=null&&Kt.length)||pt.length===0)return 0;let 
It=Kt.filter(rs=>rs.clientId===St);if(It.length===0&&Ot){const rs=Ot.toLowerCase().trim();It=Kt.filter(Ut=>Ut.clientNam
e&&Ut.clientName.toLowerCase().trim()===rs)}if(Vt&&It.length>0){const 
rs=Vt.toLowerCase().trim();It=It.filter(Ut=>Ut.productLine&&Ut.productLine.toLowerCase().trim()===rs)}return 
It.length===0?0:It.reduce((rs,Ut)=>{const At=Ut.monthlyData||Ut.monthlyValues||{};let hs=0;return pt.forEach(ps=>{hs+=A
t[ps]||0}),rs+hs},0)}},[$]),ts=reactExports.useMemo(()=>(lt,pt,St,Ot)=>{if(!(Ot!=null&&Ot.length))return 0;let 
Vt=Ot.filter(Kt=>Kt.clientId===lt);if(Vt.length===0&&pt){const Kt=pt.toLowerCase().trim();Vt=Ot.filter(It=>It.clientNam
e&&It.clientName.toLowerCase().trim()===Kt)}if(St&&Vt.length>0){const 
Kt=St.toLowerCase().trim();Vt=Vt.filter(It=>It.productLine&&It.productLine.toLowerCase().trim()===Kt)}return 
Vt.reduce((Kt,It)=>Kt+(It.total||0),0)},[]),_s=reactExports.useMemo(()=>{const lt={};return dt.forEach(pt=>{const St=Zt
(pt.id,pt.name,fs),Ot=Is(pt.id,pt.name,Es),Vt=Is(pt.id,pt.name,Yt),Kt=Is(pt.id,pt.name,Gt);lt[pt.id]={ytdActual:St,year
Minus1:Ot,yearMinus2:Vt,yearMinus3:Kt}}),lt},[dt,fs,Es,Yt,Gt,Zt,Is]),Ns=reactExports.useMemo(()=>{if(!$)return["YTD-3",
"YTD-2","YTD-1"];const lt=$.currentFinancialYear||"";let pt=new Date().getFullYear();if(lt&&lt.includes("/")){const 
St=lt.split("/");pt=parseInt(St[1],10)||pt}else lt&&(pt=parseInt(lt,10)||pt);return $.fyEndYear&&(pt=$.fyEndYear),[`FY 
${pt-3}`,`FY ${pt-2}`,`FY ${pt-1}`]},[$]),Gs=lt=>{st(lt.target.value)},Qs=lt=>{lt===ct?Tt(pt=>pt==="asc"?"desc":"asc"):
(xt(lt),Tt("asc"))},qs=lt=>{if(!lt||lt.trim()==="")return 0;const pt=lt.replace(/[^\d]/g,"");return pt?parseInt(pt,10):
0},sn=(lt,pt)=>{nt(St=>St.map(Ot=>Ot.id===lt?{...Ot,comments:pt}:Ot))},tn=async()=>{if(!(!tt||!$))try{h(!0),_("");const
 lt=auth.currentUser,pt=(lt==null?void 0:lt.uid)||"system",St=it.map(Ot=>saveClientFinancial(Ot.clientId,Ot.clientName,
Ot.financialYear,Ot.productLine,{history:Ot.history,months:Ot.months,comments:Ot.comments},pt));await 
Promise.all(St),alert("Client financial data saved successfully.")}catch(lt){console.error("Error saving client 
financial data:",lt),_("Failed to save client financial data. Please try 
again.")}finally{h(!1)}},Dn=reactExports.useMemo(()=>{const lt=ys==="admin"||ys==="manager"||ys==="accountant";let 
pt=it;if(!lt&&ms&&dt.length>0){const Ot=new Set(dt.filter(Vt=>Vt.assignedSalesPerson===ms).map(Vt=>Vt.id));pt=pt.filter
(Vt=>Ot.has(Vt.clientId))}if(lt&&zt!=="all"&&dt.length>0){const Ot=new Set(dt.filter(Vt=>Vt.assignedSalesPerson===zt).m
ap(Vt=>Vt.id));pt=pt.filter(Vt=>Ot.has(Vt.clientId))}if(bt!=="all"&&(pt=pt.filter(Ot=>Ot.clientId===bt)),Rt.trim()){con
st 
Ot=Rt.toLowerCase();pt=pt.filter(Vt=>(Vt.clientName||"").toLowerCase().includes(Ot))}return[...pt].sort((Ot,Vt)=>{var 
It,rs;const Kt=yt==="asc"?1:-1;if(ct==="clientName")return(Ot.clientName||"").localeCompare(Vt.clientName||"")*Kt;if(ct
==="ytd"){const Ut=((It=Ot.history)==null?void 0:It.currentYearYTD)||0,At=((rs=Vt.history)==null?void 
0:rs.currentYearYTD)||0;return(Ut-At)*Kt}if(ct==="forecast"){const 
Ut=Ot.fullYearForecast||0,At=Vt.fullYearForecast||0;return(Ut-At)*Kt}return 
0})},[it,bt,zt,ct,yt,Rt,dt,ms,ys]),Un=reactExports.useMemo(()=>{const lt=new 
Map,pt=["General","Consulting"];Dn.forEach(It=>{var 
hs,ps,Ss,on,ln,qn,er,kn;if(!It.clientId||pt.includes(It.productLine))return;let 
rs=lt.get(It.clientId);rs||(rs={clientId:It.clientId,clientName:It.clientName||"Unknown Client",productLines:new Set,hi
story:{yearMinus3:0,yearMinus2:0,yearMinus1:0,currentYearYTD:0},months:{},fullYearForecast:0,comments:""},lt.set(It.cli
entId,rs)),((((hs=It.history)==null?void 0:hs.yearMinus3)||0)!==0||(((ps=It.history)==null?void 
0:ps.yearMinus2)||0)!==0||(((Ss=It.history)==null?void 0:Ss.yearMinus1)||0)!==0||(((on=It.history)==null?void 0:on.curr
entYearYTD)||0)!==0||(It.fullYearForecast||0)!==0)&&It.productLine&&rs.productLines.add(It.productLine),rs.history.year
Minus3+=((ln=It.history)==null?void 0:ln.yearMinus3)||0,rs.history.yearMinus2+=((qn=It.history)==null?void 
0:qn.yearMinus2)||0,rs.history.yearMinus1+=((er=It.history)==null?void 
0:er.yearMinus1)||0,rs.history.currentYearYTD+=((kn=It.history)==null?void 0:kn.currentYearYTD)||0;const 
At=It.months||{};Object.entries(At).forEach(([Wn,Fs])=>{const Pn=typeof Fs=="number"?Fs:parseInt(Fs||0,10);rs.months[Wn
]||(rs.months[Wn]=0),rs.months[Wn]+=Pn}),rs.fullYearForecast+=It.fullYearForecast||0,It.comments&&(rs.comments=It.comme
nts)});let St=Array.from(lt.values()).map(It=>({...It,productSummary:Array.from(It.productLines).join(", ")}));const 
Ot=ys==="admin"||ys==="manager"||ys==="accountant",Vt=new 
Set(St.map(It=>It.clientId));dt.forEach(It=>{if(Vt.has(It.id))return;const rs=_s[It.id];if(rs&&(rs.ytdActual>0||rs.year
Minus1>0||rs.yearMinus2>0||rs.yearMinus3>0)&&!(!Ot&&ms&&It.assignedSalesPerson!==ms)&&!(Ot&&zt!=="all"&&It.assignedSale
sPerson!==zt)){if(Rt.trim()){const At=Rt.toLowerCase();if(!(It.name||"").toLowerCase().includes(At))return}bt!=="all"&&
It.id!==bt||St.push({clientId:It.id,clientName:It.name||"Unknown Client",productLines:new Set,productSummary:"",history
:{yearMinus3:0,yearMinus2:0,yearMinus1:0,currentYearYTD:0},months:{},fullYearForecast:0,comments:""})}});const 
Kt=yt==="asc"?1:-1;return St.sort((It,rs)=>{var Ut,At;if(ct==="clientName")return 
It.clientName.localeCompare(rs.clientName)*Kt;if(ct==="ytd"){const hs=((Ut=_s[It.clientId])==null?void 
0:Ut.ytdActual)||It.history.currentYearYTD,ps=((At=_s[rs.clientId])==null?void 
0:At.ytdActual)||rs.history.currentYearYTD;return(hs-ps)*Kt}return ct==="forecast"?(It.fullYearForecast-rs.fullYearFore
cast)*Kt:0}),St},[Dn,ct,yt,dt,_s,ys,ms,zt,bt,Rt]),Zn=reactExports.useMemo(()=>{const 
lt={yearMinus3:0,yearMinus2:0,yearMinus1:0,currentYearYTD:0,months:{},fullYearForecast:0};return Un.forEach(pt=>{var 
Ot,Vt,Kt,It;const St=_s[pt.clientId];lt.yearMinus3+=(St==null?void 0:St.yearMinus3)||((Ot=pt.history)==null?void 
0:Ot.yearMinus3)||0,lt.yearMinus2+=(St==null?void 0:St.yearMinus2)||((Vt=pt.history)==null?void 
0:Vt.yearMinus2)||0,lt.yearMinus1+=(St==null?void 0:St.yearMinus1)||((Kt=pt.history)==null?void 
0:Kt.yearMinus1)||0,lt.currentYearYTD+=(St==null?void 0:St.ytdActual)||((It=pt.history)==null?void 0:It.currentYearYTD)
||0,lt.fullYearForecast+=pt.fullYearForecast||0,Object.entries(pt.months||{}).forEach(([rs,Ut])=>{lt.months[rs]||(lt.mo
nths[rs]=0),lt.months[rs]+=Ut||0})}),lt},[Un,_s]),gr=ys==="admin"||ys==="manager"||ys==="accountant",hr=(lt,pt)=>{const
 St=Dn.filter(Ut=>Ut.clientId===lt),Ot=dt.find(Ut=>Ut.id===lt),Vt=Ut=>({yearMinus3:ts(lt,pt,Ut,Gt),yearMinus2:ts(lt,pt,
Ut,Yt),yearMinus1:ts(lt,pt,Ut,Es),currentYearYTD:ns(lt,pt,Ut,fs)}),Kt=["General","Consulting"];let 
It=St.filter(Ut=>!Kt.includes(Ut.productLine)).map(Ut=>{var hs,ps,Ss,on;const 
At=Vt(Ut.productLine);return{...Ut,history:{yearMinus3:At.yearMinus3||((hs=Ut.history)==null?void 
0:hs.yearMinus3)||0,yearMinus2:At.yearMinus2||((ps=Ut.history)==null?void 
0:ps.yearMinus2)||0,yearMinus1:At.yearMinus1||((Ss=Ut.history)==null?void 
0:Ss.yearMinus1)||0,currentYearYTD:At.currentYearYTD||((on=Ut.history)==null?void 0:on.currentYearYTD)||0},months:{...U
t.months||{}},fullYearForecast:Ut.fullYearForecast||0,comments:Ut.comments||"",learnershipDetails:Ut.learnershipDetails
||[],tapBusinessDetails:Ut.tapBusinessDetails||[],complianceDetails:Ut.complianceDetails||[],otherCoursesDetails:Ut.oth
erCoursesDetails||[]}});["Learnerships","Compliance Training","Other Courses","TAP 
Business"].forEach(Ut=>{if(!It.some(hs=>hs.productLine===Ut)&&lt&&pt){const hs=Vt(Ut);It.push({id:`${lt}_${tt}_${Ut.rep
lace(/\s+/g,"_")}`,clientId:lt,clientName:pt,financialYear:tt,productLine:Ut,history:{yearMinus3:hs.yearMinus3||0,yearM
inus2:hs.yearMinus2||0,yearMinus1:hs.yearMinus1||0,currentYearYTD:hs.currentYearYTD||0},months:{},fullYearForecast:0,co
mments:"",learnershipDetails:[],tapBusinessDetails:[],complianceDetails:[],otherCoursesDetails:[]})}}),It.sort((Ut,At)=
>{var Ss,on;const hs=(Ss=Ut.productLine)!=null&&Ss.toLowerCase().includes("learnership")?0:1,ps=(on=At.productLine)!=nu
ll&&on.toLowerCase().includes("learnership")?0:1;return 
hs!==ps?hs-ps:(Ut.productLine||"").localeCompare(At.productLine||"")}),os({id:lt,name:pt,skillsPartnerId:Ot==null?void 
0:Ot.skillsPartnerId}),Ft(It),Dt(!0)},Er=(lt,pt,St)=>{const Ot=qs(St);Ft(Vt=>{var hs;const 
Kt=[...Vt],It={...Kt[lt]},rs={...It.months||{}};rs[pt]=Ot,It.months=rs;const Ut=((hs=It.history)==null?void 
0:hs.currentYearYTD)||0,At=As.reduce((ps,Ss)=>{const on=`${Ss.year}-${Ss.number}`,ln=rs[on]||0;return ps+(typeof 
ln=="number"?ln:parseInt(ln||0,10))},0);return It.fullYearForecast=Ut+At,Kt[lt]=It,Kt})},yr=(lt,pt)=>{const 
St=qs(pt);Ft(Ot=>{var At,hs,ps;const Vt=[...Ot],Kt={...Vt[lt]},It={yearMinus3:((At=Kt.history)==null?void 
0:At.yearMinus3)||0,yearMinus2:((hs=Kt.history)==null?void 0:hs.yearMinus2)||0,yearMinus1:((ps=Kt.history)==null?void 
0:ps.yearMinus1)||0,currentYearYTD:St};Kt.history=It;const rs=Kt.months||{},Ut=As.reduce((Ss,on)=>{const 
ln=`${on.year}-${on.number}`,qn=rs[ln]||0;return Ss+(typeof qn=="number"?qn:parseInt(qn||0,10))},0);return 
Kt.fullYearForecast=St+Ut,Vt[lt]=Kt,Vt})},wr=(lt,pt)=>{Ft(St=>{const Ot=[...St];return 
Ot[lt]={...Ot[lt],comments:pt},Ot})},Pr=(lt,pt)=>{Ft(St=>{const Ot=[...St];return 
Ot[lt]={...Ot[lt],productLine:pt},Ot})},Rr=lt=>{Ft(pt=>{const St=[...pt],Ot={...St[lt]},Vt=Array.isArray(Ot.learnership
Details)?[...Ot.learnershipDetails]:[],Kt=ar(Ot.productLine);return Vt.push({id:`D${Vt.length+1}`,name:"",description:"
",certaintyPercentage:100,learners:"",costPerLearner:0,fundingType:"SETA",paymentStartDate:"",paymentFrequency:"Monthly
",paymentMonths:12,facilitatorCost:0,facilitatorCostFrequency:"Monthly",commissionPercentage:Kt,commissionFrequency:"Wi
th Income",travelCost:0,travelCostFrequency:"Monthly",assessorCost:0,assessorCostFrequency:"End of 
Learnership",moderatorCost:0,moderatorCostFrequency:"End of Learnership",otherCost:0,otherCostFrequency:"Once-off",cust
omLabel:"",customCost:0,customCostFrequency:"Once-off"}),Ot.learnershipDetails=Vt,St[lt]=Ot,St})},ar=lt=>{if(!(Ht!=null
&&Ht.skillsPartnerId)||Ht.skillsPartnerId==="not-allocated")return 0;const 
pt=Pt.find(Ot=>Ot.id===Ht.skillsPartnerId);if(!pt||!pt.commissionRates)return 0;const St=Bt.find(Ot=>{var 
Vt;return((Vt=Ot.name)==null?void 0:Vt.toLowerCase())===(lt==null?void 0:lt.toLowerCase())});return 
St&&pt.commissionRates[St.id]||0},Rn=(lt,pt,St,Ot)=>{Ft(Vt=>{var At;const 
Kt=[...Vt],It={...Kt[lt]},rs=Array.isArray(It.learnershipDetails)?[...It.learnershipDetails]:[];if(!rs[pt])return 
Vt;const Ut={...rs[pt]};if(["paymentMonths","commissionPercentage","certaintyPercentage"].includes(St)?Ut[St]=parseFloa
t(Ot)||0:St==="learners"?Ut[St]=Ot===""?"":parseFloat(Ot)||0:["costPerLearner","facilitatorCost","travelCost","assessor
Cost","moderatorCost","otherCost","customCost"].includes(St)?Ut[St]=qs(Ot.toString()):(["facilitatorCostFrequency","com
missionFrequency","travelCostFrequency","assessorCostFrequency","moderatorCostFrequency","otherCostFrequency","customCo
stFrequency"].includes(St),Ut[St]=Ot),St==="paymentFrequency"&&Ot==="Once-off"&&(Ut.paymentMonths=1),St==="commissionPe
rcentage"||St==="learners"||St==="costPerLearner"){const hs=(Ut.learners||0)*(Ut.costPerLearner||0),ps=Ut.commissionPer
centage||0;Ut.commissionCost=hs*ps/100}if(rs[pt]=Ut,It.learnershipDetails=rs,It.productLine&&It.productLine.toLowerCase
().includes("learnership")){const hs=or(rs,$,As);It.months=hs.months;const ps=((At=It.history)==null?void 
0:At.currentYearYTD)||0;It.fullYearForecast=ps+hs.forecastTotal}return Kt[lt]=It,Kt})},fr=(lt,pt)=>{Ft(St=>{var 
It;const Ot=[...St],Vt={...Ot[lt]},Kt=Array.isArray(Vt.learnershipDetails)?[...Vt.learnershipDetails]:[];if(Kt.splice(p
t,1),Vt.learnershipDetails=Kt,Vt.productLine&&Vt.productLine.toLowerCase().includes("learnership")){const 
rs=or(Kt,$,As);Vt.months=rs.months;const Ut=((It=Vt.history)==null?void 
0:It.currentYearYTD)||0;Vt.fullYearForecast=Ut+rs.forecastTotal}return Ot[lt]=Vt,Ot})},cr=lt=>{Ft(pt=>{const St=[...pt]
,Ot={...St[lt]},Vt=Array.isArray(Ot.tapBusinessDetails)?[...Ot.tapBusinessDetails]:[],Kt=ar(Ot.productLine);return Vt.p
ush({id:`TAP${Vt.length+1}`,name:"",description:"",certaintyPercentage:100,numberOfEmployees:0,costPerEmployeePerMonth:
0,paymentStartDate:"",paymentType:"Monthly",contractMonths:12,commissionPercentage:Kt,commissionFrequency:"With Income"
,customCostLabel:"",customCost:0,customCostFrequency:"Once-off"}),Ot.tapBusinessDetails=Vt,St[lt]=Ot,St})},Gn=(lt,pt,St
,Ot)=>{Ft(Vt=>{var At;const 
Kt=[...Vt],It={...Kt[lt]},rs=Array.isArray(It.tapBusinessDetails)?[...It.tapBusinessDetails]:[];if(!rs[pt])return 
Vt;const Ut={...rs[pt]};if(["numberOfEmployees","costPerEmployeePerMonth","commissionPercentage","certaintyPercentage",
"contractMonths","customCost"].includes(St)?Ut[St]=parseFloat(Ot)||0:Ut[St]=Ot,St==="paymentType"&&Ot==="Annual"&&(Ut.c
ontractMonths=1),rs[pt]=Ut,It.tapBusinessDetails=rs,It.productLine&&It.productLine.toLowerCase().includes("tap")){const
 hs=bs(rs,$,As);It.months=hs.months;const ps=((At=It.history)==null?void 
0:At.currentYearYTD)||0;It.fullYearForecast=ps+hs.forecastTotal}return Kt[lt]=It,Kt})},Dr=(lt,pt)=>{Ft(St=>{var 
It;const Ot=[...St],Vt={...Ot[lt]},Kt=Array.isArray(Vt.tapBusinessDetails)?[...Vt.tapBusinessDetails]:[];if(Kt.splice(p
t,1),Vt.tapBusinessDetails=Kt,Vt.productLine&&Vt.productLine.toLowerCase().includes("tap")){const 
rs=bs(Kt,$,As);Vt.months=rs.months;const Ut=((It=Vt.history)==null?void 
0:It.currentYearYTD)||0;Vt.fullYearForecast=Ut+rs.forecastTotal}return Ot[lt]=Vt,Ot})},Us=lt=>{Ft(pt=>{const St=[...pt]
,Ot={...St[lt]},Vt=Array.isArray(Ot.complianceDetails)?[...Ot.complianceDetails]:[],Kt=ar(Ot.productLine);return Vt.pus
h({id:`COMP${Vt.length+1}`,name:"",description:"",certaintyPercentage:100,courseName:"",customCourseName:"",numberOfTra
inees:0,pricePerPerson:0,trainingDate:"",commissionPercentage:Kt,commissionFrequency:"With Income",travelCost:0,travelC
ostFrequency:"Once-off",manualsCost:0,manualsCostFrequency:"Once-off",accommodationCost:0,accommodationCostFrequency:"O
nce-off",accreditationCost:0,accreditationCostFrequency:"Once-off",customCostLabel:"",customCost:0,customCostFrequency:
"Once-off"}),Ot.complianceDetails=Vt,St[lt]=Ot,St})},rn=(lt,pt,St,Ot)=>{Ft(Vt=>{var At;const 
Kt=[...Vt],It={...Kt[lt]},rs=Array.isArray(It.complianceDetails)?[...It.complianceDetails]:[];if(!rs[pt])return 
Vt;const Ut={...rs[pt]};if(["numberOfTrainees","pricePerPerson","commissionPercentage","certaintyPercentage","travelCos
t","manualsCost","accommodationCost","accreditationCost","customCost"].includes(St)?Ut[St]=parseFloat(Ot)||0:Ut[St]=Ot,
rs[pt]=Ut,It.complianceDetails=rs,It.productLine&&It.productLine.toLowerCase().includes("compliance")){const 
hs=Ys(rs,$,As);It.months=hs.months;const ps=((At=It.history)==null?void 
0:At.currentYearYTD)||0;It.fullYearForecast=ps+hs.forecastTotal}return Kt[lt]=It,Kt})},Ms=(lt,pt)=>{Ft(St=>{var 
It;const Ot=[...St],Vt={...Ot[lt]},Kt=Array.isArray(Vt.complianceDetails)?[...Vt.complianceDetails]:[];if(Kt.splice(pt,
1),Vt.complianceDetails=Kt,Vt.productLine&&Vt.productLine.toLowerCase().includes("compliance")){const 
rs=Ys(Kt,$,As);Vt.months=rs.months;const Ut=((It=Vt.history)==null?void 
0:It.currentYearYTD)||0;Vt.fullYearForecast=Ut+rs.forecastTotal}return Ot[lt]=Vt,Ot})},ur=lt=>{Ft(pt=>{const St=[...pt]
,Ot={...St[lt]},Vt=Array.isArray(Ot.otherCoursesDetails)?[...Ot.otherCoursesDetails]:[],Kt=ar(Ot.productLine);return Vt
.push({id:`COURSE${Vt.length+1}`,name:"",description:"",certaintyPercentage:100,courseName:"",customCourseName:"",numbe
rOfTrainees:0,pricePerPerson:0,trainingDate:"",commissionPercentage:Kt,commissionFrequency:"With Income",travelCost:0,t
ravelCostFrequency:"Once-off",manualsCost:0,manualsCostFrequency:"Once-off",accommodationCost:0,accommodationCostFreque
ncy:"Once-off",accreditationCost:0,accreditationCostFrequency:"Once-off",customCostLabel:"",customCost:0,customCostFreq
uency:"Once-off"}),Ot.otherCoursesDetails=Vt,St[lt]=Ot,St})},fn=(lt,pt,St,Ot)=>{Ft(Vt=>{var At;const 
Kt=[...Vt],It={...Kt[lt]},rs=Array.isArray(It.otherCoursesDetails)?[...It.otherCoursesDetails]:[];if(!rs[pt])return 
Vt;const Ut={...rs[pt]};if(["numberOfTrainees","pricePerPerson","commissionPercentage","certaintyPercentage","travelCos
t","manualsCost","accommodationCost","accreditationCost","customCost"].includes(St)?Ut[St]=parseFloat(Ot)||0:Ut[St]=Ot,
rs[pt]=Ut,It.otherCoursesDetails=rs,It.productLine&&(It.productLine.toLowerCase().includes("course")||It.productLine.to
LowerCase().includes("training"))){const hs=Ys(rs,$,As);It.months=hs.months;const ps=((At=It.history)==null?void 
0:At.currentYearYTD)||0;It.fullYearForecast=ps+hs.forecastTotal}return Kt[lt]=It,Kt})},Nn=(lt,pt)=>{Ft(St=>{var 
It;const Ot=[...St],Vt={...Ot[lt]},Kt=Array.isArray(Vt.otherCoursesDetails)?[...Vt.otherCoursesDetails]:[];if(Kt.splice
(pt,1),Vt.otherCoursesDetails=Kt,Vt.productLine&&(Vt.productLine.toLowerCase().includes("course")||Vt.productLine.toLow
erCase().includes("training"))){const rs=Ys(Kt,$,As);Vt.months=rs.months;const Ut=((It=Vt.history)==null?void 
0:It.currentYearYTD)||0;Vt.fullYearForecast=Ut+rs.forecastTotal}return Ot[lt]=Vt,Ot})},Ys=(lt,pt,St)=>{if(!pt||!lt||lt.
length===0)return{months:{},ytd:0,forecastTotal:0,breakdown:{totalIncome:0,totalCosts:0,totalGP:0,incomeYTD:0,incomeFor
ecast:0,incomeNextFY:0,costsYTD:0,costsForecast:0,costsNextFY:0,gpYTD:0,gpForecast:0,gpNextFY:0,dealDetails:[]}};const 
Ot={};let Vt=0,Kt=0;const It={totalIncome:0,totalCosts:0,totalGP:0,incomeYTD:0,incomeForecast:0,incomeNextFY:0,costsYTD
:0,costsForecast:0,costsNextFY:0,gpYTD:0,gpForecast:0,gpNextFY:0,dealDetails:[]},rs=pt.reportingMonth??new 
Date().getMonth(),Ut=pt.fyStartMonth??2;let At=pt.currentFinancialYear;rs>=Ut&&(At=pt.currentFinancialYear-1);const 
hs=yn(pt,St);return lt.forEach((ps,Ss)=>{const 
on=ps.numberOfTrainees||0,ln=ps.pricePerPerson||0;if(!ps.trainingDate)return;const qn=on*ln,er=ps.commissionPercentage|
|0,kn=qn*er/100,Wn=ps.travelCost||0,Fs=ps.manualsCost||0,Pn=ps.accommodationCost||0,bn=ps.accreditationCost||0,An=ps.cu
stomCost||0,dn=kn+Wn+Fs+Pn+bn+An,Ds=qn-dn,Sn=_r(ps.trainingDate);if(isNaN(Sn.getTime()))return;const 
Zs={dealNumber:Ss+1,name:ps.name||ps.courseName||`Deal ${Ss+1}`,courseName:ps.courseName==="Other"?ps.customCourseName:
ps.courseName,totalIncome:qn,totalCosts:dn,totalGP:Ds,incomeYTD:0,incomeForecast:0,incomeNextFY:0,costsYTD:0,costsForec
ast:0,costsNextFY:0,gpYTD:0,gpForecast:0,gpNextFY:0},zn=(rr,at)=>{const kt=jn(rr,at,hs),us=Mn(rr,at,At,rs);return kt?us
?"ytd":"forecast":"nextFY"},en=Sn.getMonth(),nn=Sn.getFullYear(),xn=`${nn}-${en}`,$s=zn(nn,en);$s==="ytd"?Zs.incomeYTD=
qn:$s==="forecast"?(Zs.incomeForecast=qn,Ot[xn]||(Ot[xn]=0),Ot[xn]+=Ds,Kt+=Ds):Zs.incomeNextFY=qn;const 
Vs=(rr,at)=>{if(!rr)return{ytd:0,forecast:0,nextFY:0};const kt={ytd:0,forecast:0,nextFY:0};return $s==="ytd"?kt.ytd=rr:
$s==="forecast"?kt.forecast=rr:kt.nextFY=rr,kt},gn=Vs(kn,ps.commissionFrequency),an=Vs(Wn,ps.travelCostFrequency),tr=Vs
(Fs,ps.manualsCostFrequency),Ws=Vs(Pn,ps.accommodationCostFrequency),sr=Vs(bn,ps.accreditationCostFrequency),dr=Vs(An,p
s.customCostFrequency);Zs.costsYTD=gn.ytd+an.ytd+tr.ytd+Ws.ytd+sr.ytd+dr.ytd,Zs.costsForecast=gn.forecast+an.forecast+t
r.forecast+Ws.forecast+sr.forecast+dr.forecast,Zs.costsNextFY=gn.nextFY+an.nextFY+tr.nextFY+Ws.nextFY+sr.nextFY+dr.next
FY,Zs.gpYTD=Zs.incomeYTD-Zs.costsYTD,Zs.gpForecast=Zs.incomeForecast-Zs.costsForecast,Zs.gpNextFY=Zs.incomeNextFY-Zs.co
stsNextFY,$s==="ytd"&&(Vt+=Ds),It.dealDetails.push(Zs),It.totalIncome+=qn,It.totalCosts+=dn,It.totalGP+=Ds,It.incomeYTD
+=Zs.incomeYTD,It.incomeForecast+=Zs.incomeForecast,It.incomeNextFY+=Zs.incomeNextFY,It.costsYTD+=Zs.costsYTD,It.costsF
orecast+=Zs.costsForecast,It.costsNextFY+=Zs.costsNextFY,It.gpYTD+=Zs.gpYTD,It.gpForecast+=Zs.gpForecast,It.gpNextFY+=Z
s.gpNextFY}),{months:Ot,ytd:Vt,forecastTotal:Kt,breakdown:It}},bs=(lt,pt,St)=>{if(!pt||!lt||lt.length===0)return{months
:{},ytd:0,forecastTotal:0,breakdown:{totalIncome:0,totalCosts:0,totalGP:0,incomeYTD:0,incomeForecast:0,incomeNextFY:0,c
ostsYTD:0,costsForecast:0,costsNextFY:0,gpYTD:0,gpForecast:0,gpNextFY:0,dealDetails:[]}};const Ot={};let 
Vt=0,Kt=0;const It={totalIncome:0,totalCosts:0,totalGP:0,incomeYTD:0,incomeForecast:0,incomeNextFY:0,costsYTD:0,costsFo
recast:0,costsNextFY:0,gpYTD:0,gpForecast:0,gpNextFY:0,dealDetails:[]},rs=pt.reportingMonth??new 
Date().getMonth(),Ut=pt.fyStartMonth??2;let At=pt.currentFinancialYear;rs>=Ut&&(At=pt.currentFinancialYear-1);const 
hs=yn(pt,St);return lt.forEach((ps,Ss)=>{const 
on=ps.numberOfEmployees||0,ln=ps.costPerEmployeePerMonth||0;if(!ps.paymentStartDate||!on||!ln)return;const 
qn=ps.paymentType||"Monthly",er=ps.contractMonths||12;let kn;qn==="Annual"?kn=on*ln*12:kn=on*ln*er;const Wn=ps.commissi
onPercentage||0,Fs=kn*Wn/100,Pn=ps.customCost||0,bn=Fs+Pn,An=kn-bn,dn=_r(ps.paymentStartDate);if(isNaN(dn.getTime()))re
turn;const Ds={dealNumber:Ss+1,name:ps.name||`Deal ${Ss+1}`,totalIncome:kn,totalCosts:bn,totalGP:An,incomeYTD:0,incomeF
orecast:0,incomeNextFY:0,costsYTD:0,costsForecast:0,costsNextFY:0,gpYTD:0,gpForecast:0,gpNextFY:0,monthsInYTD:0,monthsI
nForecast:0,monthsInNextFY:0},Sn=(nn,xn)=>{const $s=jn(nn,xn,hs),Vs=Mn(nn,xn,At,rs);return 
$s?Vs?"ytd":"forecast":"nextFY"};if(qn==="Annual"){const 
nn=dn.getMonth(),xn=dn.getFullYear(),$s=Sn(xn,nn);if($s==="ytd")Ds.incomeYTD=kn,Ds.monthsInYTD=1;else 
if($s==="forecast"){Ds.incomeForecast=kn,Ds.monthsInForecast=1;const 
Vs=`${xn}-${nn}`;Ot[Vs]||(Ot[Vs]=0),Ot[Vs]+=An,Kt+=An}else Ds.incomeNextFY=kn,Ds.monthsInNextFY=1}else{const 
nn=on*ln;let xn=new Date(dn);for(let $s=0;$s<er;$s++){const Vs=xn.getMonth(),gn=xn.getFullYear(),an=Sn(gn,Vs);an==="ytd
"?(Ds.incomeYTD+=nn,Ds.monthsInYTD++):an==="forecast"?(Ds.incomeForecast+=nn,Ds.monthsInForecast++):(Ds.incomeNextFY+=n
n,Ds.monthsInNextFY++),xn.setMonth(xn.getMonth()+1)}}const Zs=(nn,xn)=>{if(!nn)return{ytd:0,forecast:0,nextFY:0};const 
$s={ytd:0,forecast:0,nextFY:0};if(xn==="Once-off"){const Vs=dn.getMonth(),gn=dn.getFullYear(),an=Sn(gn,Vs);an==="ytd"?$
s.ytd=nn:an==="forecast"?$s.forecast=nn:$s.nextFY=nn}else if(xn==="With Income")if(qn==="Annual"){const Vs=dn.getMonth(
),gn=dn.getFullYear(),an=Sn(gn,Vs);an==="ytd"?$s.ytd=nn:an==="forecast"?$s.forecast=nn:$s.nextFY=nn}else{const 
Vs=nn/er;let gn=new Date(dn);for(let an=0;an<er;an++){const tr=gn.getMonth(),Ws=gn.getFullYear(),sr=Sn(Ws,tr);sr==="ytd
"?$s.ytd+=Vs:sr==="forecast"?$s.forecast+=Vs:$s.nextFY+=Vs,gn.setMonth(gn.getMonth()+1)}}return 
$s},zn=Zs(Fs,ps.commissionFrequency||"With Income"),en=Zs(Pn,ps.customCostFrequency||"Once-off");if(Ds.costsYTD=zn.ytd+
en.ytd,Ds.costsForecast=zn.forecast+en.forecast,Ds.costsNextFY=zn.nextFY+en.nextFY,Ds.gpYTD=Ds.incomeYTD-Ds.costsYTD,Ds
.gpForecast=Ds.incomeForecast-Ds.costsForecast,Ds.gpNextFY=Ds.incomeNextFY-Ds.costsNextFY,qn==="Monthly"){const 
nn=An/er;let xn=new Date(dn);for(let $s=0;$s<er;$s++){const Vs=xn.getMonth(),gn=xn.getFullYear(),an=`${gn}-${Vs}`,tr=Sn
(gn,Vs);tr==="forecast"?(Ot[an]||(Ot[an]=0),Ot[an]+=nn,Kt+=nn):tr==="ytd"&&(Vt+=nn),xn.setMonth(xn.getMonth()+1)}}It.de
alDetails.push(Ds),It.totalIncome+=kn,It.totalCosts+=bn,It.totalGP+=An,It.incomeYTD+=Ds.incomeYTD,It.incomeForecast+=Ds
.incomeForecast,It.incomeNextFY+=Ds.incomeNextFY,It.costsYTD+=Ds.costsYTD,It.costsForecast+=Ds.costsForecast,It.costsNe
xtFY+=Ds.costsNextFY,It.gpYTD+=Ds.gpYTD,It.gpForecast+=Ds.gpForecast,It.gpNextFY+=Ds.gpNextFY}),{months:Ot,ytd:Vt,forec
astTotal:Kt,breakdown:It}},yn=(lt,pt)=>{const St=lt.fyStartMonth??2,Ot=lt.fyEndMonth??1;let 
Vt,Kt;if(pt&&pt.length>0){const It=pt.map(Ut=>Ut.year),rs=Math.max(...It);St>Ot?pt.some(Ut=>Ut.year===rs&&Ut.number<=Ot
)?(Kt=rs,Vt=rs-1):(Kt=rs+1,Vt=rs):Vt=Kt=Math.min(...It)}else{const It=lt.currentFinancialYear;Vt=St>Ot?It-1:It,Kt=It}re
turn{fyStartMonth:St,fyEndMonth:Ot,fyStartYear:Vt,fyEndYear:Kt}},jn=(lt,pt,St)=>{const{fyStartMonth:Ot,fyEndMonth:Vt,fy
StartYear:Kt,fyEndYear:It}=St;if(Ot>Vt){if(lt===Kt&&pt>=Ot)return!0;if(lt===It&&pt<=Vt)return!0}else 
if(lt===Kt&&pt>=Ot&&pt<=Vt)return!0;return!1},Mn=(lt,pt,St,Ot)=>lt<St||lt===St&&pt<=Ot,_r=lt=>{if(typeof 
lt=="string"){const pt=lt.split("-");return pt.length===3?new 
Date(parseInt(pt[0],10),parseInt(pt[1],10)-1,parseInt(pt[2],10)):new Date(lt)}return new Date(lt)},Tr=(lt,pt)=>{const 
St=_r(lt);if(isNaN(St.getTime()))return null;const Ot=new Date(St);return Ot.setMonth(Ot.getMonth()+pt-1),Ot},or=(lt,pt
,St)=>{if(!pt||!lt||lt.length===0)return{months:{},ytd:0,forecastTotal:0,breakdown:{totalIncome:0,totalCosts:0,totalGP:
0,incomeYTD:0,incomeForecast:0,incomeNextFY:0,costsYTD:0,costsForecast:0,costsNextFY:0,gpYTD:0,gpForecast:0,gpNextFY:0,
lineDetails:[]}};const Ot={};let Vt=0,Kt=0;const It={totalIncome:0,totalCosts:0,totalGP:0,incomeYTD:0,incomeForecast:0,
incomeNextFY:0,costsYTD:0,costsForecast:0,costsNextFY:0,gpYTD:0,gpForecast:0,gpNextFY:0,lineDetails:[]},rs=pt.reporting
Month??new Date().getMonth(),Ut=pt.fyStartMonth??2;let 
At=pt.currentFinancialYear;rs<Ut||(At=pt.currentFinancialYear-1);const hs=yn(pt,St);return lt.forEach((ps,Ss)=>{const 
on=ps.learners===""?0:parseFloat(ps.learners)||0;if(!ps.paymentStartDate||!on||!ps.costPerLearner)return;const ln=on*(p
s.costPerLearner||0),qn=ps.commissionPercentage||0,er=ln*qn/100,kn=ps.facilitatorCost||0,Wn=ps.travelCost||0,Fs=ps.asse
ssorCost||0,Pn=ps.moderatorCost||0,bn=ps.otherCost||0,An=ps.customCost||0,dn=ps.facilitatorCostFrequency||"Monthly",Ds=
ps.commissionFrequency||"With Income",Sn=ps.travelCostFrequency||"Monthly",Zs=ps.assessorCostFrequency||"End of 
Learnership",zn=ps.moderatorCostFrequency||"End of Learnership",en=ps.otherCostFrequency||"Once-off",nn=ps.customCostFr
equency||"Once-off",xn=kn+er+Wn+Fs+Pn+bn+An,$s=ln-xn,Vs=_r(ps.paymentStartDate);if(isNaN(Vs.getTime()))return;const gn=
ps.paymentFrequency||"Monthly",an=parseInt(ps.paymentMonths||12,10),tr=Tr(ps.paymentStartDate,an),Ws={lineNumber:Ss+1,n
ame:ps.name||`Deal ${Ss+1}`,totalIncome:ln,totalCosts:xn,totalGP:$s,incomeYTD:0,incomeForecast:0,incomeNextFY:0,costsYT
D:0,costsForecast:0,costsNextFY:0,gpYTD:0,gpForecast:0,gpNextFY:0,monthsInYTD:0,monthsInForecast:0,monthsInNextFY:0},sr
=(Js,cn)=>{const Qn=jn(Js,cn,hs),un=Mn(Js,cn,At,rs);if(Qn)return 
un?"ytd":"forecast";{const{fyStartMonth:Fn,fyEndMonth:_n,fyStartYear:Bs}=hs;return 
Fn>_n&&(Js<Bs||Js===Bs&&cn<Fn)?"before":"nextFY"}};if(gn==="Once-off"){const Js=Vs.getMonth(),cn=Vs.getFullYear(),Qn=`$
{cn}-${Js}`,un=sr(cn,Js);un==="ytd"?(Ws.incomeYTD+=ln,Ws.monthsInYTD=1):un==="forecast"?(Ws.incomeForecast+=ln,Ws.month
sInForecast=1,Ot[Qn]||(Ot[Qn]=0),Ot[Qn]+=$s,Kt+=$s):un==="nextFY"&&(Ws.incomeNextFY+=ln,Ws.monthsInNextFY=1)}else{const
 Js=ln/an;let cn=new Date(Vs);for(let Qn=0;Qn<an;Qn++){const un=cn.getMonth(),Fn=cn.getFullYear(),_n=sr(Fn,un);_n==="yt
d"?(Ws.incomeYTD+=Js,Ws.monthsInYTD++):_n==="forecast"?(Ws.incomeForecast+=Js,Ws.monthsInForecast++):_n==="nextFY"&&(Ws
.incomeNextFY+=Js,Ws.monthsInNextFY++),cn.setMonth(cn.getMonth()+1)}}const 
dr=(Js,cn,Qn)=>{if(!Js||Js===0)return{ytd:0,forecast:0,nextFY:0};const 
un={ytd:0,forecast:0,nextFY:0};if(cn==="Once-off"){const Fn=Vs.getMonth(),_n=Vs.getFullYear(),Bs=sr(_n,Fn);Bs==="ytd"?u
n.ytd=Js:Bs==="forecast"?un.forecast=Js:Bs==="nextFY"&&(un.nextFY=Js)}else if(cn==="With 
Income")if(gn==="Once-off"){const Fn=Vs.getMonth(),_n=Vs.getFullYear(),Bs=sr(_n,Fn);Bs==="ytd"?un.ytd=Js:Bs==="forecast
"?un.forecast=Js:Bs==="nextFY"&&(un.nextFY=Js)}else{const Fn=Js/an;let _n=new Date(Vs);for(let Bs=0;Bs<an;Bs++){const p
n=_n.getMonth(),ir=_n.getFullYear(),jr=sr(ir,pn);jr==="ytd"?un.ytd+=Fn:jr==="forecast"?un.forecast+=Fn:jr==="nextFY"&&(
un.nextFY+=Fn),_n.setMonth(_n.getMonth()+1)}}else if(cn==="End of Learnership"){if(tr){const Fn=tr.getMonth(),_n=tr.get
FullYear(),Bs=sr(_n,Fn);Bs==="ytd"?un.ytd=Js:Bs==="forecast"?un.forecast=Js:Bs==="nextFY"&&(un.nextFY=Js)}}else 
if(cn==="Monthly"){const Fn=Js/an;let _n=new Date(Vs);for(let Bs=0;Bs<an;Bs++){const pn=_n.getMonth(),ir=_n.getFullYear
(),jr=sr(ir,pn);jr==="ytd"?un.ytd+=Fn:jr==="forecast"?un.forecast+=Fn:jr==="nextFY"&&(un.nextFY+=Fn),_n.setMonth(_n.get
Month()+1)}}return un},rr=dr(kn,dn),at=dr(er,Ds),kt=dr(Wn,Sn),us=dr(Fs,Zs),ds=dr(Pn,zn),vn=dr(bn,en),In=dr(An,nn);if(Ws
.costsYTD=rr.ytd+at.ytd+kt.ytd+us.ytd+ds.ytd+vn.ytd+In.ytd,Ws.costsForecast=rr.forecast+at.forecast+kt.forecast+us.fore
cast+ds.forecast+vn.forecast+In.forecast,Ws.costsNextFY=rr.nextFY+at.nextFY+kt.nextFY+us.nextFY+ds.nextFY+vn.nextFY+In.
nextFY,Ws.gpYTD=Ws.incomeYTD-Ws.costsYTD,Ws.gpForecast=Ws.incomeForecast-Ws.costsForecast,Ws.gpNextFY=Ws.incomeNextFY-W
s.costsNextFY,gn==="Monthly"){const Js=$s/an;let cn=new Date(Vs);for(let Qn=0;Qn<an;Qn++){const un=cn.getMonth(),Fn=cn.
getFullYear(),_n=`${Fn}-${un}`,Bs=sr(Fn,un);Bs==="forecast"?(Ot[_n]||(Ot[_n]=0),Ot[_n]+=Js,Kt+=Js):Bs==="ytd"&&(Vt+=Js)
,cn.setMonth(cn.getMonth()+1)}}It.lineDetails.push(Ws),It.totalIncome+=ln,It.totalCosts+=xn,It.totalGP+=$s,It.incomeYTD
+=Ws.incomeYTD,It.incomeForecast+=Ws.incomeForecast,It.incomeNextFY+=Ws.incomeNextFY,It.costsYTD+=Ws.costsYTD,It.costsF
orecast+=Ws.costsForecast,It.costsNextFY+=Ws.costsNextFY,It.gpYTD+=Ws.gpYTD,It.gpForecast+=Ws.gpForecast,It.gpNextFY+=W
s.gpNextFY}),{months:Ot,ytd:Vt,forecastTotal:Kt,breakdown:It}},br=()=>{Ht&&Ft(lt=>[...lt,{id:`${Ht.id}_${tt}_New_${lt.l
ength+1}`,clientId:Ht.id,clientName:Ht.name,financialYear:tt,productLine:"",history:{yearMinus3:0,yearMinus2:0,yearMinu
s1:0,currentYearYTD:0},months:{},fullYearForecast:0,comments:""}])},Ar=async()=>{if(!Ht)return;h(!0);const 
lt=Qt.filter(pt=>(pt.productLine||"").trim()!=="");try{const pt=auth.currentUser,St=(pt==null?void 0:pt.uid)||"system",
Ot=lt.map(Vt=>saveClientFinancial(Vt.clientId,Vt.clientName,Vt.financialYear||tt,Vt.productLine,{history:Vt.history,mon
ths:Vt.months,fullYearForecast:Vt.fullYearForecast||0,comments:Vt.comments,learnershipDetails:Vt.learnershipDetails||[]
,tapBusinessDetails:Vt.tapBusinessDetails||[],complianceDetails:Vt.complianceDetails||[],otherCoursesDetails:Vt.otherCo
ursesDetails||[]},St));await 
Promise.all(Ot),nt(Vt=>[...Vt.filter(It=>It.clientId!==Ht.id),...lt]),Dt(!1),_("")}catch(pt){console.error("Error 
saving client detail financial data:",pt),console.error("Error 
details:",{message:pt.message,stack:pt.stack,detailClient:Ht,rowsCount:lt.length}),_("Failed to save client financial 
data for this client. Please try again.")}finally{h(!1)}},as=lt=>lt?new 
Intl.NumberFormat("en-ZA",{style:"currency",currency:"ZAR",minimumFractionDigits:0}).format(lt):"R 0",Ks=lt=>lt?new 
Intl.NumberFormat("en-ZA",{style:"currency",currency:"ZAR",minimumFractionDigits:0}).format(lt):"";return o?jsxRuntimeE
xports.jsxs("div",{className:"client-financial-editor",children:[jsxRuntimeExports.jsx("h1",{children:"Client 
Financial Forecasting"}),jsxRuntimeExports.jsx("p",{children:"Loading..."})]}):jsxRuntimeExports.jsxs("div",{className:
"client-financial-editor",children:[jsxRuntimeExports.jsxs("div",{className:"editor-header",children:[jsxRuntimeExports
.jsxs("div",{children:[jsxRuntimeExports.jsx("h1",{children:"Client Financial 
Forecasting"}),jsxRuntimeExports.jsx("p",{className:"editor-subtitle",children:"Edit detailed forecasts per client and 
product line, using current year YTD and remaining months."})]}),jsxRuntimeExports.jsxs("div",{className:"editor-action
s",children:[gr&&jsxRuntimeExports.jsxs("div",{className:"filter-group",children:[jsxRuntimeExports.jsx("label",{childr
en:"Filter by Sales Person"}),jsxRuntimeExports.jsxs("select",{value:zt,onChange:lt=>Ct(lt.target.value),className:"sal
esperson-filter-select",children:[jsxRuntimeExports.jsx("option",{value:"all",children:"All Sales People"}),gt.map(lt=>
jsxRuntimeExports.jsx("option",{value:lt.id,children:lt.displayName||lt.email},lt.id))]})]}),jsxRuntimeExports.jsxs("di
v",{className:"filter-group",children:[jsxRuntimeExports.jsx("label",{children:"Search 
Client"}),jsxRuntimeExports.jsx("input",{type:"text",value:Rt,onChange:Gs,placeholder:"Type to filter clients...",class
Name:"client-search-input"})]}),jsxRuntimeExports.jsx("button",{onClick:tn,className:"save-btn",disabled:d,children:d?"
Saving...":"Save All Changes"})]})]}),j&&jsxRuntimeExports.jsx("div",{className:"editor-error",children:j}),jsxRuntimeE
xports.jsx("div",{className:"client-financial-table-wrapper",children:jsxRuntimeExports.jsxs("table",{className:"client
-financial-table",children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeEx
ports.jsx("th",{onClick:()=>Qs("clientName"),className:"sortable",children:"Client / Product Line"}),jsxRuntimeExports.
jsx("th",{children:Ns[0]}),jsxRuntimeExports.jsx("th",{children:Ns[1]}),jsxRuntimeExports.jsx("th",{children:Ns[2]}),js
xRuntimeExports.jsxs("th",{onClick:()=>Qs("ytd"),className:"sortable",children:[jsxRuntimeExports.jsx("div",{className:
"header-main",children:"YTD Actual"}),vt&&jsxRuntimeExports.jsx("div",{className:"header-sub",children:vt})]}),As.map(l
t=>jsxRuntimeExports.jsx("th",{children:lt.name},`${lt.year}-${lt.number}`)),jsxRuntimeExports.jsxs("th",{onClick:()=>Q
s("forecast"),className:"sortable",children:[jsxRuntimeExports.jsx("div",{className:"header-main",children:"Full Year F
orecast"}),wt&&jsxRuntimeExports.jsx("div",{className:"header-sub",children:wt})]}),jsxRuntimeExports.jsx("th",{childre
n:"Comments"})]})}),jsxRuntimeExports.jsx("tbody",{children:Un.length===0?jsxRuntimeExports.jsx("tr",{children:jsxRunti
meExports.jsx("td",{colSpan:7+As.length,className:"empty-state",children:"No client financial data found for this 
year."})}):Un.map(lt=>{var pt,St,Ot,Vt;return jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("td",{childr
en:jsxRuntimeExports.jsxs("div",{className:"client-product-cell",children:[jsxRuntimeExports.jsx("button",{type:"button
",className:"client-name-link",onClick:()=>hr(lt.clientId,lt.clientName),children:lt.clientName||"Unknown Client"}),lt.
productSummary&&jsxRuntimeExports.jsx("div",{className:"product-line",children:lt.productSummary})]})}),jsxRuntimeExpor
ts.jsx("td",{children:as(((pt=_s[lt.clientId])==null?void 
0:pt.yearMinus3)||lt.history.yearMinus3||0)}),jsxRuntimeExports.jsx("td",{children:as(((St=_s[lt.clientId])==null?void 
0:St.yearMinus2)||lt.history.yearMinus2||0)}),jsxRuntimeExports.jsx("td",{children:as(((Ot=_s[lt.clientId])==null?void 
0:Ot.yearMinus1)||lt.history.yearMinus1||0)}),jsxRuntimeExports.jsx("td",{children:as(((Vt=_s[lt.clientId])==null?void 
0:Vt.ytdActual)||lt.history.currentYearYTD||0)}),As.map(Kt=>{var Ut;const 
It=`${Kt.year}-${Kt.number}`,rs=((Ut=lt.months)==null?void 0:Ut[It])||0;return jsxRuntimeExports.jsx("td",{children:as(
rs)},It)}),jsxRuntimeExports.jsx("td",{children:as(lt.fullYearForecast||0)}),jsxRuntimeExports.jsx("td",{children:jsxRu
ntimeExports.jsx("textarea",{className:"comments-input",value:lt.comments||"",onChange:Kt=>sn(lt.id,Kt.target.value)})}
)]},lt.clientId)})}),Un.length>0&&jsxRuntimeExports.jsx("tfoot",{children:jsxRuntimeExports.jsxs("tr",{className:"total
s-row",children:[jsxRuntimeExports.jsx("td",{children:jsxRuntimeExports.jsx("strong",{children:"TOTALS"})}),jsxRuntimeE
xports.jsx("td",{children:jsxRuntimeExports.jsx("strong",{children:as(Zn.yearMinus3)})}),jsxRuntimeExports.jsx("td",{ch
ildren:jsxRuntimeExports.jsx("strong",{children:as(Zn.yearMinus2)})}),jsxRuntimeExports.jsx("td",{children:jsxRuntimeEx
ports.jsx("strong",{children:as(Zn.yearMinus1)})}),jsxRuntimeExports.jsx("td",{children:jsxRuntimeExports.jsx("strong",
{children:as(Zn.currentYearYTD)})}),As.map(lt=>{const pt=`${lt.year}-${lt.number}`;return jsxRuntimeExports.jsx("td",{c
hildren:jsxRuntimeExports.jsx("strong",{children:as(Zn.months[pt]||0)})},pt)}),jsxRuntimeExports.jsx("td",{children:jsx
RuntimeExports.jsx("strong",{children:as(Zn.fullYearForecast)})}),jsxRuntimeExports.jsx("td",{})]})})]})}),Xt&&Ht&&jsxR
untimeExports.jsx("div",{className:"client-detail-modal-backdrop",children:jsxRuntimeExports.jsxs("div",{className:"cli
ent-detail-modal",children:[jsxRuntimeExports.jsxs("div",{className:"modal-header",children:[jsxRuntimeExports.jsxs("di
v",{children:[jsxRuntimeExports.jsx("h2",{children:Ht.name}),jsxRuntimeExports.jsx("p",{className:"modal-subtitle",chil
dren:"Edit forecasts per product line. Changes will update the client summary automatically."})]}),jsxRuntimeExports.js
xs("div",{className:"modal-actions",children:[jsxRuntimeExports.jsx("button",{type:"button",className:"secondary-btn",o
nClick:()=>Dt(!1),disabled:d,children:"Cancel"}),jsxRuntimeExports.jsx("button",{type:"button",className:"primary-btn",
onClick:Ar,disabled:d,children:d?"Saving...":"Save & Close"})]})]}),jsxRuntimeExports.jsxs("div",{className:"modal-body
",children:[jsxRuntimeExports.jsx("button",{type:"button",className:"add-product-btn",onClick:br,children:"+ Add Produc
t"}),jsxRuntimeExports.jsx("div",{className:"client-detail-table-wrapper",children:jsxRuntimeExports.jsxs("table",{clas
sName:"client-detail-table",children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{children:[js
xRuntimeExports.jsx("th",{children:"Product Line"}),jsxRuntimeExports.jsx("th",{children:Ns[0]}),jsxRuntimeExports.jsx(
"th",{children:Ns[1]}),jsxRuntimeExports.jsx("th",{children:Ns[2]}),jsxRuntimeExports.jsxs("th",{children:[jsxRuntimeEx
ports.jsx("div",{className:"header-main",children:"YTD Actual"}),vt&&jsxRuntimeExports.jsx("div",{className:"header-sub
",children:vt})]}),As.map(lt=>jsxRuntimeExports.jsx("th",{children:lt.name},`${lt.year}-${lt.number}`)),jsxRuntimeExpor
ts.jsxs("th",{children:[jsxRuntimeExports.jsx("div",{className:"header-main",children:"Full Year Forecast"}),wt&&jsxRun
timeExports.jsx("div",{className:"header-sub",children:wt})]}),jsxRuntimeExports.jsx("th",{children:"Comments"})]})}),j
sxRuntimeExports.jsx("tbody",{children:Qt.length===0?jsxRuntimeExports.jsx("tr",{children:jsxRuntimeExports.jsx("td",{c
olSpan:7+As.length,className:"empty-state",children:'No product lines yet. Click "Add Product" to 
start.'})}):Qt.map((lt,pt)=>{var St,Ot,Vt,Kt,It,rs,Ut,At;return jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExport
s.jsx("td",{children:jsxRuntimeExports.jsxs("div",{className:"product-line-cell",children:[jsxRuntimeExports.jsx("input
",{type:"text",value:lt.productLine||"",onChange:hs=>Pr(pt,hs.target.value),className:"product-line-input"}),lt.product
Line&&lt.productLine.toLowerCase().includes("learnership")&&jsxRuntimeExports.jsxs("button",{type:"button",className:"l
earnership-edit-btn",onClick:()=>{Os(pt),js(0),Cs(!0)},title:`Edit Learnership Deals 
(${((St=lt.learnershipDetails)==null?void 0:St.length)||0})`,children:["âœï¸ 
",((Ot=lt.learnershipDetails)==null?void 0:Ot.length)||0]}),lt.productLine&&lt.productLine.toLowerCase().includes("tap"
)&&jsxRuntimeExports.jsxs("button",{type:"button",className:"learnership-edit-btn 
tap-business-edit-btn",onClick:()=>{Tn(pt),En(0),vs(!0)},title:`Edit TAP Business Deals 
(${((Vt=lt.tapBusinessDetails)==null?void 0:Vt.length)||0})`,children:["âœï¸ 
",((Kt=lt.tapBusinessDetails)==null?void 0:Kt.length)||0]}),lt.productLine&&lt.productLine.toLowerCase().includes("comp
liance")&&jsxRuntimeExports.jsxs("button",{type:"button",className:"learnership-edit-btn 
compliance-edit-btn",onClick:()=>{ks(pt),hn(0),Ps(!0)},title:`Edit Compliance Training Deals 
(${((It=lt.complianceDetails)==null?void 0:It.length)||0})`,children:["âœï¸ ",((rs=lt.complianceDetails)==null?void 0
:rs.length)||0]}),lt.productLine&&(lt.productLine.toLowerCase().includes("course")||lt.productLine.toLowerCase().includ
es("other training"))&&!lt.productLine.toLowerCase().includes("compliance")&&jsxRuntimeExports.jsxs("button",{type:"but
ton",className:"learnership-edit-btn other-courses-edit-btn",onClick:()=>{Vn(pt),Kn(0),nr(!0)},title:`Edit Other 
Courses Deals (${((Ut=lt.otherCoursesDetails)==null?void 0:Ut.length)||0})`,children:["âœï¸ 
",((At=lt.otherCoursesDetails)==null?void 0:At.length)||0]})]})}),jsxRuntimeExports.jsx("td",{children:as(lt.history.ye
arMinus3||0)}),jsxRuntimeExports.jsx("td",{children:as(lt.history.yearMinus2||0)}),jsxRuntimeExports.jsx("td",{children
:as(lt.history.yearMinus1||0)}),jsxRuntimeExports.jsx("td",{children:ys==="accountant"||ys==="admin"?jsxRuntimeExports.
jsx("input",{type:"text",className:"month-input",value:Ks(lt.history.currentYearYTD||0),onChange:hs=>yr(pt,hs.target.va
lue)}):jsxRuntimeExports.jsx("div",{className:"readonly-ytd",children:as(lt.history.currentYearYTD||0)})}),As.map(hs=>{
var on;const ps=`${hs.year}-${hs.number}`,Ss=((on=lt.months)==null?void 0:on[ps])||0;return jsxRuntimeExports.jsx("td",
{children:jsxRuntimeExports.jsx("input",{type:"text",className:"month-input",value:Ks(Ss),onChange:ln=>Er(pt,ps,ln.targ
et.value)})},ps)}),jsxRuntimeExports.jsx("td",{children:as(lt.fullYearForecast||0)}),jsxRuntimeExports.jsx("td",{childr
en:jsxRuntimeExports.jsx("textarea",{className:"comments-input",value:lt.comments||"",onChange:hs=>wr(pt,hs.target.valu
e)})})]},lt.id||`${lt.clientId}-${pt}`)})}),Qt.length>0&&jsxRuntimeExports.jsx("tfoot",{children:jsxRuntimeExports.jsxs
("tr",{className:"total-row",children:[jsxRuntimeExports.jsx("td",{children:"Total"}),jsxRuntimeExports.jsx("td",{child
ren:as(Qt.reduce((lt,pt)=>lt+(pt.history.yearMinus3||0),0))}),jsxRuntimeExports.jsx("td",{children:as(Qt.reduce((lt,pt)
=>lt+(pt.history.yearMinus2||0),0))}),jsxRuntimeExports.jsx("td",{children:as(Qt.reduce((lt,pt)=>lt+(pt.history.yearMin
us1||0),0))}),jsxRuntimeExports.jsx("td",{children:as(Qt.reduce((lt,pt)=>lt+(pt.history.currentYearYTD||0),0))}),As.map
(lt=>{const pt=`${lt.year}-${lt.number}`,St=Qt.reduce((Ot,Vt)=>{var It;const Kt=((It=Vt.months)==null?void 
0:It[pt])||0;return Ot+(typeof Kt=="number"?Kt:parseInt(Kt||0,10))},0);return jsxRuntimeExports.jsx("td",{children:as(S
t)},pt)}),jsxRuntimeExports.jsx("td",{children:as(Qt.reduce((lt,pt)=>lt+(pt.fullYearForecast||0),0))}),jsxRuntimeExport
s.jsx("td",{})]})})]})})]})]})}),xs&&gs!==null&&Qt[gs]&&jsxRuntimeExports.jsx("div",{className:"learnership-modal-backd
rop",children:jsxRuntimeExports.jsxs("div",{className:"learnership-modal",children:[jsxRuntimeExports.jsxs("div",{class
Name:"learnership-modal-header",children:[jsxRuntimeExports.jsxs("h3",{children:["Learnership Deals - ",Qt[gs].productL
ine]}),jsxRuntimeExports.jsx("button",{type:"button",className:"close-btn",onClick:()=>Cs(!1),children:"Ã—"})]}),jsxRun
timeExports.jsxs("div",{className:"learnership-modal-body",children:[jsxRuntimeExports.jsxs("div",{className:"learnersh
ip-summary",children:[jsxRuntimeExports.jsx("h4",{children:"Forecast Preview"}),(()=>{var rs;const 
lt=Qt[gs],pt=or(lt.learnershipDetails||[],$,As),St=pt.breakdown,Ot=((rs=lt.history)==null?void 
0:rs.currentYearYTD)||0,Vt=As.reduce((Ut,At)=>{const hs=`${At.year}-${At.number}`,ps=pt.months[hs]||0;return 
Ut+(typeof ps=="number"?ps:parseFloat(ps||0))},0),Kt=[],It=[];return St.lineDetails.forEach(Ut=>{const 
At=Ut.name||`Deal ${Ut.lineNumber}`;Ut.incomeYTD>0&&Ut.incomeForecast===0&&Ut.incomeNextFY===0?Kt.push(`${At}: All 
income (${as(Ut.incomeYTD)}) is already in YTD period - no forecast impact.`):Ut.incomeYTD>0&&It.push(`${At}: 
${as(Ut.incomeYTD)} income already in YTD (should be in uploaded numbers).`),Ut.incomeNextFY>0&&Kt.push(`${At}: 
${Ut.monthsInNextFY} month(s) of income (${as(Ut.incomeNextFY)}) will be in the following financial 
year.`),Ut.costsNextFY>0&&It.push(`${At}: ${as(Ut.costsNextFY)} in costs will be paid in the next financial year 
(e.g., assessor/moderator fees at end of learnership).`)}),jsxRuntimeExports.jsxs("div",{className:"summary-content",ch
ildren:[Kt.length>0&&jsxRuntimeExports.jsx("div",{className:"summary-warnings",children:Kt.map((Ut,At)=>jsxRuntimeExpor
ts.jsxs("div",{className:"warning-message",children:["âšï¸ ",Ut]},At))}),It.length>0&&jsxRuntimeExports.jsx("div",{cla
ssName:"summary-info-messages",children:It.map((Ut,At)=>jsxRuntimeExports.jsxs("div",{className:"info-message",children
:["â„¹ï¸ ",Ut]},At))}),jsxRuntimeExports.jsxs("div",{className:"summary-row",children:[jsxRuntimeExports.jsxs("div",{c
lassName:"summary-item",children:[jsxRuntimeExports.jsx("label",{children:"Total GP (All Deals)"}),jsxRuntimeExports.js
x("div",{className:"summary-value",children:as(St.totalGP)})]}),jsxRuntimeExports.jsxs("div",{className:"summary-item",
children:[jsxRuntimeExports.jsx("label",{children:"YTD Actual"}),jsxRuntimeExports.jsx("div",{className:"summary-value 
ytd-value",children:as(Ot)})]}),jsxRuntimeExports.jsxs("div",{className:"summary-item",children:[jsxRuntimeExports.jsx(
"label",{children:"Forecast Total"}),jsxRuntimeExports.jsx("div",{className:"summary-value 
forecast-value",children:as(Vt)})]}),jsxRuntimeExports.jsxs("div",{className:"summary-item 
highlight",children:[jsxRuntimeExports.jsx("label",{children:"Full Year 
Forecast"}),jsxRuntimeExports.jsx("div",{className:"summary-value full-year-value",children:as(Ot+Vt)})]})]}),jsxRuntim
eExports.jsxs("div",{className:"breakdown-section",children:[jsxRuntimeExports.jsx("h5",{children:"Deal Breakdown by Pe
riod"}),jsxRuntimeExports.jsxs("table",{className:"breakdown-table",children:[jsxRuntimeExports.jsx("thead",{children:j
sxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("th",{}),jsxRuntimeExports.jsx("th",{children:"Total 
Deal"}),jsxRuntimeExports.jsx("th",{children:"In YTD"}),jsxRuntimeExports.jsx("th",{children:"In 
Forecast"}),jsxRuntimeExports.jsx("th",{children:"Next FY"})]})}),jsxRuntimeExports.jsxs("tbody",{children:[jsxRuntimeE
xports.jsxs("tr",{className:"income-row",children:[jsxRuntimeExports.jsx("td",{children:jsxRuntimeExports.jsx("strong",
{children:"Income"})}),jsxRuntimeExports.jsx("td",{children:as(St.totalIncome)}),jsxRuntimeExports.jsx("td",{children:a
s(St.incomeYTD)}),jsxRuntimeExports.jsx("td",{children:as(St.incomeForecast)}),jsxRuntimeExports.jsx("td",{children:as(
St.incomeNextFY)})]}),jsxRuntimeExports.jsxs("tr",{className:"costs-row",children:[jsxRuntimeExports.jsx("td",{children
:jsxRuntimeExports.jsx("strong",{children:"Costs"})}),jsxRuntimeExports.jsx("td",{children:as(St.totalCosts)}),jsxRunti
meExports.jsx("td",{children:as(St.costsYTD)}),jsxRuntimeExports.jsx("td",{children:as(St.costsForecast)}),jsxRuntimeEx
ports.jsx("td",{children:as(St.costsNextFY)})]}),jsxRuntimeExports.jsxs("tr",{className:"gp-row",children:[jsxRuntimeEx
ports.jsx("td",{children:jsxRuntimeExports.jsx("strong",{children:"Gross Profit"})}),jsxRuntimeExports.jsx("td",{childr
en:jsxRuntimeExports.jsx("strong",{children:as(St.totalGP)})}),jsxRuntimeExports.jsx("td",{children:jsxRuntimeExports.j
sx("strong",{children:as(St.gpYTD)})}),jsxRuntimeExports.jsx("td",{children:jsxRuntimeExports.jsx("strong",{children:as
(St.gpForecast)})}),jsxRuntimeExports.jsx("td",{children:jsxRuntimeExports.jsx("strong",{children:as(St.gpNextFY)})})]}
)]})]}),jsxRuntimeExports.jsxs("div",{className:"breakdown-explanation",children:[jsxRuntimeExports.jsx("p",{children:j
sxRuntimeExports.jsx("strong",{children:"Understanding this breakdown:"})}),jsxRuntimeExports.jsxs("ul",{children:[jsxR
untimeExports.jsxs("li",{children:[jsxRuntimeExports.jsx("strong",{children:"YTD:"})," Already included in the 
accountant's uploaded year-to-date 
figures"]}),jsxRuntimeExports.jsxs("li",{children:[jsxRuntimeExports.jsx("strong",{children:"Forecast:"})," Will be 
added to your forecast months (Dec, Jan, 
Feb)"]}),jsxRuntimeExports.jsxs("li",{children:[jsxRuntimeExports.jsx("strong",{children:"Next FY:"})," Will be in the 
following financial year - not included in current forecast"]})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"summa
ry-months",children:[jsxRuntimeExports.jsx("label",{children:"Monthly 
Breakdown:"}),jsxRuntimeExports.jsx("div",{className:"months-grid",children:As.map(Ut=>{const 
At=`${Ut.year}-${Ut.number}`,hs=pt.months[At]||0;return jsxRuntimeExports.jsxs("div",{className:"month-preview",childre
n:[jsxRuntimeExports.jsx("div",{className:"month-name",children:Ut.name}),jsxRuntimeExports.jsx("div",{className:"month
-amount",children:as(hs)})]},At)})})]})]})})()]}),jsxRuntimeExports.jsxs("div",{className:"learnership-tabs-header",chi
ldren:[jsxRuntimeExports.jsxs("div",{className:"learnership-tabs",children:[(Qt[gs].learnershipDetails||[]).map((lt,pt)
=>jsxRuntimeExports.jsxs("button",{type:"button",className:`learnership-tab 
${qt===pt?"active":""}`,onClick:()=>js(pt),children:["Deal ",pt+1," ",lt.name?`- ${lt.name}`:""," ",lt.certaintyPercent
age<100?`(${lt.certaintyPercentage}%)`:""]},lt.id||pt)),jsxRuntimeExports.jsx("button",{type:"button",className:"learne
rship-tab add-tab",onClick:()=>{Rr(gs),js((Qt[gs].learnershipDetails||[]).length)},children:"+ Add 
Deal"})]}),jsxRuntimeExports.jsx("button",{type:"button",className:"apply-forecast-btn",onClick:()=>{const 
lt=Qt[gs];if(lt.productLine&&lt.productLine.toLowerCase().includes("learnership")){const 
pt=or(lt.learnershipDetails||[],$,As);Ft(St=>{var It;const Ot=[...St],Vt={...Ot[gs]};Vt.months=pt.months;const 
Kt=((It=Vt.history)==null?void 0:It.currentYearYTD)||0;return 
Vt.fullYearForecast=Kt+pt.forecastTotal,Ot[gs]=Vt,Ot}),alert("Monthly forecast updated based on learnership 
calculations!")}},children:"Apply to Forecast Months"})]}),jsxRuntimeExports.jsx("div",{className:"learnership-tabs-con
tent",children:(Qt[gs].learnershipDetails||[]).length===0?jsxRuntimeExports.jsx("div",{className:"empty-state",children
:'No learnership deals yet. Click "+ Add Deal" to start.'}):Qt[gs].learnershipDetails.map((lt,pt)=>{if(qt!==pt)return 
null;const St=(lt.learners||0)*(lt.costPerLearner||0),Ot=lt.commissionPercentage||0,Vt=St*Ot/100,Kt=(lt.facilitatorCost
||0)+Vt+(lt.travelCost||0)+(lt.assessorCost||0)+(lt.moderatorCost||0)+(lt.otherCost||0)+(lt.customCost||0),It=St-Kt,rs=
lt.certaintyPercentage??100,Ut=It*(rs/100);return jsxRuntimeExports.jsxs("div",{className:"learnership-line-card",child
ren:[jsxRuntimeExports.jsxs("div",{className:"learnership-line-header",children:[jsxRuntimeExports.jsxs("h4",{children:
["Deal ",pt+1," ",lt.name?`- 
${lt.name}`:""]}),jsxRuntimeExports.jsx("button",{type:"button",className:"delete-btn-small",onClick:()=>{const At=(Qt[
gs].learnershipDetails||[]).length-1;fr(gs,pt),qt>=At&&At>0?js(At-1):At===0&&js(0)},children:"Delete"})]}),jsxRuntimeEx
ports.jsxs("div",{className:"learnership-vertical-grid",children:[jsxRuntimeExports.jsxs("div",{className:"learnership-
field",children:[jsxRuntimeExports.jsx("label",{children:"Deal Name"}),jsxRuntimeExports.jsx("input",{type:"text",value
:lt.name||"",onChange:At=>Rn(gs,pt,"name",At.target.value),className:"learnership-input-compact",placeholder:"e.g., 
ABC Company Learnership"})]}),jsxRuntimeExports.jsxs("div",{className:"learnership-field",children:[jsxRuntimeExports.j
sx("label",{children:"Deal Certainty %"}),jsxRuntimeExports.jsx("input",{type:"number",min:"0",max:"100",value:lt.certa
intyPercentage??100,onChange:At=>Rn(gs,pt,"certaintyPercentage",At.target.value),className:"learnership-input-compact",
placeholder:"100"})]}),jsxRuntimeExports.jsxs("div",{className:"learnership-field full-width",children:[jsxRuntimeExpor
ts.jsx("label",{children:"Description"}),jsxRuntimeExports.jsx("textarea",{value:lt.description||"",onChange:At=>Rn(gs,
pt,"description",At.target.value),className:"learnership-input-compact learnership-textarea",placeholder:"Add notes 
about this deal...",rows:"2"})]}),jsxRuntimeExports.jsxs("div",{className:"learnership-field",children:[jsxRuntimeExpor
ts.jsx("label",{children:"Funding Type"}),jsxRuntimeExports.jsxs("select",{value:lt.fundingType||"",onChange:At=>Rn(gs,
pt,"fundingType",At.target.value),className:"learnership-input-compact",children:[jsxRuntimeExports.jsx("option",{value
:"",children:"-- Select --"}),(Array.isArray($n.fundingTypes)?$n.fundingTypes:[]).map((At,hs)=>{const ps=typeof 
At=="string"?At:At.name,Ss=typeof At=="string"?At:At.value||At.name;return jsxRuntimeExports.jsx("option",{value:Ss,chi
ldren:ps},At.id||hs)})]})]}),jsxRuntimeExports.jsxs("div",{className:"learnership-field",children:[jsxRuntimeExports.js
x("label",{children:"Learnership Type"}),jsxRuntimeExports.jsxs("select",{value:lt.learnershipType||"",onChange:At=>Rn(
gs,pt,"learnershipType",At.target.value),className:"learnership-input-compact",children:[jsxRuntimeExports.jsx("option"
,{value:"",children:"-- Select --"}),(Array.isArray($n.learnershipTypes)?$n.learnershipTypes:[]).map((At,hs)=>{const 
ps=typeof At=="string"?At:At.name,Ss=typeof At=="string"?At:At.value||At.name;return jsxRuntimeExports.jsx("option",{va
lue:Ss,children:ps},At.id||hs)})]})]}),jsxRuntimeExports.jsxs("div",{className:"learnership-field",children:[jsxRuntime
Exports.jsx("label",{children:"No. Learners"}),jsxRuntimeExports.jsx("input",{type:"number",min:"0",value:lt.learners||
"",onChange:At=>Rn(gs,pt,"learners",At.target.value),className:"learnership-input-compact",placeholder:""})]}),jsxRunti
meExports.jsxs("div",{className:"learnership-field",children:[jsxRuntimeExports.jsx("label",{children:"Cost / Learner"}
),jsxRuntimeExports.jsx("input",{type:"text",value:Ks(lt.costPerLearner||0),onChange:At=>Rn(gs,pt,"costPerLearner",At.t
arget.value),className:"learnership-input-compact"})]}),jsxRuntimeExports.jsxs("div",{className:"learnership-field",chi
ldren:[jsxRuntimeExports.jsx("label",{children:"Total Amount"}),jsxRuntimeExports.jsx("div",{className:"learnership-val
ue",children:as(St)})]}),jsxRuntimeExports.jsxs("div",{className:"learnership-field",children:[jsxRuntimeExports.jsx("l
abel",{children:"Payment Start Date"}),jsxRuntimeExports.jsx("input",{type:"date",value:lt.paymentStartDate||"",onChang
e:At=>Rn(gs,pt,"paymentStartDate",At.target.value),className:"learnership-input-compact"})]}),jsxRuntimeExports.jsxs("d
iv",{className:"learnership-field",children:[jsxRuntimeExports.jsx("label",{children:"Frequency"}),jsxRuntimeExports.js
xs("select",{value:lt.paymentFrequency||"Monthly",onChange:At=>Rn(gs,pt,"paymentFrequency",At.target.value),className:"
learnership-input-compact",children:[jsxRuntimeExports.jsx("option",{value:"Monthly",children:"Monthly"}),jsxRuntimeExp
orts.jsx("option",{value:"Once-off",children:"Once-off"})]})]}),jsxRuntimeExports.jsxs("div",{className:"learnership-fi
eld",children:[jsxRuntimeExports.jsx("label",{children:"Months"}),jsxRuntimeExports.jsx("input",{type:"number",min:"1",
value:lt.paymentFrequency==="Once-off"?1:lt.paymentMonths||12,onChange:At=>Rn(gs,pt,"paymentMonths",At.target.value),cl
assName:"learnership-input-compact",disabled:lt.paymentFrequency==="Once-off",title:lt.paymentFrequency==="Once-off"?"M
onths is automatically set to 1 for Once-off payments":""})]}),jsxRuntimeExports.jsxs("div",{className:"learnership-cos
ts-section",children:[jsxRuntimeExports.jsx("h5",{children:"Cost of 
Sales"}),jsxRuntimeExports.jsx("p",{className:"costs-section-hint",children:"Set when each cost will be paid to 
calculate GP correctly per period"}),jsxRuntimeExports.jsxs("div",{className:"cost-item-row",children:[jsxRuntimeExport
s.jsxs("div",{className:"cost-amount-field",children:[jsxRuntimeExports.jsx("label",{children:"Facilitator Cost"}),jsxR
untimeExports.jsx("input",{type:"text",value:Ks(lt.facilitatorCost||0),onChange:At=>Rn(gs,pt,"facilitatorCost",At.targe
t.value),className:"learnership-input-compact"})]}),jsxRuntimeExports.jsxs("div",{className:"cost-frequency-field",chil
dren:[jsxRuntimeExports.jsx("label",{children:"When Paid"}),jsxRuntimeExports.jsxs("select",{value:lt.facilitatorCostFr
equency||"Monthly",onChange:At=>Rn(gs,pt,"facilitatorCostFrequency",At.target.value),className:"learnership-input-compa
ct",children:[jsxRuntimeExports.jsx("option",{value:"Monthly",children:"Monthly (spread over 
duration)"}),jsxRuntimeExports.jsx("option",{value:"Once-off",children:"Once-off (at 
start)"}),jsxRuntimeExports.jsx("option",{value:"End of Learnership",children:"End of Learnership"})]})]})]}),jsxRuntim
eExports.jsxs("div",{className:"cost-item-row",children:[jsxRuntimeExports.jsxs("div",{className:"cost-amount-field 
commission-field",children:[jsxRuntimeExports.jsxs("label",{children:["Commission % 
",Ht!=null&&Ht.skillsPartnerId&&Ht.skillsPartnerId!=="not-allocated"?"(Auto from Skills Partner)":"(No Skills Partner)"
]}),jsxRuntimeExports.jsx("input",{type:"number",min:"0",max:"100",step:"0.01",value:lt.commissionPercentage||"",readOn
ly:!0,disabled:!0,className:"learnership-input-compact commission-readonly",placeholder:"%",title:Ht!=null&&Ht.skillsPa
rtnerId&&Ht.skillsPartnerId!=="not-allocated"?"Commission rate is set by the assigned Skills Partner. Update via 
Skills Partner Commissions admin page.":"No skills partner assigned to this 
client."}),jsxRuntimeExports.jsxs("span",{className:"commission-amount",children:["= ",as(Vt)]})]}),jsxRuntimeExports.j
sxs("div",{className:"cost-frequency-field",children:[jsxRuntimeExports.jsx("label",{children:"When 
Paid"}),jsxRuntimeExports.jsxs("select",{value:lt.commissionFrequency||"With Income",onChange:At=>Rn(gs,pt,"commissionF
requency",At.target.value),className:"learnership-input-compact",children:[jsxRuntimeExports.jsx("option",{value:"With 
Income",children:"With Income (same as revenue)"}),jsxRuntimeExports.jsx("option",{value:"Once-off",children:"Once-off 
(at start)"}),jsxRuntimeExports.jsx("option",{value:"End of Learnership",children:"End of Learnership"})]})]})]}),jsxRu
ntimeExports.jsxs("div",{className:"cost-item-row",children:[jsxRuntimeExports.jsxs("div",{className:"cost-amount-field
",children:[jsxRuntimeExports.jsx("label",{children:"Travel Cost"}),jsxRuntimeExports.jsx("input",{type:"text",value:Ks
(lt.travelCost||0),onChange:At=>Rn(gs,pt,"travelCost",At.target.value),className:"learnership-input-compact"})]}),jsxRu
ntimeExports.jsxs("div",{className:"cost-frequency-field",children:[jsxRuntimeExports.jsx("label",{children:"When Paid"
}),jsxRuntimeExports.jsxs("select",{value:lt.travelCostFrequency||"Monthly",onChange:At=>Rn(gs,pt,"travelCostFrequency"
,At.target.value),className:"learnership-input-compact",children:[jsxRuntimeExports.jsx("option",{value:"Monthly",child
ren:"Monthly (spread over duration)"}),jsxRuntimeExports.jsx("option",{value:"Once-off",children:"Once-off (at 
start)"}),jsxRuntimeExports.jsx("option",{value:"End of Learnership",children:"End of Learnership"})]})]})]}),jsxRuntim
eExports.jsxs("div",{className:"cost-item-row",children:[jsxRuntimeExports.jsxs("div",{className:"cost-amount-field",ch
ildren:[jsxRuntimeExports.jsx("label",{children:"Assessor Cost"}),jsxRuntimeExports.jsx("input",{type:"text",value:Ks(l
t.assessorCost||0),onChange:At=>Rn(gs,pt,"assessorCost",At.target.value),className:"learnership-input-compact"})]}),jsx
RuntimeExports.jsxs("div",{className:"cost-frequency-field",children:[jsxRuntimeExports.jsx("label",{children:"When 
Paid"}),jsxRuntimeExports.jsxs("select",{value:lt.assessorCostFrequency||"End of Learnership",onChange:At=>Rn(gs,pt,"as
sessorCostFrequency",At.target.value),className:"learnership-input-compact",children:[jsxRuntimeExports.jsx("option",{v
alue:"Monthly",children:"Monthly (spread over 
duration)"}),jsxRuntimeExports.jsx("option",{value:"Once-off",children:"Once-off (at 
start)"}),jsxRuntimeExports.jsx("option",{value:"End of Learnership",children:"End of Learnership"})]})]})]}),jsxRuntim
eExports.jsxs("div",{className:"cost-item-row",children:[jsxRuntimeExports.jsxs("div",{className:"cost-amount-field",ch
ildren:[jsxRuntimeExports.jsx("label",{children:"Moderator Cost"}),jsxRuntimeExports.jsx("input",{type:"text",value:Ks(
lt.moderatorCost||0),onChange:At=>Rn(gs,pt,"moderatorCost",At.target.value),className:"learnership-input-compact"})]}),
jsxRuntimeExports.jsxs("div",{className:"cost-frequency-field",children:[jsxRuntimeExports.jsx("label",{children:"When 
Paid"}),jsxRuntimeExports.jsxs("select",{value:lt.moderatorCostFrequency||"End of Learnership",onChange:At=>Rn(gs,pt,"m
oderatorCostFrequency",At.target.value),className:"learnership-input-compact",children:[jsxRuntimeExports.jsx("option",
{value:"Monthly",children:"Monthly (spread over 
duration)"}),jsxRuntimeExports.jsx("option",{value:"Once-off",children:"Once-off (at 
start)"}),jsxRuntimeExports.jsx("option",{value:"End of Learnership",children:"End of Learnership"})]})]})]}),jsxRuntim
eExports.jsxs("div",{className:"cost-item-row",children:[jsxRuntimeExports.jsxs("div",{className:"cost-amount-field",ch
ildren:[jsxRuntimeExports.jsx("label",{children:"Other Cost"}),jsxRuntimeExports.jsx("input",{type:"text",value:Ks(lt.o
therCost||0),onChange:At=>Rn(gs,pt,"otherCost",At.target.value),className:"learnership-input-compact"})]}),jsxRuntimeEx
ports.jsxs("div",{className:"cost-frequency-field",children:[jsxRuntimeExports.jsx("label",{children:"When Paid"}),jsxR
untimeExports.jsxs("select",{value:lt.otherCostFrequency||"Once-off",onChange:At=>Rn(gs,pt,"otherCostFrequency",At.targ
et.value),className:"learnership-input-compact",children:[jsxRuntimeExports.jsx("option",{value:"Monthly",children:"Mon
thly (spread over duration)"}),jsxRuntimeExports.jsx("option",{value:"Once-off",children:"Once-off (at 
start)"}),jsxRuntimeExports.jsx("option",{value:"End of Learnership",children:"End of 
Learnership"})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"cost-item-row custom-cost-row",children:[jsxRuntimeExp
orts.jsxs("div",{className:"cost-label-field",children:[jsxRuntimeExports.jsx("label",{children:"Custom Label"}),jsxRun
timeExports.jsx("input",{type:"text",value:lt.customLabel||"",onChange:At=>Rn(gs,pt,"customLabel",At.target.value),clas
sName:"learnership-input-compact",placeholder:"e.g., Materials"})]}),jsxRuntimeExports.jsxs("div",{className:"cost-amou
nt-field",children:[jsxRuntimeExports.jsx("label",{children:"Amount"}),jsxRuntimeExports.jsx("input",{type:"text",value
:Ks(lt.customCost||0),onChange:At=>Rn(gs,pt,"customCost",At.target.value),className:"learnership-input-compact"})]}),js
xRuntimeExports.jsxs("div",{className:"cost-frequency-field",children:[jsxRuntimeExports.jsx("label",{children:"When Pa
id"}),jsxRuntimeExports.jsxs("select",{value:lt.customCostFrequency||"Once-off",onChange:At=>Rn(gs,pt,"customCostFreque
ncy",At.target.value),className:"learnership-input-compact",children:[jsxRuntimeExports.jsx("option",{value:"Monthly",c
hildren:"Monthly (spread over duration)"}),jsxRuntimeExports.jsx("option",{value:"Once-off",children:"Once-off (at 
start)"}),jsxRuntimeExports.jsx("option",{value:"End of Learnership",children:"End of Learnership"})]})]})]})]}),jsxRun
timeExports.jsxs("div",{className:"deal-calculation-result",children:[jsxRuntimeExports.jsx("h5",{children:"Calculation
 Result"}),jsxRuntimeExports.jsxs("div",{className:"calc-result-content",children:[jsxRuntimeExports.jsxs("div",{classN
ame:"calc-formula",children:[jsxRuntimeExports.jsx("span",{className:"formula-label",children:"Formula:"}),jsxRuntimeEx
ports.jsxs("span",{className:"formula-text",children:[lt.learners||0," learners Ã— ",as(lt.costPerLearner||0)," = 
Total Income"]})]}),jsxRuntimeExports.jsxs("div",{className:"calc-row",children:[jsxRuntimeExports.jsxs("div",{classNam
e:"calc-item income",children:[jsxRuntimeExports.jsx("label",{children:"Total Income"}),jsxRuntimeExports.jsx("div",{cl
assName:"calc-value",children:as(St)})]}),jsxRuntimeExports.jsxs("div",{className:"calc-item 
costs",children:[jsxRuntimeExports.jsx("label",{children:"Total 
Costs"}),jsxRuntimeExports.jsxs("div",{className:"calc-value 
negative",children:["-",as(Kt)]})]}),jsxRuntimeExports.jsxs("div",{className:"calc-item 
gp",children:[jsxRuntimeExports.jsx("label",{children:"Gross 
Profit"}),jsxRuntimeExports.jsx("div",{className:`calc-value ${It>=0?"positive":"negative"}`,children:as(It)})]})]}),rs
<100&&jsxRuntimeExports.jsxs("div",{className:"calc-certainty",children:[jsxRuntimeExports.jsxs("span",{className:"cert
ainty-label",children:["With ",rs,"% certainty:"]}),jsxRuntimeExports.jsx("span",{className:"certainty-value",children:
as(Ut)})]}),jsxRuntimeExports.jsxs("div",{className:"calc-breakdown",children:[jsxRuntimeExports.jsx("label",{children:
"Distribution:"}),jsxRuntimeExports.jsx("span",{className:"breakdown-text",children:lt.paymentFrequency==="Once-off"?`O
nce-off payment starting ${lt.paymentStartDate||"TBD"}`:`${as(St/(lt.paymentMonths||12))}/month over 
${lt.paymentMonths||12} months`})]}),jsxRuntimeExports.jsxs("div",{className:"calc-costs-summary",children:[jsxRuntimeE
xports.jsx("label",{children:"Costs Breakdown:"}),jsxRuntimeExports.jsxs("ul",{className:"costs-list",children:[(lt.fac
ilitatorCost||0)>0&&jsxRuntimeExports.jsxs("li",{children:["Facilitator: ",as(lt.facilitatorCost)," 
(",lt.facilitatorCostFrequency||"Monthly",")"]}),Vt>0&&jsxRuntimeExports.jsxs("li",{children:["Commission 
(",lt.commissionPercentage,"%): ",as(Vt)," (",lt.commissionFrequency||"With 
Income",")"]}),(lt.travelCost||0)>0&&jsxRuntimeExports.jsxs("li",{children:["Travel: ",as(lt.travelCost)," 
(",lt.travelCostFrequency||"Monthly",")"]}),(lt.assessorCost||0)>0&&jsxRuntimeExports.jsxs("li",{children:["Assessor: 
",as(lt.assessorCost)," (",lt.assessorCostFrequency||"End of 
Learnership",")"]}),(lt.moderatorCost||0)>0&&jsxRuntimeExports.jsxs("li",{children:["Moderator: 
",as(lt.moderatorCost)," (",lt.moderatorCostFrequency||"End of 
Learnership",")"]}),(lt.otherCost||0)>0&&jsxRuntimeExports.jsxs("li",{children:["Other: ",as(lt.otherCost)," (",lt.othe
rCostFrequency||"Once-off",")"]}),(lt.customCost||0)>0&&jsxRuntimeExports.jsxs("li",{children:[lt.customLabel||"Custom"
,": ",as(lt.customCost)," (",lt.customCostFrequency||"Once-off",")"]})]})]}),jsxRuntimeExports.jsxs("div",{className:"c
alc-gp-margin",children:[jsxRuntimeExports.jsx("label",{children:"GP 
Margin:"}),jsxRuntimeExports.jsx("span",{className:`margin-value ${St>0?It/St*100>=0?"positive":"negative":""}`,childre
n:St>0?`${(It/St*100).toFixed(1)}%`:"N/A"})]})]})]})]})]},lt.id||pt)}).filter(Boolean)})]})]})}),es&&Rs!==null&&Qt[Rs]&
&jsxRuntimeExports.jsx("div",{className:"learnership-modal-backdrop",children:jsxRuntimeExports.jsxs("div",{className:"
learnership-modal tap-business-modal",children:[jsxRuntimeExports.jsxs("div",{className:"learnership-modal-header",chil
dren:[jsxRuntimeExports.jsxs("h3",{children:["TAP Business Deals - ",Qt[Rs].productLine]}),jsxRuntimeExports.jsx("butto
n",{type:"button",className:"close-btn",onClick:()=>vs(!1),children:"Ã—"})]}),jsxRuntimeExports.jsxs("div",{className:"
learnership-modal-body",children:[jsxRuntimeExports.jsxs("div",{className:"learnership-summary",children:[jsxRuntimeExp
orts.jsx("h4",{children:"Forecast Preview"}),(()=>{var rs;const 
lt=Qt[Rs],pt=bs(lt.tapBusinessDetails||[],$,As),St=pt.breakdown,Ot=((rs=lt.history)==null?void 
0:rs.currentYearYTD)||0,Vt=As.reduce((Ut,At)=>{const hs=`${At.year}-${At.number}`,ps=pt.months[hs]||0;return 
Ut+(typeof ps=="number"?ps:parseFloat(ps||0))},0),Kt=[],It=[];return St.dealDetails.forEach(Ut=>{const 
At=Ut.name||`Deal ${Ut.dealNumber}`;Ut.incomeYTD>0&&Ut.incomeForecast===0&&Ut.incomeNextFY===0?Kt.push(`${At}: All 
income (${as(Ut.incomeYTD)}) is already in YTD period - no forecast impact.`):Ut.incomeYTD>0&&It.push(`${At}: 
${as(Ut.incomeYTD)} income already in YTD.`),Ut.incomeNextFY>0&&Kt.push(`${At}: ${as(Ut.incomeNextFY)} income will be 
in the following financial year.`),Ut.costsNextFY>0&&It.push(`${At}: ${as(Ut.costsNextFY)} in costs will be paid in 
the next financial year.`)}),jsxRuntimeExports.jsxs("div",{className:"summary-content",children:[Kt.length>0&&jsxRuntim
eExports.jsx("div",{className:"summary-warnings",children:Kt.map((Ut,At)=>jsxRuntimeExports.jsxs("div",{className:"warn
ing-message",children:["âšï¸ ",Ut]},At))}),It.length>0&&jsxRuntimeExports.jsx("div",{className:"summary-info-messages"
,children:It.map((Ut,At)=>jsxRuntimeExports.jsxs("div",{className:"info-message",children:["â„¹ï¸ ",Ut]},At))}),jsxRun
timeExports.jsxs("div",{className:"summary-row",children:[jsxRuntimeExports.jsxs("div",{className:"summary-item",childr
en:[jsxRuntimeExports.jsx("label",{children:"Total GP (All Deals)"}),jsxRuntimeExports.jsx("div",{className:"summary-va
lue",children:as(St.totalGP)})]}),jsxRuntimeExports.jsxs("div",{className:"summary-item",children:[jsxRuntimeExports.js
x("label",{children:"YTD Actual"}),jsxRuntimeExports.jsx("div",{className:"summary-value ytd-value",children:as(Ot)})]}
),jsxRuntimeExports.jsxs("div",{className:"summary-item",children:[jsxRuntimeExports.jsx("label",{children:"Forecast 
Total"}),jsxRuntimeExports.jsx("div",{className:"summary-value 
forecast-value",children:as(Vt)})]}),jsxRuntimeExports.jsxs("div",{className:"summary-item 
highlight",children:[jsxRuntimeExports.jsx("label",{children:"Full Year 
Forecast"}),jsxRuntimeExports.jsx("div",{className:"summary-value full-year-value",children:as(Ot+Vt)})]})]}),jsxRuntim
eExports.jsxs("div",{className:"breakdown-section",children:[jsxRuntimeExports.jsx("h5",{children:"Deal Breakdown by Pe
riod"}),jsxRuntimeExports.jsxs("table",{className:"breakdown-table",children:[jsxRuntimeExports.jsx("thead",{children:j
sxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("th",{}),jsxRuntimeExports.jsx("th",{children:"Total 
Deal"}),jsxRuntimeExports.jsx("th",{children:"In YTD"}),jsxRuntimeExports.jsx("th",{children:"In 
Forecast"}),jsxRuntimeExports.jsx("th",{children:"Next FY"})]})}),jsxRuntimeExports.jsxs("tbody",{children:[jsxRuntimeE
xports.jsxs("tr",{className:"income-row",children:[jsxRuntimeExports.jsx("td",{children:jsxRuntimeExports.jsx("strong",
{children:"Income"})}),jsxRuntimeExports.jsx("td",{children:as(St.totalIncome)}),jsxRuntimeExports.jsx("td",{children:a
s(St.incomeYTD)}),jsxRuntimeExports.jsx("td",{children:as(St.incomeForecast)}),jsxRuntimeExports.jsx("td",{children:as(
St.incomeNextFY)})]}),jsxRuntimeExports.jsxs("tr",{className:"costs-row",children:[jsxRuntimeExports.jsx("td",{children
:jsxRuntimeExports.jsx("strong",{children:"Costs"})}),jsxRuntimeExports.jsx("td",{children:as(St.totalCosts)}),jsxRunti
meExports.jsx("td",{children:as(St.costsYTD)}),jsxRuntimeExports.jsx("td",{children:as(St.costsForecast)}),jsxRuntimeEx
ports.jsx("td",{children:as(St.costsNextFY)})]}),jsxRuntimeExports.jsxs("tr",{className:"gp-row",children:[jsxRuntimeEx
ports.jsx("td",{children:jsxRuntimeExports.jsx("strong",{children:"Gross Profit"})}),jsxRuntimeExports.jsx("td",{childr
en:jsxRuntimeExports.jsx("strong",{children:as(St.totalGP)})}),jsxRuntimeExports.jsx("td",{children:jsxRuntimeExports.j
sx("strong",{children:as(St.gpYTD)})}),jsxRuntimeExports.jsx("td",{children:jsxRuntimeExports.jsx("strong",{children:as
(St.gpForecast)})}),jsxRuntimeExports.jsx("td",{children:jsxRuntimeExports.jsx("strong",{children:as(St.gpNextFY)})})]}
)]})]}),jsxRuntimeExports.jsxs("div",{className:"breakdown-explanation",children:[jsxRuntimeExports.jsx("p",{children:j
sxRuntimeExports.jsx("strong",{children:"Understanding this breakdown:"})}),jsxRuntimeExports.jsxs("ul",{children:[jsxR
untimeExports.jsxs("li",{children:[jsxRuntimeExports.jsx("strong",{children:"YTD:"})," Already included in the 
accountant's uploaded year-to-date 
figures"]}),jsxRuntimeExports.jsxs("li",{children:[jsxRuntimeExports.jsx("strong",{children:"Forecast:"})," Will be 
added to your forecast 
months"]}),jsxRuntimeExports.jsxs("li",{children:[jsxRuntimeExports.jsx("strong",{children:"Next FY:"})," Will be in 
the following financial year - not included in current forecast"]})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"s
ummary-months",children:[jsxRuntimeExports.jsx("label",{children:"Monthly 
Breakdown:"}),jsxRuntimeExports.jsx("div",{className:"months-grid",children:As.map(Ut=>{const 
At=`${Ut.year}-${Ut.number}`,hs=pt.months[At]||0;return jsxRuntimeExports.jsxs("div",{className:"month-preview",childre
n:[jsxRuntimeExports.jsx("div",{className:"month-name",children:Ut.name}),jsxRuntimeExports.jsx("div",{className:"month
-amount",children:as(hs)})]},At)})})]})]})})()]}),jsxRuntimeExports.jsxs("div",{className:"learnership-tabs-header",chi
ldren:[jsxRuntimeExports.jsxs("div",{className:"learnership-tabs",children:[(Qt[Rs].tapBusinessDetails||[]).map((lt,pt)
=>jsxRuntimeExports.jsxs("button",{type:"button",className:`learnership-tab 
${Hs===pt?"active":""}`,onClick:()=>En(pt),children:["Deal ",pt+1," ",lt.name?`- ${lt.name}`:""," ",lt.certaintyPercent
age<100?`(${lt.certaintyPercentage}%)`:""]},lt.id||pt)),jsxRuntimeExports.jsx("button",{type:"button",className:"learne
rship-tab add-tab",onClick:()=>{cr(Rs),En((Qt[Rs].tapBusinessDetails||[]).length)},children:"+ Add 
Deal"})]}),jsxRuntimeExports.jsx("button",{type:"button",className:"apply-forecast-btn",onClick:()=>{const 
lt=Qt[Rs];if(lt.productLine&&lt.productLine.toLowerCase().includes("tap")){const 
pt=bs(lt.tapBusinessDetails||[],$,As);Ft(St=>{var It;const Ot=[...St],Vt={...Ot[Rs]};Vt.months=pt.months;const 
Kt=((It=Vt.history)==null?void 0:It.currentYearYTD)||0;return 
Vt.fullYearForecast=Kt+pt.forecastTotal,Ot[Rs]=Vt,Ot}),alert("Monthly forecast updated based on TAP Business 
calculations!")}},children:"Apply to Forecast Months"})]}),jsxRuntimeExports.jsx("div",{className:"learnership-tabs-con
tent",children:(Qt[Rs].tapBusinessDetails||[]).length===0?jsxRuntimeExports.jsx("div",{className:"empty-state",children
:'No TAP Business deals yet. Click "+ Add Deal" to start.'}):Qt[Rs].tapBusinessDetails.map((lt,pt)=>{if(Hs!==pt)return 
null;const 
St=lt.numberOfEmployees||0,Ot=lt.costPerEmployeePerMonth||0,Vt=lt.paymentType||"Monthly",Kt=lt.contractMonths||12;let 
It;Vt==="Annual"?It=St*Ot*12:It=St*Ot*Kt;const 
rs=lt.commissionPercentage||0,Ut=It*rs/100,At=lt.customCost||0,hs=Ut+At,ps=It-hs;return lt.certaintyPercentage,jsxRunti
meExports.jsxs("div",{className:"learnership-line-card",children:[jsxRuntimeExports.jsxs("div",{className:"learnership-
line-header",children:[jsxRuntimeExports.jsxs("h4",{children:["Deal ",pt+1," ",lt.name?`- 
${lt.name}`:""]}),jsxRuntimeExports.jsx("button",{type:"button",className:"delete-btn-small",onClick:()=>{const Ss=(Qt[
Rs].tapBusinessDetails||[]).length-1;Dr(Rs,pt),Hs>=Ss&&Ss>0?En(Ss-1):Ss===0&&En(0)},children:"Delete"})]}),jsxRuntimeEx
ports.jsxs("div",{className:"learnership-vertical-grid",children:[jsxRuntimeExports.jsxs("div",{className:"learnership-
field",children:[jsxRuntimeExports.jsx("label",{children:"Deal Name"}),jsxRuntimeExports.jsx("input",{type:"text",value
:lt.name||"",onChange:Ss=>Gn(Rs,pt,"name",Ss.target.value),className:"learnership-input-compact",placeholder:"e.g., 
Company ABC TAP"})]}),jsxRuntimeExports.jsxs("div",{className:"learnership-field",children:[jsxRuntimeExports.jsx("labe
l",{children:"Deal Certainty %"}),jsxRuntimeExports.jsx("input",{type:"number",min:"0",max:"100",value:lt.certaintyPerc
entage??100,onChange:Ss=>Gn(Rs,pt,"certaintyPercentage",Ss.target.value),className:"learnership-input-compact",placehol
der:"100"})]}),jsxRuntimeExports.jsxs("div",{className:"learnership-field full-width",children:[jsxRuntimeExports.jsx("
label",{children:"Description"}),jsxRuntimeExports.jsx("textarea",{value:lt.description||"",onChange:Ss=>Gn(Rs,pt,"desc
ription",Ss.target.value),className:"learnership-input-compact learnership-textarea",placeholder:"Add notes about this 
deal...",rows:"2"})]}),jsxRuntimeExports.jsxs("div",{className:"learnership-field",children:[jsxRuntimeExports.jsx("lab
el",{children:"Number of Employees"}),jsxRuntimeExports.jsx("input",{type:"number",min:"0",value:lt.numberOfEmployees||
"",onChange:Ss=>Gn(Rs,pt,"numberOfEmployees",Ss.target.value),className:"learnership-input-compact",placeholder:"0"})]}
),jsxRuntimeExports.jsxs("div",{className:"learnership-field",children:[jsxRuntimeExports.jsx("label",{children:"Cost 
per Employee / Month"}),jsxRuntimeExports.jsx("input",{type:"text",value:Ks(lt.costPerEmployeePerMonth||0),onChange:Ss=
>Gn(Rs,pt,"costPerEmployeePerMonth",qs(Ss.target.value)),className:"learnership-input-compact"})]}),jsxRuntimeExports.j
sxs("div",{className:"learnership-field",children:[jsxRuntimeExports.jsx("label",{children:"Payment Type"}),jsxRuntimeE
xports.jsxs("select",{value:lt.paymentType||"Monthly",onChange:Ss=>Gn(Rs,pt,"paymentType",Ss.target.value),className:"l
earnership-input-compact",children:[jsxRuntimeExports.jsx("option",{value:"Monthly",children:"Monthly 
Fee"}),jsxRuntimeExports.jsx("option",{value:"Annual",children:"Annual Fee"})]})]}),jsxRuntimeExports.jsxs("div",{class
Name:"learnership-field",children:[jsxRuntimeExports.jsx("label",{children:"Payment Start Date"}),jsxRuntimeExports.jsx
("input",{type:"date",value:lt.paymentStartDate||"",onChange:Ss=>Gn(Rs,pt,"paymentStartDate",Ss.target.value),className
:"learnership-input-compact"})]}),jsxRuntimeExports.jsxs("div",{className:"learnership-field",children:[jsxRuntimeExpor
ts.jsx("label",{children:"Contract Duration (Months)"}),jsxRuntimeExports.jsx("input",{type:"number",min:"1",value:lt.p
aymentType==="Annual"?1:lt.contractMonths||12,onChange:Ss=>Gn(Rs,pt,"contractMonths",Ss.target.value),className:"learne
rship-input-compact",disabled:lt.paymentType==="Annual",title:lt.paymentType==="Annual"?"Duration is automatically set 
to 1 for Annual payments":""})]}),jsxRuntimeExports.jsxs("div",{className:"learnership-field",children:[jsxRuntimeExpor
ts.jsx("label",{children:"Total Income"}),jsxRuntimeExports.jsx("div",{className:"learnership-value",children:as(It)})]
}),jsxRuntimeExports.jsxs("div",{className:"learnership-costs-section",children:[jsxRuntimeExports.jsx("h5",{children:"
Cost of Sales"}),jsxRuntimeExports.jsx("p",{className:"costs-section-hint",children:"Set when each cost will be paid 
to calculate GP correctly per period"}),jsxRuntimeExports.jsxs("div",{className:"cost-item-row",children:[jsxRuntimeExp
orts.jsxs("div",{className:"cost-amount-field 
commission-field",children:[jsxRuntimeExports.jsx("label",{children:"Commission %"}),jsxRuntimeExports.jsx("input",{typ
e:"number",min:"0",max:"100",step:"0.01",value:lt.commissionPercentage||"",onChange:Ss=>{const on=parseFloat(Ss.target.
value)||0;Gn(Rs,pt,"commissionPercentage",on)},className:"learnership-input-compact",placeholder:"%"}),jsxRuntimeExport
s.jsxs("span",{className:"commission-amount",children:["= ",as(Ut)]})]}),jsxRuntimeExports.jsxs("div",{className:"cost-
frequency-field",children:[jsxRuntimeExports.jsx("label",{children:"When 
Paid"}),jsxRuntimeExports.jsxs("select",{value:lt.commissionFrequency||"With Income",onChange:Ss=>Gn(Rs,pt,"commissionF
requency",Ss.target.value),className:"learnership-input-compact",children:[jsxRuntimeExports.jsx("option",{value:"With 
Income",children:"With Income (same as revenue)"}),jsxRuntimeExports.jsx("option",{value:"Once-off",children:"Once-off 
(at start)"})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"cost-item-row custom-cost-row",children:[jsxRuntimeExpo
rts.jsxs("div",{className:"cost-label-field",children:[jsxRuntimeExports.jsx("label",{children:"Custom Cost Label"}),js
xRuntimeExports.jsx("input",{type:"text",value:lt.customCostLabel||"",onChange:Ss=>Gn(Rs,pt,"customCostLabel",Ss.target
.value),className:"learnership-input-compact",placeholder:"e.g., Setup Fee"})]}),jsxRuntimeExports.jsxs("div",{classNam
e:"cost-amount-field",children:[jsxRuntimeExports.jsx("label",{children:"Amount"}),jsxRuntimeExports.jsx("input",{type:
"text",value:Ks(lt.customCost||0),onChange:Ss=>Gn(Rs,pt,"customCost",qs(Ss.target.value)),className:"learnership-input-
compact"})]}),jsxRuntimeExports.jsxs("div",{className:"cost-frequency-field",children:[jsxRuntimeExports.jsx("label",{c
hildren:"When Paid"}),jsxRuntimeExports.jsxs("select",{value:lt.customCostFrequency||"Once-off",onChange:Ss=>Gn(Rs,pt,"
customCostFrequency",Ss.target.value),className:"learnership-input-compact",children:[jsxRuntimeExports.jsx("option",{v
alue:"Once-off",children:"Once-off (at start)"}),jsxRuntimeExports.jsx("option",{value:"With Income",children:"With 
Income (same as revenue)"})]})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"learnership-field 
gp-field",children:[jsxRuntimeExports.jsx("label",{children:"Gross Profit 
(GP)"}),jsxRuntimeExports.jsx("div",{className:"learnership-value gp-value",children:as(ps)})]})]})]},lt.id||pt)}).filt
er(Boolean)})]})]})}),Hn&&Ts!==null&&Qt[Ts]&&jsxRuntimeExports.jsx("div",{className:"learnership-modal-backdrop",childr
en:jsxRuntimeExports.jsxs("div",{className:"learnership-modal compliance-modal",children:[jsxRuntimeExports.jsxs("div",
{className:"learnership-modal-header",children:[jsxRuntimeExports.jsxs("h3",{children:["Compliance Training Deals - ",Q
t[Ts].productLine]}),jsxRuntimeExports.jsx("button",{type:"button",className:"close-btn",onClick:()=>Ps(!1),children:"Ã
—"})]}),jsxRuntimeExports.jsxs("div",{className:"learnership-modal-body",children:[jsxRuntimeExports.jsxs("div",{classN
ame:"learnership-summary",children:[jsxRuntimeExports.jsx("h4",{children:"Forecast Preview"}),(()=>{var rs;const 
lt=Qt[Ts],pt=Ys(lt.complianceDetails||[],$,As),St=pt.breakdown,Ot=((rs=lt.history)==null?void 
0:rs.currentYearYTD)||0,Vt=As.reduce((Ut,At)=>{const hs=`${At.year}-${At.number}`,ps=pt.months[hs]||0;return 
Ut+(typeof ps=="number"?ps:parseFloat(ps||0))},0),Kt=[],It=[];return St.dealDetails.forEach(Ut=>{const 
At=Ut.courseName||Ut.name||`Deal 
${Ut.dealNumber}`;Ut.incomeYTD>0&&Ut.incomeForecast===0&&Ut.incomeNextFY===0&&Kt.push(`${At}: All income 
(${as(Ut.incomeYTD)}) is already in YTD period.`),Ut.incomeNextFY>0&&Kt.push(`${At}: Training scheduled for next 
financial year.`),Ut.totalIncome===0&&Ut.totalCosts>0&&It.push(`${At}: No income but ${as(Ut.totalCosts)} in costs 
(internal training).`)}),jsxRuntimeExports.jsxs("div",{className:"summary-content",children:[Kt.length>0&&jsxRuntimeExp
orts.jsx("div",{className:"summary-warnings",children:Kt.map((Ut,At)=>jsxRuntimeExports.jsxs("div",{className:"warning-
message",children:["âšï¸ ",Ut]},At))}),It.length>0&&jsxRuntimeExports.jsx("div",{className:"summary-info-messages",chi
ldren:It.map((Ut,At)=>jsxRuntimeExports.jsxs("div",{className:"info-message",children:["â„¹ï¸ ",Ut]},At))}),jsxRuntime
Exports.jsxs("div",{className:"summary-row",children:[jsxRuntimeExports.jsxs("div",{className:"summary-item",children:[
jsxRuntimeExports.jsx("label",{children:"Total GP (All Deals)"}),jsxRuntimeExports.jsx("div",{className:"summary-value"
,children:as(St.totalGP)})]}),jsxRuntimeExports.jsxs("div",{className:"summary-item",children:[jsxRuntimeExports.jsx("l
abel",{children:"YTD Actual"}),jsxRuntimeExports.jsx("div",{className:"summary-value ytd-value",children:as(Ot)})]}),js
xRuntimeExports.jsxs("div",{className:"summary-item",children:[jsxRuntimeExports.jsx("label",{children:"Forecast 
Total"}),jsxRuntimeExports.jsx("div",{className:"summary-value 
forecast-value",children:as(Vt)})]}),jsxRuntimeExports.jsxs("div",{className:"summary-item 
highlight",children:[jsxRuntimeExports.jsx("label",{children:"Full Year 
Forecast"}),jsxRuntimeExports.jsx("div",{className:"summary-value full-year-value",children:as(Ot+Vt)})]})]}),jsxRuntim
eExports.jsxs("div",{className:"breakdown-section",children:[jsxRuntimeExports.jsx("h5",{children:"Deal Breakdown by Pe
riod"}),jsxRuntimeExports.jsxs("table",{className:"breakdown-table",children:[jsxRuntimeExports.jsx("thead",{children:j
sxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("th",{}),jsxRuntimeExports.jsx("th",{children:"Total 
Deal"}),jsxRuntimeExports.jsx("th",{children:"In YTD"}),jsxRuntimeExports.jsx("th",{children:"In 
Forecast"}),jsxRuntimeExports.jsx("th",{children:"Next FY"})]})}),jsxRuntimeExports.jsxs("tbody",{children:[jsxRuntimeE
xports.jsxs("tr",{className:"income-row",children:[jsxRuntimeExports.jsx("td",{children:jsxRuntimeExports.jsx("strong",
{children:"Income"})}),jsxRuntimeExports.jsx("td",{children:as(St.totalIncome)}),jsxRuntimeExports.jsx("td",{children:a
s(St.incomeYTD)}),jsxRuntimeExports.jsx("td",{children:as(St.incomeForecast)}),jsxRuntimeExports.jsx("td",{children:as(
St.incomeNextFY)})]}),jsxRuntimeExports.jsxs("tr",{className:"costs-row",children:[jsxRuntimeExports.jsx("td",{children
:jsxRuntimeExports.jsx("strong",{children:"Costs"})}),jsxRuntimeExports.jsx("td",{children:as(St.totalCosts)}),jsxRunti
meExports.jsx("td",{children:as(St.costsYTD)}),jsxRuntimeExports.jsx("td",{children:as(St.costsForecast)}),jsxRuntimeEx
ports.jsx("td",{children:as(St.costsNextFY)})]}),jsxRuntimeExports.jsxs("tr",{className:"gp-row",children:[jsxRuntimeEx
ports.jsx("td",{children:jsxRuntimeExports.jsx("strong",{children:"Gross Profit"})}),jsxRuntimeExports.jsx("td",{childr
en:jsxRuntimeExports.jsx("strong",{children:as(St.totalGP)})}),jsxRuntimeExports.jsx("td",{children:jsxRuntimeExports.j
sx("strong",{children:as(St.gpYTD)})}),jsxRuntimeExports.jsx("td",{children:jsxRuntimeExports.jsx("strong",{children:as
(St.gpForecast)})}),jsxRuntimeExports.jsx("td",{children:jsxRuntimeExports.jsx("strong",{children:as(St.gpNextFY)})})]}
)]})]})]}),jsxRuntimeExports.jsxs("div",{className:"summary-months",children:[jsxRuntimeExports.jsx("label",{children:"
Monthly Breakdown:"}),jsxRuntimeExports.jsx("div",{className:"months-grid",children:As.map(Ut=>{const 
At=`${Ut.year}-${Ut.number}`,hs=pt.months[At]||0;return jsxRuntimeExports.jsxs("div",{className:"month-preview",childre
n:[jsxRuntimeExports.jsx("div",{className:"month-name",children:Ut.name}),jsxRuntimeExports.jsx("div",{className:"month
-amount",children:as(hs)})]},At)})})]})]})})()]}),jsxRuntimeExports.jsxs("div",{className:"learnership-tabs-header",chi
ldren:[jsxRuntimeExports.jsxs("div",{className:"learnership-tabs",children:[(Qt[Ts].complianceDetails||[]).map((lt,pt)=
>jsxRuntimeExports.jsxs("button",{type:"button",className:`learnership-tab 
${Ln===pt?"active":""}`,onClick:()=>hn(pt),children:["Deal ",pt+1," ",lt.courseName?`- ${lt.courseName==="Other"?lt.cus
tomCourseName:lt.courseName}`:""]},lt.id||pt)),jsxRuntimeExports.jsx("button",{type:"button",className:"learnership-tab
 add-tab",onClick:()=>{Us(Ts),hn((Qt[Ts].complianceDetails||[]).length)},children:"+ Add 
Deal"})]}),jsxRuntimeExports.jsx("button",{type:"button",className:"apply-forecast-btn",onClick:()=>{const 
lt=Qt[Ts],pt=Ys(lt.complianceDetails||[],$,As);Ft(St=>{var It;const 
Ot=[...St],Vt={...Ot[Ts]};Vt.months=pt.months;const Kt=((It=Vt.history)==null?void 0:It.currentYearYTD)||0;return 
Vt.fullYearForecast=Kt+pt.forecastTotal,Ot[Ts]=Vt,Ot}),alert("Monthly forecast updated based on Compliance Training 
calculations!")},children:"Apply to Forecast Months"})]}),jsxRuntimeExports.jsx("div",{className:"learnership-tabs-cont
ent",children:(Qt[Ts].complianceDetails||[]).length===0?jsxRuntimeExports.jsx("div",{className:"empty-state",children:'
No compliance training deals yet. Click "+ Add Deal" to 
start.'}):Qt[Ts].complianceDetails.map((lt,pt)=>{if(Ln!==pt)return null;const St=lt.numberOfTrainees||0,Ot=lt.pricePerP
erson||0,Vt=St*Ot,Kt=lt.commissionPercentage||0,It=Vt*Kt/100,rs=It+(lt.travelCost||0)+(lt.manualsCost||0)+(lt.accommoda
tionCost||0)+(lt.accreditationCost||0)+(lt.customCost||0),Ut=Vt-rs;return jsxRuntimeExports.jsxs("div",{className:"lear
nership-line-card",children:[jsxRuntimeExports.jsxs("div",{className:"learnership-line-header",children:[jsxRuntimeExpo
rts.jsxs("h4",{children:["Deal ",pt+1," ",lt.courseName?`- ${lt.courseName==="Other"?lt.customCourseName:lt.courseName}
`:""]}),jsxRuntimeExports.jsx("button",{type:"button",className:"delete-btn-small",onClick:()=>{const At=(Qt[Ts].compli
anceDetails||[]).length-1;Ms(Ts,pt),Ln>=At&&At>0?hn(At-1):At===0&&hn(0)},children:"Delete"})]}),jsxRuntimeExports.jsxs(
"div",{className:"learnership-vertical-grid",children:[jsxRuntimeExports.jsxs("div",{className:"learnership-field",chil
dren:[jsxRuntimeExports.jsx("label",{children:"Course"}),jsxRuntimeExports.jsxs("select",{value:lt.courseName||"",onCha
nge:At=>rn(Ts,pt,"courseName",At.target.value),className:"learnership-input-compact",children:[jsxRuntimeExports.jsx("o
ption",{value:"",children:"-- Select Course --"}),zs.map(At=>jsxRuntimeExports.jsx("option",{value:At,children:At},At))
]})]}),lt.courseName==="Other"&&jsxRuntimeExports.jsxs("div",{className:"learnership-field",children:[jsxRuntimeExports
.jsx("label",{children:"Custom Course Name"}),jsxRuntimeExports.jsx("input",{type:"text",value:lt.customCourseName||"",
onChange:At=>rn(Ts,pt,"customCourseName",At.target.value),className:"learnership-input-compact",placeholder:"Enter 
course name"})]}),jsxRuntimeExports.jsxs("div",{className:"learnership-field",children:[jsxRuntimeExports.jsx("label",{
children:"Deal Certainty %"}),jsxRuntimeExports.jsx("input",{type:"number",min:"0",max:"100",value:lt.certaintyPercenta
ge??100,onChange:At=>rn(Ts,pt,"certaintyPercentage",At.target.value),className:"learnership-input-compact"})]}),jsxRunt
imeExports.jsxs("div",{className:"learnership-field full-width",children:[jsxRuntimeExports.jsx("label",{children:"Desc
ription"}),jsxRuntimeExports.jsx("textarea",{value:lt.description||"",onChange:At=>rn(Ts,pt,"description",At.target.val
ue),className:"learnership-input-compact learnership-textarea",placeholder:"Add notes about this deal...",rows:"2"})]})
,jsxRuntimeExports.jsxs("div",{className:"learnership-field",children:[jsxRuntimeExports.jsx("label",{children:"Trainin
g Date"}),jsxRuntimeExports.jsx("input",{type:"date",value:lt.trainingDate||"",onChange:At=>rn(Ts,pt,"trainingDate",At.
target.value),className:"learnership-input-compact"})]}),jsxRuntimeExports.jsxs("div",{className:"learnership-field",ch
ildren:[jsxRuntimeExports.jsx("label",{children:"Number of Trainees"}),jsxRuntimeExports.jsx("input",{type:"number",min
:"0",value:lt.numberOfTrainees||"",onChange:At=>rn(Ts,pt,"numberOfTrainees",At.target.value),className:"learnership-inp
ut-compact"})]}),jsxRuntimeExports.jsxs("div",{className:"learnership-field",children:[jsxRuntimeExports.jsx("label",{c
hildren:"Price per Person"}),jsxRuntimeExports.jsx("input",{type:"text",value:Ks(lt.pricePerPerson||0),onChange:At=>rn(
Ts,pt,"pricePerPerson",qs(At.target.value)),className:"learnership-input-compact"})]}),jsxRuntimeExports.jsxs("div",{cl
assName:"learnership-field",children:[jsxRuntimeExports.jsx("label",{children:"Total Income"}),jsxRuntimeExports.jsx("d
iv",{className:"learnership-value",children:as(Vt)})]}),jsxRuntimeExports.jsxs("div",{className:"learnership-costs-sect
ion",children:[jsxRuntimeExports.jsx("h5",{children:"Cost of 
Sales"}),jsxRuntimeExports.jsx("p",{className:"costs-section-hint",children:"Price can be zero for internal training - 
only costs will apply"}),jsxRuntimeExports.jsxs("div",{className:"cost-item-row",children:[jsxRuntimeExports.jsxs("div"
,{className:"cost-amount-field commission-field",children:[jsxRuntimeExports.jsx("label",{children:"Commission %"}),jsx
RuntimeExports.jsx("input",{type:"number",min:"0",max:"100",step:"0.01",value:lt.commissionPercentage||"",onChange:At=>
rn(Ts,pt,"commissionPercentage",At.target.value),className:"learnership-input-compact",placeholder:"%"}),jsxRuntimeExpo
rts.jsxs("span",{className:"commission-amount",children:["= ",as(It)]})]}),jsxRuntimeExports.jsxs("div",{className:"cos
t-frequency-field",children:[jsxRuntimeExports.jsx("label",{children:"When 
Paid"}),jsxRuntimeExports.jsxs("select",{value:lt.commissionFrequency||"With Income",onChange:At=>rn(Ts,pt,"commissionF
requency",At.target.value),className:"learnership-input-compact",children:[jsxRuntimeExports.jsx("option",{value:"With 
Income",children:"With Income"}),jsxRuntimeExports.jsx("option",{value:"Once-off",children:"Once-off"})]})]})]}),jsxRun
timeExports.jsxs("div",{className:"cost-item-row",children:[jsxRuntimeExports.jsxs("div",{className:"cost-amount-field"
,children:[jsxRuntimeExports.jsx("label",{children:"Travel Cost"}),jsxRuntimeExports.jsx("input",{type:"text",value:Ks(
lt.travelCost||0),onChange:At=>rn(Ts,pt,"travelCost",qs(At.target.value)),className:"learnership-input-compact"})]}),js
xRuntimeExports.jsxs("div",{className:"cost-frequency-field",children:[jsxRuntimeExports.jsx("label",{children:"When Pa
id"}),jsxRuntimeExports.jsx("select",{value:lt.travelCostFrequency||"Once-off",onChange:At=>rn(Ts,pt,"travelCostFrequen
cy",At.target.value),className:"learnership-input-compact",children:jsxRuntimeExports.jsx("option",{value:"Once-off",ch
ildren:"Once-off"})})]})]}),jsxRuntimeExports.jsxs("div",{className:"cost-item-row",children:[jsxRuntimeExports.jsxs("d
iv",{className:"cost-amount-field",children:[jsxRuntimeExports.jsx("label",{children:"Manuals Cost"}),jsxRuntimeExports
.jsx("input",{type:"text",value:Ks(lt.manualsCost||0),onChange:At=>rn(Ts,pt,"manualsCost",qs(At.target.value)),classNam
e:"learnership-input-compact"})]}),jsxRuntimeExports.jsxs("div",{className:"cost-frequency-field",children:[jsxRuntimeE
xports.jsx("label",{children:"When Paid"}),jsxRuntimeExports.jsx("select",{value:lt.manualsCostFrequency||"Once-off",on
Change:At=>rn(Ts,pt,"manualsCostFrequency",At.target.value),className:"learnership-input-compact",children:jsxRuntimeEx
ports.jsx("option",{value:"Once-off",children:"Once-off"})})]})]}),jsxRuntimeExports.jsxs("div",{className:"cost-item-r
ow",children:[jsxRuntimeExports.jsxs("div",{className:"cost-amount-field",children:[jsxRuntimeExports.jsx("label",{chil
dren:"Accommodation Cost"}),jsxRuntimeExports.jsx("input",{type:"text",value:Ks(lt.accommodationCost||0),onChange:At=>r
n(Ts,pt,"accommodationCost",qs(At.target.value)),className:"learnership-input-compact"})]}),jsxRuntimeExports.jsxs("div
",{className:"cost-frequency-field",children:[jsxRuntimeExports.jsx("label",{children:"When Paid"}),jsxRuntimeExports.j
sx("select",{value:lt.accommodationCostFrequency||"Once-off",onChange:At=>rn(Ts,pt,"accommodationCostFrequency",At.targ
et.value),className:"learnership-input-compact",children:jsxRuntimeExports.jsx("option",{value:"Once-off",children:"Onc
e-off"})})]})]}),jsxRuntimeExports.jsxs("div",{className:"cost-item-row",children:[jsxRuntimeExports.jsxs("div",{classN
ame:"cost-amount-field",children:[jsxRuntimeExports.jsx("label",{children:"Accreditation Cost"}),jsxRuntimeExports.jsx(
"input",{type:"text",value:Ks(lt.accreditationCost||0),onChange:At=>rn(Ts,pt,"accreditationCost",qs(At.target.value)),c
lassName:"learnership-input-compact"})]}),jsxRuntimeExports.jsxs("div",{className:"cost-frequency-field",children:[jsxR
untimeExports.jsx("label",{children:"When Paid"}),jsxRuntimeExports.jsx("select",{value:lt.accreditationCostFrequency||
"Once-off",onChange:At=>rn(Ts,pt,"accreditationCostFrequency",At.target.value),className:"learnership-input-compact",ch
ildren:jsxRuntimeExports.jsx("option",{value:"Once-off",children:"Once-off"})})]})]}),jsxRuntimeExports.jsxs("div",{cla
ssName:"cost-item-row custom-cost-row",children:[jsxRuntimeExports.jsxs("div",{className:"cost-label-field",children:[j
sxRuntimeExports.jsx("label",{children:"Custom Cost Label"}),jsxRuntimeExports.jsx("input",{type:"text",value:lt.custom
CostLabel||"",onChange:At=>rn(Ts,pt,"customCostLabel",At.target.value),className:"learnership-input-compact",placeholde
r:"e.g., Catering"})]}),jsxRuntimeExports.jsxs("div",{className:"cost-amount-field",children:[jsxRuntimeExports.jsx("la
bel",{children:"Amount"}),jsxRuntimeExports.jsx("input",{type:"text",value:Ks(lt.customCost||0),onChange:At=>rn(Ts,pt,"
customCost",qs(At.target.value)),className:"learnership-input-compact"})]}),jsxRuntimeExports.jsxs("div",{className:"co
st-frequency-field",children:[jsxRuntimeExports.jsx("label",{children:"When Paid"}),jsxRuntimeExports.jsx("select",{val
ue:lt.customCostFrequency||"Once-off",onChange:At=>rn(Ts,pt,"customCostFrequency",At.target.value),className:"learnersh
ip-input-compact",children:jsxRuntimeExports.jsx("option",{value:"Once-off",children:"Once-off"})})]})]})]}),jsxRuntime
Exports.jsxs("div",{className:"learnership-field gp-field",children:[jsxRuntimeExports.jsx("label",{children:"Gross 
Profit (GP)"}),jsxRuntimeExports.jsx("div",{className:"learnership-value gp-value",children:as(Ut)})]})]})]},lt.id||pt)
}).filter(Boolean)})]})]})}),Jn&&Ls!==null&&Qt[Ls]&&jsxRuntimeExports.jsx("div",{className:"learnership-modal-backdrop"
,children:jsxRuntimeExports.jsxs("div",{className:"learnership-modal other-courses-modal",children:[jsxRuntimeExports.j
sxs("div",{className:"learnership-modal-header",children:[jsxRuntimeExports.jsxs("h3",{children:["Other Courses Deals 
- ",Qt[Ls].productLine]}),jsxRuntimeExports.jsx("button",{type:"button",className:"close-btn",onClick:()=>nr(!1),childr
en:"Ã—"})]}),jsxRuntimeExports.jsxs("div",{className:"learnership-modal-body",children:[jsxRuntimeExports.jsxs("div",{c
lassName:"learnership-summary",children:[jsxRuntimeExports.jsx("h4",{children:"Forecast Preview"}),(()=>{var rs;const 
lt=Qt[Ls],pt=Ys(lt.otherCoursesDetails||[],$,As),St=pt.breakdown,Ot=((rs=lt.history)==null?void 
0:rs.currentYearYTD)||0,Vt=As.reduce((Ut,At)=>{const hs=`${At.year}-${At.number}`,ps=pt.months[hs]||0;return 
Ut+(typeof ps=="number"?ps:parseFloat(ps||0))},0),Kt=[],It=[];return St.dealDetails.forEach(Ut=>{const 
At=Ut.courseName||Ut.name||`Deal 
${Ut.dealNumber}`;Ut.incomeYTD>0&&Ut.incomeForecast===0&&Ut.incomeNextFY===0&&Kt.push(`${At}: All income 
(${as(Ut.incomeYTD)}) is already in YTD period.`),Ut.incomeNextFY>0&&Kt.push(`${At}: Training scheduled for next 
financial year.`),Ut.totalIncome===0&&Ut.totalCosts>0&&It.push(`${At}: No income but ${as(Ut.totalCosts)} in costs 
(internal training).`)}),jsxRuntimeExports.jsxs("div",{className:"summary-content",children:[Kt.length>0&&jsxRuntimeExp
orts.jsx("div",{className:"summary-warnings",children:Kt.map((Ut,At)=>jsxRuntimeExports.jsxs("div",{className:"warning-
message",children:["âšï¸ ",Ut]},At))}),It.length>0&&jsxRuntimeExports.jsx("div",{className:"summary-info-messages",chi
ldren:It.map((Ut,At)=>jsxRuntimeExports.jsxs("div",{className:"info-message",children:["â„¹ï¸ ",Ut]},At))}),jsxRuntime
Exports.jsxs("div",{className:"summary-row",children:[jsxRuntimeExports.jsxs("div",{className:"summary-item",children:[
jsxRuntimeExports.jsx("label",{children:"Total GP (All Deals)"}),jsxRuntimeExports.jsx("div",{className:"summary-value"
,children:as(St.totalGP)})]}),jsxRuntimeExports.jsxs("div",{className:"summary-item",children:[jsxRuntimeExports.jsx("l
abel",{children:"YTD Actual"}),jsxRuntimeExports.jsx("div",{className:"summary-value ytd-value",children:as(Ot)})]}),js
xRuntimeExports.jsxs("div",{className:"summary-item",children:[jsxRuntimeExports.jsx("label",{children:"Forecast 
Total"}),jsxRuntimeExports.jsx("div",{className:"summary-value 
forecast-value",children:as(Vt)})]}),jsxRuntimeExports.jsxs("div",{className:"summary-item 
highlight",children:[jsxRuntimeExports.jsx("label",{children:"Full Year 
Forecast"}),jsxRuntimeExports.jsx("div",{className:"summary-value full-year-value",children:as(Ot+Vt)})]})]}),jsxRuntim
eExports.jsxs("div",{className:"breakdown-section",children:[jsxRuntimeExports.jsx("h5",{children:"Deal Breakdown by Pe
riod"}),jsxRuntimeExports.jsxs("table",{className:"breakdown-table",children:[jsxRuntimeExports.jsx("thead",{children:j
sxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("th",{}),jsxRuntimeExports.jsx("th",{children:"Total 
Deal"}),jsxRuntimeExports.jsx("th",{children:"In YTD"}),jsxRuntimeExports.jsx("th",{children:"In 
Forecast"}),jsxRuntimeExports.jsx("th",{children:"Next FY"})]})}),jsxRuntimeExports.jsxs("tbody",{children:[jsxRuntimeE
xports.jsxs("tr",{className:"income-row",children:[jsxRuntimeExports.jsx("td",{children:jsxRuntimeExports.jsx("strong",
{children:"Income"})}),jsxRuntimeExports.jsx("td",{children:as(St.totalIncome)}),jsxRuntimeExports.jsx("td",{children:a
s(St.incomeYTD)}),jsxRuntimeExports.jsx("td",{children:as(St.incomeForecast)}),jsxRuntimeExports.jsx("td",{children:as(
St.incomeNextFY)})]}),jsxRuntimeExports.jsxs("tr",{className:"costs-row",children:[jsxRuntimeExports.jsx("td",{children
:jsxRuntimeExports.jsx("strong",{children:"Costs"})}),jsxRuntimeExports.jsx("td",{children:as(St.totalCosts)}),jsxRunti
meExports.jsx("td",{children:as(St.costsYTD)}),jsxRuntimeExports.jsx("td",{children:as(St.costsForecast)}),jsxRuntimeEx
ports.jsx("td",{children:as(St.costsNextFY)})]}),jsxRuntimeExports.jsxs("tr",{className:"gp-row",children:[jsxRuntimeEx
ports.jsx("td",{children:jsxRuntimeExports.jsx("strong",{children:"Gross Profit"})}),jsxRuntimeExports.jsx("td",{childr
en:jsxRuntimeExports.jsx("strong",{children:as(St.totalGP)})}),jsxRuntimeExports.jsx("td",{children:jsxRuntimeExports.j
sx("strong",{children:as(St.gpYTD)})}),jsxRuntimeExports.jsx("td",{children:jsxRuntimeExports.jsx("strong",{children:as
(St.gpForecast)})}),jsxRuntimeExports.jsx("td",{children:jsxRuntimeExports.jsx("strong",{children:as(St.gpNextFY)})})]}
)]})]})]}),jsxRuntimeExports.jsxs("div",{className:"summary-months",children:[jsxRuntimeExports.jsx("label",{children:"
Monthly Breakdown:"}),jsxRuntimeExports.jsx("div",{className:"months-grid",children:As.map(Ut=>{const 
At=`${Ut.year}-${Ut.number}`,hs=pt.months[At]||0;return jsxRuntimeExports.jsxs("div",{className:"month-preview",childre
n:[jsxRuntimeExports.jsx("div",{className:"month-name",children:Ut.name}),jsxRuntimeExports.jsx("div",{className:"month
-amount",children:as(hs)})]},At)})})]})]})})()]}),jsxRuntimeExports.jsxs("div",{className:"learnership-tabs-header",chi
ldren:[jsxRuntimeExports.jsxs("div",{className:"learnership-tabs",children:[(Qt[Ls].otherCoursesDetails||[]).map((lt,pt
)=>jsxRuntimeExports.jsxs("button",{type:"button",className:`learnership-tab 
${Yn===pt?"active":""}`,onClick:()=>Kn(pt),children:["Deal ",pt+1," ",lt.courseName?`- ${lt.courseName==="Other"?lt.cus
tomCourseName:lt.courseName}`:""]},lt.id||pt)),jsxRuntimeExports.jsx("button",{type:"button",className:"learnership-tab
 add-tab",onClick:()=>{ur(Ls),Kn((Qt[Ls].otherCoursesDetails||[]).length)},children:"+ Add 
Deal"})]}),jsxRuntimeExports.jsx("button",{type:"button",className:"apply-forecast-btn",onClick:()=>{const 
lt=Qt[Ls],pt=Ys(lt.otherCoursesDetails||[],$,As);Ft(St=>{var It;const 
Ot=[...St],Vt={...Ot[Ls]};Vt.months=pt.months;const Kt=((It=Vt.history)==null?void 0:It.currentYearYTD)||0;return 
Vt.fullYearForecast=Kt+pt.forecastTotal,Ot[Ls]=Vt,Ot}),alert("Monthly forecast updated based on Other Courses 
calculations!")},children:"Apply to Forecast Months"})]}),jsxRuntimeExports.jsx("div",{className:"learnership-tabs-cont
ent",children:(Qt[Ls].otherCoursesDetails||[]).length===0?jsxRuntimeExports.jsx("div",{className:"empty-state",children
:'No course deals yet. Click "+ Add Deal" to start.'}):Qt[Ls].otherCoursesDetails.map((lt,pt)=>{if(Yn!==pt)return 
null;const St=lt.numberOfTrainees||0,Ot=lt.pricePerPerson||0,Vt=St*Ot,Kt=lt.commissionPercentage||0,It=Vt*Kt/100,rs=It+
(lt.travelCost||0)+(lt.manualsCost||0)+(lt.accommodationCost||0)+(lt.accreditationCost||0)+(lt.customCost||0),Ut=Vt-rs;
return jsxRuntimeExports.jsxs("div",{className:"learnership-line-card",children:[jsxRuntimeExports.jsxs("div",{classNam
e:"learnership-line-header",children:[jsxRuntimeExports.jsxs("h4",{children:["Deal ",pt+1," ",lt.courseName?`- ${lt.cou
rseName==="Other"?lt.customCourseName:lt.courseName}`:""]}),jsxRuntimeExports.jsx("button",{type:"button",className:"de
lete-btn-small",onClick:()=>{const At=(Qt[Ls].otherCoursesDetails||[]).length-1;Nn(Ls,pt),Yn>=At&&At>0?Kn(At-1):At===0&
&Kn(0)},children:"Delete"})]}),jsxRuntimeExports.jsxs("div",{className:"learnership-vertical-grid",children:[jsxRuntime
Exports.jsxs("div",{className:"learnership-field",children:[jsxRuntimeExports.jsx("label",{children:"Course"}),jsxRunti
meExports.jsxs("select",{value:lt.courseName||"",onChange:At=>fn(Ls,pt,"courseName",At.target.value),className:"learner
ship-input-compact",children:[jsxRuntimeExports.jsx("option",{value:"",children:"-- Select Course --"}),mn.map(At=>jsxR
untimeExports.jsx("option",{value:At,children:At},At))]})]}),lt.courseName==="Other"&&jsxRuntimeExports.jsxs("div",{cla
ssName:"learnership-field",children:[jsxRuntimeExports.jsx("label",{children:"Custom Course Name"}),jsxRuntimeExports.j
sx("input",{type:"text",value:lt.customCourseName||"",onChange:At=>fn(Ls,pt,"customCourseName",At.target.value),classNa
me:"learnership-input-compact",placeholder:"Enter course name"})]}),jsxRuntimeExports.jsxs("div",{className:"learnershi
p-field",children:[jsxRuntimeExports.jsx("label",{children:"Deal Certainty %"}),jsxRuntimeExports.jsx("input",{type:"nu
mber",min:"0",max:"100",value:lt.certaintyPercentage??100,onChange:At=>fn(Ls,pt,"certaintyPercentage",At.target.value),
className:"learnership-input-compact"})]}),jsxRuntimeExports.jsxs("div",{className:"learnership-field full-width",child
ren:[jsxRuntimeExports.jsx("label",{children:"Description"}),jsxRuntimeExports.jsx("textarea",{value:lt.description||""
,onChange:At=>fn(Ls,pt,"description",At.target.value),className:"learnership-input-compact 
learnership-textarea",placeholder:"Add notes about this deal...",rows:"2"})]}),jsxRuntimeExports.jsxs("div",{className:
"learnership-field",children:[jsxRuntimeExports.jsx("label",{children:"Training Date"}),jsxRuntimeExports.jsx("input",{
type:"date",value:lt.trainingDate||"",onChange:At=>fn(Ls,pt,"trainingDate",At.target.value),className:"learnership-inpu
t-compact"})]}),jsxRuntimeExports.jsxs("div",{className:"learnership-field",children:[jsxRuntimeExports.jsx("label",{ch
ildren:"Number of Trainees"}),jsxRuntimeExports.jsx("input",{type:"number",min:"0",value:lt.numberOfTrainees||"",onChan
ge:At=>fn(Ls,pt,"numberOfTrainees",At.target.value),className:"learnership-input-compact"})]}),jsxRuntimeExports.jsxs("
div",{className:"learnership-field",children:[jsxRuntimeExports.jsx("label",{children:"Price per Person"}),jsxRuntimeEx
ports.jsx("input",{type:"text",value:Ks(lt.pricePerPerson||0),onChange:At=>fn(Ls,pt,"pricePerPerson",qs(At.target.value
)),className:"learnership-input-compact"})]}),jsxRuntimeExports.jsxs("div",{className:"learnership-field",children:[jsx
RuntimeExports.jsx("label",{children:"Total Income"}),jsxRuntimeExports.jsx("div",{className:"learnership-value",childr
en:as(Vt)})]}),jsxRuntimeExports.jsxs("div",{className:"learnership-costs-section",children:[jsxRuntimeExports.jsx("h5"
,{children:"Cost of Sales"}),jsxRuntimeExports.jsx("p",{className:"costs-section-hint",children:"Price can be zero for 
internal training - only costs will apply"}),jsxRuntimeExports.jsxs("div",{className:"cost-item-row",children:[jsxRunti
meExports.jsxs("div",{className:"cost-amount-field 
commission-field",children:[jsxRuntimeExports.jsx("label",{children:"Commission %"}),jsxRuntimeExports.jsx("input",{typ
e:"number",min:"0",max:"100",step:"0.01",value:lt.commissionPercentage||"",onChange:At=>fn(Ls,pt,"commissionPercentage"
,At.target.value),className:"learnership-input-compact",placeholder:"%"}),jsxRuntimeExports.jsxs("span",{className:"com
mission-amount",children:["= ",as(It)]})]}),jsxRuntimeExports.jsxs("div",{className:"cost-frequency-field",children:[js
xRuntimeExports.jsx("label",{children:"When 
Paid"}),jsxRuntimeExports.jsxs("select",{value:lt.commissionFrequency||"With Income",onChange:At=>fn(Ls,pt,"commissionF
requency",At.target.value),className:"learnership-input-compact",children:[jsxRuntimeExports.jsx("option",{value:"With 
Income",children:"With Income"}),jsxRuntimeExports.jsx("option",{value:"Once-off",children:"Once-off"})]})]})]}),jsxRun
timeExports.jsxs("div",{className:"cost-item-row",children:[jsxRuntimeExports.jsxs("div",{className:"cost-amount-field"
,children:[jsxRuntimeExports.jsx("label",{children:"Travel Cost"}),jsxRuntimeExports.jsx("input",{type:"text",value:Ks(
lt.travelCost||0),onChange:At=>fn(Ls,pt,"travelCost",qs(At.target.value)),className:"learnership-input-compact"})]}),js
xRuntimeExports.jsxs("div",{className:"cost-frequency-field",children:[jsxRuntimeExports.jsx("label",{children:"When Pa
id"}),jsxRuntimeExports.jsx("select",{value:lt.travelCostFrequency||"Once-off",onChange:At=>fn(Ls,pt,"travelCostFrequen
cy",At.target.value),className:"learnership-input-compact",children:jsxRuntimeExports.jsx("option",{value:"Once-off",ch
ildren:"Once-off"})})]})]}),jsxRuntimeExports.jsxs("div",{className:"cost-item-row",children:[jsxRuntimeExports.jsxs("d
iv",{className:"cost-amount-field",children:[jsxRuntimeExports.jsx("label",{children:"Manuals Cost"}),jsxRuntimeExports
.jsx("input",{type:"text",value:Ks(lt.manualsCost||0),onChange:At=>fn(Ls,pt,"manualsCost",qs(At.target.value)),classNam
e:"learnership-input-compact"})]}),jsxRuntimeExports.jsxs("div",{className:"cost-frequency-field",children:[jsxRuntimeE
xports.jsx("label",{children:"When Paid"}),jsxRuntimeExports.jsx("select",{value:lt.manualsCostFrequency||"Once-off",on
Change:At=>fn(Ls,pt,"manualsCostFrequency",At.target.value),className:"learnership-input-compact",children:jsxRuntimeEx
ports.jsx("option",{value:"Once-off",children:"Once-off"})})]})]}),jsxRuntimeExports.jsxs("div",{className:"cost-item-r
ow",children:[jsxRuntimeExports.jsxs("div",{className:"cost-amount-field",children:[jsxRuntimeExports.jsx("label",{chil
dren:"Accommodation Cost"}),jsxRuntimeExports.jsx("input",{type:"text",value:Ks(lt.accommodationCost||0),onChange:At=>f
n(Ls,pt,"accommodationCost",qs(At.target.value)),className:"learnership-input-compact"})]}),jsxRuntimeExports.jsxs("div
",{className:"cost-frequency-field",children:[jsxRuntimeExports.jsx("label",{children:"When Paid"}),jsxRuntimeExports.j
sx("select",{value:lt.accommodationCostFrequency||"Once-off",onChange:At=>fn(Ls,pt,"accommodationCostFrequency",At.targ
et.value),className:"learnership-input-compact",children:jsxRuntimeExports.jsx("option",{value:"Once-off",children:"Onc
e-off"})})]})]}),jsxRuntimeExports.jsxs("div",{className:"cost-item-row",children:[jsxRuntimeExports.jsxs("div",{classN
ame:"cost-amount-field",children:[jsxRuntimeExports.jsx("label",{children:"Accreditation Cost"}),jsxRuntimeExports.jsx(
"input",{type:"text",value:Ks(lt.accreditationCost||0),onChange:At=>fn(Ls,pt,"accreditationCost",qs(At.target.value)),c
lassName:"learnership-input-compact"})]}),jsxRuntimeExports.jsxs("div",{className:"cost-frequency-field",children:[jsxR
untimeExports.jsx("label",{children:"When Paid"}),jsxRuntimeExports.jsx("select",{value:lt.accreditationCostFrequency||
"Once-off",onChange:At=>fn(Ls,pt,"accreditationCostFrequency",At.target.value),className:"learnership-input-compact",ch
ildren:jsxRuntimeExports.jsx("option",{value:"Once-off",children:"Once-off"})})]})]}),jsxRuntimeExports.jsxs("div",{cla
ssName:"cost-item-row custom-cost-row",children:[jsxRuntimeExports.jsxs("div",{className:"cost-label-field",children:[j
sxRuntimeExports.jsx("label",{children:"Custom Cost Label"}),jsxRuntimeExports.jsx("input",{type:"text",value:lt.custom
CostLabel||"",onChange:At=>fn(Ls,pt,"customCostLabel",At.target.value),className:"learnership-input-compact",placeholde
r:"e.g., Venue Hire"})]}),jsxRuntimeExports.jsxs("div",{className:"cost-amount-field",children:[jsxRuntimeExports.jsx("
label",{children:"Amount"}),jsxRuntimeExports.jsx("input",{type:"text",value:Ks(lt.customCost||0),onChange:At=>fn(Ls,pt
,"customCost",qs(At.target.value)),className:"learnership-input-compact"})]}),jsxRuntimeExports.jsxs("div",{className:"
cost-frequency-field",children:[jsxRuntimeExports.jsx("label",{children:"When Paid"}),jsxRuntimeExports.jsx("select",{v
alue:lt.customCostFrequency||"Once-off",onChange:At=>fn(Ls,pt,"customCostFrequency",At.target.value),className:"learner
ship-input-compact",children:jsxRuntimeExports.jsx("option",{value:"Once-off",children:"Once-off"})})]})]})]}),jsxRunti
meExports.jsxs("div",{className:"learnership-field gp-field",children:[jsxRuntimeExports.jsx("label",{children:"Gross 
Profit (GP)"}),jsxRuntimeExports.jsx("div",{className:"learnership-value gp-value",children:as(Ut)})]})]})]},lt.id||pt)
}).filter(Boolean)})]})]})})]})},EditFinancial=()=>{const{clientId:s}=useParams(),[e]=useSearchParams(),i=e.get("produc
tLine");return jsxRuntimeExports.jsx(ClientFinancialEditor,{preselectedClientId:s,preselectedProductLine:i})},Clients=(
)=>{const[s,e]=reactExports.useState([]),[i,a]=reactExports.useState([]),[o,c]=reactExports.useState(!0),[d,h]=reactExp
orts.useState(""),[j,_]=reactExports.useState("all"),[$,rt]=reactExports.useState("all"),[tt,mt]=reactExports.useState(
"all"),[vt,_t]=reactExports.useState({total:0,active:0,pending:0,prospects:0,ytdRevenue:0,pipelineValue:0}),[wt,ht]=rea
ctExports.useState({leadGeneration:0,contactMade:0,needsAssessment:0,dealClosed:0}),[dt,jt]=reactExports.useState([]),[
bt,ut]=reactExports.useState([]),[Rt,st]=reactExports.useState([]),[it,nt]=reactExports.useState([]),[ct,xt]=reactExpor
ts.useState(""),{getTenantId:yt,currentUser:Tt,isSystemAdmin:fs,accessibleUserIds:cs,isTeamManager:Es,isSalesHead:ls,hi
erarchyLoading:Yt}=useTenant(),Mt=fs||Es()||ls();reactExports.useEffect(()=>{!Yt&&Tt&&(Wt(),Gt())},[Yt,Tt,cs]),reactExp
orts.useEffect(()=>{ft()},[s,d,j,$,tt]);const Gt=async()=>{try{if(Mt){const[Pt,$t]=await 
Promise.all([getUsers$1(),getSkillsPartners$1()]);jt(Pt),ut($t)}}catch(Pt){console.error("Error loading supporting 
data:",Pt)}},Wt=async()=>{try{const Pt=yt(),[$t,Bt,Lt]=await Promise.all([getClients({},Pt),getFinancialYearSettings(Pt
),calculateFinancialYearMonths(Pt)]);xt(Bt.currentFinancialYear||""),nt(Lt.ytdMonths||[]);let 
Xt=[];Bt.currentFinancialYear&&Pt&&(Xt=await 
getFinancialData(UPLOAD_TYPES.YTD_ACTUAL,Bt.currentFinancialYear,Pt),st(Xt));let Dt=$t;!fs&&!ls()&&Tt&&(Dt=$t.filter(Ft
=>!!(Ft.assignedSalesPerson&&cs.includes(Ft.assignedSalesPerson)||Ft.createdBy&&cs.includes(Ft.createdBy)))),e(Dt);cons
t Ht=(Ft,xs)=>{let Cs=Xt.filter(Os=>Os.clientId===Ft);if(Cs.length===0&&xs){const Os=xs.toLowerCase().trim();Cs=Xt.filt
er(qt=>qt.clientName&&qt.clientName.toLowerCase().trim()===Os)}if(Cs.length===0)return 0;const 
gs=(Lt.ytdMonths||[]).map(Os=>Os.name);return gs.length===0?0:Cs.reduce((Os,qt)=>{const 
js=qt.monthlyData||qt.monthlyValues||{};let es=0;return gs.forEach(vs=>{es+=js[vs]||0}),Os+es},0)},os=Dt.reduce((Ft,xs)
=>Ft+Ht(xs.id,xs.name),0),Qt={total:Dt.length,active:Dt.filter(Ft=>Ft.status==="Active").length,pending:Dt.filter(Ft=>F
t.status==="Pending").length,prospects:Dt.filter(Ft=>Ft.status==="Prospect").length,ytdRevenue:os,pipelineValue:Dt.redu
ce((Ft,xs)=>Ft+(xs.pipelineValue||0),0)};_t(Qt),c(!1)}catch(Pt){console.error("Error loading 
clients:",Pt),c(!1)}},ms=reactExports.useMemo(()=>{const 
Pt=it.map($t=>$t.name);return($t,Bt)=>{if(Rt.length===0||Pt.length===0)return 0;let 
Lt=Rt.filter(Xt=>Xt.clientId===$t);if(Lt.length===0&&Bt){const 
Xt=Bt.toLowerCase().trim();Lt=Rt.filter(Dt=>Dt.clientName&&Dt.clientName.toLowerCase().trim()===Xt)}return 
Lt.length===0?0:Lt.reduce((Xt,Dt)=>{const Ht=Dt.monthlyData||Dt.monthlyValues||{};let os=0;return 
Pt.forEach(Qt=>{os+=Ht[Qt]||0}),Xt+os},0)}},[Rt,it]),ss=Pt=>{if(!Pt)return"Unassigned";const 
$t=dt.find(Bt=>Bt.id===Pt);return($t==null?void 0:$t.displayName)||($t==null?void 
0:$t.email)||"Unknown"},ys=Pt=>{if(!Pt||Pt==="not-allocated")return"Not Allocated";if(Pt==="none")return"No Skills 
Partner";const $t=bt.find(Bt=>Bt.id===Pt);return($t==null?void 0:$t.name)||"Unknown"},Et=Pt=>{var Dt;if(Pt.pipelineStat
us==="Won"||Pt.pipelineStatus==="Lost")return"not-applicable";if(!Pt.nextFollowUpDate)return"none";const 
$t=(Dt=Pt.nextFollowUpDate)!=null&&Dt.toDate?Pt.nextFollowUpDate.toDate():new Date(Pt.nextFollowUpDate),Bt=new 
Date;Bt.setHours(0,0,0,0),$t.setHours(0,0,0,0);const 
Lt=$t.getTime()-Bt.getTime(),Xt=Math.ceil(Lt/(1e3*60*60*24));return 
Xt<0?"overdue":Xt===0?"due-today":Xt<=3?"due-soon":"scheduled"},gt=Pt=>Pt?(Pt!=null&&Pt.toDate?Pt.toDate():new 
Date(Pt)).toLocaleDateString("en-ZA",{day:"numeric",month:"short"}):null,ft=()=>{let Pt=[...s];if(d){const 
$t=d.toLowerCase();Pt=Pt.filter(Bt=>{var Lt,Xt,Dt,Ht,os,Qt,Ft,xs,Cs,gs,Os,qt;return((Lt=Bt.name)==null?void 
0:Lt.toLowerCase().includes($t))||((Xt=Bt.legalName)==null?void 
0:Xt.toLowerCase().includes($t))||((Dt=Bt.tradingName)==null?void 
0:Dt.toLowerCase().includes($t))||((Ht=Bt.vatNumber)==null?void 
0:Ht.toLowerCase().includes($t))||((os=Bt.primaryContact)==null?void 
0:os.toLowerCase().includes($t))||((Qt=Bt.contactEmail)==null?void 
0:Qt.toLowerCase().includes($t))||((Ft=Bt.phone)==null?void 
0:Ft.toLowerCase().includes($t))||((xs=Bt.hrContactPerson)==null?void 
0:xs.toLowerCase().includes($t))||((Cs=Bt.hrContactEmail)==null?void 
0:Cs.toLowerCase().includes($t))||((gs=Bt.sdfName)==null?void 
0:gs.toLowerCase().includes($t))||((Os=Bt.trainingManagerName)==null?void 
0:Os.toLowerCase().includes($t))||((qt=Bt.decisionMakerName)==null?void 0:qt.toLowerCase().includes($t))})}j!=="all"&&(
Pt=Pt.filter($t=>$t.status===j)),$!=="all"&&(Pt=Pt.filter($t=>$t.type===$)),tt!=="all"&&(Pt=Pt.filter($t=>{const 
Bt=Et($t);return tt==="needs-attention"?Bt==="overdue"||Bt==="due-today"||Bt==="none":Bt===tt})),a(Pt)},zt=Pt=>new Intl
.NumberFormat("en-ZA",{style:"currency",currency:"ZAR",minimumFractionDigits:0}).format(Pt),Ct=Pt=>Pt?(Pt.toDate?Pt.toD
ate():new Date(Pt)).toLocaleDateString("en-ZA"):"N/A";return o?jsxRuntimeExports.jsxs("div",{className:"clients",childr
en:[jsxRuntimeExports.jsx("h1",{children:"Clients"}),jsxRuntimeExports.jsx("div",{className:"clients-content",children:
jsxRuntimeExports.jsx("p",{children:"Loading..."})})]}):jsxRuntimeExports.jsxs("div",{className:"clients",children:[jsx
RuntimeExports.jsxs("div",{className:"clients-header",children:[jsxRuntimeExports.jsx("h1",{children:"Clients"}),jsxRun
timeExports.jsx(Link,{to:"/clients/new",className:"add-client-btn",children:"+ Add Client"})]}),jsxRuntimeExports.jsxs(
"div",{className:"pipeline-summary",children:[jsxRuntimeExports.jsx("h3",{children:"Sales Pipeline Summary"}),jsxRuntim
eExports.jsxs("div",{className:"pipeline-stats",children:[jsxRuntimeExports.jsxs("div",{className:"pipeline-stat",child
ren:[jsxRuntimeExports.jsx("span",{className:"stat-label",children:"Lead Generation"}),jsxRuntimeExports.jsx("span",{cl
assName:"stat-value",children:wt.leadGeneration})]}),jsxRuntimeExports.jsxs("div",{className:"pipeline-stat",children:[
jsxRuntimeExports.jsx("span",{className:"stat-label",children:"Contact Made"}),jsxRuntimeExports.jsx("span",{className:
"stat-value",children:wt.contactMade})]}),jsxRuntimeExports.jsxs("div",{className:"pipeline-stat",children:[jsxRuntimeE
xports.jsx("span",{className:"stat-label",children:"Needs Assessment"}),jsxRuntimeExports.jsx("span",{className:"stat-v
alue",children:wt.needsAssessment})]}),jsxRuntimeExports.jsxs("div",{className:"pipeline-stat",children:[jsxRuntimeExpo
rts.jsx("span",{className:"stat-label",children:"Deal Closed"}),jsxRuntimeExports.jsx("span",{className:"stat-value",ch
ildren:wt.dealClosed})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"client-overview",children:[jsxRuntimeExports.j
sx("h3",{children:"Client Overview"}),jsxRuntimeExports.jsxs("div",{className:"overview-stats",children:[jsxRuntimeExpo
rts.jsxs("div",{className:"overview-stat",children:[jsxRuntimeExports.jsx("span",{className:"stat-label",children:"Tota
l Clients"}),jsxRuntimeExports.jsx("span",{className:"stat-value",children:vt.total})]}),jsxRuntimeExports.jsxs("div",{
className:"overview-stat",children:[jsxRuntimeExports.jsx("span",{className:"stat-label",children:"Active"}),jsxRuntime
Exports.jsx("span",{className:"stat-value",children:vt.active})]}),jsxRuntimeExports.jsxs("div",{className:"overview-st
at",children:[jsxRuntimeExports.jsx("span",{className:"stat-label",children:"Pending"}),jsxRuntimeExports.jsx("span",{c
lassName:"stat-value",children:vt.pending})]}),jsxRuntimeExports.jsxs("div",{className:"overview-stat",children:[jsxRun
timeExports.jsx("span",{className:"stat-label",children:"Prospects"}),jsxRuntimeExports.jsx("span",{className:"stat-val
ue",children:vt.prospects})]}),jsxRuntimeExports.jsxs("div",{className:"overview-stat",children:[jsxRuntimeExports.jsx(
"span",{className:"stat-label",children:"YTD Actual"}),jsxRuntimeExports.jsx("span",{className:"stat-value",children:zt
(vt.ytdRevenue)})]}),jsxRuntimeExports.jsxs("div",{className:"overview-stat",children:[jsxRuntimeExports.jsx("span",{cl
assName:"stat-label",children:"Pipeline Value"}),jsxRuntimeExports.jsx("span",{className:"stat-value",children:zt(vt.pi
pelineValue)})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"clients-filters",children:[jsxRuntimeExports.jsx("inpu
t",{type:"text",placeholder:"Search clients...",className:"search-input",value:d,onChange:Pt=>h(Pt.target.value)}),jsxR
untimeExports.jsxs("select",{className:"filter-select",value:j,onChange:Pt=>_(Pt.target.value),children:[jsxRuntimeExpo
rts.jsx("option",{value:"all",children:"All Status"}),jsxRuntimeExports.jsx("option",{value:"Active",children:"Active"}
),jsxRuntimeExports.jsx("option",{value:"Pending",children:"Pending"}),jsxRuntimeExports.jsx("option",{value:"Prospect"
,children:"Prospect"}),jsxRuntimeExports.jsx("option",{value:"Inactive",children:"Inactive"})]}),jsxRuntimeExports.jsxs
("select",{className:"filter-select",value:$,onChange:Pt=>rt(Pt.target.value),children:[jsxRuntimeExports.jsx("option",
{value:"all",children:"All Types"}),jsxRuntimeExports.jsx("option",{value:"Corporate",children:"Corporate"}),jsxRuntime
Exports.jsx("option",{value:"School",children:"School"}),jsxRuntimeExports.jsx("option",{value:"Program",children:"Prog
ram"})]}),jsxRuntimeExports.jsxs("select",{className:"filter-select followup-filter",value:tt,onChange:Pt=>mt(Pt.target
.value),children:[jsxRuntimeExports.jsx("option",{value:"all",children:"All 
Follow-ups"}),jsxRuntimeExports.jsx("option",{value:"needs-attention",children:"Needs Attention"}),jsxRuntimeExports.js
x("option",{value:"overdue",children:"Overdue"}),jsxRuntimeExports.jsx("option",{value:"due-today",children:"Due 
Today"}),jsxRuntimeExports.jsx("option",{value:"due-soon",children:"Due 
Soon"}),jsxRuntimeExports.jsx("option",{value:"none",children:"No Follow-up"}),jsxRuntimeExports.jsx("option",{value:"s
cheduled",children:"Scheduled"})]}),jsxRuntimeExports.jsx("button",{className:"export-btn",children:"Export Data"})]}),
jsxRuntimeExports.jsx("div",{className:"clients-content",children:jsxRuntimeExports.jsxs("table",{className:"clients-ta
ble",children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("th
",{children:"Client Name"}),jsxRuntimeExports.jsx("th",{children:"Type"}),jsxRuntimeExports.jsx("th",{children:"Status"
}),jsxRuntimeExports.jsx("th",{children:"Follow-Up"}),Mt&&jsxRuntimeExports.jsx("th",{children:"Sales 
Person"}),Mt&&jsxRuntimeExports.jsx("th",{children:"Skills Partner"}),jsxRuntimeExports.jsx("th",{children:"Last 
Contact"}),jsxRuntimeExports.jsx("th",{children:"YTD Actual"}),jsxRuntimeExports.jsx("th",{children:"Actions"})]})}),js
xRuntimeExports.jsx("tbody",{children:i.length>0?i.map(Pt=>{var $t;return jsxRuntimeExports.jsxs("tr",{children:[jsxRun
timeExports.jsx("td",{children:jsxRuntimeExports.jsx(Link,{to:`/clients/${Pt.id}`,className:"client-name-link",children
:Pt.name||Pt.legalName||"Unnamed Client"})}),jsxRuntimeExports.jsx("td",{children:Pt.type||"N/A"}),jsxRuntimeExports.js
x("td",{children:jsxRuntimeExports.jsx("span",{className:`status-badge status-${($t=Pt.status)==null?void 
0:$t.toLowerCase()}`,children:Pt.status||"N/A"})}),jsxRuntimeExports.jsx("td",{children:(()=>{const 
Bt=Et(Pt),Lt=gt(Pt.nextFollowUpDate);return 
Bt==="not-applicable"?jsxRuntimeExports.jsx("span",{className:"followup-badge 
na",children:"N/A"}):Bt==="none"?jsxRuntimeExports.jsx("span",{className:"followup-badge none",children:"No Follow-up"}
):jsxRuntimeExports.jsxs("div",{className:"followup-cell",children:[jsxRuntimeExports.jsxs("span",{className:`followup-
badge ${Bt}`,children:[Bt==="overdue"&&"Overdue",Bt==="due-today"&&"Today",Bt==="due-soon"&&"Soon",Bt==="scheduled"&&"S
cheduled"]}),jsxRuntimeExports.jsx("span",{className:"followup-date",children:Lt})]})})()}),Mt&&jsxRuntimeExports.jsx("
td",{children:jsxRuntimeExports.jsx("span",{className:Pt.assignedSalesPerson?"":"unassigned-text",children:ss(Pt.assign
edSalesPerson)})}),Mt&&jsxRuntimeExports.jsx("td",{children:jsxRuntimeExports.jsx("span",{className:!Pt.skillsPartnerId
||Pt.skillsPartnerId==="not-allocated"?"unassigned-text":"",children:ys(Pt.skillsPartnerId)})}),jsxRuntimeExports.jsx("
td",{children:Ct(Pt.lastContact)}),jsxRuntimeExports.jsx("td",{children:zt(ms(Pt.id,Pt.name))}),jsxRuntimeExports.jsxs(
"td",{children:[jsxRuntimeExports.jsx(Link,{to:`/clients/${Pt.id}`,className:"action-link",children:"View"}),jsxRuntime
Exports.jsx(Link,{to:`/clients/${Pt.id}/edit`,className:"action-link",children:"Edit"})]})]},Pt.id)}):jsxRuntimeExports
.jsx("tr",{children:jsxRuntimeExports.jsxs("td",{colSpan:Mt?9:7,className:"no-clients",children:["No clients found. 
",jsxRuntimeExports.jsx(Link,{to:"/clients/new",children:"Add your first 
client"})]})})})]})})]})},SETAS_COLLECTION="setas",getSetas=async()=>{var s,e;try{const 
i=collection(db,SETAS_COLLECTION);return(await getDocs(i)).docs.map(c=>({id:c.id,...c.data()})).sort((c,d)=>(c.shortNam
e||"").localeCompare(d.shortName||""))}catch(i){if(console.error("Error getting SETAs:",i),i.code==="permission-denied"
||(s=i.message)!=null&&s.includes("index")||(e=i.message)!=null&&e.includes("collection"))return console.log("SETA 
collection may not exist yet"),[];throw i}},createSeta=async s=>{try{const e={shortName:s.shortName,fullName:s.fullName
,createdAt:Timestamp.now(),updatedAt:Timestamp.now()},i=collection(db,SETAS_COLLECTION);return(await 
addDoc(i,e)).id}catch(e){throw console.error("Error creating SETA:",e),e}},updateSeta=async(s,e)=>{try{const 
i=doc(db,SETAS_COLLECTION,s),a={shortName:e.shortName,fullName:e.fullName,updatedAt:Timestamp.now()};await 
updateDoc(i,a)}catch(i){throw console.error("Error updating SETA:",i),i}},deleteSeta=async s=>{try{const 
e=doc(db,SETAS_COLLECTION,s);await deleteDoc(e)}catch(e){throw console.error("Error deleting 
SETA:",e),e}},seedSetas=async()=>{try{const s=[{shortName:"AgriSETA",fullName:"Agricultural Sector Education and 
Training Authority"},{shortName:"BANKSETA",fullName:"Banking Sector Education and Training 
Authority"},{shortName:"CHIETA",fullName:"Chemical Industries Education and Training 
Authority"},{shortName:"CETA",fullName:"Construction Education and Training 
Authority"},{shortName:"CATHSSETA",fullName:"Culture, Arts, Tourism, Hospitality and Sport SETA"},{shortName:"ETDP 
SETA",fullName:"Education, Training and Development Practices SETA"},{shortName:"EWSETA",fullName:"Energy and Water 
SETA"},{shortName:"FP&M SETA",fullName:"Fibre Processing & Manufacturing SETA"},{shortName:"FASSET",fullName:"Finance 
and Accounting Services SETA"},{shortName:"FoodBev SETA",fullName:"Food and Beverage Manufacturing Industry 
SETA"},{shortName:"HWSETA",fullName:"Health and Welfare SETA"},{shortName:"INSETA",fullName:"Insurance 
SETA"},{shortName:"LGSETA",fullName:"Local Government SETA"},{shortName:"merSETA",fullName:"Manufacturing, Engineering 
and Related Services SETA"},{shortName:"MICT SETA",fullName:"Media, Information and Communication Technologies 
SETA"},{shortName:"MQA",fullName:"Mining Qualifications Authority"},{shortName:"PSETA",fullName:"Public Service 
SETA"},{shortName:"SASSETA",fullName:"Safety and Security SETA"},{shortName:"SSETA",fullName:"Services 
SETA"},{shortName:"TETA",fullName:"Transport Education and Training 
Authority"},{shortName:"W&RSETA",fullName:"Wholesale & Retail SETA"}],e=collection(db,SETAS_COLLECTION),i=s.map(a=>addD
oc(e,{...a,createdAt:Timestamp.now(),updatedAt:Timestamp.now()}));await Promise.all(i),console.log("SETAs seeded 
successfully")}catch(s){throw console.error("Error seeding 
SETAs:",s),s}},JOB_TITLES_COLLECTION="jobTitles",getJobTitles=async()=>{var s,e;try{const 
i=collection(db,JOB_TITLES_COLLECTION);return(await getDocs(i)).docs.map(c=>({id:c.id,...c.data()})).sort((c,d)=>(c.tit
le||"").localeCompare(d.title||""))}catch(i){if(console.error("Error getting job titles:",i),i.code==="permission-denie
d"||(s=i.message)!=null&&s.includes("index")||(e=i.message)!=null&&e.includes("collection"))return console.log("Job 
titles collection may not exist yet"),[];throw i}},createJobTitle=async s=>{try{const e={title:s.title,createdAt:Timest
amp.now(),updatedAt:Timestamp.now()},i=collection(db,JOB_TITLES_COLLECTION);return(await 
addDoc(i,e)).id}catch(e){throw console.error("Error creating job title:",e),e}},updateJobTitle=async(s,e)=>{try{const 
i=doc(db,JOB_TITLES_COLLECTION,s),a={title:e.title,updatedAt:Timestamp.now()};await updateDoc(i,a)}catch(i){throw 
console.error("Error updating job title:",i),i}},deleteJobTitle=async s=>{try{const 
e=doc(db,JOB_TITLES_COLLECTION,s);await deleteDoc(e)}catch(e){throw console.error("Error deleting job 
title:",e),e}},seedJobTitles=async()=>{try{const s=[{title:"HR Manager"},{title:"HR Admin"},{title:"Skills and 
Development Facilitator"},{title:"Transformations Manager"},{title:"HR Director"},{title:"Financial 
Manager"},{title:"Financial Director"},{title:"Managing Director"}],e=collection(db,JOB_TITLES_COLLECTION),i=s.map(a=>a
ddDoc(e,{...a,createdAt:Timestamp.now(),updatedAt:Timestamp.now()}));await Promise.all(i),console.log("Job titles 
seeded successfully")}catch(s){throw console.error("Error seeding job titles:",s),s}},NewClient=()=>{const s=useNavigat
e(),e=getAuth(),{getTenantId:i}=useTenant(),[a,o]=reactExports.useState(!1),[c,d]=reactExports.useState([]),[h,j]=react
Exports.useState([]),[_,$]=reactExports.useState([]),[rt,tt]=reactExports.useState([]),[mt,vt]=reactExports.useState({n
ame:"",legalName:"",tradingName:"",vatNumber:"",type:"Corporate",status:"Prospect",physicalAddress:"",postalAddress:"",
country:"South Africa",industry:"",sector:"",hrContactPerson:"",hrContactEmail:"",hrContactPhone:"",sdfName:"",sdfEmail
:"",sdfPhone:"",trainingManagerName:"",trainingManagerEmail:"",trainingManagerPhone:"",decisionMakerName:"",decisionMak
erEmail:"",decisionMakerPhone:"",currentLmsUsage:"No",lmsId:"",bbbeeLevel:"",seta:"",financialYearEnd:"",sharePointFold
erLink:"",primaryContact:"",contactEmail:"",phone:"",notes:"",companyBackground:"",ytdRevenue:0,pipelineValue:0,assigne
dSalesPerson:"",skillsPartnerId:"not-allocated"});reactExports.useEffect(()=>{e.currentUser&&vt(nt=>({...nt,assignedSal
esPerson:e.currentUser.uid})),_t(),wt(),ht()},[]);const _t=async()=>{try{const nt=await 
getUsers();d(nt)}catch(nt){console.error("Error loading users:",nt)}},wt=async()=>{try{const nt=await 
getSetas();j(nt)}catch(nt){console.error("Error loading SETAs:",nt)}},ht=async()=>{try{const nt=await 
getJobTitles();$(nt)}catch(nt){console.error("Error loading job titles:",nt)}},dt=()=>{tt(nt=>[...nt,{id:Date.now(),nam
e:"",email:"",phone:"",jobTitle:"",isDecisionMaker:!1,isMainContact:!1}])},jt=nt=>{tt(ct=>ct.filter(xt=>xt.id!==nt))},b
t=(nt,ct,xt)=>{tt(yt=>yt.map(Tt=>Tt.id===nt?{...Tt,[ct]:xt}:Tt))},ut=nt=>{const{name:ct,value:xt}=nt.target;vt(yt=>({..
.yt,[ct]:xt}))},Rt=nt=>{if(nt===""||nt===null||nt===void 0)return"";const ct=parseFloat(nt);return isNaN(ct)?"":ct.toLo
caleString("en-ZA")},st=nt=>{const{name:ct,value:xt}=nt.target,yt=xt.replace(/[^\d.]/g,""),Tt=yt===""?0:parseFloat(yt);
vt(fs=>({...fs,[ct]:isNaN(Tt)?0:Tt}))},it=async nt=>{var ct,xt,yt;nt.preventDefault(),o(!0);try{const Tt=i(),fs=await 
createClient({...mt,clientId:`CLI-${Date.now()}`,contacts:rt},Tt);await 
addClientActivity(fs,{type:"client_created",description:`Client "${mt.name||mt.legalName}" was 
created`,userId:((ct=e.currentUser)==null?void 0:ct.uid)||"system",userName:((xt=e.currentUser)==null?void 
0:xt.displayName)||((yt=e.currentUser)==null?void 
0:yt.email)||"System"}),s(`/clients/${fs}`)}catch(Tt){console.error("Error creating client:",Tt),alert("Failed to 
create client. Please try again."),o(!1)}};return jsxRuntimeExports.jsxs("div",{className:"new-client",children:[jsxRun
timeExports.jsxs("div",{className:"new-client-header",children:[jsxRuntimeExports.jsx("h1",{children:"Add New Client"})
,jsxRuntimeExports.jsx("button",{onClick:()=>s("/clients"),className:"cancel-btn",children:"Cancel"})]}),jsxRuntimeExpo
rts.jsxs("form",{onSubmit:it,className:"client-form",children:[jsxRuntimeExports.jsxs("div",{className:"form-section",c
hildren:[jsxRuntimeExports.jsx("h2",{children:"Basic Information"}),jsxRuntimeExports.jsxs("div",{className:"form-grid"
,children:[jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"name"
,children:"Client Name *"}),jsxRuntimeExports.jsx("input",{type:"text",id:"name",name:"name",value:mt.name,onChange:ut,
required:!0})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:
"legalName",children:"Legal Name"}),jsxRuntimeExports.jsx("input",{type:"text",id:"legalName",name:"legalName",value:mt
.legalName,onChange:ut})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label
",{htmlFor:"tradingName",children:"Trading Name"}),jsxRuntimeExports.jsx("input",{type:"text",id:"tradingName",name:"tr
adingName",value:mt.tradingName,onChange:ut})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRunt
imeExports.jsx("label",{htmlFor:"vatNumber",children:"VAT Number"}),jsxRuntimeExports.jsx("input",{type:"text",id:"vatN
umber",name:"vatNumber",value:mt.vatNumber,onChange:ut})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",childr
en:[jsxRuntimeExports.jsx("label",{htmlFor:"type",children:"Client Type *"}),jsxRuntimeExports.jsxs("select",{id:"type"
,name:"type",value:mt.type,onChange:ut,required:!0,children:[jsxRuntimeExports.jsx("option",{value:"Corporate",children
:"Corporate"}),jsxRuntimeExports.jsx("option",{value:"School",children:"School"}),jsxRuntimeExports.jsx("option",{value
:"Program",children:"Program"})]})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.
jsx("label",{htmlFor:"status",children:"Status *"}),jsxRuntimeExports.jsxs("select",{id:"status",name:"status",value:mt
.status,onChange:ut,required:!0,children:[jsxRuntimeExports.jsx("option",{value:"Prospect",children:"Prospect"}),jsxRun
timeExports.jsx("option",{value:"Active",children:"Active"}),jsxRuntimeExports.jsx("option",{value:"Pending",children:"
Pending"}),jsxRuntimeExports.jsx("option",{value:"Inactive",children:"Inactive"})]})]})]})]}),jsxRuntimeExports.jsxs("d
iv",{className:"form-section",children:[jsxRuntimeExports.jsx("h2",{children:"Contact Information"}),jsxRuntimeExports.
jsxs("div",{className:"form-grid",children:[jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeEx
ports.jsx("label",{htmlFor:"primaryContact",children:"Primary Contact"}),jsxRuntimeExports.jsx("input",{type:"text",id:
"primaryContact",name:"primaryContact",value:mt.primaryContact,onChange:ut})]}),jsxRuntimeExports.jsxs("div",{className
:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"contactEmail",children:"Contact Email"}),jsxRuntimeExpo
rts.jsx("input",{type:"email",id:"contactEmail",name:"contactEmail",value:mt.contactEmail,onChange:ut})]}),jsxRuntimeEx
ports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"phone",children:"Phone"}),js
xRuntimeExports.jsx("input",{type:"tel",id:"phone",name:"phone",value:mt.phone,onChange:ut})]})]})]}),jsxRuntimeExports
.jsxs("div",{className:"form-section",children:[jsxRuntimeExports.jsx("h2",{children:"Location"}),jsxRuntimeExports.jsx
s("div",{className:"form-grid",children:[jsxRuntimeExports.jsxs("div",{className:"form-group 
form-group-full",children:[jsxRuntimeExports.jsx("label",{htmlFor:"physicalAddress",children:"Physical Address"}),jsxRu
ntimeExports.jsx("input",{type:"text",id:"physicalAddress",name:"physicalAddress",value:mt.physicalAddress,onChange:ut}
)]}),jsxRuntimeExports.jsxs("div",{className:"form-group 
form-group-full",children:[jsxRuntimeExports.jsx("label",{htmlFor:"postalAddress",children:"Postal Address"}),jsxRuntim
eExports.jsx("input",{type:"text",id:"postalAddress",name:"postalAddress",value:mt.postalAddress,onChange:ut})]}),jsxRu
ntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"country",children:"Co
untry"}),jsxRuntimeExports.jsx("input",{type:"text",id:"country",name:"country",value:mt.country,onChange:ut})]})]})]})
,jsxRuntimeExports.jsxs("div",{className:"form-section",children:[jsxRuntimeExports.jsx("h2",{children:"Industry & 
SETA Information"}),jsxRuntimeExports.jsxs("div",{className:"form-grid",children:[jsxRuntimeExports.jsxs("div",{classNa
me:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"industry",children:"Industry"}),jsxRuntimeExports.jsx
("input",{type:"text",id:"industry",name:"industry",value:mt.industry,onChange:ut,placeholder:"e.g., Manufacturing, Ret
ail"})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"sector
",children:"Sector"}),jsxRuntimeExports.jsx("input",{type:"text",id:"sector",name:"sector",value:mt.sector,onChange:ut,
placeholder:"Important for SETA allocation"})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRunt
imeExports.jsx("label",{htmlFor:"seta",children:"SETA"}),jsxRuntimeExports.jsxs("select",{id:"seta",name:"seta",value:m
t.seta,onChange:ut,children:[jsxRuntimeExports.jsx("option",{value:"",children:"Select SETA"}),h.map(nt=>jsxRuntimeExpo
rts.jsx("option",{value:nt.shortName,children:nt.shortName},nt.id))]})]}),jsxRuntimeExports.jsxs("div",{className:"form
-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"bbbeeLevel",children:"BBBEE Level"}),jsxRuntimeExports.jsxs("
select",{id:"bbbeeLevel",name:"bbbeeLevel",value:mt.bbbeeLevel,onChange:ut,children:[jsxRuntimeExports.jsx("option",{va
lue:"",children:"Select Level"}),jsxRuntimeExports.jsx("option",{value:"Level 1",children:"Level 
1"}),jsxRuntimeExports.jsx("option",{value:"Level 2",children:"Level 2"}),jsxRuntimeExports.jsx("option",{value:"Level 
3",children:"Level 3"}),jsxRuntimeExports.jsx("option",{value:"Level 4",children:"Level 
4"}),jsxRuntimeExports.jsx("option",{value:"Level 5",children:"Level 5"}),jsxRuntimeExports.jsx("option",{value:"Non-Co
mpliant",children:"Non-Compliant"})]})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"form-section",children:[jsxRun
timeExports.jsxs("div",{className:"section-header",children:[jsxRuntimeExports.jsx("h2",{children:"Contact 
Persons"}),jsxRuntimeExports.jsx("button",{type:"button",className:"add-contact-btn",onClick:dt,children:"+ Add Contact
"})]}),rt.length===0?jsxRuntimeExports.jsx("div",{className:"empty-contacts",children:jsxRuntimeExports.jsx("p",{childr
en:'No contacts added yet. Click "Add Contact" to add contact persons.'})}):jsxRuntimeExports.jsx("div",{className:"con
tacts-list",children:rt.map((nt,ct)=>jsxRuntimeExports.jsxs("div",{className:"contact-row",children:[jsxRuntimeExports.
jsx("div",{className:"contact-number",children:ct+1}),jsxRuntimeExports.jsxs("div",{className:"contact-field",children:
[jsxRuntimeExports.jsx("label",{children:"Name"}),jsxRuntimeExports.jsx("input",{type:"text",value:nt.name,onChange:xt=
>bt(nt.id,"name",xt.target.value),placeholder:"Contact name"})]}),jsxRuntimeExports.jsxs("div",{className:"contact-fiel
d",children:[jsxRuntimeExports.jsx("label",{children:"Job Title"}),jsxRuntimeExports.jsxs("select",{value:nt.jobTitle,o
nChange:xt=>bt(nt.id,"jobTitle",xt.target.value),children:[jsxRuntimeExports.jsx("option",{value:"",children:"Select 
job title"}),_.map(xt=>jsxRuntimeExports.jsx("option",{value:xt.title,children:xt.title},xt.id))]})]}),jsxRuntimeExport
s.jsxs("div",{className:"contact-field",children:[jsxRuntimeExports.jsx("label",{children:"Email (Optional)"}),jsxRunti
meExports.jsx("input",{type:"text",value:nt.email,onChange:xt=>bt(nt.id,"email",xt.target.value),placeholder:"email@exa
mple.com (optional)"})]}),jsxRuntimeExports.jsxs("div",{className:"contact-field",children:[jsxRuntimeExports.jsx("labe
l",{children:"Phone (Optional)"}),jsxRuntimeExports.jsx("input",{type:"text",value:nt.phone,onChange:xt=>bt(nt.id,"phon
e",xt.target.value),placeholder:"Phone number (optional)"})]}),jsxRuntimeExports.jsx("div",{className:"contact-field ch
eckbox-field",children:jsxRuntimeExports.jsxs("label",{children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked
:nt.isDecisionMaker,onChange:xt=>bt(nt.id,"isDecisionMaker",xt.target.checked)}),jsxRuntimeExports.jsx("span",{children
:"Decision Maker"})]})}),jsxRuntimeExports.jsx("div",{className:"contact-field checkbox-field",children:jsxRuntimeExpor
ts.jsxs("label",{children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:nt.isMainContact,onChange:xt=>bt(nt.i
d,"isMainContact",xt.target.checked)}),jsxRuntimeExports.jsx("span",{children:"Main Contact"})]})}),jsxRuntimeExports.j
sx("button",{type:"button",className:"remove-contact-btn",onClick:()=>jt(nt.id),title:"Remove contact",children:"Ã—"})]
},nt.id))})]}),jsxRuntimeExports.jsxs("div",{className:"form-section",children:[jsxRuntimeExports.jsx("h2",{children:"L
MS Information"}),jsxRuntimeExports.jsxs("div",{className:"form-grid",children:[jsxRuntimeExports.jsxs("div",{className
:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"currentLmsUsage",children:"Current LMS Usage"}),jsxRunt
imeExports.jsxs("select",{id:"currentLmsUsage",name:"currentLmsUsage",value:mt.currentLmsUsage,onChange:ut,children:[js
xRuntimeExports.jsx("option",{value:"No",children:"No"}),jsxRuntimeExports.jsx("option",{value:"Yes",children:"Yes"})]}
)]}),mt.currentLmsUsage==="Yes"&&jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("
label",{htmlFor:"lmsId",children:"LMS 
ID"}),jsxRuntimeExports.jsx("input",{type:"text",id:"lmsId",name:"lmsId",value:mt.lmsId,onChange:ut,placeholder:"Enter 
LMS ID if applicable"})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"form-section",children:[jsxRuntimeExports.jsx
("h2",{children:"Account Assignment"}),jsxRuntimeExports.jsx("div",{className:"form-grid",children:jsxRuntimeExports.js
xs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"assignedSalesPerson",children:"Accou
nt Owner *"}),jsxRuntimeExports.jsxs("select",{id:"assignedSalesPerson",name:"assignedSalesPerson",value:mt.assignedSal
esPerson,onChange:ut,required:!0,children:[jsxRuntimeExports.jsx("option",{value:"",children:"Select Salesperson"}),c.m
ap(nt=>jsxRuntimeExports.jsx("option",{value:nt.id,children:nt.displayName||nt.email||nt.id},nt.id))]}),jsxRuntimeExpor
ts.jsx("small",{children:"Defaults to current user. Manager can reassign later."})]})})]}),jsxRuntimeExports.jsxs("div"
,{className:"form-section",children:[jsxRuntimeExports.jsx("h2",{children:"Notes & Company Background"}),jsxRuntimeExpo
rts.jsxs("div",{className:"form-grid",children:[jsxRuntimeExports.jsxs("div",{className:"form-group 
form-group-full",children:[jsxRuntimeExports.jsx("label",{htmlFor:"companyBackground",children:"Company Background"}),j
sxRuntimeExports.jsx("textarea",{id:"companyBackground",name:"companyBackground",rows:"4",value:mt.companyBackground,on
Change:ut,placeholder:"Enter company background and notes..."})]}),jsxRuntimeExports.jsxs("div",{className:"form-group 
form-group-full",children:[jsxRuntimeExports.jsx("label",{htmlFor:"notes",children:"Additional Notes"}),jsxRuntimeExpor
ts.jsx("textarea",{id:"notes",name:"notes",rows:"3",value:mt.notes,onChange:ut,placeholder:"Enter any additional notes.
.."})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"form-section",children:[jsxRuntimeExports.jsx("h2",{children:"F
inancial Information"}),jsxRuntimeExports.jsxs("div",{className:"form-grid",children:[jsxRuntimeExports.jsxs("div",{cla
ssName:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"financialYearEnd",children:"Financial Year 
End"}),jsxRuntimeExports.jsx("input",{type:"text",id:"financialYearEnd",name:"financialYearEnd",placeholder:"e.g., Marc
h",value:mt.financialYearEnd,onChange:ut})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntime
Exports.jsx("label",{htmlFor:"ytdRevenue",children:"YTD Revenue (R)"}),jsxRuntimeExports.jsx("input",{type:"text",id:"y
tdRevenue",name:"ytdRevenue",value:Rt(mt.ytdRevenue),onChange:st,placeholder:"0"})]}),jsxRuntimeExports.jsxs("div",{cla
ssName:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"pipelineValue",children:"Pipeline Value (R)"}),js
xRuntimeExports.jsx("input",{type:"text",id:"pipelineValue",name:"pipelineValue",value:Rt(mt.pipelineValue),onChange:st
,placeholder:"0"})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"form-section",children:[jsxRuntimeExports.jsx("h2"
,{children:"Additional Information"}),jsxRuntimeExports.jsx("div",{className:"form-grid",children:jsxRuntimeExports.jsx
s("div",{className:"form-group 
form-group-full",children:[jsxRuntimeExports.jsx("label",{htmlFor:"sharePointFolderLink",children:"SharePoint/Google 
Drive Link"}),jsxRuntimeExports.jsx("input",{type:"url",id:"sharePointFolderLink",name:"sharePointFolderLink",value:mt.
sharePointFolderLink,onChange:ut,placeholder:"https://..."})]})})]}),jsxRuntimeExports.jsxs("div",{className:"form-acti
ons",children:[jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>s("/clients"),className:"cancel-btn",children:
"Cancel"}),jsxRuntimeExports.jsx("button",{type:"submit",className:"save-btn",disabled:a,children:a?"Creating...":"Crea
te Client"})]})]})]})},InteractionCapture=({clientId:s,client:e,contacts:i=[],onInteractionCreated:a})=>{const 
o=getAuth(),[c,d]=reactExports.useState(!1),[h,j]=reactExports.useState(!1),_=()=>{const jt=new Date;return 
jt.setDate(jt.getDate()+7),jt.toISOString().split("T")[0]},rt=(()=>{const jt=[];return 
e!=null&&e.primaryContact&&jt.push({id:"primary",name:e.primaryContact,role:"Primary Contact",email:e.contactEmail,phon
e:e.phone}),e!=null&&e.hrContactPerson&&jt.push({id:"hr",name:e.hrContactPerson,role:"HR Contact",email:e.hrContactEmai
l,phone:e.hrContactPhone}),e!=null&&e.sdfName&&jt.push({id:"sdf",name:e.sdfName,role:"Skills Development Facilitator",e
mail:e.sdfEmail,phone:e.sdfPhone}),e!=null&&e.trainingManagerName&&jt.push({id:"training",name:e.trainingManagerName,ro
le:"Training Manager",email:e.trainingManagerEmail,phone:e.trainingManagerPhone}),e!=null&&e.decisionMakerName&&jt.push
({id:"decision",name:e.decisionMakerName,role:"Decision Maker",email:e.decisionMakerEmail,phone:e.decisionMakerPhone}),
i&&i.length>0&&i.forEach(bt=>{jt.push({id:bt.id,name:bt.name,role:bt.role||bt.jobTitle||"Contact",email:bt.email,phone:
bt.phone})}),jt})(),[tt,mt]=reactExports.useState({type:"Call",contactPerson:"",contactPersonName:"",contactPersonRole:
"",summary:"",notes:"",documentsShared:"",objectionsRaised:"",nextSteps:"",date:new 
Date().toISOString().split("T")[0],time:new Date().toTimeString().slice(0,5),followUpDate:_(),followUpReason:"",followU
pType:"call"}),vt=["Call","Meeting","Email","WhatsApp","Teams","SMS","Other"],_t=[{value:"call",label:"Call"},{value:"e
mail",label:"Send Email"},{value:"meeting",label:"Schedule Meeting"},{value:"proposal",label:"Send 
Proposal"},{value:"quote",label:"Follow Up on Quote"},{value:"demo",label:"Schedule 
Demo"},{value:"contract",label:"Contract Discussion"},{value:"other",label:"Other"}],wt=jt=>{const{name:bt,value:ut}=jt
.target;mt(Rt=>({...Rt,[bt]:ut}))},ht=jt=>{const 
bt=jt.target.value;if(!bt){mt(Rt=>({...Rt,contactPerson:"",contactPersonName:"",contactPersonRole:""}));return}const ut
=rt.find(Rt=>Rt.id===bt);ut&&mt(Rt=>({...Rt,contactPerson:bt,contactPersonName:ut.name,contactPersonRole:ut.role}))},dt
=async jt=>{var bt,ut,Rt;jt.preventDefault(),j(!0);try{const st=new 
Date(`${tt.date}T${tt.time}`),it=Timestamp.fromDate(st),nt=new 
Date(`${tt.followUpDate}T09:00:00`),ct=Timestamp.fromDate(nt);await createInteraction(s,{type:tt.type.toLowerCase(),con
tactPersonId:tt.contactPerson||null,contactPersonName:tt.contactPersonName||null,contactPersonRole:tt.contactPersonRole
||null,summary:tt.summary,notes:tt.notes,documentsShared:tt.documentsShared,objectionsRaised:tt.objectionsRaised,nextSt
eps:tt.nextSteps,userId:(bt=o.currentUser)==null?void 0:bt.uid,userName:((ut=o.currentUser)==null?void 
0:ut.displayName)||((Rt=o.currentUser)==null?void 0:Rt.email),timestamp:it,followUpDate:ct,followUpReason:tt.followUpRe
ason,followUpType:tt.followUpType}),mt({type:"Call",contactPerson:"",contactPersonName:"",contactPersonRole:"",summary:
"",notes:"",documentsShared:"",objectionsRaised:"",nextSteps:"",date:new Date().toISOString().split("T")[0],time:new Da
te().toTimeString().slice(0,5),followUpDate:_(),followUpReason:"",followUpType:"call"}),d(!1),a&&a()}catch(st){console.
error("Error creating interaction:",st),alert("Failed to log interaction. Please try again.")}finally{j(!1)}};return c?
jsxRuntimeExports.jsxs("div",{className:"interaction-capture-form",children:[jsxRuntimeExports.jsxs("div",{className:"f
orm-header",children:[jsxRuntimeExports.jsx("h3",{children:"Log New Interaction"}),jsxRuntimeExports.jsx("button",{clas
sName:"close-btn",onClick:()=>d(!1),children:"Ã—"})]}),jsxRuntimeExports.jsxs("form",{onSubmit:dt,children:[jsxRuntimeE
xports.jsxs("div",{className:"form-row",children:[jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRun
timeExports.jsx("label",{children:"Interaction Type *"}),jsxRuntimeExports.jsx("select",{name:"type",value:tt.type,onCh
ange:wt,required:!0,children:vt.map(jt=>jsxRuntimeExports.jsx("option",{value:jt,children:jt},jt))})]}),jsxRuntimeExpor
ts.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Date *"}),jsxRuntimeExports.js
x("input",{type:"date",name:"date",value:tt.date,onChange:wt,required:!0})]}),jsxRuntimeExports.jsxs("div",{className:"
form-group",children:[jsxRuntimeExports.jsx("label",{children:"Time"}),jsxRuntimeExports.jsx("input",{type:"time",name:
"time",value:tt.time,onChange:wt})]})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExpor
ts.jsx("label",{children:"Contact Person"}),jsxRuntimeExports.jsxs("select",{name:"contactPerson",value:tt.contactPerso
n,onChange:ht,children:[jsxRuntimeExports.jsx("option",{value:"",children:"-- Select Contact 
--"}),rt.map(jt=>jsxRuntimeExports.jsxs("option",{value:jt.id,children:[jt.name," (",jt.role,")"]},jt.id))]}),tt.contac
tPersonName&&jsxRuntimeExports.jsxs("span",{className:"selected-contact-info",children:["Speaking with: ",tt.contactPer
sonName]})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"S
ummary of Discussion *"}),jsxRuntimeExports.jsx("textarea",{name:"summary",rows:"4",value:tt.summary,onChange:wt,requir
ed:!0,placeholder:"Brief summary of what was discussed..."})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",ch
ildren:[jsxRuntimeExports.jsx("label",{children:"Notes"}),jsxRuntimeExports.jsx("textarea",{name:"notes",rows:"3",value
:tt.notes,onChange:wt,placeholder:"Additional notes..."})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",child
ren:[jsxRuntimeExports.jsx("label",{children:"Documents Shared"}),jsxRuntimeExports.jsx("input",{type:"text",name:"docu
mentsShared",value:tt.documentsShared,onChange:wt,placeholder:"List any documents shared (e.g., Proposal.pdf, Quote.xls
x)"})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Object
ions Raised"}),jsxRuntimeExports.jsx("textarea",{name:"objectionsRaised",rows:"2",value:tt.objectionsRaised,onChange:wt
,placeholder:"Any objections or concerns raised..."})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:
[jsxRuntimeExports.jsx("label",{children:"Next Steps"}),jsxRuntimeExports.jsx("textarea",{name:"nextSteps",rows:"2",val
ue:tt.nextSteps,onChange:wt,placeholder:"Agreed next steps..."})]}),jsxRuntimeExports.jsxs("div",{className:"follow-up-
section",children:[jsxRuntimeExports.jsx("h4",{children:"Schedule Next Follow-Up 
*"}),jsxRuntimeExports.jsx("p",{className:"section-description",children:"Every interaction must have a scheduled 
follow-up to keep the client in the sales cycle."}),jsxRuntimeExports.jsxs("div",{className:"form-row",children:[jsxRun
timeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Follow-Up Date *"}),j
sxRuntimeExports.jsx("input",{type:"date",name:"followUpDate",value:tt.followUpDate,onChange:wt,required:!0,min:new Dat
e().toISOString().split("T")[0]})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.j
sx("label",{children:"Follow-Up Action *"}),jsxRuntimeExports.jsx("select",{name:"followUpType",value:tt.followUpType,o
nChange:wt,required:!0,children:_t.map(jt=>jsxRuntimeExports.jsx("option",{value:jt.value,children:jt.label},jt.value))
})]})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Reason
 for Follow-Up *"}),jsxRuntimeExports.jsx("input",{type:"text",name:"followUpReason",value:tt.followUpReason,onChange:w
t,required:!0,placeholder:"E.g., Discuss pricing options, Send updated proposal, Check decision..."})]})]}),jsxRuntimeE
xports.jsxs("div",{className:"form-actions",children:[jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>d(!1),c
lassName:"cancel-btn",children:"Cancel"}),jsxRuntimeExports.jsx("button",{type:"submit",className:"save-btn",disabled:h
,children:h?"Saving...":"Save Interaction & Schedule 
Follow-Up"})]})]})]}):jsxRuntimeExports.jsx("button",{className:"add-interaction-btn",onClick:()=>d(!0),children:"+ 
Log New Interaction"})},ClientDetail=()=>{var sr,dr,rr;const{id:s}=useParams(),e=useNavigate(),{userRole:i,getTenantId:
a}=useTenant(),o=a(),[c,d]=reactExports.useState(!0),[h,j]=reactExports.useState(null),[_,$]=reactExports.useState([]),
[rt,tt]=reactExports.useState([]),[mt,vt]=reactExports.useState([]),[_t,wt]=reactExports.useState([]),[ht,dt]=reactExpo
rts.useState([]),[jt,bt]=reactExports.useState([]),[ut,Rt]=reactExports.useState([]),[st,it]=reactExports.useState([]),
[nt,ct]=reactExports.useState([]),[xt,yt]=reactExports.useState([]),[Tt,fs]=reactExports.useState(null),[cs,Es]=reactEx
ports.useState([]),[ls,Yt]=reactExports.useState(null),[Mt,Gt]=reactExports.useState(null),[Wt,ms]=reactExports.useStat
e({ytdActual:[],budget:[],ytd1:[],ytd2:[],ytd3:[]}),[ss,ys]=reactExports.useState({type:"all",userId:"all"}),[Et,gt]=re
actExports.useState("overview"),[ft,zt]=reactExports.useState(""),[Ct,Pt]=reactExports.useState(!1),[$t,Bt]=reactExport
s.useState(!1),[Lt,Xt]=reactExports.useState(null),[Dt,Ht]=reactExports.useState([]),[os,Qt]=reactExports.useState(!1),
[Ft,xs]=reactExports.useState(0),[Cs,gs]=reactExports.useState(!1),[Os,qt]=reactExports.useState(!1),[js,es]=reactExpor
ts.useState({date:"",type:"call",reason:""}),[vs,Rs]=reactExports.useState(!1),[Tn,Hs]=reactExports.useState(!1),[En,Hn
]=reactExports.useState(""),[Ps,Ts]=reactExports.useState(!1),[ks,Ln]=reactExports.useState({}),[hn,Jn]=reactExports.us
eState(!1),[nr,Ls]=reactExports.useState(!1),[Vn,Yn]=reactExports.useState(""),[Kn,$n]=reactExports.useState(!1),[Cn,zs
]=reactExports.useState([]),[Xs,mn]=reactExports.useState(!1),[On,As]=reactExports.useState(null),[Zt,Is]=reactExports.
useState({name:"",address:"",city:"",province:"",postalCode:"",isHeadOffice:!1}),[ns,ts]=reactExports.useState(!1),[_s,
Ns]=reactExports.useState([]),[Gs,Qs]=reactExports.useState(!1),[qs,sn]=reactExports.useState(null),[tn,Dn]=reactExport
s.useState({firstName:"",lastName:"",email:"",phone:"",jobTitle:"",locationId:"",isDecisionMaker:!1,isMainContact:!1,no
tes:""}),[Un,Zn]=reactExports.useState(!1),[gr,hr]=reactExports.useState([]),[Er,yr]=reactExports.useState([]),[wr,Pr]=
reactExports.useState([]),[Rr,ar]=reactExports.useState([]),Rn=[{value:"call",label:"Call"},{value:"email",label:"Send 
Email"},{value:"meeting",label:"Schedule Meeting"},{value:"proposal",label:"Send 
Proposal"},{value:"quote",label:"Follow Up on Quote"},{value:"demo",label:"Schedule 
Demo"},{value:"contract",label:"Contract 
Discussion"},{value:"other",label:"Other"}],[fr,cr]=reactExports.useState([{id:"",name:"Not in 
Pipeline",color:"#f5f5f5"}]);reactExports.useEffect(()=>{s&&Gn()},[s]);const Gn=async()=>{try{const at=await 
getClient(s);if(!at){console.error("Client not found with ID:",s),d(!1);return}if(j(at),Hn(at.sharePointFolderLink||"")
,Ln(at.documentChecklist||{}),zs(at.locations||[]),Ns(at.contacts||[]),at.lastContact){const 
Xn=at.lastContact.toDate?at.lastContact.toDate():new Date(at.lastContact);Yn(Xn.toISOString().split("T")[0])}else 
Yn("");let kt=null;try{const[Xn,Sr]=await Promise.all([calculateFinancialYearMonths(o),getFinancialYearSettings(o)]);kt
=Xn,Yt(kt),Gt(Sr)}catch(Xn){console.error("Error loading financial year 
info:",Xn),Yt({currentFinancialYear:2025}),Gt({reportingMonth:"February"})}const us=async(Xn,Sr=[])=>{try{return await 
Xn()}catch(kr){return console.error("Error loading data:",kr),Sr}},[ds,vn,In,Js,cn,Qn,un,Fn,_n,Bs,pn,ir,jr,vr]=await Pr
omise.all([us(()=>getQuotes(s)),us(()=>getInvoices(s)),us(()=>getClientInteractions(s)),us(()=>getFollowUpTasks({client
Id:s})),us(()=>kt?getClientFinancialsByYear(kt.currentFinancialYear,{clientId:s}):Promise.resolve([])),us(()=>getFeedba
ck(s)),us(()=>getContracts(s)),us(()=>getDeals(null,{clientId:s})),us(()=>getUsers()),us(()=>getPipelineStatuses()),us(
()=>getProducts()),us(()=>getProductLines()),us(()=>getLegalDocumentTypes()),us(()=>getJobTitles())]);if(tt(ds),$(ds.sl
ice(0,5)),wt(vn),vt(vn.slice(0,5)),dt(In),bt(Js),Rt(cn),it(Qn),ct(un),yt(Fn),Es(_n),cr([{id:"",name:"Not in 
Pipeline",color:"#f5f5f5"},...Bs]),hr(pn.filter(Xn=>Xn.status==="active")),yr(ir),Pr(jr),ar(vr),(at==null?void 
0:at.currentLmsUsage)==="Yes"&&(at!=null&&at.lmsId)&&fs(Dr(at)),o&&kt)try{const Xn=kt.currentFinancialYear,Sr=calculate
FinancialYear(Xn,-1),kr=calculateFinancialYear(Xn,-2),Lr=calculateFinancialYear(Xn,-3),Cr=await getFinancialDataByClien
t(s,o),xr=Cr.filter(et=>et.uploadType===UPLOAD_TYPES.YTD_ACTUAL&&et.financialYear===Xn),Mr=Cr.filter(et=>et.uploadType=
==UPLOAD_TYPES.BUDGET&&et.financialYear===Xn),Vr=Cr.filter(et=>et.uploadType===UPLOAD_TYPES.YTD_1&&et.financialYear===S
r),Ir=Cr.filter(et=>et.uploadType===UPLOAD_TYPES.YTD_2&&et.financialYear===kr),g=Cr.filter(et=>et.uploadType===UPLOAD_T
YPES.YTD_3&&et.financialYear===Lr);ms({ytdActual:xr,budget:Mr,ytd1:Vr,ytd2:Ir,ytd3:g})}catch(Xn){console.error("Error 
loading uploaded financials:",Xn)}d(!1)}catch(at){console.error("Error loading client data:",at),d(!1)}},Dr=at=>{const 
kt=Math.floor(Math.random()*200)+20;return{totalEmployees:kt,activeUsers:Math.floor(kt*(.6+Math.random()*.3)),completed
Courses:Math.floor(Math.random()*500)+100,inProgressCourses:Math.floor(Math.random()*150)+30,avgCompletionRate:Math.flo
or(Math.random()*30)+65,lastActivityDate:new Date(Date.now()-Math.random()*7*24*60*60*1e3),courses:[{name:"First Aid 
Level 1",enrolled:Math.floor(Math.random()*50)+10,completed:Math.floor(Math.random()*40)+5,avgScore:Math.floor(Math.ran
dom()*20)+75},{name:"Fire Safety Basics",enrolled:Math.floor(Math.random()*40)+8,completed:Math.floor(Math.random()*35)
+3,avgScore:Math.floor(Math.random()*15)+80},{name:"OHS Awareness",enrolled:Math.floor(Math.random()*60)+15,completed:M
ath.floor(Math.random()*50)+10,avgScore:Math.floor(Math.random()*18)+78},{name:"Excel Fundamentals",enrolled:Math.floor
(Math.random()*30)+5,completed:Math.floor(Math.random()*25)+2,avgScore:Math.floor(Math.random()*20)+70},{name:"Leadersh
ip Skills",enrolled:Math.floor(Math.random()*20)+3,completed:Math.floor(Math.random()*15)+1,avgScore:Math.floor(Math.ra
ndom()*15)+82}],recentActivity:[{user:"John Smith",action:"Completed",course:"First Aid Level 1",date:new 
Date(Date.now()-2*60*60*1e3)},{user:"Sarah Johnson",action:"Started",course:"Fire Safety Basics",date:new 
Date(Date.now()-5*60*60*1e3)},{user:"Mike Williams",action:"Passed Assessment",course:"OHS Awareness",date:new 
Date(Date.now()-1*24*60*60*1e3)},{user:"Emily Brown",action:"Enrolled",course:"Leadership Skills",date:new 
Date(Date.now()-2*24*60*60*1e3)},{user:"David Lee",action:"Completed",course:"Excel Fundamentals",date:new 
Date(Date.now()-3*24*60*60*1e3)}]}},Us=()=>{Gn()},rn=at=>{if(!at)return"Unassigned";const 
kt=cs.find(us=>us.id===at);return(kt==null?void 0:kt.displayName)||(kt==null?void 0:kt.email)||"Unknown 
User"},Ms=async()=>{Ts(!0);try{await updateClient(s,{sharePointFolderLink:En}),j(at=>({...at,sharePointFolderLink:En}))
,Hs(!1)}catch(at){console.error("Error saving SharePoint link:",at),alert("Failed to save SharePoint 
link")}finally{Ts(!1)}},ur=async()=>{$n(!0);try{const at=Vn?Timestamp.fromDate(new Date(Vn)):null;await 
updateClient(s,{lastContact:at}),j(kt=>({...kt,lastContact:at})),Ls(!1)}catch(at){console.error("Error updating last 
contact:",at),alert("Failed to update last contact date")}finally{$n(!1)}},fn=async(at,kt)=>{const 
us={...ks,[at]:kt};Ln(us),Jn(!0);try{await 
updateClient(s,{documentChecklist:us}),j(ds=>({...ds,documentChecklist:us}))}catch(ds){console.error("Error saving 
document checklist:",ds)}finally{Jn(!1)}},Nn=(at=null)=>{at?(As(at),Is({...at})):(As(null),Is({name:"",address:"",city:
"",province:"",postalCode:"",isHeadOffice:!1})),mn(!0)},Ys=async()=>{if(!Zt.name.trim()){alert("Location name is 
required");return}ts(!0);try{let at;if(On)at=Cn.map(kt=>kt.id===On.id?{...Zt,id:On.id}:kt);else{const 
kt={...Zt,id:`loc-${Date.now()}`};at=[...Cn,kt]}await 
updateClient(s,{locations:at}),zs(at),j(kt=>({...kt,locations:at})),mn(!1)}catch(at){console.error("Error saving 
location:",at),alert("Failed to save location")}finally{ts(!1)}},bs=async at=>{if(window.confirm("Are you sure you 
want to delete this location?"))try{const kt=Cn.filter(us=>us.id!==at);await 
updateClient(s,{locations:kt}),zs(kt),j(us=>({...us,locations:kt}))}catch(kt){console.error("Error deleting location:",
kt)}},yn=(at=null)=>{at?(sn(at),Dn({firstName:at.firstName||"",lastName:at.lastName||"",email:at.email||"",phone:at.pho
ne||"",jobTitle:at.jobTitle||"",locationId:at.locationId||"",isDecisionMaker:at.isDecisionMaker||!1,isMainContact:at.is
MainContact||!1,notes:at.notes||""})):(sn(null),Dn({firstName:"",lastName:"",email:"",phone:"",jobTitle:"",locationId:"
",isDecisionMaker:!1,isMainContact:!1,notes:""})),Qs(!0)},jn=async()=>{var 
at,kt;if(!((at=tn.firstName)!=null&&at.trim())||!((kt=tn.lastName)!=null&&kt.trim())){alert("First name and last name 
are required");return}Zn(!0);try{let us;if(qs)us=_s.map(ds=>ds.id===qs.id?{...ds,...tn,updatedAt:new 
Date().toISOString()}:ds);else{const ds={id:`contact-${Date.now()}`,...tn,createdAt:new 
Date().toISOString(),updatedAt:new Date().toISOString()};us=[..._s,ds]}await 
updateClient(s,{contacts:us}),Ns(us),j(ds=>({...ds,contacts:us})),Qs(!1),sn(null)}catch(us){console.error("Error 
saving contact:",us),alert("Failed to save contact")}finally{Zn(!1)}},Mn=async at=>{if(window.confirm("Are you sure 
you want to delete this contact?")){Zn(!0);try{const kt=_s.filter(us=>us.id!==at);await 
updateClient(s,{contacts:kt}),Ns(kt),j(us=>({...us,contacts:kt}))}catch(kt){console.error("Error deleting 
contact:",kt),alert("Failed to delete contact")}finally{Zn(!1)}}},_r=at=>{const 
kt=Cn.find(us=>us.id===at);return(kt==null?void 0:kt.name)||"N/A"},Tr=async()=>{if(ft.trim()){Pt(!0);try{await 
createFeedback({clientId:s,clientName:(h==null?void 0:h.name)||"Unknown",type:"comment",content:ft,date:new 
Date,userName:"Current User",userId:"currentUserId"}),zt(""),Gn()}catch(at){console.error("Error adding 
comment:",at),alert("Failed to add comment")}finally{Pt(!1)}}},or=async at=>{gs(!0);try{const kt=await updateClientPipe
lineStatus(s,at);j(us=>({...us,pipelineStatus:at,pipelineStatusHistory:kt}))}catch(kt){console.error("Error updating 
pipeline status:",kt),alert("Failed to update pipeline status")}finally{gs(!1)}},br=at=>{const 
kt=fr.find(us=>us.id===at);return 
kt?kt.color:"#f5f5f5"},Ar=()=>{if(!(h!=null&&h.nextFollowUpDate))return{status:"none",daysUntil:null};const at=new 
Date;at.setHours(0,0,0,0);const kt=h.nextFollowUpDate.toDate?h.nextFollowUpDate.toDate():new 
Date(h.nextFollowUpDate);kt.setHours(0,0,0,0);const us=kt-at,ds=Math.ceil(us/(1e3*60*60*24));return ds<0?{status:"overd
ue",daysUntil:ds}:ds===0?{status:"due-today",daysUntil:0}:ds<=7?{status:"due-soon",daysUntil:ds}:{status:"scheduled",da
ysUntil:ds}},as=async()=>{var at;if(!js.date||!js.reason){alert("Please fill in all required 
fields");return}Rs(!0);try{const kt=new Date(`${js.date}T09:00:00`),us=Timestamp.fromDate(kt);await 
updateClientFollowUp(s,{date:us,reason:js.reason,type:js.type},(at=auth.currentUser)==null?void 0:at.uid),j(ds=>({...ds
,nextFollowUpDate:us,nextFollowUpReason:js.reason,nextFollowUpType:js.type})),qt(!1),es({date:"",type:"call",reason:""}
)}catch(kt){console.error("Error saving follow-up:",kt),alert("Failed to save follow-up. Please try 
again.")}finally{Rs(!1)}},Ks=()=>{if(h!=null&&h.nextFollowUpDate){const 
at=h.nextFollowUpDate.toDate?h.nextFollowUpDate.toDate():new Date(h.nextFollowUpDate);es({date:at.toISOString().split("
T")[0],type:h.nextFollowUpType||"call",reason:h.nextFollowUpReason||""})}else{const at=new Date;at.setDate(at.getDate()
+7),es({date:at.toISOString().split("T")[0],type:"call",reason:""})}qt(!0)},lt=ht.filter(at=>!(ss.type!=="all"&&at.type
!==ss.type||ss.userId!=="all"&&at.userId!==ss.userId)),pt=at=>new Intl.NumberFormat("en-ZA",{style:"currency",currency:
"ZAR",minimumFractionDigits:0,maximumFractionDigits:0}).format(Math.round(at||0)),St=at=>at?(at.toDate?at.toDate():new 
Date(at)).toLocaleDateString("en-ZA"):"N/A",Ot=at=>at?(at.toDate?at.toDate():new 
Date(at)).toLocaleString("en-ZA"):"N/A",Vt=at=>{if(!at)return"N/A";const kt=at.toDate?at.toDate():new Date(at),ds=new 
Date-kt,vn=Math.floor(ds/6e4),In=Math.floor(ds/36e5),Js=Math.floor(ds/864e5);return vn<60?`${vn} minutes 
ago`:In<24?`${In} hours ago`:Js<7?`${Js} days ago`:St(at)},Kt=at=>{var ds;Xt(at);const 
kt=((ds=at.productLine)==null?void 0:ds.toLowerCase())||"";let us=[];kt.includes("learnership")?us=at.learnershipDetail
s||[]:kt.includes("tap")||kt.includes("business")?us=at.tapBusinessDetails||[]:kt.includes("compliance")?us=at.complian
ceDetails||[]:(kt.includes("course")||kt.includes("other"))&&(us=at.otherCoursesDetails||[]),Ht(JSON.parse(JSON.stringi
fy(us))),xs(0),Bt(!0)},It=()=>{Bt(!1),Xt(null),Ht([])},rs=at=>{const kt=(at==null?void 0:at.toLowerCase())||"";return k
t.includes("learnership")?"learnership":kt.includes("tap")||kt.includes("business")?"tap":kt.includes("compliance")?"co
mpliance":"other"},Ut=at=>{const kt=Er.find(us=>{var vn;const ds=((vn=us.name)==null?void 
0:vn.toLowerCase())||"";return at==="learnership"?ds.includes("learnership"):at==="tap"?ds.includes("tap")||ds.includes
("business"):at==="compliance"?ds.includes("compliance"):ds.includes("other")||ds.includes("course")});return 
kt?gr.filter(us=>us.productLineId===kt.id):[]},At=(at,kt,us)=>{const ds=gr.find(vn=>vn.id===kt);ds&&Ht(vn=>{const 
In=[...vn];return In[at]&&(In[at]={...In[at],productId:kt,name:ds.name,...us==="learnership"&&ds.defaultCostPerLearner?
{costPerLearner:ds.defaultCostPerLearner}:{},...us==="tap"&&ds.defaultMonthlyFee?{costPerEmployeePerMonth:ds.defaultMon
thlyFee}:{},...us==="compliance"&&ds.defaultCostPerTrainee?{pricePerPerson:ds.defaultCostPerTrainee}:{},...us==="other"
&&ds.defaultDailyRate?{pricePerPerson:ds.defaultDailyRate}:{}}),In})},hs=(at,kt,us)=>{Ht(ds=>{const vn=[...ds];return 
vn[at]&&(vn[at]={...vn[at],[kt]:us}),vn})},ps=async()=>{var at;if(Lt){Qt(!0);try{const 
kt=((at=Lt.productLine)==null?void 0:at.toLowerCase())||"",us={...Lt};if(kt.includes("learnership")?us.learnershipDetai
ls=Dt:kt.includes("tap")||kt.includes("business")?us.tapBusinessDetails=Dt:kt.includes("compliance")?us.complianceDetai
ls=Dt:us.otherCoursesDetails=Dt,await saveClientFinancial(us),ls){const ds=await 
getClientFinancialsByYear(ls.currentFinancialYear,s);Rt(ds)}It(),alert("Deals saved 
successfully!")}catch(kt){console.error("Error saving deals:",kt),alert("Failed to save deals. Please try 
again.")}finally{Qt(!1)}}},Ss=()=>{var us;if(!Lt)return;const at=((us=Lt.productLine)==null?void 
0:us.toLowerCase())||"";let kt={};at.includes("learnership")?kt={id:`D${Dt.length+1}`,name:"",description:"",certaintyP
ercentage:100,learners:0,costPerLearner:0,fundingType:"SETA",paymentStartDate:"",paymentFrequency:"Monthly",paymentMont
hs:12}:at.includes("tap")||at.includes("business")?kt={id:`TAP${Dt.length+1}`,name:"",description:"",certaintyPercentag
e:100,numberOfEmployees:0,costPerEmployeePerMonth:0,paymentStartDate:"",paymentType:"Monthly",contractMonths:12}:at.inc
ludes("compliance")?kt={id:`COMP${Dt.length+1}`,name:"",description:"",certaintyPercentage:100,courseName:"",numberOfTr
ainees:0,pricePerPerson:0,trainingDate:""}:kt={id:`COURSE${Dt.length+1}`,name:"",description:"",certaintyPercentage:100
,courseName:"",numberOfTrainees:0,pricePerPerson:0,trainingDate:""},Ht(ds=>[...ds,kt]),xs(Dt.length)},on=at=>{window.co
nfirm("Are you sure you want to delete this 
deal?")&&(Ht(kt=>kt.filter((us,ds)=>ds!==at)),Ft>=Dt.length-1&&xs(Math.max(0,Dt.length-2)))};if(c)return jsxRuntimeExpo
rts.jsx("div",{className:"client-detail",children:jsxRuntimeExports.jsx("div",{className:"loading-spinner",children:jsx
RuntimeExports.jsx("p",{children:"Loading client dashboard..."})})});if(!h)return 
jsxRuntimeExports.jsxs("div",{className:"client-detail",children:[jsxRuntimeExports.jsx("p",{children:"Client not 
found"}),jsxRuntimeExports.jsx(Link,{to:"/clients",children:"Back to Clients"})]});const ln=_t.reduce((at,kt)=>at+(kt.a
mount||0),0),er=_t.filter(at=>at.status==="Paid").reduce((at,kt)=>at+(kt.amount||0),0),kn=_t.filter(at=>at.status!=="Pa
id"&&at.status!=="Cancelled"),Wn=kn.reduce((at,kt)=>at+(kt.amount||0),0),Fs=kn.filter(at=>at.dueDate?(at.dueDate.toDate
?at.dueDate.toDate():new Date(at.dueDate))<new Date:!1),Pn=Fs.reduce((at,kt)=>at+(kt.amount||0),0),bn=ut.reduce((at,kt)
=>at+(kt.fullYearForecast||0),0),An=ut.reduce((at,kt)=>{var us;return at+(((us=kt.history)==null?void 0:us.currentYearY
TD)||0)},0),dn=Wt.ytdActual.reduce((at,kt)=>at+(kt.total||0),0),Ds=Wt.budget.reduce((at,kt)=>at+(kt.total||0),0),Sn=Wt.
ytd1.reduce((at,kt)=>at+(kt.total||0),0),Zs=(at,kt="")=>{if(!at||at.length===0)return 0;const us=(ls==null?void 
0:ls.ytdMonths)||[];if(us.length===0)return console.warn(`calculateUploadedYtdTotal [${kt}]: No ytdMonths available in 
fyInfo`,{fyInfo:ls}),0;const ds=us.map(In=>In.name);if(kt&&at.length>0){const 
In=at[0],Js=In.monthlyData||In.monthlyValues||{};console.log(`calculateUploadedYtdTotal [${kt}]:`,{ytdMonthNames:ds,rec
ordCount:at.length,sampleMonthDataKeys:Object.keys(Js),sampleMonthDataValues:Js,sampleRecordTotal:In.total})}const 
vn=at.reduce((In,Js)=>{const cn=Js.monthlyData||Js.monthlyValues||{};let Qn=0;return 
ds.forEach(un=>{cn[un]&&(Qn+=cn[un])}),In+Qn},0);return kt&&console.log(`calculateUploadedYtdTotal [${kt}]: YTD Total 
= ${vn}`),vn},zn=Zs(Wt.ytdActual,"ClientDetail-YtdActual"),en=Zs(Wt.budget,"ClientDetail-Budget"),nn=Zs(Wt.ytd1,"Client
Detail-Ytd1"),xn=Wt.ytdActual.length>0||Wt.budget.length>0,$s=Math.max(0,bn-An),Vs=xn?zn:An,gn=Vs+$s,an=jt.filter(at=>a
t.status==="pending"),tr=an.filter(at=>at.dueDate?(at.dueDate.toDate?at.dueDate.toDate():new Date(at.dueDate))<new 
Date:!1),Ws=rt.filter(at=>at.status==="Sent"||at.status==="Pending");return jsxRuntimeExports.jsxs("div",{className:"cl
ient-detail",children:[jsxRuntimeExports.jsxs("div",{className:"client-detail-header",children:[jsxRuntimeExports.jsxs(
"div",{children:[jsxRuntimeExports.jsx(Link,{to:"/clients",className:"back-link",children:"â† Back to 
Clients"}),jsxRuntimeExports.jsx("h1",{children:h.name||h.legalName||"Unnamed 
Client"}),jsxRuntimeExports.jsxs("p",{className:"client-type",children:[h.type||"N/A"," ",h.industry&&`â€¢ ${h.industry
}`]})]}),jsxRuntimeExports.jsxs("div",{className:"header-actions",children:[jsxRuntimeExports.jsx("button",{className:"
financial-btn",onClick:()=>e(`/financial-editor/${s}`),children:"Financial 
Editor"}),jsxRuntimeExports.jsx(Link,{to:`/clients/${s}/edit`,className:"edit-btn",children:"Edit Client"})]})]}),jsxRu
ntimeExports.jsxs("div",{className:"quick-stats-bar",children:[jsxRuntimeExports.jsxs("div",{className:"quick-stat",chi
ldren:[jsxRuntimeExports.jsx("span",{className:"stat-icon",children:"ðŸ“Š"}),jsxRuntimeExports.jsxs("div",{className:"s
tat-content",children:[jsxRuntimeExports.jsx("span",{className:"stat-value",children:pt(xn?zn:An)}),jsxRuntimeExports.j
sx("span",{className:"stat-label",children:"YTD Actual"})]})]}),jsxRuntimeExports.jsxs("div",{className:"quick-stat",ch
ildren:[jsxRuntimeExports.jsx("span",{className:"stat-icon",children:"ðŸ’°"}),jsxRuntimeExports.jsxs("div",{className:"
stat-content",children:[jsxRuntimeExports.jsx("span",{className:"stat-value",children:pt(gn)}),jsxRuntimeExports.jsx("s
pan",{className:"stat-label",children:"Full Year Forecast"})]})]}),Ds>0&&jsxRuntimeExports.jsxs("div",{className:"quick
-stat",children:[jsxRuntimeExports.jsx("span",{className:"stat-icon",children:"ðŸ“‹"}),jsxRuntimeExports.jsxs("div",{cl
assName:"stat-content",children:[jsxRuntimeExports.jsx("span",{className:"stat-value",children:pt(Ds)}),jsxRuntimeExpor
ts.jsx("span",{className:"stat-label",children:"Full Year 
Budget"})]})]}),jsxRuntimeExports.jsxs("div",{className:"quick-stat 
warning",children:[jsxRuntimeExports.jsx("span",{className:"stat-icon",children:"âšï¸"}),jsxRuntimeExports.jsxs("div",
{className:"stat-content",children:[jsxRuntimeExports.jsx("span",{className:"stat-value",children:pt(Wn)}),jsxRuntimeEx
ports.jsx("span",{className:"stat-label",children:"Outstanding"})]})]}),(i==null?void 0:i.id)!=="salesperson"&&jsxRunti
meExports.jsxs("div",{className:"quick-stat",children:[jsxRuntimeExports.jsx("span",{className:"stat-icon",children:"ðŸ
“"}),jsxRuntimeExports.jsxs("div",{className:"stat-content",children:[jsxRuntimeExports.jsx("span",{className:"stat-va
lue",children:an.length}),jsxRuntimeExports.jsx("span",{className:"stat-label",children:"Pending Tasks"})]})]}),jsxRunt
imeExports.jsxs("div",{className:"quick-stat",children:[jsxRuntimeExports.jsx("span",{className:"stat-icon",children:"ð
Ÿ¤"}),jsxRuntimeExports.jsxs("div",{className:"stat-content",children:[jsxRuntimeExports.jsx("span",{className:"stat-v
alue",children:ht.length}),jsxRuntimeExports.jsx("span",{className:"stat-label",children:"Interactions"})]})]})]}),jsxR
untimeExports.jsxs("div",{className:"client-tabs",children:[jsxRuntimeExports.jsx("button",{className:Et==="overview"?"
active":"",onClick:()=>gt("overview"),children:"Overview"}),jsxRuntimeExports.jsx("button",{className:Et==="forecast"?"
active":"",onClick:()=>gt("forecast"),children:"Forecast"}),jsxRuntimeExports.jsx("button",{className:Et==="financials"
?"active":"",onClick:()=>gt("financials"),children:"Invoices & Quotes"}),jsxRuntimeExports.jsxs("button",{className:Et=
=="interactions"?"active":"",onClick:()=>gt("interactions"),children:["Interactions (",ht.length,")"]}),jsxRuntimeExpor
ts.jsxs("button",{className:Et==="comments"?"active":"",onClick:()=>gt("comments"),children:["Comments 
(",st.length,")"]}),(i==null?void 0:i.id)!=="salesperson"&&jsxRuntimeExports.jsxs("button",{className:Et==="tasks"?"act
ive":"",onClick:()=>gt("tasks"),children:["Tasks (",an.length,")"]}),jsxRuntimeExports.jsxs("button",{className:Et==="l
ocations"?"active":"",onClick:()=>gt("locations"),children:["Locations (",Cn.length,")"]}),jsxRuntimeExports.jsxs("butt
on",{className:Et==="contacts"?"active":"",onClick:()=>gt("contacts"),children:["Contacts (",_s.length,")"]}),jsxRuntim
eExports.jsx("button",{className:Et==="legal"?"active":"",onClick:()=>gt("legal"),children:"Legal"}),h.currentLmsUsage=
=="Yes"&&jsxRuntimeExports.jsx("button",{className:Et==="lms"?"active":"",onClick:()=>gt("lms"),children:"LMS Reports"}
)]}),!h.pipelineStatus&&jsxRuntimeExports.jsxs("div",{className:"pipeline-warning-bar",children:[jsxRuntimeExports.jsx(
"span",{className:"warning-icon",children:"âš
ï¸"}),jsxRuntimeExports.jsx("span",{className:"warning-text",children:"This client has no pipeline status set. Please 
assign a pipeline stage."}),jsxRuntimeExports.jsxs("select",{className:"quick-pipeline-select",value:"",onChange:at=>or
(at.target.value),disabled:Cs,children:[jsxRuntimeExports.jsx("option",{value:"",disabled:!0,children:"Set Pipeline Sta
tus..."}),fr.filter(at=>at.id!=="").map(at=>jsxRuntimeExports.jsx("option",{value:at.id,children:at.name},at.id))]})]})
,(()=>{var kt;const at=Ar();return jsxRuntimeExports.jsxs("div",{className:`followup-status-card followup-${at.status}`
,children:[jsxRuntimeExports.jsxs("div",{className:"followup-status-content",children:[jsxRuntimeExports.jsxs("div",{cl
assName:"followup-status-icon",children:[at.status==="overdue"&&"ðŸ”´",at.status==="due-today"&&"ðŸŸ",at.status==="due-
soon"&&"ðŸŸ¡",at.status==="scheduled"&&"ðŸŸ¢",at.status==="none"&&"âšª"]}),jsxRuntimeExports.jsxs("div",{className:"fol
lowup-status-details",children:[jsxRuntimeExports.jsx("div",{className:"followup-status-label",children:"Next Follow-Up
"}),h.nextFollowUpDate?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{class
Name:"followup-status-date",children:[St(h.nextFollowUpDate),at.status==="overdue"&&jsxRuntimeExports.jsxs("span",{clas
sName:"followup-badge overdue",children:[" (Overdue by ",Math.abs(at.daysUntil)," 
days)"]}),at.status==="due-today"&&jsxRuntimeExports.jsx("span",{className:"followup-badge due-today",children:" (Due 
Today)"}),at.status==="due-soon"&&jsxRuntimeExports.jsxs("span",{className:"followup-badge due-soon",children:[" (In 
",at.daysUntil," days)"]})]}),jsxRuntimeExports.jsxs("div",{className:"followup-status-info",children:[jsxRuntimeExport
s.jsx("span",{className:"followup-type-badge",children:((kt=Rn.find(us=>us.value===h.nextFollowUpType))==null?void 0:kt
.label)||"Follow-Up"}),h.nextFollowUpReason&&jsxRuntimeExports.jsx("span",{className:"followup-reason",children:h.nextF
ollowUpReason})]})]}):jsxRuntimeExports.jsxs("div",{className:"followup-status-missing",children:[jsxRuntimeExports.jsx
("span",{className:"warning-text",children:"No follow-up 
scheduled!"}),jsxRuntimeExports.jsx("span",{className:"helper-text",children:"Log an interaction to schedule a follow-u
p"})]})]}),jsxRuntimeExports.jsx("button",{className:"followup-edit-btn",onClick:Ks,children:h.nextFollowUpDate?"Update
":"Set Follow-Up"})]}),Os&&jsxRuntimeExports.jsx("div",{className:"followup-edit-inline",children:jsxRuntimeExports.jsx
s("div",{className:"followup-edit-form-row",children:[jsxRuntimeExports.jsxs("div",{className:"form-group",children:[js
xRuntimeExports.jsx("label",{children:"Date *"}),jsxRuntimeExports.jsx("input",{type:"date",value:js.date,onChange:us=>
es(ds=>({...ds,date:us.target.value})),min:new Date().toISOString().split("T")[0]})]}),jsxRuntimeExports.jsxs("div",{cl
assName:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Action *"}),jsxRuntimeExports.jsx("select",{val
ue:js.type,onChange:us=>es(ds=>({...ds,type:us.target.value})),children:Rn.map(us=>jsxRuntimeExports.jsx("option",{valu
e:us.value,children:us.label},us.value))})]}),jsxRuntimeExports.jsxs("div",{className:"form-group 
flex-grow",children:[jsxRuntimeExports.jsx("label",{children:"Reason *"}),jsxRuntimeExports.jsx("input",{type:"text",va
lue:js.reason,onChange:us=>es(ds=>({...ds,reason:us.target.value})),placeholder:"E.g., Follow up on proposal, Check dec
ision..."})]}),jsxRuntimeExports.jsxs("div",{className:"form-actions",children:[jsxRuntimeExports.jsx("button",{classNa
me:"cancel-btn",onClick:()=>qt(!1),disabled:vs,children:"Cancel"}),jsxRuntimeExports.jsx("button",{className:"save-btn"
,onClick:as,disabled:vs,children:vs?"Saving...":"Save"})]})]})})]})})(),jsxRuntimeExports.jsx("div",{className:"status-
bar",children:jsxRuntimeExports.jsxs("div",{className:"status-info",children:[jsxRuntimeExports.jsxs("div",{className:"
status-item",children:[jsxRuntimeExports.jsx("span",{className:"status-label",children:"Status:"}),jsxRuntimeExports.js
x("span",{className:`status-badge status-${(sr=h.status)==null?void 0:sr.toLowerCase()}`,children:h.status||"N/A"})]}),
jsxRuntimeExports.jsxs("div",{className:"status-item",children:[jsxRuntimeExports.jsx("span",{className:"status-label",
children:"Pipeline:"}),jsxRuntimeExports.jsx("select",{className:"pipeline-status-select",value:h.pipelineStatus||"",on
Change:at=>or(at.target.value),disabled:Cs,style:{backgroundColor:br(h.pipelineStatus)},children:fr.map(at=>jsxRuntimeE
xports.jsx("option",{value:at.id,children:at.name},at.id))})]}),jsxRuntimeExports.jsxs("div",{className:"status-item",c
hildren:[jsxRuntimeExports.jsx("span",{className:"status-label",children:"Last Contact:"}),nr?jsxRuntimeExports.jsxs("d
iv",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[jsxRuntimeExports.jsx("input",{type:"date",value:Vn
,onChange:at=>Yn(at.target.value),disabled:Kn,style:{padding:"4px 8px",fontSize:"14px"}}),jsxRuntimeExports.jsx("button
",{className:"btn-save-small",onClick:ur,disabled:Kn,children:Kn?"Saving...":"Save"}),jsxRuntimeExports.jsx("button",{c
lassName:"btn-cancel-small",onClick:()=>{if(Ls(!1),h.lastContact){const 
at=h.lastContact.toDate?h.lastContact.toDate():new Date(h.lastContact);Yn(at.toISOString().split("T")[0])}else Yn("")},
disabled:Kn,children:"Cancel"})]}):jsxRuntimeExports.jsxs("span",{className:"status-value",style:{display:"flex",gap:"8
px",alignItems:"center"},children:[St(h.lastContact),jsxRuntimeExports.jsx("button",{className:"btn-edit-small",onClick
:()=>Ls(!0),title:"Edit last contact date",children:"âœï¸"})]})]}),jsxRuntimeExports.jsxs("div",{className:"status-it
em",children:[jsxRuntimeExports.jsx("span",{className:"status-label",children:"Account Owner:"}),jsxRuntimeExports.jsx(
"span",{className:"status-value",children:rn(h.assignedSalesPerson)})]}),jsxRuntimeExports.jsxs("div",{className:"statu
s-item",children:[jsxRuntimeExports.jsx("span",{className:"status-label",children:"FY End:"}),jsxRuntimeExports.jsx("sp
an",{className:"status-value",children:h.financialYearEnd||"February"})]}),h.sharePointFolderLink&&jsxRuntimeExports.js
x("div",{className:"status-item",children:jsxRuntimeExports.jsx("a",{href:h.sharePointFolderLink,target:"_blank",rel:"n
oopener noreferrer",className:"sharepoint-link",children:"ðŸ“ SharePoint Folder"})})]})}),Et==="overview"&&jsxRuntimeE
xports.jsxs("div",{className:"tab-content",children:[xn&&jsxRuntimeExports.jsxs("div",{className:"financial-summary-sec
tion",children:[jsxRuntimeExports.jsxs("h2",{className:"section-title",children:["Financial Summary - FY 
",ls==null?void 0:ls.currentFinancialYear]}),jsxRuntimeExports.jsxs("div",{className:"financial-cards-row",children:[js
xRuntimeExports.jsxs("div",{className:"financial-card actual",children:[jsxRuntimeExports.jsxs("div",{className:"card-h
eader",children:[jsxRuntimeExports.jsx("h4",{children:"Actual 
YTD"}),jsxRuntimeExports.jsx("span",{className:"year-badge",children:ls==null?void 0:ls.currentFinancialYear})]}),jsxRu
ntimeExports.jsx("div",{className:"card-value",children:pt(zn)}),jsxRuntimeExports.jsx("div",{className:"card-label",ch
ildren:Mt==null?void 0:Mt.reportingMonth})]}),jsxRuntimeExports.jsxs("div",{className:"financial-card budget",children:
[jsxRuntimeExports.jsxs("div",{className:"card-header",children:[jsxRuntimeExports.jsx("h4",{children:"Budget 
YTD"}),jsxRuntimeExports.jsx("span",{className:"year-badge",children:ls==null?void 0:ls.currentFinancialYear})]}),jsxRu
ntimeExports.jsx("div",{className:"card-value",children:pt(en)}),jsxRuntimeExports.jsx("div",{className:"card-label",ch
ildren:Mt==null?void 0:Mt.reportingMonth})]}),jsxRuntimeExports.jsxs("div",{className:"financial-card prior",children:[
jsxRuntimeExports.jsxs("div",{className:"card-header",children:[jsxRuntimeExports.jsx("h4",{children:"Prior Year 
YTD"}),jsxRuntimeExports.jsx("span",{className:"year-badge",children:calculateFinancialYear(ls==null?void 0:ls.currentF
inancialYear,-1)})]}),jsxRuntimeExports.jsx("div",{className:"card-value",children:pt(nn)}),jsxRuntimeExports.jsx("div"
,{className:"card-label",children:Mt==null?void 0:Mt.reportingMonth})]})]}),jsxRuntimeExports.jsxs("div",{className:"co
mparison-row",children:[jsxRuntimeExports.jsxs("div",{className:`comparison-card 
${zn>=en?"positive":"negative"}`,children:[jsxRuntimeExports.jsx("span",{className:"comparison-label",children:"Actual 
YTD vs Budget YTD"}),jsxRuntimeExports.jsx("span",{className:"comparison-value",children:en>0?`${zn>=en?"+":""}${((zn-e
n)/en*100).toFixed(1)}%`:"N/A"}),jsxRuntimeExports.jsx("span",{className:"comparison-detail",children:pt(zn-en)})]}),js
xRuntimeExports.jsxs("div",{className:`comparison-card 
${zn>=nn?"positive":"negative"}`,children:[jsxRuntimeExports.jsx("span",{className:"comparison-label",children:"Actual 
YTD vs Prior Year YTD"}),jsxRuntimeExports.jsx("span",{className:"comparison-value",children:nn>0?`${zn>=nn?"+":""}${((
zn-nn)/nn*100).toFixed(1)}%`:"N/A"}),jsxRuntimeExports.jsx("span",{className:"comparison-detail",children:pt(zn-nn)})]}
)]}),jsxRuntimeExports.jsx("h3",{className:"subsection-title",children:"Full Year Totals"}),jsxRuntimeExports.jsxs("div
",{className:"financial-cards-row",children:[jsxRuntimeExports.jsxs("div",{className:"financial-card actual",children:[
jsxRuntimeExports.jsxs("div",{className:"card-header",children:[jsxRuntimeExports.jsx("h4",{children:"Actual Full 
Year"}),jsxRuntimeExports.jsx("span",{className:"year-badge",children:ls==null?void 0:ls.currentFinancialYear})]}),jsxR
untimeExports.jsx("div",{className:"card-value",children:pt(dn)}),jsxRuntimeExports.jsxs("div",{className:"card-label",
children:[Wt.ytdActual.length," records"]})]}),jsxRuntimeExports.jsxs("div",{className:"financial-card budget",children
:[jsxRuntimeExports.jsxs("div",{className:"card-header",children:[jsxRuntimeExports.jsx("h4",{children:"Budget Full 
Year"}),jsxRuntimeExports.jsx("span",{className:"year-badge",children:ls==null?void 0:ls.currentFinancialYear})]}),jsxR
untimeExports.jsx("div",{className:"card-value",children:pt(Ds)}),jsxRuntimeExports.jsxs("div",{className:"card-label",
children:[Wt.budget.length," records"]})]}),jsxRuntimeExports.jsxs("div",{className:"financial-card prior",children:[js
xRuntimeExports.jsxs("div",{className:"card-header",children:[jsxRuntimeExports.jsx("h4",{children:"Prior Year 
Full"}),jsxRuntimeExports.jsx("span",{className:"year-badge",children:calculateFinancialYear(ls==null?void 0:ls.current
FinancialYear,-1)})]}),jsxRuntimeExports.jsx("div",{className:"card-value",children:pt(Sn)}),jsxRuntimeExports.jsxs("di
v",{className:"card-label",children:[Wt.ytd1.length," records"]})]})]}),jsxRuntimeExports.jsxs("div",{className:"compar
ison-row",children:[jsxRuntimeExports.jsxs("div",{className:`comparison-card 
${dn>=Ds?"positive":"negative"}`,children:[jsxRuntimeExports.jsx("span",{className:"comparison-label",children:"Actual 
vs Budget"}),jsxRuntimeExports.jsx("span",{className:"comparison-value",children:Ds>0?`${dn>=Ds?"+":""}${((dn-Ds)/Ds*10
0).toFixed(1)}%`:"N/A"}),jsxRuntimeExports.jsx("span",{className:"comparison-detail",children:pt(dn-Ds)})]}),jsxRuntime
Exports.jsxs("div",{className:`comparison-card 
${dn>=Sn?"positive":"negative"}`,children:[jsxRuntimeExports.jsx("span",{className:"comparison-label",children:"Actual 
vs Prior Year"}),jsxRuntimeExports.jsx("span",{className:"comparison-value",children:Sn>0?`${dn>=Sn?"+":""}${((dn-Sn)/S
n*100).toFixed(1)}%`:"N/A"}),jsxRuntimeExports.jsx("span",{className:"comparison-detail",children:pt(dn-Sn)})]})]})]}),
jsxRuntimeExports.jsxs("div",{className:"overview-grid",children:[jsxRuntimeExports.jsxs("div",{className:"info-card",c
hildren:[jsxRuntimeExports.jsx("h3",{children:"Client Information"}),jsxRuntimeExports.jsxs("div",{className:"info-grid
",children:[jsxRuntimeExports.jsxs("div",{className:"info-item",children:[jsxRuntimeExports.jsx("label",{children:"Lega
l Name"}),jsxRuntimeExports.jsx("span",{children:h.legalName||"N/A"})]}),jsxRuntimeExports.jsxs("div",{className:"info-
item",children:[jsxRuntimeExports.jsx("label",{children:"Trading Name"}),jsxRuntimeExports.jsx("span",{children:h.tradi
ngName||"N/A"})]}),jsxRuntimeExports.jsxs("div",{className:"info-item",children:[jsxRuntimeExports.jsx("label",{childre
n:"VAT Number"}),jsxRuntimeExports.jsx("span",{children:h.vatNumber||"N/A"})]}),jsxRuntimeExports.jsxs("div",{className
:"info-item",children:[jsxRuntimeExports.jsx("label",{children:"Industry"}),jsxRuntimeExports.jsx("span",{children:h.in
dustry||"N/A"})]}),jsxRuntimeExports.jsxs("div",{className:"info-item",children:[jsxRuntimeExports.jsx("label",{childre
n:"Sector"}),jsxRuntimeExports.jsx("span",{children:h.sector||"N/A"})]}),jsxRuntimeExports.jsxs("div",{className:"info-
item",children:[jsxRuntimeExports.jsx("label",{children:"SETA"}),jsxRuntimeExports.jsx("span",{children:h.seta||"N/A"})
]}),jsxRuntimeExports.jsxs("div",{className:"info-item",children:[jsxRuntimeExports.jsx("label",{children:"B-BBEE Level
"}),jsxRuntimeExports.jsx("span",{children:h.bbbeeLevel||"N/A"})]})]})]}),_s.length>0&&jsxRuntimeExports.jsxs("div",{cl
assName:"info-card",children:[jsxRuntimeExports.jsxs("h3",{children:["Contacts (",_s.length,")"]}),jsxRuntimeExports.js
xs("div",{className:"contacts-minimal-list",children:[_s.slice(0,3).map(at=>jsxRuntimeExports.jsxs("div",{className:"co
ntact-minimal-item",children:[jsxRuntimeExports.jsxs("strong",{children:[at.firstName," 
",at.lastName]}),at.jobTitle&&jsxRuntimeExports.jsxs("span",{children:[" - 
",at.jobTitle]}),at.isMainContact&&jsxRuntimeExports.jsx("span",{className:"badge-minimal 
main",children:"Main"}),at.isDecisionMaker&&jsxRuntimeExports.jsx("span",{className:"badge-minimal 
dm",children:"DM"})]},at.id)),_s.length>3&&jsxRuntimeExports.jsxs("div",{className:"contact-minimal-item 
more",children:["+",_s.length-3," more 
contact",_s.length-3>1?"s":""]})]})]}),jsxRuntimeExports.jsxs("div",{className:"info-card 
alerts-card",children:[jsxRuntimeExports.jsx("h3",{children:"Outstanding Items"}),jsxRuntimeExports.jsxs("div",{classNa
me:"alerts-list",children:[Pn>0&&jsxRuntimeExports.jsxs("div",{className:"alert-item alert-danger",children:[jsxRuntime
Exports.jsx("span",{className:"alert-icon",children:"ðŸ”´"}),jsxRuntimeExports.jsxs("div",{className:"alert-content",ch
ildren:[jsxRuntimeExports.jsxs("strong",{children:[Fs.length," Overdue 
Invoice",Fs.length!==1?"s":""]}),jsxRuntimeExports.jsxs("span",{children:["Total: 
",pt(Pn)]})]})]}),kn.length>0&&jsxRuntimeExports.jsxs("div",{className:"alert-item alert-warning",children:[jsxRuntimeE
xports.jsx("span",{className:"alert-icon",children:"ðŸŸ¡"}),jsxRuntimeExports.jsxs("div",{className:"alert-content",chi
ldren:[jsxRuntimeExports.jsxs("strong",{children:[kn.length," Outstanding 
Invoice",kn.length!==1?"s":""]}),jsxRuntimeExports.jsxs("span",{children:["Total: 
",pt(Wn)]})]})]}),tr.length>0&&(i==null?void 
0:i.id)!=="salesperson"&&jsxRuntimeExports.jsxs("div",{className:"alert-item alert-danger",children:[jsxRuntimeExports.
jsx("span",{className:"alert-icon",children:"â°"}),jsxRuntimeExports.jsxs("div",{className:"alert-content",children:[j
sxRuntimeExports.jsxs("strong",{children:[tr.length," Overdue 
Task",tr.length!==1?"s":""]}),jsxRuntimeExports.jsx("span",{children:"Requires immediate 
attention"})]})]}),Ws.length>0&&jsxRuntimeExports.jsxs("div",{className:"alert-item alert-info",children:[jsxRuntimeExp
orts.jsx("span",{className:"alert-icon",children:"ðŸ“‹"}),jsxRuntimeExports.jsxs("div",{className:"alert-content",child
ren:[jsxRuntimeExports.jsxs("strong",{children:[Ws.length," Pending 
Quote",Ws.length!==1?"s":""]}),jsxRuntimeExports.jsx("span",{children:"Awaiting client 
response"})]})]}),Pn===0&&kn.length===0&&((i==null?void 
0:i.id)==="salesperson"||tr.length===0)&&Ws.length===0&&jsxRuntimeExports.jsxs("div",{className:"alert-item alert-succe
ss",children:[jsxRuntimeExports.jsx("span",{className:"alert-icon",children:"âœ…"}),jsxRuntimeExports.jsxs("div",{class
Name:"alert-content",children:[jsxRuntimeExports.jsx("strong",{children:"All 
Clear"}),jsxRuntimeExports.jsx("span",{children:"No outstanding items"})]})]})]})]}),jsxRuntimeExports.jsxs("div",{clas
sName:"info-card",children:[jsxRuntimeExports.jsx("h3",{children:"Recent 
Activity"}),jsxRuntimeExports.jsxs("div",{className:"recent-activity-list",children:[ht.slice(0,5).map(at=>{var 
kt;return jsxRuntimeExports.jsxs("div",{className:"activity-item",children:[jsxRuntimeExports.jsx("span",{className:`ac
tivity-type type-${at.type}`,children:(kt=at.type)==null?void 
0:kt.toUpperCase()}),jsxRuntimeExports.jsx("span",{className:"activity-summary",children:at.summary||"No summary"}),jsx
RuntimeExports.jsx("span",{className:"activity-date",children:Vt(at.timestamp)})]},at.id)}),ht.length===0&&jsxRuntimeEx
ports.jsx("p",{className:"no-data",children:"No recent activity"})]})]})]}),h.notes&&jsxRuntimeExports.jsxs("div",{clas
sName:"notes-section",children:[jsxRuntimeExports.jsx("h3",{children:"Notes"}),jsxRuntimeExports.jsx("p",{children:h.no
tes})]}),Cn.length>0&&jsxRuntimeExports.jsxs("div",{className:"locations-overview-section",children:[jsxRuntimeExports.
jsx("h3",{children:"Client Locations"}),jsxRuntimeExports.jsx("div",{className:"locations-grid",children:Cn.map(at=>jsx
RuntimeExports.jsxs("div",{className:"location-card",children:[jsxRuntimeExports.jsxs("div",{className:"location-name",
children:[jsxRuntimeExports.jsx("strong",{children:at.name}),at.isHeadOffice&&jsxRuntimeExports.jsx("span",{className:"
head-office-badge",children:"Head Office"})]}),at.address&&jsxRuntimeExports.jsx("div",{className:"location-detail",chi
ldren:at.address}),(at.city||at.province)&&jsxRuntimeExports.jsxs("div",{className:"location-detail",children:[at.city,
at.city&&at.province&&", ",at.province,at.postalCode&&` ${at.postalCode}`]})]},at.id))})]})]}),Et==="forecast"&&jsxRunt
imeExports.jsxs("div",{className:"tab-content",children:[jsxRuntimeExports.jsxs("div",{className:"forecast-header",chil
dren:[jsxRuntimeExports.jsxs("h2",{children:["Financial Forecast - FY ",(ls==null?void 0:ls.currentFinancialYear)||"N/A
"]}),jsxRuntimeExports.jsx("button",{className:"edit-forecast-btn",onClick:()=>e(`/financial-editor/${s}`),children:"Ed
it Forecast"})]}),jsxRuntimeExports.jsxs("div",{className:"forecast-summary-cards",children:[jsxRuntimeExports.jsxs("di
v",{className:"forecast-card",children:[jsxRuntimeExports.jsx("span",{className:"forecast-label",children:"YTD Actual"}
),jsxRuntimeExports.jsx("span",{className:"forecast-value",children:pt(Vs)})]}),jsxRuntimeExports.jsxs("div",{className
:"forecast-card",children:[jsxRuntimeExports.jsx("span",{className:"forecast-label",children:"Remaining Forecast"}),jsx
RuntimeExports.jsx("span",{className:"forecast-value",children:pt($s)})]}),jsxRuntimeExports.jsxs("div",{className:"for
ecast-card highlight",children:[jsxRuntimeExports.jsx("span",{className:"forecast-label",children:"Full Year Forecast"}
),jsxRuntimeExports.jsx("span",{className:"forecast-value",children:pt(gn)})]}),jsxRuntimeExports.jsxs("div",{className
:"forecast-card",children:[jsxRuntimeExports.jsx("span",{className:"forecast-label",children:"Pipeline Value"}),jsxRunt
imeExports.jsx("span",{className:"forecast-value",children:pt(h.pipelineValue||0)})]})]}),jsxRuntimeExports.jsxs("div",
{className:"forecast-by-product",children:[jsxRuntimeExports.jsxs("div",{className:"forecast-header-inline",children:[j
sxRuntimeExports.jsx("h3",{children:"Forecast by Product 
Line"}),jsxRuntimeExports.jsx("span",{className:"click-hint",children:"Click any product line to edit calculations"})]}
),ut.length>0?jsxRuntimeExports.jsxs("table",{className:"data-table",children:[jsxRuntimeExports.jsx("thead",{children:
jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("th",{children:"Product 
Line"}),jsxRuntimeExports.jsx("th",{children:"Previous 
Year"}),jsxRuntimeExports.jsx("th",{children:"YTD"}),jsxRuntimeExports.jsx("th",{children:"Forecast 
Remaining"}),jsxRuntimeExports.jsx("th",{children:"Full 
Year"}),jsxRuntimeExports.jsx("th",{children:"Growth"})]})}),jsxRuntimeExports.jsxs("tbody",{children:[ut.map(at=>{var 
Js,cn;const kt=((Js=at.history)==null?void 0:Js.yearMinus1)||0,us=((cn=at.history)==null?void 
0:cn.currentYearYTD)||0,ds=at.fullYearForecast||0,vn=ds-us,In=kt>0?((ds-kt)/kt*100).toFixed(1):"N/A";return 
jsxRuntimeExports.jsxs("tr",{className:"clickable-row",onClick:()=>Kt(at),title:"Click to edit forecast details",childr
en:[jsxRuntimeExports.jsx("td",{children:jsxRuntimeExports.jsx("strong",{className:"product-line-link",children:at.prod
uctLine})}),jsxRuntimeExports.jsx("td",{children:pt(kt)}),jsxRuntimeExports.jsx("td",{children:pt(us)}),jsxRuntimeExpor
ts.jsx("td",{children:pt(vn)}),jsxRuntimeExports.jsx("td",{children:jsxRuntimeExports.jsx("strong",{children:pt(ds)})})
,jsxRuntimeExports.jsx("td",{children:typeof In=="number"||In!=="N/A"?jsxRuntimeExports.jsxs("span",{className:parseFlo
at(In)>=0?"growth-positive":"growth-negative",children:[parseFloat(In)>=0?"+":"",In,"%"]}):jsxRuntimeExports.jsx("span"
,{className:"growth-na",children:"N/A"})})]},at.id)}),jsxRuntimeExports.jsxs("tr",{className:"totals-row",children:[jsx
RuntimeExports.jsx("td",{children:jsxRuntimeExports.jsx("strong",{children:"TOTAL"})}),jsxRuntimeExports.jsx("td",{chil
dren:jsxRuntimeExports.jsx("strong",{children:pt(ut.reduce((at,kt)=>{var us;return at+(((us=kt.history)==null?void 0:us
.yearMinus1)||0)},0))})}),jsxRuntimeExports.jsx("td",{children:jsxRuntimeExports.jsx("strong",{children:pt(Vs)})}),jsxR
untimeExports.jsx("td",{children:jsxRuntimeExports.jsx("strong",{children:pt($s)})}),jsxRuntimeExports.jsx("td",{childr
en:jsxRuntimeExports.jsx("strong",{children:pt(gn)})}),jsxRuntimeExports.jsx("td",{})]})]})]}):jsxRuntimeExports.jsxs("
div",{className:"no-data-card",children:[jsxRuntimeExports.jsx("p",{children:"No forecast data available for this 
client."}),jsxRuntimeExports.jsx("button",{onClick:()=>e(`/financial-editor/${s}`),children:"Create Forecast"})]})]}),x
t.length>0&&jsxRuntimeExports.jsxs("div",{className:"deals-section",children:[jsxRuntimeExports.jsx("h3",{children:"Act
ive Deals in Pipeline"}),jsxRuntimeExports.jsxs("table",{className:"data-table",children:[jsxRuntimeExports.jsx("thead"
,{children:jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("th",{children:"Deal Name"}),jsxRuntimeExports.
jsx("th",{children:"Product"}),jsxRuntimeExports.jsx("th",{children:"Value"}),jsxRuntimeExports.jsx("th",{children:"Sta
ge"}),jsxRuntimeExports.jsx("th",{children:"Probability"}),jsxRuntimeExports.jsx("th",{children:"Expected 
Close"})]})}),jsxRuntimeExports.jsx("tbody",{children:xt.map(at=>{var kt;return 
jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("td",{children:at.name||"Unnamed Deal"}),jsxRuntimeExports
.jsx("td",{children:at.product||"N/A"}),jsxRuntimeExports.jsx("td",{children:pt(at.value)}),jsxRuntimeExports.jsx("td",
{children:jsxRuntimeExports.jsx("span",{className:`stage-badge stage-${at.stage}`,children:((kt=at.stage)==null?void 
0:kt.replace("-"," "))||"N/A"})}),jsxRuntimeExports.jsxs("td",{children:[at.probability||0,"%"]}),jsxRuntimeExports.jsx
("td",{children:St(at.expectedCloseDate)})]},at.id)})})]})]})]}),Et==="financials"&&jsxRuntimeExports.jsxs("div",{class
Name:"tab-content",children:[jsxRuntimeExports.jsxs("div",{className:"financial-overview",children:[jsxRuntimeExports.j
sx("h2",{children:"Financial Summary"}),jsxRuntimeExports.jsxs("div",{className:"financial-cards",children:[jsxRuntimeE
xports.jsxs("div",{className:"financial-card",children:[jsxRuntimeExports.jsx("span",{className:"card-label",children:"
Total Invoiced"}),jsxRuntimeExports.jsx("span",{className:"card-value",children:pt(ln)})]}),jsxRuntimeExports.jsxs("div
",{className:"financial-card",children:[jsxRuntimeExports.jsx("span",{className:"card-label",children:"Total 
Paid"}),jsxRuntimeExports.jsx("span",{className:"card-value positive",children:pt(er)})]}),jsxRuntimeExports.jsxs("div"
,{className:"financial-card",children:[jsxRuntimeExports.jsx("span",{className:"card-label",children:"Outstanding"}),js
xRuntimeExports.jsx("span",{className:"card-value warning",children:pt(Wn)})]}),jsxRuntimeExports.jsxs("div",{className
:"financial-card",children:[jsxRuntimeExports.jsx("span",{className:"card-label",children:"Overdue"}),jsxRuntimeExports
.jsx("span",{className:"card-value 
danger",children:pt(Pn)})]})]})]}),(Wt.budget.length>0||Wt.ytd1.length>0)&&(()=>{const at=((ls==null?void 
0:ls.ytdMonths)||[]).map(Bs=>Bs.name),kt=at.length,us=Bs=>!Bs||at.length===0?0:Bs.reduce((pn,ir)=>{const 
jr=ir.monthlyData||ir.monthlyValues||{};let vr=0;return at.forEach(Xn=>{vr+=jr[Xn]||0}),pn+vr},0),ds=us(Wt.budget),vn=u
s(Wt.ytd1),In=us(Wt.ytd2),Js=us(Wt.ytd3),cn=Wt.budget.reduce((Bs,pn)=>Bs+(pn.total||0),0),Qn=Wt.ytd1.reduce((Bs,pn)=>Bs
+(pn.total||0),0),un=Wt.ytd2.reduce((Bs,pn)=>Bs+(pn.total||0),0),Fn=Wt.ytd3.reduce((Bs,pn)=>Bs+(pn.total||0),0),_n=(Mt=
=null?void 0:Mt.reportingMonth)||"February";return ls!=null&&ls.reportingFyMonth,jsxRuntimeExports.jsxs("div",{classNam
e:"budget-section",children:[jsxRuntimeExports.jsxs("h2",{children:["Year-to-Date (YTD) - ",_n]}),jsxRuntimeExports.jsx
s("div",{className:"financial-cards",children:[jsxRuntimeExports.jsxs("div",{className:"financial-card 
budget",children:[jsxRuntimeExports.jsxs("span",{className:"card-label",children:["Budget YTD ",Mt==null?void 0:Mt.curr
entFinancialYear]}),jsxRuntimeExports.jsx("span",{className:"card-value",children:pt(ds)})]}),jsxRuntimeExports.jsxs("d
iv",{className:"financial-card ytd1",children:[jsxRuntimeExports.jsx("span",{className:"card-label",children:"Prior 
Year YTD"}),jsxRuntimeExports.jsx("span",{className:"card-value",children:pt(vn)})]}),jsxRuntimeExports.jsxs("div",{cla
ssName:"financial-card ytd2",children:[jsxRuntimeExports.jsx("span",{className:"card-label",children:"2 Years Ago YTD"}
),jsxRuntimeExports.jsx("span",{className:"card-value",children:pt(In)})]}),jsxRuntimeExports.jsxs("div",{className:"fi
nancial-card ytd3",children:[jsxRuntimeExports.jsx("span",{className:"card-label",children:"3 Years Ago YTD"}),jsxRunti
meExports.jsx("span",{className:"card-value",children:pt(Js)})]})]}),jsxRuntimeExports.jsx("h2",{style:{marginTop:"24px
"},children:"Full Year Totals"}),jsxRuntimeExports.jsxs("div",{className:"financial-cards",children:[jsxRuntimeExports.
jsxs("div",{className:"financial-card 
budget",children:[jsxRuntimeExports.jsxs("span",{className:"card-label",children:["Budget Full Year ",Mt==null?void 0:M
t.currentFinancialYear]}),jsxRuntimeExports.jsx("span",{className:"card-value",children:pt(cn)})]}),jsxRuntimeExports.j
sxs("div",{className:"financial-card 
ytd1",children:[jsxRuntimeExports.jsx("span",{className:"card-label",children:"Prior Year Full"}),jsxRuntimeExports.jsx
("span",{className:"card-value",children:pt(Qn)})]}),jsxRuntimeExports.jsxs("div",{className:"financial-card 
ytd2",children:[jsxRuntimeExports.jsx("span",{className:"card-label",children:"2 Years Ago Full"}),jsxRuntimeExports.js
x("span",{className:"card-value",children:pt(un)})]}),jsxRuntimeExports.jsxs("div",{className:"financial-card 
ytd3",children:[jsxRuntimeExports.jsx("span",{className:"card-label",children:"3 Years Ago Full"}),jsxRuntimeExports.js
x("span",{className:"card-value",children:pt(Fn)})]})]}),Wt.budget.length>0&&jsxRuntimeExports.jsxs("div",{className:"b
udget-by-product",children:[jsxRuntimeExports.jsx("h3",{children:"Full Year by Product Line"}),jsxRuntimeExports.jsxs("
table",{className:"data-table",children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{children:
[jsxRuntimeExports.jsx("th",{children:"Product 
Line"}),jsxRuntimeExports.jsx("th",{children:"Budget"}),jsxRuntimeExports.jsx("th",{children:"Prior 
Year"}),jsxRuntimeExports.jsx("th",{children:"2 Years Ago"}),jsxRuntimeExports.jsx("th",{children:"3 Years 
Ago"})]})}),jsxRuntimeExports.jsx("tbody",{children:[...new Set([...Wt.budget.map(Bs=>Bs.productLine),...Wt.ytd1.map(Bs
=>Bs.productLine),...Wt.ytd2.map(Bs=>Bs.productLine),...Wt.ytd3.map(Bs=>Bs.productLine)])].filter(Boolean).map(Bs=>jsxR
untimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("td",{children:Bs}),jsxRuntimeExports.jsx("td",{children:pt(Wt
.budget.filter(pn=>pn.productLine===Bs).reduce((pn,ir)=>pn+(ir.total||0),0))}),jsxRuntimeExports.jsx("td",{children:pt(
Wt.ytd1.filter(pn=>pn.productLine===Bs).reduce((pn,ir)=>pn+(ir.total||0),0))}),jsxRuntimeExports.jsx("td",{children:pt(
Wt.ytd2.filter(pn=>pn.productLine===Bs).reduce((pn,ir)=>pn+(ir.total||0),0))}),jsxRuntimeExports.jsx("td",{children:pt(
Wt.ytd3.filter(pn=>pn.productLine===Bs).reduce((pn,ir)=>pn+(ir.total||0),0))})]},Bs))}),jsxRuntimeExports.jsx("tfoot",{
children:jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("th",{children:"Total"}),jsxRuntimeExports.jsx("t
h",{children:pt(cn)}),jsxRuntimeExports.jsx("th",{children:pt(Qn)}),jsxRuntimeExports.jsx("th",{children:pt(un)}),jsxRu
ntimeExports.jsx("th",{children:pt(Fn)})]})})]})]})]})})(),jsxRuntimeExports.jsxs("div",{className:"recent-section",chi
ldren:[jsxRuntimeExports.jsxs("h2",{children:["Quotes (",rt.length,")"]}),rt.length>0?jsxRuntimeExports.jsxs("table",{c
lassName:"data-table",children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{children:[jsxRunti
meExports.jsx("th",{children:"Quote Number"}),jsxRuntimeExports.jsx("th",{children:"Product"}),jsxRuntimeExports.jsx("t
h",{children:"Date"}),jsxRuntimeExports.jsx("th",{children:"Amount"}),jsxRuntimeExports.jsx("th",{children:"Valid 
Until"}),jsxRuntimeExports.jsx("th",{children:"Status"})]})}),jsxRuntimeExports.jsx("tbody",{children:rt.map(at=>{var 
kt;return jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("td",{children:at.quoteNumber||at.id}),jsxRuntim
eExports.jsx("td",{children:at.product||"N/A"}),jsxRuntimeExports.jsx("td",{children:St(at.date)}),jsxRuntimeExports.js
x("td",{children:pt(at.amount)}),jsxRuntimeExports.jsx("td",{children:St(at.validUntil)}),jsxRuntimeExports.jsx("td",{c
hildren:jsxRuntimeExports.jsx("span",{className:`status-badge status-${(kt=at.status)==null?void 0:kt.toLowerCase()}`,c
hildren:at.status||"N/A"})})]},at.id)})})]}):jsxRuntimeExports.jsx("p",{className:"no-data",children:"No quotes found"}
)]}),jsxRuntimeExports.jsxs("div",{className:"recent-section",children:[jsxRuntimeExports.jsxs("h2",{children:["Invoice
s (",_t.length,")"]}),_t.length>0?jsxRuntimeExports.jsxs("table",{className:"data-table",children:[jsxRuntimeExports.js
x("thead",{children:jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("th",{children:"Invoice 
Number"}),jsxRuntimeExports.jsx("th",{children:"Product"}),jsxRuntimeExports.jsx("th",{children:"Issue 
Date"}),jsxRuntimeExports.jsx("th",{children:"Amount"}),jsxRuntimeExports.jsx("th",{children:"Due 
Date"}),jsxRuntimeExports.jsx("th",{children:"Status"})]})}),jsxRuntimeExports.jsx("tbody",{children:_t.map(at=>{var 
us;const kt=at.status!=="Paid"&&at.dueDate&&(at.dueDate.toDate?at.dueDate.toDate():new Date(at.dueDate))<new 
Date;return jsxRuntimeExports.jsxs("tr",{className:kt?"overdue-row":"",children:[jsxRuntimeExports.jsx("td",{children:a
t.invoiceNumber||at.id}),jsxRuntimeExports.jsx("td",{children:at.product||"N/A"}),jsxRuntimeExports.jsx("td",{children:
St(at.issueDate)}),jsxRuntimeExports.jsx("td",{children:pt(at.amount)}),jsxRuntimeExports.jsx("td",{className:kt?"overd
ue-text":"",children:St(at.dueDate)}),jsxRuntimeExports.jsx("td",{children:jsxRuntimeExports.jsx("span",{className:`sta
tus-badge status-${(us=at.status)==null?void 0:us.toLowerCase()} ${kt?"overdue":""}`,children:kt?"OVERDUE":at.status||"
N/A"})})]},at.id)})})]}):jsxRuntimeExports.jsx("p",{className:"no-data",children:"No invoices found"})]})]}),Et==="inte
ractions"&&jsxRuntimeExports.jsxs("div",{className:"tab-content",children:[jsxRuntimeExports.jsx(InteractionCapture,{cl
ientId:s,client:h,contacts:_s,onInteractionCreated:Us}),jsxRuntimeExports.jsx("div",{className:"interactions-filters",c
hildren:jsxRuntimeExports.jsxs("select",{value:ss.type,onChange:at=>ys({...ss,type:at.target.value}),children:[jsxRunti
meExports.jsx("option",{value:"all",children:"All Types"}),jsxRuntimeExports.jsx("option",{value:"call",children:"Call"
}),jsxRuntimeExports.jsx("option",{value:"meeting",children:"Meeting"}),jsxRuntimeExports.jsx("option",{value:"email",c
hildren:"Email"}),jsxRuntimeExports.jsx("option",{value:"whatsapp",children:"WhatsApp"}),jsxRuntimeExports.jsx("option"
,{value:"teams",children:"Teams"}),jsxRuntimeExports.jsx("option",{value:"sms",children:"SMS"}),jsxRuntimeExports.jsx("
option",{value:"other",children:"Other"})]})}),jsxRuntimeExports.jsx("div",{className:"interactions-timeline",children:
lt.length>0?lt.map(at=>{var kt;return jsxRuntimeExports.jsxs("div",{className:"interaction-item",children:[jsxRuntimeEx
ports.jsxs("div",{className:"interaction-header",children:[jsxRuntimeExports.jsx("span",{className:`interaction-type 
type-${at.type}`,children:(kt=at.type)==null?void 0:kt.toUpperCase()}),jsxRuntimeExports.jsx("span",{className:"interac
tion-date",children:Ot(at.timestamp)})]}),jsxRuntimeExports.jsxs("div",{className:"interaction-user",children:["By: 
",at.userName||"Unknown",at.contactPersonName&&jsxRuntimeExports.jsxs("span",{className:"interaction-with",children:[" 
| With: ",at.contactPersonName," (",at.contactPersonRole,")"]})]}),at.summary&&jsxRuntimeExports.jsxs("div",{className:
"interaction-summary",children:[jsxRuntimeExports.jsx("strong",{children:"Summary:"})," ",at.summary]}),at.notes&&jsxRu
ntimeExports.jsxs("div",{className:"interaction-notes",children:[jsxRuntimeExports.jsx("strong",{children:"Notes:"})," 
",at.notes]}),at.documentsShared&&jsxRuntimeExports.jsxs("div",{className:"interaction-docs",children:[jsxRuntimeExport
s.jsx("strong",{children:"Documents Shared:"})," ",at.documentsShared]}),at.objectionsRaised&&jsxRuntimeExports.jsxs("d
iv",{className:"interaction-objections",children:[jsxRuntimeExports.jsx("strong",{children:"Objections:"})," ",at.objec
tionsRaised]}),at.nextSteps&&jsxRuntimeExports.jsxs("div",{className:"interaction-next-steps",children:[jsxRuntimeExpor
ts.jsx("strong",{children:"Next Steps:"})," 
",at.nextSteps]})]},at.id)}):jsxRuntimeExports.jsx("p",{className:"no-interactions",children:"No interactions recorded 
yet."})})]}),Et==="comments"&&jsxRuntimeExports.jsxs("div",{className:"tab-content",children:[jsxRuntimeExports.jsxs("d
iv",{className:"add-comment-form",children:[jsxRuntimeExports.jsx("h3",{children:"Add 
Comment"}),jsxRuntimeExports.jsx("textarea",{value:ft,onChange:at=>zt(at.target.value),placeholder:"Add a comment or 
note about this client...",rows:"3"}),jsxRuntimeExports.jsx("button",{onClick:Tr,disabled:Ct||!ft.trim(),className:"sub
mit-comment-btn",children:Ct?"Adding...":"Add Comment"})]}),jsxRuntimeExports.jsxs("div",{className:"comments-list",chi
ldren:[jsxRuntimeExports.jsx("h3",{children:"Comments & Feedback 
History"}),st.length>0?st.map(at=>jsxRuntimeExports.jsxs("div",{className:`comment-item type-${at.type||"comment"}`,chi
ldren:[jsxRuntimeExports.jsxs("div",{className:"comment-header",children:[jsxRuntimeExports.jsx("span",{className:"comm
ent-user",children:at.userName||"Unknown User"}),jsxRuntimeExports.jsx("span",{className:"comment-date",children:Ot(at.
date||at.createdAt)})]}),jsxRuntimeExports.jsx("div",{className:"comment-content",children:at.content||at.message||at.n
otes}),at.type&&at.type!=="comment"&&jsxRuntimeExports.jsx("span",{className:`comment-type-badge 
type-${at.type}`,children:at.type})]},at.id)):jsxRuntimeExports.jsx("p",{className:"no-data",children:"No comments or 
feedback recorded yet."})]})]}),Et==="tasks"&&jsxRuntimeExports.jsx("div",{className:"tab-content",children:jsxRuntimeE
xports.jsxs("div",{className:"tasks-section",children:[jsxRuntimeExports.jsxs("div",{className:"tasks-header",children:
[jsxRuntimeExports.jsx("h2",{children:"Follow-Up Tasks"}),jsxRuntimeExports.jsxs("div",{className:"tasks-summary",child
ren:[jsxRuntimeExports.jsxs("span",{className:"task-count pending",children:[an.length," 
Pending"]}),jsxRuntimeExports.jsxs("span",{className:"task-count overdue",children:[tr.length," 
Overdue"]})]})]}),jt.length>0?jsxRuntimeExports.jsx("div",{className:"tasks-list",children:jt.map(at=>{const 
kt=at.status==="pending"&&at.dueDate&&(at.dueDate.toDate?at.dueDate.toDate():new Date(at.dueDate))<new Date;return 
jsxRuntimeExports.jsxs("div",{className:`task-item task-${at.status} ${kt?"overdue":""}`,children:[jsxRuntimeExports.js
xs("div",{className:"task-header",children:[jsxRuntimeExports.jsx("span",{className:"task-description",children:at.desc
ription}),jsxRuntimeExports.jsx("span",{className:`task-status task-status-${at.status} ${kt?"overdue":""}`,children:kt
?"OVERDUE":at.status})]}),jsxRuntimeExports.jsxs("div",{className:"task-meta",children:[jsxRuntimeExports.jsxs("span",{
children:["Type: ",at.type]}),jsxRuntimeExports.jsxs("span",{className:kt?"overdue-text":"",children:["Due: ",St(at.due
Date)]}),at.priority&&jsxRuntimeExports.jsxs("span",{className:`priority-${at.priority.toLowerCase()}`,children:["Prior
ity: ",at.priority]}),at.assignedToName&&jsxRuntimeExports.jsxs("span",{children:["Assigned: ",at.assignedToName]})]}),
at.notes&&jsxRuntimeExports.jsx("div",{className:"task-notes",children:at.notes})]},at.id)})}):jsxRuntimeExports.jsx("p
",{children:"No follow-up tasks for this client."})]})}),Et==="locations"&&jsxRuntimeExports.jsx("div",{className:"tab-
content",children:jsxRuntimeExports.jsxs("div",{className:"locations-section",children:[jsxRuntimeExports.jsxs("div",{c
lassName:"section-header",children:[jsxRuntimeExports.jsx("h2",{children:"Client 
Locations"}),jsxRuntimeExports.jsx("button",{className:"add-btn",onClick:()=>Nn(),children:"+ Add Location"})]}),Cn.len
gth>0?jsxRuntimeExports.jsxs("table",{className:"data-table",children:[jsxRuntimeExports.jsx("thead",{children:jsxRunti
meExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("th",{children:"Location Name"}),jsxRuntimeExports.jsx("th",{child
ren:"Address"}),jsxRuntimeExports.jsx("th",{children:"City"}),jsxRuntimeExports.jsx("th",{children:"Province"}),jsxRunt
imeExports.jsx("th",{children:"Postal Code"}),jsxRuntimeExports.jsx("th",{children:"Head Office"}),jsxRuntimeExports.js
x("th",{children:"Actions"})]})}),jsxRuntimeExports.jsx("tbody",{children:Cn.map(at=>jsxRuntimeExports.jsxs("tr",{child
ren:[jsxRuntimeExports.jsx("td",{children:jsxRuntimeExports.jsx("strong",{children:at.name})}),jsxRuntimeExports.jsx("t
d",{children:at.address||"N/A"}),jsxRuntimeExports.jsx("td",{children:at.city||"N/A"}),jsxRuntimeExports.jsx("td",{chil
dren:at.province||"N/A"}),jsxRuntimeExports.jsx("td",{children:at.postalCode||"N/A"}),jsxRuntimeExports.jsx("td",{child
ren:at.isHeadOffice?jsxRuntimeExports.jsx("span",{className:"status-badge 
status-active",children:"Yes"}):jsxRuntimeExports.jsx("span",{className:"status-badge status-inactive",children:"No"})}
),jsxRuntimeExports.jsxs("td",{children:[jsxRuntimeExports.jsx("button",{className:"action-btn 
edit",onClick:()=>Nn(at),children:"Edit"}),jsxRuntimeExports.jsx("button",{className:"action-btn delete",onClick:()=>bs
(at.id),children:"Delete"})]})]},at.id))})]}):jsxRuntimeExports.jsxs("div",{className:"no-data-card",children:[jsxRunti
meExports.jsx("p",{children:"No locations added yet."}),jsxRuntimeExports.jsx("button",{onClick:()=>Nn(),children:"Add 
First Location"})]})]})}),Et==="contacts"&&jsxRuntimeExports.jsx("div",{className:"tab-content",children:jsxRuntimeExpo
rts.jsxs("div",{className:"contacts-section",children:[jsxRuntimeExports.jsxs("div",{className:"section-header",childre
n:[jsxRuntimeExports.jsx("h2",{children:"Client 
Contacts"}),jsxRuntimeExports.jsx("button",{className:"add-btn",onClick:()=>yn(),children:"+ Add 
Contact"})]}),_s.length>0?jsxRuntimeExports.jsxs("table",{className:"data-table contacts-table",children:[jsxRuntimeExp
orts.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("th",{children:"First 
Name"}),jsxRuntimeExports.jsx("th",{children:"Last Name"}),jsxRuntimeExports.jsx("th",{children:"Job Title"}),jsxRuntim
eExports.jsx("th",{children:"Location"}),jsxRuntimeExports.jsx("th",{className:"text-center",children:"Decision 
Maker"}),jsxRuntimeExports.jsx("th",{className:"text-center",children:"Main Contact"}),jsxRuntimeExports.jsx("th",{chil
dren:"Actions"})]})}),jsxRuntimeExports.jsx("tbody",{children:_s.map(at=>jsxRuntimeExports.jsxs("tr",{children:[jsxRunt
imeExports.jsx("td",{children:jsxRuntimeExports.jsx("strong",{children:at.firstName||"N/A"})}),jsxRuntimeExports.jsx("t
d",{children:jsxRuntimeExports.jsx("strong",{children:at.lastName||"N/A"})}),jsxRuntimeExports.jsx("td",{children:at.jo
bTitle||"N/A"}),jsxRuntimeExports.jsx("td",{children:_r(at.locationId)}),jsxRuntimeExports.jsx("td",{className:"text-ce
nter",children:at.isDecisionMaker?jsxRuntimeExports.jsx("span",{className:"badge-check",children:"âœ“"}):jsxRuntimeExpo
rts.jsx("span",{className:"badge-uncheck",children:"â€”"})}),jsxRuntimeExports.jsx("td",{className:"text-center",childr
en:at.isMainContact?jsxRuntimeExports.jsx("span",{className:"badge-check",children:"âœ“"}):jsxRuntimeExports.jsx("span"
,{className:"badge-uncheck",children:"â€”"})}),jsxRuntimeExports.jsxs("td",{children:[jsxRuntimeExports.jsx("button",{c
lassName:"action-btn edit",onClick:()=>yn(at),children:"Edit"}),jsxRuntimeExports.jsx("button",{className:"action-btn d
elete",onClick:()=>Mn(at.id),children:"Delete"})]})]},at.id))})]}):jsxRuntimeExports.jsxs("div",{className:"no-data-car
d",children:[jsxRuntimeExports.jsx("p",{children:"No contacts added 
yet."}),jsxRuntimeExports.jsx("button",{onClick:()=>yn(),children:"Add First Contact"})]})]})}),Et==="legal"&&jsxRuntim
eExports.jsx("div",{className:"tab-content",children:jsxRuntimeExports.jsxs("div",{className:"legal-section",children:[
jsxRuntimeExports.jsx("h2",{children:"Legal Documents & Contracts"}),jsxRuntimeExports.jsxs("div",{className:"contracts
-section",children:[jsxRuntimeExports.jsx("h3",{children:"Contracts"}),nt.length>0?jsxRuntimeExports.jsxs("table",{clas
sName:"data-table",children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeE
xports.jsx("th",{children:"Contract 
Name"}),jsxRuntimeExports.jsx("th",{children:"Type"}),jsxRuntimeExports.jsx("th",{children:"Start 
Date"}),jsxRuntimeExports.jsx("th",{children:"End Date"}),jsxRuntimeExports.jsx("th",{children:"Value"}),jsxRuntimeExpo
rts.jsx("th",{children:"Status"}),jsxRuntimeExports.jsx("th",{children:"Document"})]})}),jsxRuntimeExports.jsx("tbody",
{children:nt.map(at=>{var kt;return 
jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("td",{children:at.name||"Unnamed Contract"}),jsxRuntimeExp
orts.jsx("td",{children:at.type||"N/A"}),jsxRuntimeExports.jsx("td",{children:St(at.startDate)}),jsxRuntimeExports.jsx(
"td",{children:St(at.endDate)}),jsxRuntimeExports.jsx("td",{children:pt(at.value)}),jsxRuntimeExports.jsx("td",{childre
n:jsxRuntimeExports.jsx("span",{className:`status-badge status-${(kt=at.status)==null?void 0:kt.toLowerCase()}`,childre
n:at.status||"N/A"})}),jsxRuntimeExports.jsx("td",{children:at.documentUrl?jsxRuntimeExports.jsx("a",{href:at.documentU
rl,target:"_blank",rel:"noopener 
noreferrer",children:"View"}):"N/A"})]},at.id)})})]}):jsxRuntimeExports.jsx("p",{className:"no-data",children:"No 
contracts on file"})]}),jsxRuntimeExports.jsxs("div",{className:"sharepoint-section",children:[jsxRuntimeExports.jsx("h
3",{children:"Document Storage (SharePoint/Google Drive)"}),Tn?jsxRuntimeExports.jsxs("div",{className:"sharepoint-edit
",children:[jsxRuntimeExports.jsx("input",{type:"url",value:En,onChange:at=>Hn(at.target.value),placeholder:"Enter 
SharePoint or Google Drive folder URL",className:"sharepoint-input"}),jsxRuntimeExports.jsxs("div",{className:"sharepoi
nt-edit-actions",children:[jsxRuntimeExports.jsx("button",{className:"btn-save",onClick:Ms,disabled:Ps,children:Ps?"Sav
ing...":"Save"}),jsxRuntimeExports.jsx("button",{className:"btn-cancel",onClick:()=>{Hs(!1),Hn(h.sharePointFolderLink||
"")},children:"Cancel"})]})]}):jsxRuntimeExports.jsx("div",{className:"sharepoint-display",children:h.sharePointFolderL
ink?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("a",{href:h.sharePointFolderLink
,target:"_blank",rel:"noopener noreferrer",className:"sharepoint-button",children:"ðŸ“ Open Document 
Folder"}),jsxRuntimeExports.jsx("button",{className:"btn-edit-link",onClick:()=>Hs(!0),children:"Edit 
Link"})]}):jsxRuntimeExports.jsx("button",{className:"btn-add-link",onClick:()=>Hs(!0),children:"+ Add Document Link"})
})]}),jsxRuntimeExports.jsxs("div",{className:"documents-section",children:[jsxRuntimeExports.jsx("h3",{children:"Docum
ents Received Checklist"}),jsxRuntimeExports.jsx("p",{className:"section-description",children:"Track which documents 
have been received from the client"}),jsxRuntimeExports.jsx("div",{className:"document-checklist-grid",children:wr.leng
th>0?wr.map(at=>jsxRuntimeExports.jsxs("label",{className:`doc-checkbox-item ${at.required?"required-doc":""}`,children
:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:ks[at.key]||!1,onChange:kt=>fn(at.key,kt.target.checked),disab
led:hn}),jsxRuntimeExports.jsxs("span",{className:"doc-checkbox-label",children:[at.label,at.required&&jsxRuntimeExport
s.jsx("span",{className:"required-indicator",children:"*"})]})]},at.key)):jsxRuntimeExports.jsx("p",{className:"no-docu
ments-msg",children:"No document types configured. Please contact your administrator."})})]}),jsxRuntimeExports.jsxs("d
iv",{className:"documents-section",children:[jsxRuntimeExports.jsx("h3",{children:"Company Information"}),jsxRuntimeExp
orts.jsxs("div",{className:"document-checklist",children:[jsxRuntimeExports.jsxs("div",{className:"doc-item",children:[
jsxRuntimeExports.jsx("span",{className:"doc-icon",children:h.vatNumber?"âœ…":"âŒ"}),jsxRuntimeExports.jsx("span",{cla
ssName:"doc-name",children:"VAT 
Registration"}),jsxRuntimeExports.jsx("span",{className:"doc-status",children:h.vatNumber||"Not provided"})]}),jsxRunti
meExports.jsxs("div",{className:"doc-item",children:[jsxRuntimeExports.jsx("span",{className:"doc-icon",children:h.bbbe
eLevel?"âœ…":"âŒ"}),jsxRuntimeExports.jsx("span",{className:"doc-name",children:"B-BBEE 
Certificate"}),jsxRuntimeExports.jsx("span",{className:"doc-status",children:h.bbbeeLevel||"Not provided"})]}),jsxRunti
meExports.jsxs("div",{className:"doc-item",children:[jsxRuntimeExports.jsx("span",{className:"doc-icon",children:h.seta
?"âœ…":"âŒ"}),jsxRuntimeExports.jsx("span",{className:"doc-name",children:"SETA 
Registration"}),jsxRuntimeExports.jsx("span",{className:"doc-status",children:h.seta||"Not provided"})]})]})]})]})}),Et
==="lms"&&Tt&&jsxRuntimeExports.jsx("div",{className:"tab-content",children:jsxRuntimeExports.jsxs("div",{className:"lm
s-section",children:[jsxRuntimeExports.jsxs("h2",{children:["LMS Reports - ",h.name]}),jsxRuntimeExports.jsxs("div",{cl
assName:"lms-overview-cards",children:[jsxRuntimeExports.jsxs("div",{className:"lms-card",children:[jsxRuntimeExports.j
sx("span",{className:"lms-icon",children:"ðŸ‘¥"}),jsxRuntimeExports.jsxs("div",{className:"lms-card-content",children:[
jsxRuntimeExports.jsx("span",{className:"lms-value",children:Tt.totalEmployees}),jsxRuntimeExports.jsx("span",{classNam
e:"lms-label",children:"Total Employees"})]})]}),jsxRuntimeExports.jsxs("div",{className:"lms-card",children:[jsxRuntim
eExports.jsx("span",{className:"lms-icon",children:"âœ…"}),jsxRuntimeExports.jsxs("div",{className:"lms-card-content",c
hildren:[jsxRuntimeExports.jsx("span",{className:"lms-value",children:Tt.activeUsers}),jsxRuntimeExports.jsx("span",{cl
assName:"lms-label",children:"Active Users"})]})]}),jsxRuntimeExports.jsxs("div",{className:"lms-card",children:[jsxRun
timeExports.jsx("span",{className:"lms-icon",children:"ðŸŽ“"}),jsxRuntimeExports.jsxs("div",{className:"lms-card-conten
t",children:[jsxRuntimeExports.jsx("span",{className:"lms-value",children:Tt.completedCourses}),jsxRuntimeExports.jsx("
span",{className:"lms-label",children:"Completed Courses"})]})]}),jsxRuntimeExports.jsxs("div",{className:"lms-card",ch
ildren:[jsxRuntimeExports.jsx("span",{className:"lms-icon",children:"ðŸ“ˆ"}),jsxRuntimeExports.jsxs("div",{className:"l
ms-card-content",children:[jsxRuntimeExports.jsxs("span",{className:"lms-value",children:[Tt.avgCompletionRate,"%"]}),j
sxRuntimeExports.jsx("span",{className:"lms-label",children:"Avg Completion Rate"})]})]})]}),jsxRuntimeExports.jsxs("di
v",{className:"lms-courses-section",children:[jsxRuntimeExports.jsx("h3",{children:"Course Performance"}),jsxRuntimeExp
orts.jsxs("table",{className:"data-table",children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr"
,{children:[jsxRuntimeExports.jsx("th",{children:"Course Name"}),jsxRuntimeExports.jsx("th",{children:"Enrolled"}),jsxR
untimeExports.jsx("th",{children:"Completed"}),jsxRuntimeExports.jsx("th",{children:"Completion 
Rate"}),jsxRuntimeExports.jsx("th",{children:"Avg Score"})]})}),jsxRuntimeExports.jsx("tbody",{children:Tt.courses.map(
(at,kt)=>jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("td",{children:at.name}),jsxRuntimeExports.jsx("t
d",{children:at.enrolled}),jsxRuntimeExports.jsx("td",{children:at.completed}),jsxRuntimeExports.jsx("td",{children:jsx
RuntimeExports.jsxs("div",{className:"progress-bar",children:[jsxRuntimeExports.jsx("div",{className:"progress-fill",st
yle:{width:`${(at.completed/at.enrolled*100).toFixed(0)}%`}}),jsxRuntimeExports.jsxs("span",{children:[(at.completed/at
.enrolled*100).toFixed(0),"%"]})]})}),jsxRuntimeExports.jsxs("td",{children:[at.avgScore,"%"]})]},kt))})]})]}),jsxRunti
meExports.jsxs("div",{className:"lms-activity-section",children:[jsxRuntimeExports.jsx("h3",{children:"Recent LMS Activ
ity"}),jsxRuntimeExports.jsx("div",{className:"lms-activity-list",children:Tt.recentActivity.map((at,kt)=>jsxRuntimeExp
orts.jsxs("div",{className:"lms-activity-item",children:[jsxRuntimeExports.jsx("span",{className:`activity-action 
action-${at.action.toLowerCase().replace(" ","-")}`,children:at.action}),jsxRuntimeExports.jsx("span",{className:"activ
ity-user",children:at.user}),jsxRuntimeExports.jsx("span",{className:"activity-course",children:at.course}),jsxRuntimeE
xports.jsx("span",{className:"activity-time",children:Vt(at.date)})]},kt))})]}),jsxRuntimeExports.jsx("div",{className:
"lms-last-sync",children:jsxRuntimeExports.jsxs("span",{children:["Last Activity: ",Vt(Tt.lastActivityDate)]})})]})}),$
t&&Lt&&jsxRuntimeExports.jsx("div",{className:"deal-modal-backdrop",onClick:It,children:jsxRuntimeExports.jsxs("div",{c
lassName:`deal-modal deal-modal-${rs(Lt.productLine)}`,onClick:at=>at.stopPropagation(),children:[jsxRuntimeExports.jsx
s("div",{className:"deal-modal-header",children:[jsxRuntimeExports.jsxs("h3",{children:[Lt.productLine," - Deals"]}),js
xRuntimeExports.jsx("button",{className:"close-btn",onClick:It,children:"Ã—"})]}),jsxRuntimeExports.jsxs("div",{classNa
me:"deal-modal-summary",children:[jsxRuntimeExports.jsxs("div",{className:"summary-item",children:[jsxRuntimeExports.js
x("label",{children:"Previous Year"}),jsxRuntimeExports.jsx("span",{children:pt(((dr=Lt.history)==null?void 0:dr.yearMi
nus1)||0)})]}),jsxRuntimeExports.jsxs("div",{className:"summary-item",children:[jsxRuntimeExports.jsx("label",{children
:"YTD"}),jsxRuntimeExports.jsx("span",{children:pt(((rr=Lt.history)==null?void 0:rr.currentYearYTD)||0)})]}),jsxRuntime
Exports.jsxs("div",{className:"summary-item",children:[jsxRuntimeExports.jsx("label",{children:"Full Year Forecast"}),j
sxRuntimeExports.jsx("span",{className:"highlight",children:pt(Lt.fullYearForecast||0)})]})]}),jsxRuntimeExports.jsxs("
div",{className:"deal-tabs",children:[Dt.map((at,kt)=>jsxRuntimeExports.jsxs("button",{className:`deal-tab 
${Ft===kt?"active":""}`,onClick:()=>xs(kt),children:[at.name||`Deal ${kt+1}`,at.certaintyPercentage<100&&` 
(${at.certaintyPercentage}%)`]},at.id||kt)),jsxRuntimeExports.jsx("button",{className:"deal-tab 
add-deal-tab",onClick:Ss,children:"+ Add Deal"})]}),jsxRuntimeExports.jsx("div",{className:"deal-content",children:Dt.l
ength===0?jsxRuntimeExports.jsx("div",{className:"no-deals",children:jsxRuntimeExports.jsx("p",{children:'No deals 
yet. Click "+ Add Deal" to create one.'})}):Dt.map((at,kt)=>{if(Ft!==kt)return null;const us=rs(Lt.productLine);return 
jsxRuntimeExports.jsxs("div",{className:"deal-form",children:[jsxRuntimeExports.jsxs("div",{className:"deal-form-header
",children:[jsxRuntimeExports.jsxs("h4",{children:["Deal 
",kt+1]}),jsxRuntimeExports.jsx("button",{className:"delete-deal-btn",onClick:()=>on(kt),children:"Delete Deal"})]}),js
xRuntimeExports.jsxs("div",{className:"deal-form-grid",children:[jsxRuntimeExports.jsxs("div",{className:"form-field",c
hildren:[jsxRuntimeExports.jsx("label",{children:us==="learnership"?"Learnership":us==="tap"?"Package":"Course"}),Ut(us
).length>0?jsxRuntimeExports.jsxs("select",{value:at.productId||"",onChange:ds=>At(kt,ds.target.value,us),children:[jsx
RuntimeExports.jsxs("option",{value:"",children:["-- Select ",us==="learnership"?"Learnership":"Product"," 
--"]}),Ut(us).map(ds=>jsxRuntimeExports.jsxs("option",{value:ds.id,children:[ds.name,ds.defaultCostPerLearner?` 
(R${ds.defaultCostPerLearner}/learner)`:"",ds.defaultMonthlyFee?` 
(R${ds.defaultMonthlyFee}/month)`:"",ds.defaultCostPerTrainee?` (R${ds.defaultCostPerTrainee}/trainee)`:""]},ds.id))]})
:jsxRuntimeExports.jsx("input",{type:"text",value:at.name||"",onChange:ds=>hs(kt,"name",ds.target.value),placeholder:"E
nter name"})]}),jsxRuntimeExports.jsxs("div",{className:"form-field",children:[jsxRuntimeExports.jsx("label",{children:
"Certainty %"}),jsxRuntimeExports.jsx("input",{type:"number",min:"0",max:"100",value:at.certaintyPercentage||100,onChan
ge:ds=>hs(kt,"certaintyPercentage",parseInt(ds.target.value)||0)})]}),jsxRuntimeExports.jsxs("div",{className:"form-fie
ld full-width",children:[jsxRuntimeExports.jsx("label",{children:"Description"}),jsxRuntimeExports.jsx("textarea",{valu
e:at.description||"",onChange:ds=>hs(kt,"description",ds.target.value),placeholder:"Deal notes...",rows:"2"})]}),us==="
learnership"&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"for
m-field",children:[jsxRuntimeExports.jsx("label",{children:"Number of Learners"}),jsxRuntimeExports.jsx("input",{type:"
number",min:"0",value:at.learners||0,onChange:ds=>hs(kt,"learners",parseInt(ds.target.value)||0)})]}),jsxRuntimeExports
.jsxs("div",{className:"form-field",children:[jsxRuntimeExports.jsx("label",{children:"Cost per Learner (R)"}),jsxRunti
meExports.jsx("input",{type:"number",min:"0",value:at.costPerLearner||0,onChange:ds=>hs(kt,"costPerLearner",parseInt(ds
.target.value)||0)})]}),jsxRuntimeExports.jsxs("div",{className:"form-field",children:[jsxRuntimeExports.jsx("label",{c
hildren:"Total Value"}),jsxRuntimeExports.jsx("div",{className:"calculated-value",children:pt((at.learners||0)*(at.cost
PerLearner||0))})]}),jsxRuntimeExports.jsxs("div",{className:"form-field",children:[jsxRuntimeExports.jsx("label",{chil
dren:"Payment Start Date"}),jsxRuntimeExports.jsx("input",{type:"date",value:at.paymentStartDate||"",onChange:ds=>hs(kt
,"paymentStartDate",ds.target.value)})]}),jsxRuntimeExports.jsxs("div",{className:"form-field",children:[jsxRuntimeExpo
rts.jsx("label",{children:"Payment Frequency"}),jsxRuntimeExports.jsxs("select",{value:at.paymentFrequency||"Monthly",o
nChange:ds=>{hs(kt,"paymentFrequency",ds.target.value),ds.target.value==="Once-off"&&hs(kt,"paymentMonths",1)},children
:[jsxRuntimeExports.jsx("option",{value:"Monthly",children:"Monthly"}),jsxRuntimeExports.jsx("option",{value:"Once-off"
,children:"Once-off"})]})]}),jsxRuntimeExports.jsxs("div",{className:"form-field",children:[jsxRuntimeExports.jsx("labe
l",{children:"Payment Months"}),jsxRuntimeExports.jsx("input",{type:"number",min:"1",value:at.paymentFrequency==="Once-
off"?1:at.paymentMonths||12,onChange:ds=>hs(kt,"paymentMonths",parseInt(ds.target.value)||1),disabled:at.paymentFrequen
cy==="Once-off"})]})]}),us==="tap"&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs
("div",{className:"form-field",children:[jsxRuntimeExports.jsx("label",{children:"Number of Employees"}),jsxRuntimeExpo
rts.jsx("input",{type:"number",min:"0",value:at.numberOfEmployees||0,onChange:ds=>hs(kt,"numberOfEmployees",parseInt(ds
.target.value)||0)})]}),jsxRuntimeExports.jsxs("div",{className:"form-field",children:[jsxRuntimeExports.jsx("label",{c
hildren:"Cost per Employee/Month (R)"}),jsxRuntimeExports.jsx("input",{type:"number",min:"0",value:at.costPerEmployeePe
rMonth||0,onChange:ds=>hs(kt,"costPerEmployeePerMonth",parseInt(ds.target.value)||0)})]}),jsxRuntimeExports.jsxs("div",
{className:"form-field",children:[jsxRuntimeExports.jsx("label",{children:"Monthly Value"}),jsxRuntimeExports.jsx("div"
,{className:"calculated-value",children:pt((at.numberOfEmployees||0)*(at.costPerEmployeePerMonth||0))})]}),jsxRuntimeEx
ports.jsxs("div",{className:"form-field",children:[jsxRuntimeExports.jsx("label",{children:"Payment Start Date"}),jsxRu
ntimeExports.jsx("input",{type:"date",value:at.paymentStartDate||"",onChange:ds=>hs(kt,"paymentStartDate",ds.target.val
ue)})]}),jsxRuntimeExports.jsxs("div",{className:"form-field",children:[jsxRuntimeExports.jsx("label",{children:"Paymen
t Type"}),jsxRuntimeExports.jsxs("select",{value:at.paymentType||"Monthly",onChange:ds=>{hs(kt,"paymentType",ds.target.
value),ds.target.value==="Annual"&&hs(kt,"contractMonths",1)},children:[jsxRuntimeExports.jsx("option",{value:"Monthly"
,children:"Monthly"}),jsxRuntimeExports.jsx("option",{value:"Annual",children:"Annual"})]})]}),jsxRuntimeExports.jsxs("
div",{className:"form-field",children:[jsxRuntimeExports.jsx("label",{children:"Contract Duration (Months)"}),jsxRuntim
eExports.jsx("input",{type:"number",min:"1",value:at.paymentType==="Annual"?1:at.contractMonths||12,onChange:ds=>hs(kt,
"contractMonths",parseInt(ds.target.value)||1),disabled:at.paymentType==="Annual"})]})]}),(us==="compliance"||us==="oth
er")&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"form-field"
,children:[jsxRuntimeExports.jsx("label",{children:"Course Name"}),jsxRuntimeExports.jsx("input",{type:"text",value:at.
courseName||"",onChange:ds=>hs(kt,"courseName",ds.target.value),placeholder:"Enter course name"})]}),jsxRuntimeExports.
jsxs("div",{className:"form-field",children:[jsxRuntimeExports.jsx("label",{children:"Number of Trainees"}),jsxRuntimeE
xports.jsx("input",{type:"number",min:"0",value:at.numberOfTrainees||0,onChange:ds=>hs(kt,"numberOfTrainees",parseInt(d
s.target.value)||0)})]}),jsxRuntimeExports.jsxs("div",{className:"form-field",children:[jsxRuntimeExports.jsx("label",{
children:"Price per Person (R)"}),jsxRuntimeExports.jsx("input",{type:"number",min:"0",value:at.pricePerPerson||0,onCha
nge:ds=>hs(kt,"pricePerPerson",parseInt(ds.target.value)||0)})]}),jsxRuntimeExports.jsxs("div",{className:"form-field",
children:[jsxRuntimeExports.jsx("label",{children:"Total Value"}),jsxRuntimeExports.jsx("div",{className:"calculated-va
lue",children:pt((at.numberOfTrainees||0)*(at.pricePerPerson||0))})]}),jsxRuntimeExports.jsxs("div",{className:"form-fi
eld",children:[jsxRuntimeExports.jsx("label",{children:"Training Date"}),jsxRuntimeExports.jsx("input",{type:"date",val
ue:at.trainingDate||"",onChange:ds=>hs(kt,"trainingDate",ds.target.value)})]})]})]})]},at.id||kt)})}),jsxRuntimeExports
.jsxs("div",{className:"deal-modal-footer",children:[jsxRuntimeExports.jsx("button",{className:"cancel-btn",onClick:It,
children:"Cancel"}),jsxRuntimeExports.jsx("button",{className:"save-btn",onClick:ps,disabled:os,children:os?"Saving..."
:"Save Changes"})]})]})}),Xs&&jsxRuntimeExports.jsx("div",{className:"modal-backdrop",onClick:()=>mn(!1),children:jsxRu
ntimeExports.jsxs("div",{className:"modal-content",onClick:at=>at.stopPropagation(),children:[jsxRuntimeExports.jsxs("d
iv",{className:"modal-header",children:[jsxRuntimeExports.jsx("h3",{children:On?"Edit Location":"Add Location"}),jsxRun
timeExports.jsx("button",{className:"close-btn",onClick:()=>mn(!1),children:"Ã—"})]}),jsxRuntimeExports.jsxs("div",{cla
ssName:"modal-body",children:[jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("lab
el",{children:"Location Name *"}),jsxRuntimeExports.jsx("input",{type:"text",value:Zt.name,onChange:at=>Is(kt=>({...kt,
name:at.target.value})),placeholder:"e.g., Head Office, Johannesburg Branch"})]}),jsxRuntimeExports.jsxs("div",{classNa
me:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Street Address"}),jsxRuntimeExports.jsx("input",{typ
e:"text",value:Zt.address,onChange:at=>Is(kt=>({...kt,address:at.target.value})),placeholder:"Street address"})]}),jsxR
untimeExports.jsxs("div",{className:"form-row",children:[jsxRuntimeExports.jsxs("div",{className:"form-group",children:
[jsxRuntimeExports.jsx("label",{children:"City"}),jsxRuntimeExports.jsx("input",{type:"text",value:Zt.city,onChange:at=
>Is(kt=>({...kt,city:at.target.value})),placeholder:"City"})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",ch
ildren:[jsxRuntimeExports.jsx("label",{children:"Province"}),jsxRuntimeExports.jsxs("select",{value:Zt.province,onChang
e:at=>Is(kt=>({...kt,province:at.target.value})),children:[jsxRuntimeExports.jsx("option",{value:"",children:"Select Pr
ovince"}),jsxRuntimeExports.jsx("option",{value:"Gauteng",children:"Gauteng"}),jsxRuntimeExports.jsx("option",{value:"W
estern Cape",children:"Western Cape"}),jsxRuntimeExports.jsx("option",{value:"KwaZulu-Natal",children:"KwaZulu-Natal"})
,jsxRuntimeExports.jsx("option",{value:"Eastern Cape",children:"Eastern 
Cape"}),jsxRuntimeExports.jsx("option",{value:"Free State",children:"Free State"}),jsxRuntimeExports.jsx("option",{valu
e:"Limpopo",children:"Limpopo"}),jsxRuntimeExports.jsx("option",{value:"Mpumalanga",children:"Mpumalanga"}),jsxRuntimeE
xports.jsx("option",{value:"North West",children:"North West"}),jsxRuntimeExports.jsx("option",{value:"Northern 
Cape",children:"Northern Cape"})]})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports
.jsx("label",{children:"Postal Code"}),jsxRuntimeExports.jsx("input",{type:"text",value:Zt.postalCode,onChange:at=>Is(k
t=>({...kt,postalCode:at.target.value})),placeholder:"Postal 
Code"})]})]}),jsxRuntimeExports.jsx("div",{className:"form-group checkbox-group",children:jsxRuntimeExports.jsxs("label
",{children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:Zt.isHeadOffice,onChange:at=>Is(kt=>({...kt,isHeadO
ffice:at.target.checked}))}),"This is the Head Office"]})})]}),jsxRuntimeExports.jsxs("div",{className:"modal-footer",c
hildren:[jsxRuntimeExports.jsx("button",{className:"cancel-btn",onClick:()=>mn(!1),children:"Cancel"}),jsxRuntimeExport
s.jsx("button",{className:"save-btn",onClick:Ys,disabled:ns,children:ns?"Saving...":On?"Update Location":"Add Location"
})]})]})}),Gs&&jsxRuntimeExports.jsx("div",{className:"modal-backdrop",onClick:()=>Qs(!1),children:jsxRuntimeExports.js
xs("div",{className:"modal-content",onClick:at=>at.stopPropagation(),children:[jsxRuntimeExports.jsxs("div",{className:
"modal-header",children:[jsxRuntimeExports.jsx("h3",{children:qs?"Edit Contact":"Add Contact"}),jsxRuntimeExports.jsx("
button",{className:"close-btn",onClick:()=>Qs(!1),children:"Ã—"})]}),jsxRuntimeExports.jsxs("div",{className:"modal-bod
y",children:[jsxRuntimeExports.jsxs("div",{className:"form-row",children:[jsxRuntimeExports.jsxs("div",{className:"form
-group",children:[jsxRuntimeExports.jsx("label",{children:"First Name *"}),jsxRuntimeExports.jsx("input",{type:"text",v
alue:tn.firstName,onChange:at=>Dn(kt=>({...kt,firstName:at.target.value})),placeholder:"First name"})]}),jsxRuntimeExpo
rts.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Last Name *"}),jsxRuntimeExpo
rts.jsx("input",{type:"text",value:tn.lastName,onChange:at=>Dn(kt=>({...kt,lastName:at.target.value})),placeholder:"Las
t name"})]})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:
"Job Title"}),jsxRuntimeExports.jsxs("select",{value:tn.jobTitle,onChange:at=>Dn(kt=>({...kt,jobTitle:at.target.value})
),children:[jsxRuntimeExports.jsx("option",{value:"",children:"Select Job Title"}),Rr.map(at=>jsxRuntimeExports.jsx("op
tion",{value:at.title,children:at.title},at.id))]})]}),jsxRuntimeExports.jsxs("div",{className:"form-row",children:[jsx
RuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Email"}),jsxRuntim
eExports.jsx("input",{type:"email",value:tn.email,onChange:at=>Dn(kt=>({...kt,email:at.target.value})),placeholder:"Ema
il address"})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children
:"Phone"}),jsxRuntimeExports.jsx("input",{type:"tel",value:tn.phone,onChange:at=>Dn(kt=>({...kt,phone:at.target.value})
),placeholder:"Phone number"})]})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.j
sx("label",{children:"Location / Place of Work"}),jsxRuntimeExports.jsxs("select",{value:tn.locationId,onChange:at=>Dn(
kt=>({...kt,locationId:at.target.value})),children:[jsxRuntimeExports.jsx("option",{value:"",children:"Select 
Location"}),Cn.map(at=>jsxRuntimeExports.jsxs("option",{value:at.id,children:[at.name,at.isHeadOffice?" (Head Office)":
""]},at.id))]})]}),jsxRuntimeExports.jsxs("div",{className:"form-row",children:[jsxRuntimeExports.jsx("div",{className:
"form-group checkbox-group",children:jsxRuntimeExports.jsxs("label",{children:[jsxRuntimeExports.jsx("input",{type:"che
ckbox",checked:tn.isDecisionMaker,onChange:at=>Dn(kt=>({...kt,isDecisionMaker:at.target.checked}))}),"Decision 
Maker"]})}),jsxRuntimeExports.jsx("div",{className:"form-group checkbox-group",children:jsxRuntimeExports.jsxs("label",
{children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:tn.isMainContact,onChange:at=>Dn(kt=>({...kt,isMainCo
ntact:at.target.checked}))}),"Main Contact"]})})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxR
untimeExports.jsx("label",{children:"Notes / Feedback"}),jsxRuntimeExports.jsx("textarea",{value:tn.notes,onChange:at=>
Dn(kt=>({...kt,notes:at.target.value})),placeholder:"Additional notes or feedback about this contact...",rows:"4"})]})]
}),jsxRuntimeExports.jsxs("div",{className:"modal-footer",children:[jsxRuntimeExports.jsx("button",{className:"cancel-b
tn",onClick:()=>Qs(!1),children:"Cancel"}),jsxRuntimeExports.jsx("button",{className:"save-btn",onClick:jn,disabled:Un,
children:Un?"Saving...":qs?"Update Contact":"Add Contact"})]})]})})]})},EditClient=()=>{const{id:s}=useParams(),e=useNa
vigate(),[i,a]=reactExports.useState(!0),[o,c]=reactExports.useState(!1),[d,h]=reactExports.useState([]),[j,_]=reactExp
orts.useState([]),[$,rt]=reactExports.useState([]),[tt,mt]=reactExports.useState({name:"",legalName:"",type:"Corporate"
,status:"Prospect",pipelineStatus:"",address:"",country:"South Africa",industry:"",sector:"",seta:"",bbbeeLevel:"",fina
ncialYearEnd:"",sharePointFolderLink:"",primaryContact:"",contactEmail:"",phone:"",ytdRevenue:0,pipelineValue:0,nextFol
lowUpDate:null,assignedSalesPerson:"",skillsPartnerId:"not-allocated"}),vt=[{id:"",name:"Not in 
Pipeline"},{id:"new-lead",name:"New Lead"},{id:"qualifying",name:"Qualifying"},{id:"proposal-sent",name:"Proposal 
Sent"},{id:"awaiting-decision",name:"Awaiting Decision"},{id:"negotiation",name:"Negotiation"},{id:"won",name:"Won"},{i
d:"lost",name:"Lost"}];reactExports.useEffect(()=>{s&&(_t(),wt(),ht())},[s]);const _t=async()=>{try{const[Rt,st]=await 
Promise.all([getClient(s),getClientActivities(s)]);Rt&&mt({name:Rt.name||"",legalName:Rt.legalName||"",type:Rt.type||"C
orporate",status:Rt.status||"Prospect",pipelineStatus:Rt.pipelineStatus||"",address:Rt.address||"",country:Rt.country||
"South Africa",industry:Rt.industry||"",sector:Rt.sector||"",seta:Rt.seta||"",bbbeeLevel:Rt.bbbeeLevel||"",financialYea
rEnd:Rt.financialYearEnd||"",sharePointFolderLink:Rt.sharePointFolderLink||"",primaryContact:Rt.primaryContact||"",cont
actEmail:Rt.contactEmail||"",phone:Rt.phone||"",ytdRevenue:Rt.ytdRevenue||0,pipelineValue:Rt.pipelineValue||0,nextFollo
wUpDate:Rt.nextFollowUpDate||null,assignedSalesPerson:Rt.assignedSalesPerson||"",skillsPartnerId:Rt.skillsPartnerId||"n
ot-allocated"}),h(st),a(!1)}catch(Rt){console.error("Error loading client data:",Rt),a(!1)}},wt=async()=>{try{const 
Rt=await getSetas();_(Rt)}catch(Rt){console.error("Error loading SETAs:",Rt)}},ht=async()=>{try{const Rt=await 
getSkillsPartners();rt(Rt)}catch(Rt){console.error("Error loading Skills Partners:",Rt)}},dt=Rt=>{const{name:st,value:i
t}=Rt.target;mt(nt=>({...nt,[st]:it}))},jt=Rt=>{if(Rt===""||Rt===null||Rt===void 0)return"";const 
st=parseFloat(Rt);return isNaN(st)?"":st.toLocaleString("en-ZA")},bt=Rt=>{const{name:st,value:it}=Rt.target,nt=it.repla
ce(/[^\d.]/g,""),ct=nt===""?0:parseFloat(nt);mt(xt=>({...xt,[st]:isNaN(ct)?0:ct}))},ut=async 
Rt=>{Rt.preventDefault(),c(!0);try{await updateClient(s,tt),await 
addClientActivity(s,{type:"client_updated",description:"Client information was 
updated",userId:"system"}),e(`/clients/${s}`)}catch(st){console.error("Error updating client:",st),alert("Failed to 
update client. Please try again."),c(!1)}};return 
i?jsxRuntimeExports.jsxs("div",{className:"edit-client",children:[jsxRuntimeExports.jsx("h1",{children:"Edit Client"}),
jsxRuntimeExports.jsx("p",{children:"Loading..."})]}):jsxRuntimeExports.jsxs("div",{className:"edit-client",children:[j
sxRuntimeExports.jsxs("div",{className:"edit-client-header",children:[jsxRuntimeExports.jsx("h1",{children:"Edit Client
"}),jsxRuntimeExports.jsx("button",{onClick:()=>e(`/clients/${s}`),className:"cancel-btn",children:"Cancel"})]}),jsxRun
timeExports.jsxs("div",{className:"edit-client-content",children:[jsxRuntimeExports.jsxs("form",{onSubmit:ut,className:
"client-form",children:[jsxRuntimeExports.jsxs("div",{className:"form-section",children:[jsxRuntimeExports.jsx("h2",{ch
ildren:"Basic Information"}),jsxRuntimeExports.jsxs("div",{className:"form-grid",children:[jsxRuntimeExports.jsxs("div"
,{className:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"name",children:"Client Name *"}),jsxRuntimeE
xports.jsx("input",{type:"text",id:"name",name:"name",value:tt.name,onChange:dt,required:!0})]}),jsxRuntimeExports.jsxs
("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"legalName",children:"Legal Name"}),jsx
RuntimeExports.jsx("input",{type:"text",id:"legalName",name:"legalName",value:tt.legalName,onChange:dt})]}),jsxRuntimeE
xports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"type",children:"Client 
Type *"}),jsxRuntimeExports.jsxs("select",{id:"type",name:"type",value:tt.type,onChange:dt,required:!0,children:[jsxRun
timeExports.jsx("option",{value:"Corporate",children:"Corporate"}),jsxRuntimeExports.jsx("option",{value:"School",child
ren:"School"}),jsxRuntimeExports.jsx("option",{value:"Program",children:"Program"})]})]}),jsxRuntimeExports.jsxs("div",
{className:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"status",children:"Status *"}),jsxRuntimeExpor
ts.jsxs("select",{id:"status",name:"status",value:tt.status,onChange:dt,required:!0,children:[jsxRuntimeExports.jsx("op
tion",{value:"Prospect",children:"Prospect"}),jsxRuntimeExports.jsx("option",{value:"Active",children:"Active"}),jsxRun
timeExports.jsx("option",{value:"Pending",children:"Pending"}),jsxRuntimeExports.jsx("option",{value:"Inactive",childre
n:"Inactive"})]})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{html
For:"pipelineStatus",children:"Pipeline Status"}),jsxRuntimeExports.jsx("select",{id:"pipelineStatus",name:"pipelineSta
tus",value:tt.pipelineStatus,onChange:dt,className:`pipeline-select ${tt.pipelineStatus?`pipeline-${tt.pipelineStatus}`
:""}`,children:vt.map(Rt=>jsxRuntimeExports.jsx("option",{value:Rt.id,children:Rt.name},Rt.id))})]})]})]}),jsxRuntimeEx
ports.jsxs("div",{className:"form-section",children:[jsxRuntimeExports.jsx("h2",{children:"Industry & SETA Information"
}),jsxRuntimeExports.jsxs("div",{className:"form-grid",children:[jsxRuntimeExports.jsxs("div",{className:"form-group",c
hildren:[jsxRuntimeExports.jsx("label",{htmlFor:"industry",children:"Industry"}),jsxRuntimeExports.jsx("input",{type:"t
ext",id:"industry",name:"industry",value:tt.industry,onChange:dt,placeholder:"e.g., Mining, Healthcare, Retail"})]}),js
xRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"sector",children:"
Sector"}),jsxRuntimeExports.jsx("input",{type:"text",id:"sector",name:"sector",value:tt.sector,onChange:dt,placeholder:
"e.g., Private, Public, NGO"})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx(
"label",{htmlFor:"seta",children:"SETA"}),jsxRuntimeExports.jsxs("select",{id:"seta",name:"seta",value:tt.seta,onChange
:dt,children:[jsxRuntimeExports.jsx("option",{value:"",children:"Select SETA"}),j.map(Rt=>jsxRuntimeExports.jsx("option
",{value:Rt.shortName,children:Rt.shortName},Rt.id))]})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",childre
n:[jsxRuntimeExports.jsx("label",{htmlFor:"bbbeeLevel",children:"BBBEE Level"}),jsxRuntimeExports.jsxs("select",{id:"bb
beeLevel",name:"bbbeeLevel",value:tt.bbbeeLevel,onChange:dt,children:[jsxRuntimeExports.jsx("option",{value:"",children
:"Select Level"}),jsxRuntimeExports.jsx("option",{value:"Level 1",children:"Level 
1"}),jsxRuntimeExports.jsx("option",{value:"Level 2",children:"Level 2"}),jsxRuntimeExports.jsx("option",{value:"Level 
3",children:"Level 3"}),jsxRuntimeExports.jsx("option",{value:"Level 4",children:"Level 
4"}),jsxRuntimeExports.jsx("option",{value:"Level 5",children:"Level 5"}),jsxRuntimeExports.jsx("option",{value:"Level 
6",children:"Level 6"}),jsxRuntimeExports.jsx("option",{value:"Level 7",children:"Level 
7"}),jsxRuntimeExports.jsx("option",{value:"Level 8",children:"Level 8"}),jsxRuntimeExports.jsx("option",{value:"Non-co
mpliant",children:"Non-compliant"})]})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExpo
rts.jsx("label",{htmlFor:"skillsPartnerId",children:"Skills Partner"}),jsxRuntimeExports.jsxs("select",{id:"skillsPartn
erId",name:"skillsPartnerId",value:tt.skillsPartnerId,onChange:dt,children:[jsxRuntimeExports.jsx("option",{value:"not-
allocated",children:"Not Allocated"}),$.map(Rt=>jsxRuntimeExports.jsx("option",{value:Rt.id,children:Rt.name},Rt.id))]}
)]})]})]}),jsxRuntimeExports.jsxs("div",{className:"form-section",children:[jsxRuntimeExports.jsx("h2",{children:"Finan
cial Information"}),jsxRuntimeExports.jsxs("div",{className:"form-grid",children:[jsxRuntimeExports.jsxs("div",{classNa
me:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"financialYearEnd",children:"Financial Year 
End"}),jsxRuntimeExports.jsx("input",{type:"text",id:"financialYearEnd",name:"financialYearEnd",placeholder:"e.g., Marc
h",value:tt.financialYearEnd,onChange:dt})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntime
Exports.jsx("label",{htmlFor:"ytdRevenue",children:"YTD Revenue (R)"}),jsxRuntimeExports.jsx("input",{type:"text",id:"y
tdRevenue",name:"ytdRevenue",value:jt(tt.ytdRevenue),onChange:bt,placeholder:"0"})]}),jsxRuntimeExports.jsxs("div",{cla
ssName:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"pipelineValue",children:"Pipeline Value (R)"}),js
xRuntimeExports.jsx("input",{type:"text",id:"pipelineValue",name:"pipelineValue",value:jt(tt.pipelineValue),onChange:bt
,placeholder:"0"})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"form-section",children:[jsxRuntimeExports.jsx("h2"
,{children:"Additional Information"}),jsxRuntimeExports.jsx("div",{className:"form-grid",children:jsxRuntimeExports.jsx
s("div",{className:"form-group 
form-group-full",children:[jsxRuntimeExports.jsx("label",{htmlFor:"sharePointFolderLink",children:"SharePoint/Google 
Drive Link"}),jsxRuntimeExports.jsx("input",{type:"url",id:"sharePointFolderLink",name:"sharePointFolderLink",value:tt.
sharePointFolderLink,onChange:dt,placeholder:"https://..."})]})})]}),jsxRuntimeExports.jsxs("div",{className:"form-acti
ons",children:[jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>e(`/clients/${s}`),className:"cancel-btn",chil
dren:"Cancel"}),jsxRuntimeExports.jsx("button",{type:"submit",className:"save-btn",disabled:o,children:o?"Saving...":"S
ave Changes"})]})]}),jsxRuntimeExports.jsxs("div",{className:"activity-log-section",children:[jsxRuntimeExports.jsx("h2
",{children:"Activity Log"}),jsxRuntimeExports.jsx("div",{className:"activity-list",children:d.length>0?d.map(Rt=>jsxRu
ntimeExports.jsxs("div",{className:"activity-item",children:[jsxRuntimeExports.jsx("div",{className:"activity-date",chi
ldren:Rt.timestamp?(Rt.timestamp.toDate?Rt.timestamp.toDate():new Date(Rt.timestamp)).toLocaleString("en-ZA"):"N/A"}),j
sxRuntimeExports.jsx("div",{className:"activity-description",children:Rt.description||Rt.type||"Activity"})]},Rt.id)):j
sxRuntimeExports.jsx("p",{className:"no-activities",children:"No activities recorded"})})]})]})]})},Messages=()=>{var Y
t;const[s,e]=reactExports.useState([]),[i,a]=reactExports.useState([]),[o,c]=reactExports.useState("inbox"),[d,h]=react
Exports.useState(""),[j,_]=reactExports.useState(!1),[$,rt]=reactExports.useState(!0),[tt,mt]=reactExports.useState([])
,[vt,_t]=reactExports.useState(null),[wt,ht]=reactExports.useState(!1),[dt,jt]=reactExports.useState(""),bt=getAuth(),{
getTenantId:ut,isSystemAdmin:Rt}=useTenant(),st=ut(),[it,nt]=reactExports.useState({subject:"",recipients:[],body:""});
reactExports.useEffect(()=>{xt(),ct()},[o,st]),reactExports.useEffect(()=>{yt()},[s,d,o]);const ct=async()=>{try{const 
Gt=await getUsersByTenant(Rt?null:st);mt(Gt)}catch(Mt){console.error("Error loading users:",Mt)}},xt=async()=>{var 
Mt;try{const Gt=(Mt=bt.currentUser)==null?void 0:Mt.email,Wt=await getMessages();let 
ms=Wt;o==="inbox"?ms=Wt.filter(ss=>{var ys;return((ys=ss.recipients)==null?void 0:ys.includes(Gt))||ss.to===Gt}):o==="s
ent"&&(ms=Wt.filter(ss=>ss.from===Gt)),e(ms),rt(!1)}catch(Gt){console.error("Error loading 
messages:",Gt),rt(!1)}},yt=()=>{let Mt=[...s];d&&(Mt=Mt.filter(Gt=>{var Wt,ms,ss;return((Wt=Gt.subject)==null?void 
0:Wt.toLowerCase().includes(d.toLowerCase()))||((ms=Gt.body)==null?void 
0:ms.toLowerCase().includes(d.toLowerCase()))||((ss=Gt.to)==null?void 
0:ss.toLowerCase().includes(d.toLowerCase()))})),a(Mt)},Tt=async 
Mt=>{if(Mt.preventDefault(),it.recipients.length===0){alert("Please select at least one recipient");return}try{const 
Gt=bt.currentUser,Wt={...it,from:(Gt==null?void 0:Gt.email)||"Unknown",fromName:(Gt==null?void 
0:Gt.displayName)||(Gt==null?void 0:Gt.email)||"Unknown",status:"unread",createdAt:new Date};await 
createMessage(Wt),_(!1),nt({subject:"",recipients:[],body:""}),xt()}catch(Gt){console.error("Error creating 
message:",Gt),alert("Failed to send message. Please try again.")}},fs=Mt=>{nt(Gt=>({...Gt,recipients:Gt.recipients.incl
udes(Mt)?Gt.recipients.filter(Wt=>Wt!==Mt):[...Gt.recipients,Mt]}))},cs=async 
Mt=>{if(_t(Mt),ht(!1),jt(""),o==="inbox"&&Mt.status==="unread")try{await updateDoc(doc(db,"messages",Mt.id),{status:"re
ad",readAt:serverTimestamp()}),e(Gt=>Gt.map(Wt=>Wt.id===Mt.id?{...Wt,status:"read"}:Wt))}catch(Gt){console.error("Error
 marking message as read:",Gt)}},Es=async()=>{if(!(!dt.trim()||!vt))try{const Mt=bt.currentUser,Gt={subject:`Re: 
${vt.subject}`,recipients:[vt.from],body:dt,from:(Mt==null?void 0:Mt.email)||"Unknown",fromName:(Mt==null?void 
0:Mt.displayName)||(Mt==null?void 0:Mt.email)||"Unknown",status:"unread",inReplyTo:vt.id,createdAt:new Date};await 
createMessage(Gt),ht(!1),jt(""),_t(null),xt()}catch(Mt){console.error("Error sending reply:",Mt),alert("Failed to send 
reply. Please try again.")}},ls=Mt=>Mt?(Mt.toDate?Mt.toDate():new Date(Mt)).toLocaleString("en-ZA"):"N/A";return $?jsxR
untimeExports.jsxs("div",{className:"messages",children:[jsxRuntimeExports.jsx("h1",{children:"Messages"}),jsxRuntimeEx
ports.jsx("div",{className:"messages-content",children:jsxRuntimeExports.jsx("p",{children:"Loading..."})})]}):jsxRunti
meExports.jsxs("div",{className:"messages",children:[jsxRuntimeExports.jsxs("div",{className:"messages-header",children
:[jsxRuntimeExports.jsx("h1",{children:"Messages"}),o!=="chatroom"&&jsxRuntimeExports.jsx("button",{className:"create-m
essage-btn",onClick:()=>_(!j),children:"+ New Message"})]}),j&&jsxRuntimeExports.jsxs("div",{className:"create-message-
form",children:[jsxRuntimeExports.jsxs("div",{className:"form-header",children:[jsxRuntimeExports.jsx("h2",{children:"N
ew Message"}),jsxRuntimeExports.jsx("button",{className:"close-btn",onClick:()=>_(!1),children:"Ã—"})]}),jsxRuntimeExpo
rts.jsxs("form",{onSubmit:Tt,children:[jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports
.jsx("label",{children:"Subject *"}),jsxRuntimeExports.jsx("input",{type:"text",required:!0,value:it.subject,onChange:M
t=>nt({...it,subject:Mt.target.value}),placeholder:"Enter message subject"})]}),jsxRuntimeExports.jsxs("div",{className
:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Recipients * (select one or more)"}),jsxRuntimeExports
.jsx("div",{className:"recipients-list",children:tt.map(Mt=>jsxRuntimeExports.jsxs("label",{className:`recipient-checkb
ox ${it.recipients.includes(Mt.email)?"selected":""}`,children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:
it.recipients.includes(Mt.email),onChange:()=>fs(Mt.email)}),jsxRuntimeExports.jsx("span",{className:"recipient-name",c
hildren:Mt.displayName||Mt.email}),jsxRuntimeExports.jsx("span",{className:"recipient-role",children:Mt.role})]},Mt.id)
)}),it.recipients.length>0&&jsxRuntimeExports.jsxs("div",{className:"selected-recipients",children:["Selected: 
",it.recipients.length," recipient(s)"]})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeE
xports.jsx("label",{children:"Message *"}),jsxRuntimeExports.jsx("textarea",{rows:"6",required:!0,value:it.body,onChang
e:Mt=>nt({...it,body:Mt.target.value}),placeholder:"Type your message..."})]}),jsxRuntimeExports.jsxs("div",{className:
"form-actions",children:[jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>_(!1),className:"discard-btn",childr
en:"Cancel"}),jsxRuntimeExports.jsx("button",{type:"submit",className:"send-btn",children:"Send Message"})]})]})]}),jsx
RuntimeExports.jsxs("div",{className:"messages-tabs",children:[jsxRuntimeExports.jsx("button",{className:o==="inbox"?"a
ctive":"",onClick:()=>c("inbox"),children:"Inbox"}),jsxRuntimeExports.jsx("button",{className:o==="sent"?"active":"",on
Click:()=>c("sent"),children:"Sent"})]}),jsxRuntimeExports.jsx("div",{className:"messages-filters",children:jsxRuntimeE
xports.jsx("input",{type:"text",placeholder:"Search messages...",className:"search-input",value:d,onChange:Mt=>h(Mt.tar
get.value)})}),jsxRuntimeExports.jsx("div",{className:"messages-content",children:i.length>0?jsxRuntimeExports.jsx("div
",{className:"messages-list",children:i.map(Mt=>{var Gt,Wt,ms;return 
jsxRuntimeExports.jsxs("div",{className:`message-item ${Mt.status==="unread"&&o==="inbox"?"unread":""}`,onClick:()=>cs(
Mt),style:{cursor:"pointer"},children:[jsxRuntimeExports.jsxs("div",{className:"message-header",children:[jsxRuntimeExp
orts.jsxs("div",{className:"message-subject",children:[Mt.status==="unread"&&o==="inbox"&&jsxRuntimeExports.jsx("span",
{className:"unread-dot"}),Mt.subject||"No Subject"]}),jsxRuntimeExports.jsx("span",{className:"message-date",children:l
s(Mt.createdAt)})]}),jsxRuntimeExports.jsx("div",{className:"message-meta",children:o==="inbox"?jsxRuntimeExports.jsxs(
"span",{className:"message-from",children:["From: 
",Mt.fromName||Mt.from]}):jsxRuntimeExports.jsxs("span",{className:"message-to",children:["To: 
",((Gt=Mt.recipients)==null?void 0:Gt.join(", 
"))||Mt.to||"N/A"]})}),jsxRuntimeExports.jsxs("div",{className:"message-preview",children:[(Wt=Mt.body)==null?void 
0:Wt.substring(0,150),((ms=Mt.body)==null?void 0:ms.length)>150?"...":""]})]},Mt.id)})}):jsxRuntimeExports.jsx("div",{c
lassName:"no-messages",children:jsxRuntimeExports.jsx("p",{children:"No messages found."})})}),vt&&jsxRuntimeExports.js
x("div",{className:"message-modal-backdrop",onClick:()=>_t(null),children:jsxRuntimeExports.jsxs("div",{className:"mess
age-modal",onClick:Mt=>Mt.stopPropagation(),children:[jsxRuntimeExports.jsxs("div",{className:"message-modal-header",ch
ildren:[jsxRuntimeExports.jsx("h2",{children:vt.subject||"No Subject"}),jsxRuntimeExports.jsx("button",{className:"clos
e-btn",onClick:()=>_t(null),children:"Ã—"})]}),jsxRuntimeExports.jsxs("div",{className:"message-modal-meta",children:[j
sxRuntimeExports.jsxs("p",{children:[jsxRuntimeExports.jsx("strong",{children:"From:"})," 
",vt.fromName||vt.from]}),jsxRuntimeExports.jsxs("p",{children:[jsxRuntimeExports.jsx("strong",{children:"To:"})," 
",((Yt=vt.recipients)==null?void 0:Yt.join(", 
"))||vt.to||"N/A"]}),jsxRuntimeExports.jsxs("p",{children:[jsxRuntimeExports.jsx("strong",{children:"Date:"})," ",ls(vt
.createdAt)]})]}),jsxRuntimeExports.jsx("div",{className:"message-modal-body",children:jsxRuntimeExports.jsx("p",{child
ren:vt.body})}),jsxRuntimeExports.jsxs("div",{className:"message-modal-actions",children:[o==="inbox"&&!wt&&jsxRuntimeE
xports.jsx("button",{className:"reply-btn",onClick:()=>ht(!0),children:"Reply"}),jsxRuntimeExports.jsx("button",{classN
ame:"close-message-btn",onClick:()=>_t(null),children:"Close"})]}),wt&&jsxRuntimeExports.jsxs("div",{className:"reply-f
orm",children:[jsxRuntimeExports.jsx("h3",{children:"Reply"}),jsxRuntimeExports.jsx("textarea",{rows:"4",value:dt,onCha
nge:Mt=>jt(Mt.target.value),placeholder:"Type your reply..."}),jsxRuntimeExports.jsxs("div",{className:"reply-actions",
children:[jsxRuntimeExports.jsx("button",{className:"cancel-btn",onClick:()=>ht(!1),children:"Cancel"}),jsxRuntimeExpor
ts.jsx("button",{className:"send-btn",onClick:Es,disabled:!dt.trim(),children:"Send 
Reply"})]})]})]})})]})},Profile=()=>{var wt,ht,dt,jt;const[s,e]=reactExports.useState(null),[i,a]=reactExports.useState
(null),[o,c]=reactExports.useState(null),[d,h]=reactExports.useState(!0),[j,_]=reactExports.useState(!1),[$,rt]=reactEx
ports.useState({displayName:"",email:"",phone:"",title:"",department:"",bio:""}),tt=getAuth();reactExports.useEffect(()
=>{mt()},[]);const mt=async()=>{try{const bt=tt.currentUser;if(bt){e(bt),rt({displayName:bt.displayName||"",email:bt.em
ail||"",phone:"",title:"",department:"",bio:""});const ut=await getUserData(bt.uid);if(ut)if(a(ut),rt(Rt=>({...Rt,phone
:ut.phone||"",title:ut.title||"",department:ut.department||"",bio:ut.bio||""})),ut.managerId){const Rt=await 
getUserData(ut.managerId);c(Rt)}else c(null)}h(!1)}catch(bt){console.error("Error loading 
profile:",bt),h(!1)}},vt=async bt=>{bt.preventDefault();try{const ut=tt.currentUser;ut&&(await 
updateProfile(ut,{displayName:$.displayName}),await createOrUpdateUser({...ut,displayName:$.displayName,phone:$.phone,t
itle:$.title,department:$.department,bio:$.bio}),_(!1),mt(),alert("Profile updated 
successfully!"))}catch(ut){console.error("Error updating profile:",ut),alert("Failed to update profile. Please try 
again.")}},_t=bt=>bt?(bt.toDate?bt.toDate():new 
Date(bt)).toLocaleDateString("en-ZA",{year:"numeric",month:"long",day:"numeric"}):"N/A";return d?jsxRuntimeExports.jsxs
("div",{className:"profile",children:[jsxRuntimeExports.jsx("h1",{children:"Profile"}),jsxRuntimeExports.jsx("div",{cla
ssName:"profile-content",children:jsxRuntimeExports.jsx("p",{children:"Loading..."})})]}):s?jsxRuntimeExports.jsxs("div
",{className:"profile",children:[jsxRuntimeExports.jsxs("div",{className:"profile-header",children:[jsxRuntimeExports.j
sx("h1",{children:"My 
Profile"}),!j&&jsxRuntimeExports.jsx("button",{className:"edit-profile-btn",onClick:()=>_(!0),children:"Edit Profile"})
]}),jsxRuntimeExports.jsx("div",{className:"profile-content",children:j?jsxRuntimeExports.jsxs("form",{onSubmit:vt,clas
sName:"profile-form",children:[jsxRuntimeExports.jsxs("div",{className:"form-section",children:[jsxRuntimeExports.jsx("
h2",{children:"Personal Information"}),jsxRuntimeExports.jsxs("div",{className:"form-row",children:[jsxRuntimeExports.j
sxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Display Name"}),jsxRuntimeExports.
jsx("input",{type:"text",value:$.displayName,onChange:bt=>rt({...$,displayName:bt.target.value}),required:!0})]}),jsxRu
ntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Email"}),jsxRuntimeE
xports.jsx("input",{type:"email",value:$.email,disabled:!0,className:"disabled-input"}),jsxRuntimeExports.jsx("small",{
children:"Email cannot be changed"})]})]}),jsxRuntimeExports.jsxs("div",{className:"form-row",children:[jsxRuntimeExpor
ts.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Phone"}),jsxRuntimeExports.jsx
("input",{type:"tel",value:$.phone,onChange:bt=>rt({...$,phone:bt.target.value}),placeholder:"+27 12 345 6789"})]}),jsx
RuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Title"}),jsxRuntim
eExports.jsx("input",{type:"text",value:$.title,onChange:bt=>rt({...$,title:bt.target.value}),placeholder:"e.g., Sales 
Manager"})]})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children
:"Department"}),jsxRuntimeExports.jsx("input",{type:"text",value:$.department,onChange:bt=>rt({...$,department:bt.targe
t.value}),placeholder:"e.g., Sales, Operations"})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsx
RuntimeExports.jsx("label",{children:"Bio"}),jsxRuntimeExports.jsx("textarea",{rows:"4",value:$.bio,onChange:bt=>rt({..
.$,bio:bt.target.value}),placeholder:"Tell us about yourself..."})]})]}),jsxRuntimeExports.jsxs("div",{className:"form-
actions",children:[jsxRuntimeExports.jsx("button",{type:"button",className:"cancel-btn",onClick:()=>{_(!1),mt()},childr
en:"Cancel"}),jsxRuntimeExports.jsx("button",{type:"submit",className:"save-btn",children:"Save Changes"})]})]}):jsxRun
timeExports.jsxs("div",{className:"profile-view",children:[jsxRuntimeExports.jsx("div",{className:"profile-avatar",chil
dren:s.photoURL?jsxRuntimeExports.jsx("img",{src:s.photoURL,alt:s.displayName||"User"}):jsxRuntimeExports.jsx("div",{cl
assName:"avatar-placeholder",children:(s.displayName||s.email||"U").charAt(0).toUpperCase()})}),jsxRuntimeExports.jsxs(
"div",{className:"profile-info",children:[jsxRuntimeExports.jsxs("div",{className:"info-section",children:[jsxRuntimeEx
ports.jsx("h2",{children:"Personal Information"}),jsxRuntimeExports.jsxs("div",{className:"info-grid",children:[jsxRunt
imeExports.jsxs("div",{className:"info-item",children:[jsxRuntimeExports.jsx("span",{className:"info-label",children:"D
isplay Name"}),jsxRuntimeExports.jsx("span",{className:"info-value",children:s.displayName||"Not set"})]}),jsxRuntimeEx
ports.jsxs("div",{className:"info-item",children:[jsxRuntimeExports.jsx("span",{className:"info-label",children:"Email"
}),jsxRuntimeExports.jsx("span",{className:"info-value",children:s.email||"N/A"})]}),jsxRuntimeExports.jsxs("div",{clas
sName:"info-item",children:[jsxRuntimeExports.jsx("span",{className:"info-label",children:"Phone"}),jsxRuntimeExports.j
sx("span",{className:"info-value",children:$.phone||"Not set"})]}),jsxRuntimeExports.jsxs("div",{className:"info-item",
children:[jsxRuntimeExports.jsx("span",{className:"info-label",children:"Title"}),jsxRuntimeExports.jsx("span",{classNa
me:"info-value",children:$.title||"Not set"})]}),jsxRuntimeExports.jsxs("div",{className:"info-item",children:[jsxRunti
meExports.jsx("span",{className:"info-label",children:"Department"}),jsxRuntimeExports.jsx("span",{className:"info-valu
e",children:$.department||"Not set"})]}),$.bio&&jsxRuntimeExports.jsxs("div",{className:"info-item full-width",children
:[jsxRuntimeExports.jsx("span",{className:"info-label",children:"Bio"}),jsxRuntimeExports.jsx("span",{className:"info-v
alue",children:$.bio})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"info-section",children:[jsxRuntimeExports.jsx(
"h2",{children:"Account Information"}),jsxRuntimeExports.jsxs("div",{className:"info-grid",children:[jsxRuntimeExports.
jsxs("div",{className:"info-item",children:[jsxRuntimeExports.jsx("span",{className:"info-label",children:"Role"}),jsxR
untimeExports.jsx("span",{className:"info-value",children:i!=null&&i.role?jsxRuntimeExports.jsx("span",{className:"role
-badge",children:i.role}):"Not assigned"})]}),jsxRuntimeExports.jsxs("div",{className:"info-item",children:[jsxRuntimeE
xports.jsx("span",{className:"info-label",children:"Manager"}),jsxRuntimeExports.jsx("span",{className:"info-value",chi
ldren:o?jsxRuntimeExports.jsx("span",{children:o.displayName||o.email}):"No manager assigned"})]}),jsxRuntimeExports.js
xs("div",{className:"info-item",children:[jsxRuntimeExports.jsx("span",{className:"info-label",children:"User 
ID"}),jsxRuntimeExports.jsx("span",{className:"info-value small",children:s.uid})]}),jsxRuntimeExports.jsxs("div",{clas
sName:"info-item",children:[jsxRuntimeExports.jsx("span",{className:"info-label",children:"Provider"}),jsxRuntimeExport
s.jsx("span",{className:"info-value",children:((ht=(wt=s.providerData)==null?void 0:wt[0])==null?void 
0:ht.providerId)==="microsoft.com"?"Microsoft":((jt=(dt=s.providerData)==null?void 0:dt[0])==null?void 
0:jt.providerId)||"Email/Password"})]}),(i==null?void 0:i.createdAt)&&jsxRuntimeExports.jsxs("div",{className:"info-ite
m",children:[jsxRuntimeExports.jsx("span",{className:"info-label",children:"Member 
Since"}),jsxRuntimeExports.jsx("span",{className:"info-value",children:_t(i.createdAt)})]}),(i==null?void 0:i.lastLogin
)&&jsxRuntimeExports.jsxs("div",{className:"info-item",children:[jsxRuntimeExports.jsx("span",{className:"info-label",c
hildren:"Last Login"}),jsxRuntimeExports.jsx("span",{className:"info-value",children:_t(i.lastLogin)})]})]})]})]})]})})
]}):jsxRuntimeExports.jsxs("div",{className:"profile",children:[jsxRuntimeExports.jsx("h1",{children:"Profile"}),jsxRun
timeExports.jsx("div",{className:"profile-content",children:jsxRuntimeExports.jsx("p",{children:"No user logged 
in."})})]})},SalesPipeline=()=>{var Bt;const[s,e]=reactExports.useState([]),[i,a]=reactExports.useState([]),[o,c]=react
Exports.useState([]),[d,h]=reactExports.useState(!0),[j,_]=reactExports.useState(!1),[$,rt]=reactExports.useState(null)
,[tt,mt]=reactExports.useState(""),[vt,_t]=reactExports.useState("all"),[wt,ht]=reactExports.useState(null),[dt,jt]=rea
ctExports.useState(null),[bt,ut]=reactExports.useState([]),{currentUser:Rt,isSystemAdmin:st,accessibleUserIds:it,isTeam
Manager:nt,isSalesHead:ct,hierarchyLoading:xt}=useTenant(),yt=st||nt()||ct(),Tt=Rt==null?void 
0:Rt.uid,fs=[{id:"new-lead",name:"New 
Lead",color:"#e3f2fd"},{id:"qualifying",name:"Qualifying",color:"#fff3e0"},{id:"proposal-sent",name:"Proposal 
Sent",color:"#e8f5e8"},{id:"awaiting-decision",name:"Awaiting Decision",color:"#f3e5f5"},{id:"negotiation",name:"Negoti
ation",color:"#fff9c4"},{id:"won",name:"Won",color:"#c8e6c9"},{id:"lost",name:"Lost",color:"#ffcdd2"}],[cs,Es]=reactExp
orts.useState({clientId:"",company:"",contact:"",product:"",numberOfLearners:"",seta:"",budgetEstimate:"",bbbeeContribu
tion:"",expectedClosingDate:"",details:"",value:"",priority:"Normal",stage:"new-lead",nextAction:"",proposalType:"",clo
seDate:"",supportingDocuments:""});reactExports.useEffect(()=>{!xt&&Rt&&(ls(),Yt())},[xt,Rt,it]);const 
ls=async()=>{try{const Lt=await getPipelineStatuses();Lt&&Array.isArray(Lt)&&Lt.length>0?ut(Lt):Lt&&Lt.statuses&&Lt.sta
tuses.length>0?ut(Lt.statuses):ut(fs)}catch(Lt){console.error("Error loading pipeline 
statuses:",Lt),ut(fs)}},Yt=async()=>{try{const[Lt,Xt]=await Promise.all([getDeals(),getClients()]);a(Lt),c(Xt);let 
Dt=[...Lt];const Ht=new Set(Lt.map(Qt=>Qt.clientId)),os=Xt.filter(Qt=>Qt.pipelineStatus&&!Ht.has(Qt.id)).map(Qt=>({id:`
client_${Qt.id}`,clientId:Qt.id,company:Qt.name||Qt.legalName||"Unknown Client",stage:Qt.pipelineStatus,value:0,priorit
y:"Normal",isClientPipeline:!0,assignedTo:Qt.assignedSalesPerson,createdAt:Qt.createdAt}));Dt=[...Dt,...os],!st&&!ct()&
&(Dt=Dt.filter(Qt=>it.includes(Qt.assignedTo)||it.includes(Qt.createdBy))),e(Dt),h(!1)}catch(Lt){console.error("Error 
loading deals:",Lt),h(!1)}},Mt=async Lt=>{Lt.preventDefault();try{const 
Xt={...cs,value:parseFloat(cs.value)||0,lastContact:new Date,createdBy:Tt,assignedTo:Tt};await createDeal(Xt),_(!1),Es(
{clientId:"",company:"",contact:"",product:"",numberOfLearners:"",seta:"",budgetEstimate:"",bbbeeContribution:"",expect
edClosingDate:"",details:"",value:"",priority:"Normal",stage:"new-lead",nextAction:"",proposalType:"",closeDate:"",supp
ortingDocuments:""}),Yt()}catch(Xt){console.error("Error creating deal:",Xt),alert("Failed to create deal. Please try 
again.")}},Gt=async(Lt,Xt)=>{try{if(Lt.startsWith("client_")){const Dt=Lt.replace("client_","");await 
updateClientPipelineStatus(Dt,Xt,Tt)}else await moveDealStage(Lt,Xt);Yt()}catch(Dt){console.error("Error moving 
deal:",Dt),alert("Failed to move deal. Please try again.")}},Wt=(Lt,Xt)=>{ht(Xt),Lt.dataTransfer.effectAllowed="move",L
t.dataTransfer.setData("text/plain",Xt.id),setTimeout(()=>{Lt.target.classList.add("dragging")},0)},ms=Lt=>{Lt.target.c
lassList.remove("dragging"),ht(null),jt(null)},ss=(Lt,Xt)=>{Lt.preventDefault(),Lt.dataTransfer.dropEffect="move",dt!==
Xt&&jt(Xt)},ys=Lt=>{Lt.currentTarget.contains(Lt.relatedTarget)||jt(null)},Et=async(Lt,Xt)=>{if(Lt.preventDefault(),jt(
null),wt&&wt.stage!==Xt)try{if(wt.isClientPipeline){const Dt=wt.id.replace("client_","");await 
updateClientPipelineStatus(Dt,Xt,Tt)}else await moveDealStage(wt.id,Xt);Yt()}catch(Dt){console.error("Error moving 
deal:",Dt),alert("Failed to move deal. Please try again.")}ht(null)},gt=Lt=>{let Xt=s.filter(Dt=>Dt.stage===Lt);return 
tt&&(Xt=Xt.filter(Dt=>{var Ht,os;return((Ht=Dt.company)==null?void 
0:Ht.toLowerCase().includes(tt.toLowerCase()))||((os=Dt.contact)==null?void 
0:os.toLowerCase().includes(tt.toLowerCase()))})),Xt},ft=()=>{const Lt=s.filter(Ft=>Ft.stage!=="won"&&Ft.stage!=="lost"
),Xt=s.filter(Ft=>Ft.stage==="won"),Dt=s.filter(Ft=>Ft.stage==="lost");s.reduce((Ft,xs)=>Ft+(xs.value||0),0);const Ht=L
t.reduce((Ft,xs)=>Ft+(xs.value||0),0),os=Lt.length>0?Ht/Lt.length:0,Qt=Xt.length+Dt.length>0?Xt.length/(Xt.length+Dt.le
ngth)*100:0;return{pipelineValue:Ht,activeDeals:Lt.length,winRate:Qt.toFixed(1),avgDealSize:os}},zt=Lt=>{if(!Lt)return"
N/A";const Xt=o.find(Dt=>Dt.id===Lt);return Xt?Xt.name||Xt.legalName||"Unknown":"Unknown Client"},Ct=Lt=>new Intl.Numbe
rFormat("en-ZA",{style:"currency",currency:"ZAR",minimumFractionDigits:0}).format(Lt),Pt=Lt=>Lt?(Lt.toDate?Lt.toDate():
new Date(Lt)).toLocaleDateString("en-ZA"):"N/A",$t=ft();return d||bt.length===0?jsxRuntimeExports.jsxs("div",{className
:"sales-pipeline",children:[jsxRuntimeExports.jsx("h1",{children:"Sales Pipeline"}),jsxRuntimeExports.jsx("div",{classN
ame:"sales-pipeline-content",children:jsxRuntimeExports.jsx("p",{children:"Loading..."})})]}):jsxRuntimeExports.jsxs("d
iv",{className:"sales-pipeline",children:[jsxRuntimeExports.jsxs("div",{className:"pipeline-header",children:[jsxRuntim
eExports.jsxs("h1",{children:["Sales Pipeline 
",!yt&&jsxRuntimeExports.jsx("span",{className:"page-subtitle",children:"(My 
Deals)"})]}),jsxRuntimeExports.jsx("button",{className:"add-deal-btn",onClick:()=>_(!j),children:"+ Add Deal"})]}),j&&j
sxRuntimeExports.jsxs("div",{className:"create-deal-form",children:[jsxRuntimeExports.jsxs("div",{className:"form-heade
r",children:[jsxRuntimeExports.jsx("h2",{children:"Create New Deal"}),jsxRuntimeExports.jsx("button",{className:"close-
btn",onClick:()=>_(!1),children:"Ã—"})]}),jsxRuntimeExports.jsxs("form",{onSubmit:Mt,children:[jsxRuntimeExports.jsxs("
div",{className:"form-row",children:[jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.j
sx("label",{children:"Client *"}),jsxRuntimeExports.jsxs("select",{required:!0,value:cs.clientId,onChange:Lt=>{const Xt
=o.find(Dt=>Dt.id===Lt.target.value);Es({...cs,clientId:Lt.target.value,company:Xt?Xt.name||Xt.legalName:""})},children
:[jsxRuntimeExports.jsx("option",{value:"",children:"Select Client"}),o.map(Lt=>jsxRuntimeExports.jsx("option",{value:L
t.id,children:Lt.name||Lt.legalName||"Unknown"},Lt.id))]})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",chil
dren:[jsxRuntimeExports.jsx("label",{children:"Contact"}),jsxRuntimeExports.jsx("input",{type:"text",value:cs.contact,o
nChange:Lt=>Es({...cs,contact:Lt.target.value})})]})]}),jsxRuntimeExports.jsxs("div",{className:"form-row",children:[js
xRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Product *"}),jsxR
untimeExports.jsxs("select",{required:!0,value:cs.product,onChange:Lt=>Es({...cs,product:Lt.target.value}),children:[js
xRuntimeExports.jsx("option",{value:"",children:"Select Product"}),jsxRuntimeExports.jsx("option",{value:"Accredited 
Training",children:"Accredited Training"}),jsxRuntimeExports.jsx("option",{value:"E-Learning",children:"E-Learning"}),j
sxRuntimeExports.jsx("option",{value:"LMS",children:"LMS"}),jsxRuntimeExports.jsx("option",{value:"Learnerships",childr
en:"Learnerships"}),jsxRuntimeExports.jsx("option",{value:"Other",children:"Other"})]})]}),jsxRuntimeExports.jsxs("div"
,{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Number of Learners"}),jsxRuntimeExports.jsx
("input",{type:"number",value:cs.numberOfLearners,onChange:Lt=>Es({...cs,numberOfLearners:Lt.target.value}),min:"0"})]}
)]}),jsxRuntimeExports.jsxs("div",{className:"form-row",children:[jsxRuntimeExports.jsxs("div",{className:"form-group",
children:[jsxRuntimeExports.jsx("label",{children:"SETA"}),jsxRuntimeExports.jsxs("select",{value:cs.seta,onChange:Lt=>
Es({...cs,seta:Lt.target.value}),children:[jsxRuntimeExports.jsx("option",{value:"",children:"Select SETA"}),jsxRuntime
Exports.jsx("option",{value:"MERSETA",children:"MERSETA"}),jsxRuntimeExports.jsx("option",{value:"W&RSETA",children:"W&
RSETA"}),jsxRuntimeExports.jsx("option",{value:"FASSET",children:"FASSET"}),jsxRuntimeExports.jsx("option",{value:"BANK
SETA",children:"BANKSETA"}),jsxRuntimeExports.jsx("option",{value:"INSETA",children:"INSETA"}),jsxRuntimeExports.jsx("o
ption",{value:"ETDP SETA",children:"ETDP SETA"}),jsxRuntimeExports.jsx("option",{value:"Other",children:"Other"})]})]})
,jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Budget 
Estimate (R)"}),jsxRuntimeExports.jsx("input",{type:"number",value:cs.budgetEstimate,onChange:Lt=>Es({...cs,budgetEstim
ate:Lt.target.value}),min:"0",step:"0.01"})]})]}),jsxRuntimeExports.jsxs("div",{className:"form-row",children:[jsxRunti
meExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"BBBEE Contribution Targ
et"}),jsxRuntimeExports.jsx("input",{type:"text",value:cs.bbbeeContribution,onChange:Lt=>Es({...cs,bbbeeContribution:Lt
.target.value}),placeholder:"e.g., Level 1, 2, etc."})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children
:[jsxRuntimeExports.jsx("label",{children:"Expected Closing Date"}),jsxRuntimeExports.jsx("input",{type:"date",value:cs
.expectedClosingDate,onChange:Lt=>Es({...cs,expectedClosingDate:Lt.target.value})})]})]}),jsxRuntimeExports.jsxs("div",
{className:"form-row",children:[jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("l
abel",{children:"Deal Value (R)"}),jsxRuntimeExports.jsx("input",{type:"number",value:cs.value,onChange:Lt=>Es({...cs,v
alue:Lt.target.value}),placeholder:"0",min:"0",step:"0.01"})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",ch
ildren:[jsxRuntimeExports.jsx("label",{children:"Priority"}),jsxRuntimeExports.jsxs("select",{value:cs.priority,onChang
e:Lt=>Es({...cs,priority:Lt.target.value}),children:[jsxRuntimeExports.jsx("option",{value:"Low",children:"Low"}),jsxRu
ntimeExports.jsx("option",{value:"Normal",children:"Normal"}),jsxRuntimeExports.jsx("option",{value:"High",children:"Hi
gh"}),jsxRuntimeExports.jsx("option",{value:"Urgent",children:"Urgent"})]})]})]}),jsxRuntimeExports.jsxs("div",{classNa
me:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Details"}),jsxRuntimeExports.jsx("textarea",{rows:"4
",value:cs.details,onChange:Lt=>Es({...cs,details:Lt.target.value}),placeholder:"Enter deal details..."})]}),jsxRuntime
Exports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Supporting Documents"}),j
sxRuntimeExports.jsx("input",{type:"text",value:cs.supportingDocuments,onChange:Lt=>Es({...cs,supportingDocuments:Lt.ta
rget.value}),placeholder:"List supporting documents (e.g., Proposal.pdf, Quote.xlsx)"})]}),jsxRuntimeExports.jsxs("div"
,{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Stage"}),jsxRuntimeExports.jsx("select",{va
lue:cs.stage,onChange:Lt=>Es({...cs,stage:Lt.target.value}),children:bt.map(Lt=>jsxRuntimeExports.jsx("option",{value:L
t.id,children:Lt.name},Lt.id))})]}),jsxRuntimeExports.jsxs("div",{className:"form-actions",children:[jsxRuntimeExports.
jsx("button",{type:"button",onClick:()=>_(!1),className:"cancel-btn",children:"Cancel"}),jsxRuntimeExports.jsx("button"
,{type:"submit",className:"save-btn",children:"Create Deal"})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"pipelin
e-metrics",children:[jsxRuntimeExports.jsxs("div",{className:"metric-card",children:[jsxRuntimeExports.jsx("div",{class
Name:"metric-label",children:"Pipeline Value"}),jsxRuntimeExports.jsx("div",{className:"metric-value",children:Ct($t.pi
pelineValue)})]}),jsxRuntimeExports.jsxs("div",{className:"metric-card",children:[jsxRuntimeExports.jsx("div",{classNam
e:"metric-label",children:"Active Deals"}),jsxRuntimeExports.jsx("div",{className:"metric-value",children:$t.activeDeal
s})]}),jsxRuntimeExports.jsxs("div",{className:"metric-card",children:[jsxRuntimeExports.jsx("div",{className:"metric-l
abel",children:"Win Rate"}),jsxRuntimeExports.jsxs("div",{className:"metric-value",children:[$t.winRate,"%"]})]}),jsxRu
ntimeExports.jsxs("div",{className:"metric-card",children:[jsxRuntimeExports.jsx("div",{className:"metric-label",childr
en:"Avg Deal Size"}),jsxRuntimeExports.jsx("div",{className:"metric-value",children:Ct($t.avgDealSize)})]})]}),jsxRunti
meExports.jsxs("div",{className:"summary-cards",children:[jsxRuntimeExports.jsxs("div",{className:"summary-card",childr
en:[jsxRuntimeExports.jsx("div",{className:"summary-label",children:"Won Deals Value"}),jsxRuntimeExports.jsx("div",{cl
assName:"summary-value",children:Ct(s.filter(Lt=>Lt.stage==="won").reduce((Lt,Xt)=>Lt+(Xt.value||0),0))})]}),jsxRuntime
Exports.jsxs("div",{className:"summary-card",children:[jsxRuntimeExports.jsx("div",{className:"summary-label",children:
"Pipeline Value"}),jsxRuntimeExports.jsx("div",{className:"summary-value",children:Ct($t.pipelineValue)})]}),jsxRuntime
Exports.jsxs("div",{className:"summary-card",children:[jsxRuntimeExports.jsx("div",{className:"summary-label",children:
"Pending Revenue"}),jsxRuntimeExports.jsx("div",{className:"summary-value",children:Ct(s.filter(Lt=>["proposal-sent","a
waiting-decision","negotiation"].includes(Lt.stage)).reduce((Lt,Xt)=>Lt+(Xt.value||0),0))})]}),jsxRuntimeExports.jsxs("
div",{className:"summary-card",children:[jsxRuntimeExports.jsx("div",{className:"summary-label",children:"Avg Deal Size
"}),jsxRuntimeExports.jsx("div",{className:"summary-value",children:Ct($t.avgDealSize)})]})]}),jsxRuntimeExports.jsxs("
div",{className:"pipeline-filters",children:[jsxRuntimeExports.jsx("input",{type:"text",placeholder:"Search companies..
.",className:"search-input",value:tt,onChange:Lt=>mt(Lt.target.value)}),jsxRuntimeExports.jsxs("select",{className:"fil
ter-select",value:vt,onChange:Lt=>_t(Lt.target.value),children:[jsxRuntimeExports.jsx("option",{value:"all",children:"A
ll Stages"}),bt.map(Lt=>jsxRuntimeExports.jsx("option",{value:Lt.id,children:Lt.name},Lt.id))]}),jsxRuntimeExports.jsx(
"button",{className:"export-btn",children:"Export"}),jsxRuntimeExports.jsx("button",{className:"bulk-actions-btn",child
ren:"Bulk Actions"})]}),jsxRuntimeExports.jsx("div",{className:"kanban-board",children:bt.map(Lt=>{const 
Xt=gt(Lt.id);return jsxRuntimeExports.jsxs("div",{className:`kanban-column ${dt===Lt.id?"drag-over":""}`,onDragOver:Dt=
>ss(Dt,Lt.id),onDragLeave:ys,onDrop:Dt=>Et(Dt,Lt.id),children:[jsxRuntimeExports.jsxs("div",{className:"column-header",
style:{backgroundColor:Lt.color},children:[jsxRuntimeExports.jsx("h3",{children:Lt.name}),jsxRuntimeExports.jsx("span",
{className:"deal-count",children:Xt.length})]}),jsxRuntimeExports.jsxs("div",{className:"deals-list",children:[Xt.map(D
t=>{var Ht;return jsxRuntimeExports.jsxs("div",{className:`deal-card ${(wt==null?void 0:wt.id)===Dt.id?"dragging":""} $
{Dt.isClientPipeline?"client-pipeline-card":""}`,draggable:!0,onDragStart:os=>Wt(os,Dt),onDragEnd:ms,onClick:()=>rt(Dt)
,children:[Dt.isClientPipeline&&jsxRuntimeExports.jsx("div",{className:"client-pipeline-badge",children:"Client Status"
}),jsxRuntimeExports.jsx("div",{className:"deal-company",children:Dt.clientId?jsxRuntimeExports.jsx(Link,{to:`/clients/
${Dt.clientId}`,onClick:os=>os.stopPropagation(),children:zt(Dt.clientId)}):Dt.company||"Unnamed 
Company"}),Dt.product&&jsxRuntimeExports.jsxs("div",{className:"deal-product",children:["Product: ",Dt.product]}),Dt.co
ntact&&jsxRuntimeExports.jsx("div",{className:"deal-contact",children:Dt.contact}),Dt.details&&jsxRuntimeExports.jsxs("
div",{className:"deal-details",children:[Dt.details.substring(0,100),"..."]}),!Dt.isClientPipeline&&jsxRuntimeExports.j
sxs("div",{className:"deal-footer",children:[jsxRuntimeExports.jsx("div",{className:"deal-value",children:Ct(Dt.value||
Dt.budgetEstimate||0)}),jsxRuntimeExports.jsx("span",{className:`priority-badge priority-${(Ht=Dt.priority)==null?void 
0:Ht.toLowerCase()}`,children:Dt.priority||"Normal"})]}),Dt.numberOfLearners&&jsxRuntimeExports.jsxs("div",{className:"
deal-meta",children:["Learners: ",Dt.numberOfLearners]}),Dt.expectedClosingDate&&jsxRuntimeExports.jsxs("div",{classNam
e:"deal-meta",children:["Closing: 
",Pt(Dt.expectedClosingDate)]}),Dt.lastContact&&jsxRuntimeExports.jsxs("div",{className:"deal-meta",children:["Last 
Contact: ",Pt(Dt.lastContact)]}),Dt.nextAction&&jsxRuntimeExports.jsxs("div",{className:"deal-meta",children:["Next: ",
Dt.nextAction]}),jsxRuntimeExports.jsxs("div",{className:"deal-actions",children:[jsxRuntimeExports.jsx("button",{class
Name:"action-btn",onClick:os=>{os.stopPropagation(),rt(Dt)},children:"View"}),Lt.id!=="won"&&Lt.id!=="lost"&&jsxRuntime
Exports.jsx("button",{className:"action-btn",onClick:os=>{os.stopPropagation();const 
Qt=bt.findIndex(Ft=>Ft.id===Lt.id);Qt<bt.length-1&&Gt(Dt.id,bt[Qt+1].id)},children:"Next 
Stage"})]})]},Dt.id)}),Xt.length===0&&jsxRuntimeExports.jsx("div",{className:"empty-stage",children:"No deals in this s
tage"})]})]},Lt.id)})}),$&&jsxRuntimeExports.jsx("div",{className:"deal-modal",onClick:()=>rt(null),children:jsxRuntime
Exports.jsxs("div",{className:"deal-modal-content",onClick:Lt=>Lt.stopPropagation(),children:[jsxRuntimeExports.jsxs("d
iv",{className:"modal-header",children:[jsxRuntimeExports.jsx("h2",{children:$.company||"Deal Details"}),jsxRuntimeExpo
rts.jsx("button",{className:"close-btn",onClick:()=>rt(null),children:"Ã—"})]}),jsxRuntimeExports.jsxs("div",{className
:"modal-body",children:[$.clientId&&jsxRuntimeExports.jsxs("div",{className:"detail-item",children:[jsxRuntimeExports.j
sx("span",{className:"detail-label",children:"Client:"}),jsxRuntimeExports.jsx("span",{className:"detail-value",childre
n:jsxRuntimeExports.jsx(Link,{to:`/clients/${$.clientId}`,children:zt($.clientId)})})]}),jsxRuntimeExports.jsxs("div",{
className:"detail-item",children:[jsxRuntimeExports.jsx("span",{className:"detail-label",children:"Contact:"}),jsxRunti
meExports.jsx("span",{className:"detail-value",children:$.contact||"N/A"})]}),$.product&&jsxRuntimeExports.jsxs("div",{
className:"detail-item",children:[jsxRuntimeExports.jsx("span",{className:"detail-label",children:"Product:"}),jsxRunti
meExports.jsx("span",{className:"detail-value",children:$.product})]}),$.numberOfLearners&&jsxRuntimeExports.jsxs("div"
,{className:"detail-item",children:[jsxRuntimeExports.jsx("span",{className:"detail-label",children:"Number of Learners
:"}),jsxRuntimeExports.jsx("span",{className:"detail-value",children:$.numberOfLearners})]}),$.seta&&jsxRuntimeExports.
jsxs("div",{className:"detail-item",children:[jsxRuntimeExports.jsx("span",{className:"detail-label",children:"SETA:"})
,jsxRuntimeExports.jsx("span",{className:"detail-value",children:$.seta})]}),jsxRuntimeExports.jsxs("div",{className:"d
etail-item",children:[jsxRuntimeExports.jsx("span",{className:"detail-label",children:"Deal Value:"}),jsxRuntimeExports
.jsx("span",{className:"detail-value",children:Ct($.value||0)})]}),$.budgetEstimate&&jsxRuntimeExports.jsxs("div",{clas
sName:"detail-item",children:[jsxRuntimeExports.jsx("span",{className:"detail-label",children:"Budget Estimate:"}),jsxR
untimeExports.jsx("span",{className:"detail-value",children:Ct($.budgetEstimate)})]}),$.bbbeeContribution&&jsxRuntimeEx
ports.jsxs("div",{className:"detail-item",children:[jsxRuntimeExports.jsx("span",{className:"detail-label",children:"BB
BEE Contribution:"}),jsxRuntimeExports.jsx("span",{className:"detail-value",children:$.bbbeeContribution})]}),$.expecte
dClosingDate&&jsxRuntimeExports.jsxs("div",{className:"detail-item",children:[jsxRuntimeExports.jsx("span",{className:"
detail-label",children:"Expected Closing Date:"}),jsxRuntimeExports.jsx("span",{className:"detail-value",children:Pt($.
expectedClosingDate)})]}),jsxRuntimeExports.jsxs("div",{className:"detail-item",children:[jsxRuntimeExports.jsx("span",
{className:"detail-label",children:"Priority:"}),jsxRuntimeExports.jsx("span",{className:"detail-value",children:$.prio
rity||"Normal"})]}),jsxRuntimeExports.jsxs("div",{className:"detail-item",children:[jsxRuntimeExports.jsx("span",{class
Name:"detail-label",children:"Stage:"}),jsxRuntimeExports.jsx("span",{className:"detail-value",children:((Bt=bt.find(Lt
=>Lt.id===$.stage))==null?void 0:Bt.name)||"N/A"})]}),$.details&&jsxRuntimeExports.jsxs("div",{className:"detail-item f
ull-width",children:[jsxRuntimeExports.jsx("span",{className:"detail-label",children:"Details:"}),jsxRuntimeExports.jsx
("span",{className:"detail-value",children:$.details})]}),$.supportingDocuments&&jsxRuntimeExports.jsxs("div",{classNam
e:"detail-item full-width",children:[jsxRuntimeExports.jsx("span",{className:"detail-label",children:"Supporting Docume
nts:"}),jsxRuntimeExports.jsx("span",{className:"detail-value",children:$.supportingDocuments})]}),$.nextAction&&jsxRun
timeExports.jsxs("div",{className:"detail-item",children:[jsxRuntimeExports.jsx("span",{className:"detail-label",childr
en:"Next Action:"}),jsxRuntimeExports.jsx("span",{className:"detail-value",children:$.nextAction})]}),$.lastContact&&js
xRuntimeExports.jsxs("div",{className:"detail-item",children:[jsxRuntimeExports.jsx("span",{className:"detail-label",ch
ildren:"Last Contact:"}),jsxRuntimeExports.jsx("span",{className:"detail-value",children:Pt($.lastContact)})]})]}),jsxR
untimeExports.jsxs("div",{className:"modal-actions",children:[jsxRuntimeExports.jsx("button",{className:"action-btn",ch
ildren:"Edit"}),jsxRuntimeExports.jsx("button",{className:"action-btn",children:"Message"}),jsxRuntimeExports.jsx("butt
on",{className:"action-btn",onClick:()=>rt(null),children:"Close"})]})]})})]})},FollowUpTasks=()=>{const[s,e]=reactExpo
rts.useState([]),[i,a]=reactExports.useState([]),[o,c]=reactExports.useState([]),[d,h]=reactExports.useState(!0),[j,_]=
reactExports.useState(!1),[$,rt]=reactExports.useState([]),[tt,mt]=reactExports.useState([]),[vt,_t]=reactExports.useSt
ate({status:"all",userId:"all",dateRange:"all"}),{currentUser:wt,isSystemAdmin:ht,accessibleUserIds:dt,isTeamManager:jt
,isSalesHead:bt,hierarchyLoading:ut}=useTenant(),Rt=ht||jt()||bt(),st=wt==null?void 0:wt.uid,[it,nt]=reactExports.useSt
ate({clientId:"",description:"",type:"Call",dueDate:"",priority:"Normal",notes:"",assignedTo:st||""}),ct=["Call","Email
","Proposal","Demo","Meeting","Follow-up on 
quote","Other"];reactExports.useEffect(()=>{!ut&&wt&&xt()},[ut,wt,dt]),reactExports.useEffect(()=>{yt()},[s,vt]);const 
xt=async()=>{try{const[gt,ft,zt]=await Promise.all([getFollowUpTasks(),getUsers$1(),getClients()]);a(gt);let 
Ct=gt;!ht&&!bt()&&(Ct=gt.filter($t=>dt.includes($t.assignedTo)||dt.includes($t.createdBy))),e(Ct);let Pt=zt;!ht&&!bt()&
&(Pt=zt.filter($t=>dt.includes($t.assignedSalesPerson)||dt.includes($t.createdBy))),mt(Pt),rt(ft),h(!1)}catch(gt){conso
le.error("Error loading data:",gt),h(!1)}},yt=()=>{let gt=[...s];if(vt.status!=="all"&&(gt=gt.filter(ft=>ft.status===vt
.status)),vt.userId!=="all"&&(gt=gt.filter(ft=>ft.assignedTo===vt.userId)),vt.dateRange!=="all"){const ft=new 
Date;gt=gt.filter(zt=>{if(!zt.dueDate)return!1;const Ct=zt.dueDate.toDate?zt.dueDate.toDate():new 
Date(zt.dueDate);switch(vt.dateRange){case"overdue":return Ct<ft&&zt.status==="pending";case"today":return 
Ct.toDateString()===ft.toDateString();case"thisWeek":const Pt=new Date(ft.getTime()+7*24*60*60*1e3);return 
Ct<=Pt&&Ct>=ft;default:return!0}})}gt.sort((ft,zt)=>{var $t,Bt;const 
Ct=($t=ft.dueDate)!=null&&$t.toDate?ft.dueDate.toDate():new 
Date(ft.dueDate||0),Pt=(Bt=zt.dueDate)!=null&&Bt.toDate?zt.dueDate.toDate():new Date(zt.dueDate||0);return 
Ct-Pt}),c(gt)},Tt=async gt=>{gt.preventDefault();try{const ft={...it,createdBy:st};await createFollowUpTask(ft),_(!1),n
t({clientId:"",description:"",type:"Call",dueDate:"",priority:"Normal",notes:"",assignedTo:st||""}),xt()}catch(ft){cons
ole.error("Error creating task:",ft),alert("Failed to create task. Please try 
again.")}},fs=async(gt,ft="")=>{try{await completeFollowUpTask(gt,ft),xt()}catch(zt){console.error("Error completing 
task:",zt),alert("Failed to complete task. Please try again.")}},cs=gt=>gt?(gt.toDate?gt.toDate():new 
Date(gt)).toLocaleDateString("en-ZA"):"N/A",Es=gt=>{if(!gt)return null;const Ct=(gt.toDate?gt.toDate():new 
Date(gt))-new Date;return Math.ceil(Ct/(1e3*60*60*24))},ls=gt=>{const ft=tt.find(zt=>zt.id===gt);return 
ft?ft.name||ft.legalName||"Unknown":"Unknown Client"},Yt=gt=>{const ft=$.find(zt=>zt.id===gt);return 
ft?ft.displayName||ft.email||"Unknown":"Unknown User"},Mt=s.filter(gt=>{if(gt.status!=="pending")return!1;const 
ft=Es(gt.dueDate);return ft!==null&&ft<0}),Gt=s.filter(gt=>gt.status!=="pending"?!1:Es(gt.dueDate)===0),Wt=s.filter(gt=
>{if(gt.status!=="pending")return!1;const ft=Es(gt.dueDate);return 
ft!==null&&ft>0&&ft<=7}),ms=gt=>{if(!gt.nextFollowUpDate)return{status:"none",daysUntil:null};const ft=new 
Date;ft.setHours(0,0,0,0);const zt=gt.nextFollowUpDate.toDate?gt.nextFollowUpDate.toDate():new 
Date(gt.nextFollowUpDate);zt.setHours(0,0,0,0);const Ct=zt-ft,Pt=Math.ceil(Ct/(1e3*60*60*24));return Pt<0?{status:"over
due",daysUntil:Pt}:Pt===0?{status:"due-today",daysUntil:0}:Pt<=7?{status:"due-soon",daysUntil:Pt}:{status:"scheduled",d
aysUntil:Pt}},ss=tt.filter(gt=>gt.nextFollowUpDate).map(gt=>({...gt,followUpStatus:ms(gt)})).sort((gt,ft)=>{const 
zt=gt.followUpStatus.daysUntil??999,Ct=ft.followUpStatus.daysUntil??999;return zt-Ct}),ys=ss.filter(gt=>gt.followUpStat
us.status==="overdue"),Et=ss.filter(gt=>gt.followUpStatus.status==="due-today");return ss.filter(gt=>gt.followUpStatus.
status==="due-soon"),d?jsxRuntimeExports.jsxs("div",{className:"follow-up-tasks",children:[jsxRuntimeExports.jsx("h1",{
children:"Follow-Up Tasks"}),jsxRuntimeExports.jsx("p",{children:"Loading..."})]}):jsxRuntimeExports.jsxs("div",{classN
ame:"follow-up-tasks",children:[jsxRuntimeExports.jsxs("div",{className:"tasks-header",children:[jsxRuntimeExports.jsxs
("h1",{children:["Follow-Up Tasks ",!Rt&&jsxRuntimeExports.jsx("span",{className:"page-subtitle",children:"(My 
Tasks)"})]}),jsxRuntimeExports.jsx("button",{className:"add-task-btn",onClick:()=>_(!j),children:"+ Create Follow-Up Ta
sk"})]}),jsxRuntimeExports.jsxs("div",{className:"task-summary",children:[jsxRuntimeExports.jsxs("div",{className:"summ
ary-card overdue",children:[jsxRuntimeExports.jsx("div",{className:"summary-label",children:"Overdue"}),jsxRuntimeExpor
ts.jsx("div",{className:"summary-value",children:Mt.length})]}),jsxRuntimeExports.jsxs("div",{className:"summary-card 
today",children:[jsxRuntimeExports.jsx("div",{className:"summary-label",children:"Due Today"}),jsxRuntimeExports.jsx("d
iv",{className:"summary-value",children:Gt.length})]}),jsxRuntimeExports.jsxs("div",{className:"summary-card 
this-week",children:[jsxRuntimeExports.jsx("div",{className:"summary-label",children:"Due This Week"}),jsxRuntimeExport
s.jsx("div",{className:"summary-value",children:Wt.length})]}),jsxRuntimeExports.jsxs("div",{className:"summary-card co
mpleted",children:[jsxRuntimeExports.jsx("div",{className:"summary-label",children:"Completed"}),jsxRuntimeExports.jsx(
"div",{className:"summary-value",children:s.filter(gt=>gt.status==="completed").length})]})]}),ss.length>0&&jsxRuntimeE
xports.jsxs("div",{className:"client-followups-section",children:[jsxRuntimeExports.jsxs("h3",{children:["Upcoming 
Client Follow-Ups",(ys.length>0||Et.length>0)&&jsxRuntimeExports.jsxs("span",{className:"followup-alert-badge",children
:[ys.length+Et.length," Needs Attention"]})]}),jsxRuntimeExports.jsx("div",{className:"client-followups-grid",children:
ss.slice(0,10).map(gt=>jsxRuntimeExports.jsxs("div",{className:`client-followup-card followup-${gt.followUpStatus.statu
s}`,children:[jsxRuntimeExports.jsx(Link,{to:`/clients/${gt.id}`,className:"client-followup-name",children:gt.name||gt.
legalName||"Unknown"}),jsxRuntimeExports.jsxs("div",{className:"client-followup-info",children:[jsxRuntimeExports.jsxs(
"span",{className:`followup-status-badge 
${gt.followUpStatus.status}`,children:[gt.followUpStatus.status==="overdue"&&`${Math.abs(gt.followUpStatus.daysUntil)} 
days overdue`,gt.followUpStatus.status==="due-today"&&"Due Today",gt.followUpStatus.status==="due-soon"&&`In 
${gt.followUpStatus.daysUntil} days`,gt.followUpStatus.status==="scheduled"&&`In ${gt.followUpStatus.daysUntil} days`]}
),jsxRuntimeExports.jsx("span",{className:"followup-date",children:cs(gt.nextFollowUpDate)})]}),gt.nextFollowUpType&&js
xRuntimeExports.jsxs("div",{className:"client-followup-type",children:[gt.nextFollowUpType,gt.nextFollowUpReason&&`: ${
gt.nextFollowUpReason}`]})]},gt.id))}),ss.length>10&&jsxRuntimeExports.jsxs("div",{className:"show-more-text",children:
["+",ss.length-10," more clients with scheduled follow-ups"]})]}),j&&jsxRuntimeExports.jsxs("div",{className:"create-ta
sk-form",children:[jsxRuntimeExports.jsxs("div",{className:"form-header",children:[jsxRuntimeExports.jsx("h2",{children
:"Create Follow-Up Task"}),jsxRuntimeExports.jsx("button",{className:"close-btn",onClick:()=>_(!1),children:"Ã—"})]}),j
sxRuntimeExports.jsxs("form",{onSubmit:Tt,children:[jsxRuntimeExports.jsxs("div",{className:"form-row",children:[jsxRun
timeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Client *"}),jsxRuntim
eExports.jsxs("select",{value:it.clientId,onChange:gt=>nt({...it,clientId:gt.target.value}),required:!0,children:[jsxRu
ntimeExports.jsx("option",{value:"",children:"Select Client"}),tt.map(gt=>jsxRuntimeExports.jsx("option",{value:gt.id,c
hildren:gt.name||gt.legalName||"Unknown"},gt.id))]})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[
jsxRuntimeExports.jsx("label",{children:"Type *"}),jsxRuntimeExports.jsx("select",{value:it.type,onChange:gt=>nt({...it
,type:gt.target.value}),required:!0,children:ct.map(gt=>jsxRuntimeExports.jsx("option",{value:gt,children:gt},gt))})]})
]}),jsxRuntimeExports.jsxs("div",{className:"form-row",children:[jsxRuntimeExports.jsxs("div",{className:"form-group",c
hildren:[jsxRuntimeExports.jsx("label",{children:"Description *"}),jsxRuntimeExports.jsx("input",{type:"text",value:it.
description,onChange:gt=>nt({...it,description:gt.target.value}),required:!0,placeholder:"What needs to be done?"})]}),
jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Due Date *"}),j
sxRuntimeExports.jsx("input",{type:"date",value:it.dueDate,onChange:gt=>nt({...it,dueDate:gt.target.value}),required:!0
})]})]}),jsxRuntimeExports.jsxs("div",{className:"form-row",children:[jsxRuntimeExports.jsxs("div",{className:"form-gro
up",children:[jsxRuntimeExports.jsx("label",{children:"Priority"}),jsxRuntimeExports.jsxs("select",{value:it.priority,o
nChange:gt=>nt({...it,priority:gt.target.value}),children:[jsxRuntimeExports.jsx("option",{value:"Low",children:"Low"})
,jsxRuntimeExports.jsx("option",{value:"Normal",children:"Normal"}),jsxRuntimeExports.jsx("option",{value:"High",childr
en:"High"}),jsxRuntimeExports.jsx("option",{value:"Urgent",children:"Urgent"})]})]}),jsxRuntimeExports.jsxs("div",{clas
sName:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Assigned To *"}),jsxRuntimeExports.jsxs("select",
{value:it.assignedTo,onChange:gt=>nt({...it,assignedTo:gt.target.value}),required:!0,children:[jsxRuntimeExports.jsx("o
ption",{value:"",children:"Select User"}),Rt?$.map(gt=>jsxRuntimeExports.jsx("option",{value:gt.id,children:gt.displayN
ame||gt.email||gt.id},gt.id)):jsxRuntimeExports.jsx("option",{value:st,children:"Myself"})]})]})]}),jsxRuntimeExports.j
sxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Notes"}),jsxRuntimeExports.jsx("te
xtarea",{rows:"3",value:it.notes,onChange:gt=>nt({...it,notes:gt.target.value}),placeholder:"Additional notes..."})]}),
jsxRuntimeExports.jsxs("div",{className:"form-actions",children:[jsxRuntimeExports.jsx("button",{type:"button",onClick:
()=>_(!1),className:"cancel-btn",children:"Cancel"}),jsxRuntimeExports.jsx("button",{type:"submit",className:"save-btn"
,children:"Create Task"})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"tasks-filters",children:[jsxRuntimeExports.
jsxs("select",{value:vt.status,onChange:gt=>_t({...vt,status:gt.target.value}),children:[jsxRuntimeExports.jsx("option"
,{value:"all",children:"All Status"}),jsxRuntimeExports.jsx("option",{value:"pending",children:"Pending"}),jsxRuntimeEx
ports.jsx("option",{value:"completed",children:"Completed"})]}),Rt&&jsxRuntimeExports.jsxs("select",{value:vt.userId,on
Change:gt=>_t({...vt,userId:gt.target.value}),children:[jsxRuntimeExports.jsx("option",{value:"all",children:"All Users
"}),$.map(gt=>jsxRuntimeExports.jsx("option",{value:gt.id,children:gt.displayName||gt.email||gt.id},gt.id))]}),jsxRunti
meExports.jsxs("select",{value:vt.dateRange,onChange:gt=>_t({...vt,dateRange:gt.target.value}),children:[jsxRuntimeExpo
rts.jsx("option",{value:"all",children:"All Dates"}),jsxRuntimeExports.jsx("option",{value:"overdue",children:"Overdue"
}),jsxRuntimeExports.jsx("option",{value:"today",children:"Due 
Today"}),jsxRuntimeExports.jsx("option",{value:"thisWeek",children:"Due This 
Week"})]})]}),jsxRuntimeExports.jsx("div",{className:"tasks-list",children:o.length>0?o.map(gt=>{var Ct;const 
ft=Es(gt.dueDate),zt=ft!==null&&ft<0&&gt.status==="pending";return jsxRuntimeExports.jsxs("div",{className:`task-card 
${zt?"overdue":""} task-${gt.status}`,children:[jsxRuntimeExports.jsxs("div",{className:"task-card-header",children:[js
xRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(Link,{to:`/clients/${gt.clientId}`,className:"task-client-l
ink",children:ls(gt.clientId)}),jsxRuntimeExports.jsx("span",{className:"task-type",children:gt.type})]}),jsxRuntimeExp
orts.jsx("span",{className:`task-status task-status-${gt.status}`,children:gt.status})]}),jsxRuntimeExports.jsx("div",{
className:"task-description",children:gt.description}),jsxRuntimeExports.jsxs("div",{className:"task-meta",children:[Rt
&&jsxRuntimeExports.jsxs("span",{children:["Assigned to: 
",Yt(gt.assignedTo)]}),jsxRuntimeExports.jsxs("span",{children:["Due: ",cs(gt.dueDate)]}),ft!==null&&gt.status==="pendi
ng"&&jsxRuntimeExports.jsx("span",{className:zt?"overdue-badge":"days-badge",children:zt?`${Math.abs(ft)} days 
overdue`:`${ft} days remaining`}),jsxRuntimeExports.jsx("span",{className:`priority-badge 
priority-${(Ct=gt.priority)==null?void 0:Ct.toLowerCase()}`,children:gt.priority})]}),gt.notes&&jsxRuntimeExports.jsx("
div",{className:"task-notes",children:gt.notes}),gt.status==="pending"&&jsxRuntimeExports.jsx("div",{className:"task-ac
tions",children:jsxRuntimeExports.jsx("button",{className:"complete-btn",onClick:()=>{const Pt=prompt("Add completion 
notes (optional):");Pt!==null&&fs(gt.id,Pt)},children:"Mark Complete"})}),gt.status==="completed"&&gt.completedAt&&jsxR
untimeExports.jsxs("div",{className:"task-completed-info",children:["Completed on: 
",cs(gt.completedAt),gt.completedNotes&&jsxRuntimeExports.jsxs("div",{className:"completed-notes",children:["Notes: 
",gt.completedNotes]})]})]},gt.id)}):jsxRuntimeExports.jsx("p",{className:"no-tasks",children:"No tasks found."})})]})}
,Reports=()=>{const[s,e]=reactExports.useState(!0),[i,a]=reactExports.useState([]),[o,c]=reactExports.useState([]),[d,h
]=reactExports.useState({salesperson:"all",dealAge:"all",sector:"all",seta:"all"}),[j,_]=reactExports.useState([]),{cur
rentUser:$,isSystemAdmin:rt,accessibleUserIds:tt,isTeamManager:mt,isSalesHead:vt,hierarchyLoading:_t}=useTenant(),wt=rt
||mt()||vt();$==null||$.uid,reactExports.useEffect(()=>{!_t&&$&&ht()},[_t,$,tt]),reactExports.useEffect(()=>{dt()},[i,d
]);const ht=async()=>{try{const[nt,ct,xt,yt]=await 
Promise.all([getClients(),getDeals(),getFollowUpTasks(),getUsers$1()]);_(yt);let Tt=nt,fs=ct,cs=xt;!rt&&!vt()&&(Tt=nt.f
ilter(Gt=>tt.includes(Gt.assignedSalesPerson)||tt.includes(Gt.createdBy)),fs=ct.filter(Gt=>tt.includes(Gt.assignedTo)||
tt.includes(Gt.createdBy)),cs=xt.filter(Gt=>tt.includes(Gt.assignedTo)||tt.includes(Gt.createdBy)));const Es=fs.filter(
Gt=>Gt.stage!=="won"&&Gt.stage!=="lost"),Mt=Tt.filter(Gt=>Es.some(Wt=>Wt.clientId===Gt.id)).map(Gt=>{const Wt=Es.filter
(Pt=>Pt.clientId===Gt.id),ms=cs.filter(Pt=>Pt.clientId===Gt.id&&Pt.status==="pending"),ss=ms.filter(Pt=>Pt.dueDate?(Pt.
dueDate.toDate?Pt.dueDate.toDate():new Date(Pt.dueDate))>=new Date:!1),ys=ms.length>0?ms.sort((Pt,$t)=>{var 
Xt,Dt;const Bt=(Xt=Pt.dueDate)!=null&&Xt.toDate?Pt.dueDate.toDate():new 
Date(Pt.dueDate||0);return((Dt=$t.dueDate)!=null&&Dt.toDate?$t.dueDate.toDate():new 
Date($t.dueDate||0))-Bt})[0]:null,Et=ys!=null&&ys.dueDate?ys.dueDate.toDate?ys.dueDate.toDate():new 
Date(ys.dueDate):null,gt=Et?Math.floor((new 
Date-Et)/(1e3*60*60*24)):null,ft=ss.length>0,zt=ms.some(Pt=>Pt.dueDate?(Pt.dueDate.toDate?Pt.dueDate.toDate():new 
Date(Pt.dueDate))<new Date:!1),Ct=Wt.reduce((Pt,$t)=>Pt+($t.value||$t.budgetEstimate||0),0);return{client:Gt,deals:Wt,t
otalDealValue:Ct,lastFollowUpDate:Et,daysSinceLastFollowUp:gt,hasUpcomingFollowUp:ft,hasOverdueFollowUp:zt,upcomingTask
sCount:ss.length,overdueTasksCount:ms.filter(Pt=>Pt.dueDate?(Pt.dueDate.toDate?Pt.dueDate.toDate():new 
Date(Pt.dueDate))<new Date:!1).length}}).filter(Gt=>!Gt.hasUpcomingFollowUp||Gt.hasOverdueFollowUp);a(Mt),e(!1)}catch(n
t){console.error("Error loading report data:",nt),e(!1)}},dt=()=>{let nt=[...i];if(d.salesperson!=="all"&&(nt=nt.filter
(ct=>ct.client.assignedSalesPerson===d.salesperson)),d.dealAge!=="all"){const ct=new Date;nt=nt.filter(xt=>{var 
cs;const yt=xt.deals.sort((Es,ls)=>{var Gt,Wt;const Yt=(Gt=Es.createdAt)!=null&&Gt.toDate?Es.createdAt.toDate():new 
Date(Es.createdAt||0),Mt=(Wt=ls.createdAt)!=null&&Wt.toDate?ls.createdAt.toDate():new Date(ls.createdAt||0);return 
Yt-Mt})[0];if(!yt)return!1;const Tt=(cs=yt.createdAt)!=null&&cs.toDate?yt.createdAt.toDate():new 
Date(yt.createdAt||0),fs=Math.floor((ct-Tt)/(1e3*60*60*24));switch(d.dealAge){case"0-30":return 
fs<=30;case"31-60":return fs>30&&fs<=60;case"61-90":return fs>60&&fs<=90;case"90+":return 
fs>90;default:return!0}})}d.sector!=="all"&&(nt=nt.filter(ct=>{var xt;return(xt=ct.client.sector)==null?void 0:xt.toLow
erCase().includes(d.sector.toLowerCase())})),d.seta!=="all"&&(nt=nt.filter(ct=>ct.client.seta===d.seta||ct.deals.some(x
t=>xt.seta===d.seta))),nt.sort((ct,xt)=>{const 
yt=ct.daysSinceLastFollowUp??999;return(xt.daysSinceLastFollowUp??999)-yt}),c(nt)},jt=nt=>new 
Intl.NumberFormat("en-ZA",{style:"currency",currency:"ZAR",minimumFractionDigits:0}).format(nt||0),bt=nt=>nt?(nt 
instanceof Date?nt:nt.toDate?nt.toDate():new Date(nt)).toLocaleDateString("en-ZA"):"Never",ut=nt=>nt.hasOverdueFollowUp
?"red":!nt.hasUpcomingFollowUp&&nt.daysSinceLastFollowUp!==null?nt.daysSinceLastFollowUp>30?"red":nt.daysSinceLastFollo
wUp>14?"amber":"green":nt.hasUpcomingFollowUp?"green":"red",Rt=nt=>nt.hasOverdueFollowUp?"Overdue 
Follow-Ups":!nt.hasUpcomingFollowUp&&nt.daysSinceLastFollowUp!==null?nt.daysSinceLastFollowUp>30?"No Follow-Up > 30 
Days":nt.daysSinceLastFollowUp>14?"No Follow-Up > 14 Days":"Recent Follow-Up":nt.hasUpcomingFollowUp?"Has Upcoming 
Follow-Ups":"No Follow-Ups",st=nt=>{if(!nt)return"Unassigned";const ct=j.find(xt=>xt.id===nt);return 
ct&&(ct.displayName||ct.email)||"Unknown"},it=()=>{const nt=["Client Name","Salesperson","Deal Value","Number of 
Deals","Last Follow-Up","Days Since Last Follow-Up","Status","Sector","SETA"],ct=o.map(cs=>[cs.client.name||cs.client.l
egalName||"Unknown",st(cs.client.assignedSalesPerson),jt(cs.totalDealValue),cs.deals.length,bt(cs.lastFollowUpDate),cs.
daysSinceLastFollowUp??"N/A",Rt(cs),cs.client.sector||"N/A",cs.client.seta||"N/A"]),xt=[nt.join(","),...ct.map(cs=>cs.m
ap(Es=>`"${Es}"`).join(","))].join(`
  `),yt=new Blob([xt],{type:"text/csv"}),Tt=window.URL.createObjectURL(yt),fs=document.createElement("a");fs.href=Tt,fs
.download=`clients-active-deals-no-followups-${new 
Date().toISOString().split("T")[0]}.csv`,fs.click(),window.URL.revokeObjectURL(Tt)};return s?jsxRuntimeExports.jsxs("di
v",{className:"reports",children:[jsxRuntimeExports.jsx("h1",{children:"Reports"}),jsxRuntimeExports.jsx("p",{children:
"Loading..."})]}):jsxRuntimeExports.jsxs("div",{className:"reports",children:[jsxRuntimeExports.jsxs("div",{className:"
reports-header",children:[jsxRuntimeExports.jsxs("h1",{children:[wt?"Clients With Active Deals & No Follow-Ups":"My 
Clients With Active Deals & No Follow-Ups",!wt&&jsxRuntimeExports.jsx("span",{className:"page-subtitle",children:"(My 
Report)"})]}),jsxRuntimeExports.jsx("button",{className:"export-btn",onClick:it,children:"Export to CSV"})]}),jsxRuntim
eExports.jsxs("div",{className:"report-summary",children:[jsxRuntimeExports.jsxs("div",{className:"summary-item",childr
en:[jsxRuntimeExports.jsx("span",{className:"summary-label",children:"Total Clients at Risk:"}),jsxRuntimeExports.jsx("
span",{className:"summary-value",children:o.length})]}),jsxRuntimeExports.jsxs("div",{className:"summary-item",children
:[jsxRuntimeExports.jsx("span",{className:"summary-label",children:"Total Pipeline Value:"}),jsxRuntimeExports.jsx("spa
n",{className:"summary-value",children:jt(o.reduce((nt,ct)=>nt+ct.totalDealValue,0))})]}),jsxRuntimeExports.jsxs("div",
{className:"summary-item",children:[jsxRuntimeExports.jsx("span",{className:"summary-label",children:"Clients with 
Overdue Follow-Ups:"}),jsxRuntimeExports.jsx("span",{className:"summary-value",children:o.filter(nt=>nt.hasOverdueFollo
wUp).length})]})]}),jsxRuntimeExports.jsxs("div",{className:"report-filters",children:[wt&&jsxRuntimeExports.jsxs("sele
ct",{value:d.salesperson,onChange:nt=>h({...d,salesperson:nt.target.value}),children:[jsxRuntimeExports.jsx("option",{v
alue:"all",children:"All Salespeople"}),j.map(nt=>jsxRuntimeExports.jsx("option",{value:nt.id,children:nt.displayName||
nt.email||nt.id},nt.id))]}),jsxRuntimeExports.jsxs("select",{value:d.dealAge,onChange:nt=>h({...d,dealAge:nt.target.val
ue}),children:[jsxRuntimeExports.jsx("option",{value:"all",children:"All Deal 
Ages"}),jsxRuntimeExports.jsx("option",{value:"0-30",children:"0-30 
Days"}),jsxRuntimeExports.jsx("option",{value:"31-60",children:"31-60 
Days"}),jsxRuntimeExports.jsx("option",{value:"61-90",children:"61-90 
Days"}),jsxRuntimeExports.jsx("option",{value:"90+",children:"90+ 
Days"})]}),jsxRuntimeExports.jsx("input",{type:"text",placeholder:"Filter by Sector",value:d.sector==="all"?"":d.sector
,onChange:nt=>h({...d,sector:nt.target.value||"all"})}),jsxRuntimeExports.jsxs("select",{value:d.seta,onChange:nt=>h({.
..d,seta:nt.target.value}),children:[jsxRuntimeExports.jsx("option",{value:"all",children:"All SETAs"}),jsxRuntimeExpor
ts.jsx("option",{value:"MERSETA",children:"MERSETA"}),jsxRuntimeExports.jsx("option",{value:"W&RSETA",children:"W&RSETA
"}),jsxRuntimeExports.jsx("option",{value:"FASSET",children:"FASSET"}),jsxRuntimeExports.jsx("option",{value:"BANKSETA"
,children:"BANKSETA"}),jsxRuntimeExports.jsx("option",{value:"INSETA",children:"INSETA"}),jsxRuntimeExports.jsx("option
",{value:"ETDP SETA",children:"ETDP SETA"})]})]}),jsxRuntimeExports.jsx("div",{className:"report-table-container",child
ren:jsxRuntimeExports.jsxs("table",{className:"report-table",children:[jsxRuntimeExports.jsx("thead",{children:jsxRunti
meExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("th",{children:"Client"}),wt&&jsxRuntimeExports.jsx("th",{children
:"Salesperson"}),jsxRuntimeExports.jsx("th",{children:"Deal Value"}),jsxRuntimeExports.jsx("th",{children:"# 
Deals"}),jsxRuntimeExports.jsx("th",{children:"Last Follow-Up"}),jsxRuntimeExports.jsx("th",{children:"Days Since"}),js
xRuntimeExports.jsx("th",{children:"Status"}),jsxRuntimeExports.jsx("th",{children:"Actions"})]})}),jsxRuntimeExports.j
sx("tbody",{children:o.length>0?o.map((nt,ct)=>{const xt=ut(nt);return jsxRuntimeExports.jsxs("tr",{className:`status-$
{xt}`,children:[jsxRuntimeExports.jsx("td",{children:jsxRuntimeExports.jsx(Link,{to:`/clients/${nt.client.id}`,children
:nt.client.name||nt.client.legalName||"Unknown"})}),wt&&jsxRuntimeExports.jsx("td",{children:st(nt.client.assignedSales
Person)}),jsxRuntimeExports.jsx("td",{children:jt(nt.totalDealValue)}),jsxRuntimeExports.jsx("td",{children:nt.deals.le
ngth}),jsxRuntimeExports.jsx("td",{children:bt(nt.lastFollowUpDate)}),jsxRuntimeExports.jsx("td",{children:nt.daysSince
LastFollowUp!==null?`${nt.daysSinceLastFollowUp} 
days`:"Never"}),jsxRuntimeExports.jsx("td",{children:jsxRuntimeExports.jsx("span",{className:`status-badge status-${xt}
`,children:Rt(nt)})}),jsxRuntimeExports.jsxs("td",{children:[jsxRuntimeExports.jsx(Link,{to:`/clients/${nt.client.id}`,
className:"action-link",children:"View Client"})," | 
",jsxRuntimeExports.jsx(Link,{to:`/follow-up-tasks?clientId=${nt.client.id}`,className:"action-link",children:"View Tas
ks"})]})]},nt.client.id)}):jsxRuntimeExports.jsx("tr",{children:jsxRuntimeExports.jsx("td",{colSpan:wt?8:7,className:"n
o-data",children:"No clients found matching the criteria."})})})]})})]})},RoleManagement=()=>{const[s,e]=reactExports.u
seState([]),[i,a]=reactExports.useState([]),[o,c]=reactExports.useState(!0),[d,h]=reactExports.useState(!1),[j,_]=react
Exports.useState(null),[$,rt]=reactExports.useState({name:"",description:"",permissions:[]});reactExports.useEffect(()=
>{tt()},[]);const tt=async()=>{try{await initializeDefaultRoles();const[ut,Rt]=await 
Promise.all([getRoles(),getUsers$1()]);e(ut.filter(st=>!st.deleted)),a(Rt),c(!1)}catch(ut){console.error("Error 
loading data:",ut),c(!1)}},mt=(ut,Rt)=>{var ct;const st=s.find(xt=>xt.id===ut);if(!st)return;const it=(ct=st.permission
s)!=null&&ct.includes(Rt)?st.permissions.filter(xt=>xt!==Rt):[...st.permissions||[],Rt],nt=s.map(xt=>xt.id===ut?{...xt,
permissions:it}:xt);e(nt),(j==null?void 0:j.id)===ut&&_({...j,permissions:it})},vt=async ut=>{try{const 
Rt=s.find(st=>st.id===ut);if(!Rt)return;await 
saveRole(ut,{name:Rt.name,description:Rt.description||"",permissions:Rt.permissions||[]}),alert("Role updated 
successfully!"),tt()}catch(Rt){console.error("Error saving role:",Rt),alert("Failed to save role. Please try 
again.")}},_t=async()=>{try{await Promise.all(s.map(ut=>saveRole(ut.id,{name:ut.name,description:ut.description||"",per
missions:ut.permissions||[]}))),alert("All role changes saved successfully!"),tt()}catch(ut){console.error("Error 
saving all roles:",ut),alert("Failed to save all roles. Please try 
again.")}},wt=async()=>{try{if(!$.name.trim()){alert("Please enter a role name");return}const 
ut=$.name.toLowerCase().replace(/\s+/g,"-");await saveRole(ut,{name:$.name,description:$.description,permissions:$.perm
issions}),rt({name:"",description:"",permissions:[]}),h(!1),tt(),alert("Role created 
successfully!")}catch(ut){console.error("Error creating role:",ut),alert("Failed to create role. Please try 
again.")}},ht=async ut=>{if(window.confirm("Are you sure you want to delete this role? Users with this role will need 
to be reassigned."))try{await deleteRole(ut),tt(),alert("Role deleted successfully!")}catch(Rt){console.error("Error 
deleting role:",Rt),alert(Rt.message||"Failed to delete role. Please try 
again.")}},dt=ut=>{_(ut)},jt=()=>{_(null),tt()},bt=async(ut,Rt)=>{try{await updateUserRole(ut,Rt),tt(),alert("User 
role updated successfully!")}catch(st){console.error("Error updating user role:",st),alert("Failed to update user 
role. Please try again.")}};return 
o?jsxRuntimeExports.jsxs("div",{className:"role-management",children:[jsxRuntimeExports.jsx("h1",{children:"Role Manage
ment"}),jsxRuntimeExports.jsx("p",{children:"Loading..."})]}):jsxRuntimeExports.jsxs("div",{className:"role-management"
,children:[jsxRuntimeExports.jsxs("div",{className:"role-management-header",children:[jsxRuntimeExports.jsx("h1",{child
ren:"Role Management"}),jsxRuntimeExports.jsx("button",{className:"add-role-btn",onClick:()=>h(!0),children:"+ Add New 
Role"})]}),d&&jsxRuntimeExports.jsxs("div",{className:"add-role-form",children:[jsxRuntimeExports.jsxs("div",{className
:"form-header",children:[jsxRuntimeExports.jsx("h2",{children:"Create New Role"}),jsxRuntimeExports.jsx("button",{class
Name:"close-btn",onClick:()=>{h(!1),rt({name:"",description:"",permissions:[]})},children:"Ã—"})]}),jsxRuntimeExports.j
sxs("div",{className:"form-content",children:[jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntime
Exports.jsx("label",{children:"Role Name *"}),jsxRuntimeExports.jsx("input",{type:"text",value:$.name,onChange:ut=>rt({
...$,name:ut.target.value}),placeholder:"e.g., Account Manager",required:!0})]}),jsxRuntimeExports.jsxs("div",{classNam
e:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Description"}),jsxRuntimeExports.jsx("textarea",{rows
:"3",value:$.description,onChange:ut=>rt({...$,description:ut.target.value}),placeholder:"Describe the role's responsib
ilities..."})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children
:"Permissions"}),jsxRuntimeExports.jsx("div",{className:"permissions-container",children:getFeatureCategories().map(ut=
>{const Rt=SYSTEM_FEATURES.filter(st=>st.category===ut);return jsxRuntimeExports.jsxs("div",{className:"permission-cate
gory",children:[jsxRuntimeExports.jsx("h4",{className:"category-heading-small",children:ut}),jsxRuntimeExports.jsx("div
",{className:"permissions-list",children:Rt.map(st=>jsxRuntimeExports.jsxs("label",{className:"permission-checkbox",chi
ldren:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:$.permissions.includes(st.id),onChange:it=>{it.target.che
cked?rt({...$,permissions:[...$.permissions,st.id]}):rt({...$,permissions:$.permissions.filter(nt=>nt!==st.id)})}}),jsx
RuntimeExports.jsx("span",{children:st.name})]},st.id))})]},ut)})})]}),jsxRuntimeExports.jsxs("div",{className:"form-ac
tions",children:[jsxRuntimeExports.jsx("button",{type:"button",className:"cancel-btn",onClick:()=>{h(!1),rt({name:"",de
scription:"",permissions:[]})},children:"Cancel"}),jsxRuntimeExports.jsx("button",{type:"button",className:"save-btn",o
nClick:wt,children:"Create Role"})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"role-grid-container",children:[jsx
RuntimeExports.jsxs("table",{className:"role-permissions-grid",children:[jsxRuntimeExports.jsx("thead",{children:jsxRun
timeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("th",{className:"feature-column",children:"System Features"}),s.
map(ut=>jsxRuntimeExports.jsx("th",{className:"role-column",children:jsxRuntimeExports.jsxs("div",{className:"role-head
er",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("strong",{children:ut.name}),ut.description
&&jsxRuntimeExports.jsx("div",{className:"role-description",children:ut.description})]}),jsxRuntimeExports.jsx("div",{c
lassName:"role-actions",children:(j==null?void 0:j.id)===ut.id?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{child
ren:[jsxRuntimeExports.jsx("button",{className:"save-role-btn",onClick:()=>vt(ut.id),children:"Save"}),jsxRuntimeExport
s.jsx("button",{className:"cancel-role-btn",onClick:jt,children:"Cancel"})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.
Fragment,{children:[jsxRuntimeExports.jsx("button",{className:"edit-role-btn",onClick:()=>dt(ut),children:"Edit"}),!["a
dmin","accountant","salesperson","manager"].includes(ut.id)&&jsxRuntimeExports.jsx("button",{className:"delete-role-btn
",onClick:()=>ht(ut.id),children:"Delete"})]})})]})},ut.id))]})}),jsxRuntimeExports.jsx("tbody",{children:getFeatureCat
egories().map(ut=>{const Rt=SYSTEM_FEATURES.filter(st=>st.category===ut);return jsxRuntimeExports.jsxs(React.Fragment,{
children:[jsxRuntimeExports.jsxs("tr",{className:"category-row",children:[jsxRuntimeExports.jsx("td",{className:"catego
ry-header-cell feature-column",children:jsxRuntimeExports.jsx("strong",{children:ut})}),jsxRuntimeExports.jsx("td",{col
Span:s.length,className:"category-header-cell",children:jsxRuntimeExports.jsx("strong",{children:ut})})]}),Rt.map(st=>j
sxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("td",{className:"feature-name",children:st.name}),s.map(it=
>{var nt;return jsxRuntimeExports.jsx("td",{className:"permission-cell",children:jsxRuntimeExports.jsx("input",{type:"c
heckbox",checked:((nt=it.permissions)==null?void 
0:nt.includes(st.id))||!1,onChange:()=>mt(it.id,st.id),disabled:(j==null?void 0:j.id)!==it.id&&j!==null})},it.id)})]},s
t.id))]},ut)})})]}),jsxRuntimeExports.jsx("div",{className:"role-grid-actions",children:jsxRuntimeExports.jsx("button",
{type:"button",className:"save-all-roles-btn",onClick:_t,children:"Save All Changes"})})]}),jsxRuntimeExports.jsxs("div
",{className:"user-roles-section",children:[jsxRuntimeExports.jsx("h2",{children:"User Role Assignment"}),jsxRuntimeExp
orts.jsxs("table",{className:"user-roles-table",children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsx
s("tr",{children:[jsxRuntimeExports.jsx("th",{children:"User"}),jsxRuntimeExports.jsx("th",{children:"Email"}),jsxRunti
meExports.jsx("th",{children:"Current Role"}),jsxRuntimeExports.jsx("th",{children:"Change 
Role"})]})}),jsxRuntimeExports.jsx("tbody",{children:i.map(ut=>{var Rt;return jsxRuntimeExports.jsxs("tr",{children:[js
xRuntimeExports.jsx("td",{children:ut.displayName||ut.email||"Unknown"}),jsxRuntimeExports.jsx("td",{children:ut.email|
|"N/A"}),jsxRuntimeExports.jsx("td",{children:jsxRuntimeExports.jsx("span",{className:"current-role",children:((Rt=s.fi
nd(st=>st.id===(ut.role||"salesperson")))==null?void 0:Rt.name)||"Salesperson"})}),jsxRuntimeExports.jsx("td",{children
:jsxRuntimeExports.jsx("select",{value:ut.role||"salesperson",onChange:st=>bt(ut.id,st.target.value),children:s.map(st=
>jsxRuntimeExports.jsx("option",{value:st.id,children:st.name},st.id))})})]},ut.id)})})]})]})]})},createUserAccount=asy
nc(s,e)=>{const{email:i,password:a,displayName:o,role:c,tenantId:d,isSystemAdmin:h,requirePasswordChange:j}=s;if(!i)thr
ow new Error("Email is required");if(!a)throw new Error("Password is required");if(a.length<6)throw new 
Error("Password must be at least 6 characters");if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(i))throw new Error("Invalid 
email format");try{const $=collection(db,"users"),rt=query($,where("email","==",i.toLowerCase()));if(!(await 
getDocs(rt)).empty)throw new Error("A user with this email already exists");const vt=(await 
createUserWithEmailAndPassword(secondaryAuth,i,a)).user.uid;await signOut(secondaryAuth);const _t={email:i.toLowerCase(
),displayName:o||i.split("@")[0],role:c||"salesperson",tenantId:d||null,isSystemAdmin:h||!1,requirePasswordChange:j||!1
,customPermissions:[],phone:"",title:"",department:"",bio:"",provider:"email",createdAt:serverTimestamp(),createdBy:e,u
pdatedAt:serverTimestamp()};return await setDoc(doc(db,"users",vt),_t),{id:vt,..._t}}catch($){throw 
console.error("Error creating user account:",$),$.code==="auth/email-already-in-use"?new Error("This email is already 
registered. The user may need to be added to a tenant instead."):$.code==="auth/invalid-email"?new Error("Invalid 
email address format"):$.code==="auth/weak-password"?new Error("Password must be at least 6 
characters"):$}},UserManagement=()=>{var Os;const{getTenantId:s,isSystemAdmin:e,currentUser:i}=useTenant(),[a,o]=reactE
xports.useState([]),[c,d]=reactExports.useState([]),[h,j]=reactExports.useState([]),[_,$]=reactExports.useState([]),[rt
,tt]=reactExports.useState(!0),[mt,vt]=reactExports.useState("list"),[_t,wt]=reactExports.useState(null),[ht,dt]=reactE
xports.useState({}),[jt,bt]=reactExports.useState(null),[ut,Rt]=reactExports.useState("all"),[st,it]=reactExports.useSt
ate(!1),[nt,ct]=reactExports.useState(!1),[xt,yt]=reactExports.useState({email:"",displayName:"",password:"",confirmPas
sword:"",role:"salesperson",tenantId:"",isSystemAdmin:!1}),[Tt,fs]=reactExports.useState(!1),[cs,Es]=reactExports.useSt
ate([]),[ls,Yt]=reactExports.useState([]),[Mt,Gt]=reactExports.useState(""),[Wt,ms]=reactExports.useState(!0),[ss,ys]=r
eactExports.useState({current:0,total:0,results:[]}),[Et,gt]=reactExports.useState(!1),ft=reactExports.useRef(null),zt=
s();reactExports.useEffect(()=>{Ct()},[e]);const Ct=async()=>{try{const qt=e?null:zt,[js,es]=await 
Promise.all([getUsersByTenant(qt),getRoles()]);o(js),d(es.filter(Rs=>!Rs.deleted));try{const Rs=await 
getManagersInTenant(zt);j(Rs)}catch(Rs){console.error("Error loading managers:",Rs)}if(e)try{const Rs=await 
getTenants();$(Rs)}catch(Rs){console.error("Error loading tenants:",Rs)}const vs={};js.forEach(Rs=>{Rs.customPermission
s&&(vs[Rs.id]=Rs.customPermissions)}),dt(vs),tt(!1)}catch(qt){console.error("Error loading 
data:",qt),tt(!1)}},Pt=async qt=>{if(qt.preventDefault(),!xt.email){alert("Email is 
required");return}if(!xt.password){alert("Password is required");return}if(xt.password.length<6){alert("Password must 
be at least 6 characters");return}if(xt.password!==xt.confirmPassword){alert("Passwords do not 
match");return}ct(!0);try{await createUserAccount({email:xt.email,password:xt.password,displayName:xt.displayName,role:
xt.role,tenantId:e?xt.tenantId:zt,isSystemAdmin:xt.isSystemAdmin},i==null?void 0:i.uid),alert(`User ${xt.email} 
created successfully! They can now log in with the password you set.`),it(!1),yt({email:"",displayName:"",password:"",c
onfirmPassword:"",role:"salesperson",tenantId:"",isSystemAdmin:!1}),Ct()}catch(js){console.error("Error adding 
user:",js),alert(js.message||"Failed to create user")}finally{ct(!1)}},$t=qt=>{const 
js=qt.target.files[0];if(!js)return;const es=new FileReader;es.onload=vs=>{const 
Rs=vs.target.result;Bt(Rs)},es.readAsText(js)},Bt=qt=>{const js=qt.split(`
  `).filter(Tn=>Tn.trim()),es=[],vs=[],Rs=js[0].toLowerCase().includes("email")?1:0;for(let 
Tn=Rs;Tn<js.length;Tn++){const Hs=js[Tn].trim();if(!Hs)continue;const En=Hs.split(",").map(Ln=>Ln.trim().replace(/^["']
|["']$/g,"")),Hn=En[0],Ps=En[1]||"",Ts=En[2]||"";if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(Hn)){es.push(`Row ${Tn+1}: 
Invalid email "${Hn}"`);continue}if(!Ts){es.push(`Row ${Tn+1}: Role is required for "${Hn}". Valid roles: 
${c.map(Ln=>Ln.id).join(", 
")}`);continue}if(c.length>0&&!c.find(hn=>hn.id===Ts||hn.name.toLowerCase()===Ts.toLowerCase())){es.push(`Row ${Tn+1}: 
Invalid role "${Ts}" for "${Hn}". Valid roles: ${c.map(hn=>hn.id).join(", ")}`);continue}vs.push({email:Hn,displayName:
Ps||Hn.split("@")[0],role:Ts||"",row:Tn+1})}Es(vs),Yt(es)},Lt=async()=>{if(cs.length===0){alert("No valid users to 
upload");return}if(!Mt){alert("Please set a default password for all users.");return}if(Mt.length<6){alert("Default 
password must be at least 6 characters");return}gt(!0),ys({current:0,total:cs.length,results:[]});const qt=[];for(let 
vs=0;vs<cs.length;vs++){const Rs=cs[vs];ys(En=>({...En,current:vs+1}));const 
Tn=c.find(En=>En.id===Rs.role||En.name.toLowerCase()===Rs.role.toLowerCase()),Hs=Tn?Tn.id:Rs.role;try{await createUserA
ccount({email:Rs.email,password:Mt,displayName:Rs.displayName,role:Hs,tenantId:e?null:zt,isSystemAdmin:!1,requirePasswo
rdChange:Wt},i==null?void 0:i.uid),qt.push({email:Rs.email,success:!0})}catch(En){qt.push({email:Rs.email,success:!1,er
ror:En.message})}}ys(vs=>({...vs,results:qt})),gt(!1);const 
js=qt.filter(vs=>vs.success).length,es=qt.filter(vs=>!vs.success).length;es===0?(alert(`Successfully created ${js} 
users!${Wt?" Users will be prompted to change their password on first login.":""}`),Xt(),Ct()):alert(`Created ${js} 
users. ${es} failed. Check the results below.`)},Xt=()=>{Es([]),Yt([]),Gt(""),ms(!0),ys({current:0,total:0,results:[]})
,fs(!1),ft.current&&(ft.current.value="")},Dt=async(qt,js)=>{try{await 
updateUserRole(qt,js),o(a.map(es=>es.id===qt?{...es,role:js}:es)),alert("User role updated 
successfully!")}catch(es){console.error("Error updating user role:",es),alert("Failed to update user role. Please try 
again.")}},Ht=async(qt,js)=>{bt(qt);try{js?(await 
assignSalespersonToManager(qt,js),o(a.map(vs=>vs.id===qt?{...vs,managerId:js}:vs))):(await 
removeSalespersonFromManager(qt),o(a.map(vs=>vs.id===qt?{...vs,managerId:null}:vs)));const es=await 
getManagersInTenant(zt);j(es)}catch(es){console.error("Error updating manager:",es),alert("Failed to update manager 
assignment. Please try again.")}finally{bt(null)}},os=qt=>{if(!qt)return[];const 
js=qt.tenantId,es=qt.role||"salesperson",vs=a.filter(Rs=>Rs.tenantId===js&&Rs.id!==qt.id);return es==="salesperson"?vs.
filter(Rs=>Rs.role==="manager"):es==="manager"?vs.filter(Rs=>Rs.role==="group-sales-manager"):[]},Qt=qt=>{if(!qt)return
"Unassigned";const js=_.find(es=>es.id===qt);return(js==null?void 0:js.name)||qt},Ft=e?ut!=="all"?a.filter(qt=>ut==="un
assigned"?!qt.tenantId:qt.tenantId===ut):a:a.filter(qt=>qt.tenantId===zt),xs=async(qt,js)=>{try{const 
es=ht[qt]||[],vs=es.includes(js)?es.filter(Tn=>Tn!==js):[...es,js],Rs=doc(db,"users",qt);await 
updateDoc(Rs,{customPermissions:vs,updatedAt:serverTimestamp()}),dt({...ht,[qt]:vs})}catch(es){console.error("Error 
updating user permissions:",es),alert("Failed to update permissions. Please try 
again.")}},Cs=qt=>{if(ht[qt.id]&&ht[qt.id].length>0)return ht[qt.id];const 
js=c.find(es=>es.id===(qt.role||"salesperson"));return(js==null?void 
0:js.permissions)||[]},gs=(qt,js)=>Cs(qt).includes(js);return 
rt?jsxRuntimeExports.jsxs("div",{className:"user-management",children:[jsxRuntimeExports.jsx("h1",{children:"User Manag
ement"}),jsxRuntimeExports.jsx("p",{children:"Loading..."})]}):jsxRuntimeExports.jsxs("div",{className:"user-management
",children:[jsxRuntimeExports.jsxs("div",{className:"user-management-header",children:[jsxRuntimeExports.jsx("h1",{chil
dren:"User Management"}),jsxRuntimeExports.jsxs("div",{className:"header-actions",children:[e&&jsxRuntimeExports.jsxs("
div",{className:"tenant-filter",children:[jsxRuntimeExports.jsx("label",{htmlFor:"tenantFilter",children:"Filter by Ten
ant:"}),jsxRuntimeExports.jsxs("select",{id:"tenantFilter",value:ut,onChange:qt=>Rt(qt.target.value),className:"tenant-
filter-select",children:[jsxRuntimeExports.jsxs("option",{value:"all",children:["All Tenants 
(",a.length,")"]}),jsxRuntimeExports.jsxs("option",{value:"unassigned",children:["Unassigned 
(",a.filter(qt=>!qt.tenantId).length,")"]}),_.map(qt=>{const js=a.filter(es=>es.tenantId===qt.id).length;return 
jsxRuntimeExports.jsxs("option",{value:qt.id,children:[qt.name||qt.id," 
(",js,")"]},qt.id)})]})]}),jsxRuntimeExports.jsx("button",{className:"add-user-btn",onClick:()=>it(!0),children:"+ Add 
User"}),jsxRuntimeExports.jsx("button",{className:"csv-upload-btn",onClick:()=>fs(!0),children:"Upload CSV"}),jsxRuntim
eExports.jsxs("div",{className:"view-mode-toggle",children:[jsxRuntimeExports.jsx("button",{className:mt==="list"?"acti
ve":"",onClick:()=>vt("list"),children:"List 
View"}),jsxRuntimeExports.jsx("button",{className:mt==="grid"?"active":"",onClick:()=>vt("grid"),children:"Grid View"})
]})]})]}),Tt&&jsxRuntimeExports.jsxs("div",{className:"csv-upload-form",children:[jsxRuntimeExports.jsx("h3",{children:
"Bulk Upload Users via CSV"}),jsxRuntimeExports.jsxs("p",{className:"form-hint",children:["Upload a CSV file with 
columns: ",jsxRuntimeExports.jsx("strong",{children:"email"}),", 
",jsxRuntimeExports.jsx("strong",{children:"displayName"})," (optional), 
",jsxRuntimeExports.jsx("strong",{children:"role"}),". All users will use the default password you set 
below.",!e&&jsxRuntimeExports.jsx("span",{children:" Users will be automatically assigned to your tenant."})]}),jsxRunt
imeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"CSV File"}),jsxRuntime
Exports.jsx("input",{type:"file",accept:".csv",ref:ft,onChange:$t,className:"file-input"})]}),jsxRuntimeExports.jsxs("d
iv",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Default Password (required for all 
users) 
*"}),jsxRuntimeExports.jsx("input",{type:"password",value:Mt,onChange:qt=>Gt(qt.target.value),placeholder:"Minimum 6 
characters",required:!0})]}),jsxRuntimeExports.jsxs("div",{className:"form-group checkbox-group",children:[jsxRuntimeEx
ports.jsxs("label",{children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:Wt,onChange:qt=>ms(qt.target.check
ed)}),"Require password change on first login"]}),jsxRuntimeExports.jsx("span",{className:"hint-text",children:"Users 
will be prompted to set a new password when they first log in"})]}),ls.length>0&&jsxRuntimeExports.jsxs("div",{classNam
e:"csv-errors",children:[jsxRuntimeExports.jsx("strong",{children:"Validation Errors:"}),jsxRuntimeExports.jsx("ul",{ch
ildren:ls.map((qt,js)=>jsxRuntimeExports.jsx("li",{children:qt},js))})]}),cs.length>0&&jsxRuntimeExports.jsxs("div",{cl
assName:"csv-preview",children:[jsxRuntimeExports.jsxs("h4",{children:["Preview (",cs.length," users to create)"]}),jsx
RuntimeExports.jsx("div",{className:"csv-table-wrapper",children:jsxRuntimeExports.jsxs("table",{className:"csv-table",
children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("th",{ch
ildren:"Row"}),jsxRuntimeExports.jsx("th",{children:"Email"}),jsxRuntimeExports.jsx("th",{children:"Display Name"}),jsx
RuntimeExports.jsx("th",{children:"Role"}),ss.results.length>0&&jsxRuntimeExports.jsx("th",{children:"Status"})]})}),js
xRuntimeExports.jsx("tbody",{children:cs.map((qt,js)=>{const es=ss.results.find(Rs=>Rs.email===qt.email),vs=qt.role?c.f
ind(Rs=>Rs.id===qt.role||Rs.name.toLowerCase()===qt.role.toLowerCase()):null;return jsxRuntimeExports.jsxs("tr",{classN
ame:es?es.success?"success-row":"error-row":"",children:[jsxRuntimeExports.jsx("td",{children:qt.row}),jsxRuntimeExport
s.jsx("td",{children:qt.email}),jsxRuntimeExports.jsx("td",{children:qt.displayName}),jsxRuntimeExports.jsx("td",{child
ren:vs?jsxRuntimeExports.jsx("span",{className:"role-set",children:vs.name}):jsxRuntimeExports.jsx("span",{className:"s
tatus-error",children:"Missing"})}),ss.results.length>0&&jsxRuntimeExports.jsx("td",{children:es?es.success?jsxRuntimeE
xports.jsx("span",{className:"status-success",children:"Created"}):jsxRuntimeExports.jsx("span",{className:"status-erro
r",title:es.error,children:"Failed"}):jsxRuntimeExports.jsx("span",{className:"status-pending",children:"Pending"})})]}
,js)})})]})})]}),Et&&jsxRuntimeExports.jsxs("div",{className:"upload-progress",children:[jsxRuntimeExports.jsx("div",{c
lassName:"progress-bar",children:jsxRuntimeExports.jsx("div",{className:"progress-fill",style:{width:`${ss.current/ss.t
otal*100}%`}})}),jsxRuntimeExports.jsxs("span",{children:["Processing ",ss.current," of ",ss.total,"..."]})]}),jsxRunti
meExports.jsxs("div",{className:"form-actions",children:[jsxRuntimeExports.jsx("button",{type:"button",className:"cance
l-btn",onClick:Xt,disabled:Et,children:"Cancel"}),jsxRuntimeExports.jsx("button",{type:"button",className:"submit-btn",
onClick:Lt,disabled:Et||cs.length===0,children:Et?"Creating Users...":`Create ${cs.length} Users`})]})]}),mt==="list"?j
sxRuntimeExports.jsxs("div",{className:"users-list-view",children:[jsxRuntimeExports.jsxs("table",{className:"users-tab
le",children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("th"
,{children:"User"}),jsxRuntimeExports.jsx("th",{children:"Email"}),e&&jsxRuntimeExports.jsx("th",{children:"Tenant"}),j
sxRuntimeExports.jsx("th",{children:"Role"}),jsxRuntimeExports.jsx("th",{children:"Manager"}),jsxRuntimeExports.jsx("th
",{children:"Custom Permissions"}),jsxRuntimeExports.jsx("th",{children:"Actions"})]})}),jsxRuntimeExports.jsx("tbody",
{children:Ft.map(qt=>{Cs(qt);const js=ht[qt.id]&&ht[qt.id].length>0;return jsxRuntimeExports.jsxs("tr",{children:[jsxRu
ntimeExports.jsx("td",{children:jsxRuntimeExports.jsxs("div",{className:"user-cell",children:[qt.photoURL?jsxRuntimeExp
orts.jsx("img",{src:qt.photoURL,alt:qt.displayName||qt.email,className:"user-avatar-small"}):jsxRuntimeExports.jsx("div
",{className:"user-avatar-small placeholder",children:(qt.displayName||qt.email||"U").charAt(0).toUpperCase()}),jsxRunt
imeExports.jsx("span",{children:qt.displayName||qt.email||"Unknown"})]})}),jsxRuntimeExports.jsx("td",{children:qt.emai
l||"N/A"}),e&&jsxRuntimeExports.jsx("td",{children:jsxRuntimeExports.jsx("span",{className:`tenant-badge ${qt.tenantId?
"":"unassigned"}`,children:Qt(qt.tenantId)})}),jsxRuntimeExports.jsx("td",{children:jsxRuntimeExports.jsx("select",{val
ue:qt.role||"salesperson",onChange:es=>Dt(qt.id,es.target.value),className:"role-select",children:c.map(es=>jsxRuntimeE
xports.jsx("option",{value:es.id,children:es.name},es.id))})}),jsxRuntimeExports.jsx("td",{children:qt.role==="salesper
son"||qt.role==="manager"?jsxRuntimeExports.jsxs("select",{value:qt.managerId||"",onChange:es=>Ht(qt.id,es.target.value
),className:"manager-select",disabled:jt===qt.id,children:[jsxRuntimeExports.jsx("option",{value:"",children:"No Manage
r"}),os(qt).map(es=>jsxRuntimeExports.jsx("option",{value:es.id,children:es.displayName||es.email},es.id))]}):jsxRuntim
eExports.jsx("span",{className:"no-manager-text",children:"N/A"})}),jsxRuntimeExports.jsx("td",{children:js?jsxRuntimeE
xports.jsxs("span",{className:"custom-permissions-badge",children:[ht[qt.id].length," custom 
permission(s)"]}):jsxRuntimeExports.jsx("span",{className:"role-permissions-badge",children:"Using role permissions"})}
),jsxRuntimeExports.jsx("td",{children:jsxRuntimeExports.jsxs("button",{className:"edit-permissions-btn",onClick:()=>wt
((_t==null?void 0:_t.id)===qt.id?null:qt),children:[(_t==null?void 0:_t.id)===qt.id?"Hide":"Edit"," Permissions"]})})]}
,qt.id)})})]}),_t&&jsxRuntimeExports.jsxs("div",{className:"permission-editor",children:[jsxRuntimeExports.jsxs("div",{
className:"editor-header",children:[jsxRuntimeExports.jsxs("h2",{children:["Edit Permissions for ",_t.displayName||_t.e
mail]}),jsxRuntimeExports.jsx("button",{className:"close-editor-btn",onClick:()=>wt(null),children:"Ã—"})]}),jsxRuntime
Exports.jsxs("div",{className:"editor-content",children:[jsxRuntimeExports.jsxs("p",{className:"editor-info",children:[
jsxRuntimeExports.jsx("strong",{children:"Current Role:"})," 
",((Os=c.find(qt=>qt.id===(_t.role||"salesperson")))==null?void 
0:Os.name)||"Salesperson"]}),jsxRuntimeExports.jsx("p",{className:"editor-info",children:"Custom permissions override 
role permissions. Uncheck all to use role permissions 
only."}),jsxRuntimeExports.jsx("div",{className:"permissions-container",children:getFeatureCategories().map(qt=>{const 
js=SYSTEM_FEATURES.filter(es=>es.category===qt);return jsxRuntimeExports.jsxs("div",{className:"permission-category",ch
ildren:[jsxRuntimeExports.jsx("h3",{className:"category-heading",children:qt}),jsxRuntimeExports.jsx("div",{className:"
permissions-grid",children:js.map(es=>{var Tn;const vs=gs(_t,es.id),Rs=(Tn=ht[_t.id])==null?void 
0:Tn.includes(es.id);return jsxRuntimeExports.jsxs("label",{className:"permission-item",children:[jsxRuntimeExports.jsx
("input",{type:"checkbox",checked:vs,onChange:()=>xs(_t.id,es.id)}),jsxRuntimeExports.jsx("span",{className:"permission
-name",children:es.name}),Rs&&jsxRuntimeExports.jsx("span",{className:"custom-indicator",children:"(Custom)"})]},es.id)
})})]},qt)})}),jsxRuntimeExports.jsx("div",{className:"editor-actions",children:jsxRuntimeExports.jsx("button",{classNa
me:"clear-custom-btn",onClick:async()=>{try{const qt=doc(db,"users",_t.id);await 
updateDoc(qt,{customPermissions:[],updatedAt:serverTimestamp()}),dt({...ht,[_t.id]:[]}),alert("Custom permissions 
cleared. User will use role permissions.")}catch(qt){console.error("Error clearing permissions:",qt),alert("Failed to 
clear permissions.")}},children:"Clear Custom Permissions"})})]})]})]}):jsxRuntimeExports.jsx("div",{className:"users-g
rid-view",children:jsxRuntimeExports.jsx("div",{className:"grid-container",children:jsxRuntimeExports.jsxs("table",{cla
ssName:"permissions-grid-table",children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{children
:[jsxRuntimeExports.jsx("th",{className:"feature-column",children:"Features"}),Ft.map(qt=>{var js;return jsxRuntimeExpo
rts.jsx("th",{className:"user-column",children:jsxRuntimeExports.jsxs("div",{className:"user-header",children:[qt.photo
URL?jsxRuntimeExports.jsx("img",{src:qt.photoURL,alt:qt.displayName||qt.email,className:"user-avatar-tiny"}):jsxRuntime
Exports.jsx("div",{className:"user-avatar-tiny placeholder",children:(qt.displayName||qt.email||"U").charAt(0).toUpperC
ase()}),jsxRuntimeExports.jsxs("div",{className:"user-header-info",children:[jsxRuntimeExports.jsx("div",{className:"us
er-name-small",children:qt.displayName||qt.email||"Unknown"}),jsxRuntimeExports.jsx("div",{className:"user-role-small",
children:((js=c.find(es=>es.id===(qt.role||"salesperson")))==null?void 0:js.name)||"Salesperson"})]})]})},qt.id)})]})})
,jsxRuntimeExports.jsx("tbody",{children:getFeatureCategories().map(qt=>{const 
js=SYSTEM_FEATURES.filter(es=>es.category===qt);return jsxRuntimeExports.jsxs(React.Fragment,{children:[jsxRuntimeExpor
ts.jsx("tr",{className:"category-row",children:jsxRuntimeExports.jsx("td",{colSpan:Ft.length+1,className:"category-head
er-cell",children:jsxRuntimeExports.jsx("strong",{children:qt})})}),js.map(es=>jsxRuntimeExports.jsxs("tr",{children:[j
sxRuntimeExports.jsx("td",{className:"feature-name-cell",children:es.name}),Ft.map(vs=>jsxRuntimeExports.jsx("td",{clas
sName:"permission-checkbox-cell",children:jsxRuntimeExports.jsx("input",{type:"checkbox",checked:gs(vs,es.id),onChange:
()=>xs(vs.id,es.id),title:`${es.name} for ${vs.displayName||vs.email}`})},vs.id))]},es.id))]},qt)})})]})})}),st&&jsxRun
timeExports.jsx("div",{className:"modal-overlay",children:jsxRuntimeExports.jsxs("div",{className:"add-user-modal",chil
dren:[jsxRuntimeExports.jsxs("div",{className:"modal-header",children:[jsxRuntimeExports.jsx("h2",{children:"Create 
New User"}),jsxRuntimeExports.jsx("button",{className:"close-modal-btn",onClick:()=>{it(!1),yt({email:"",displayName:""
,password:"",confirmPassword:"",role:"salesperson",tenantId:"",isSystemAdmin:!1})},children:"Ã—"})]}),jsxRuntimeExports
.jsxs("form",{onSubmit:Pt,className:"add-user-form",children:[jsxRuntimeExports.jsxs("div",{className:"form-group",chil
dren:[jsxRuntimeExports.jsx("label",{htmlFor:"email",children:"Email *"}),jsxRuntimeExports.jsx("input",{type:"email",i
d:"email",value:xt.email,onChange:qt=>yt({...xt,email:qt.target.value}),placeholder:"user@example.com",required:!0})]})
,jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"displayName",ch
ildren:"Display Name"}),jsxRuntimeExports.jsx("input",{type:"text",id:"displayName",value:xt.displayName,onChange:qt=>y
t({...xt,displayName:qt.target.value}),placeholder:"John Doe"})]}),jsxRuntimeExports.jsxs("div",{className:"form-group"
,children:[jsxRuntimeExports.jsx("label",{htmlFor:"password",children:"Password *"}),jsxRuntimeExports.jsx("input",{typ
e:"password",id:"password",value:xt.password,onChange:qt=>yt({...xt,password:qt.target.value}),placeholder:"Minimum 6 c
haracters",required:!0})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label
",{htmlFor:"confirmPassword",children:"Confirm Password *"}),jsxRuntimeExports.jsx("input",{type:"password",id:"confirm
Password",value:xt.confirmPassword,onChange:qt=>yt({...xt,confirmPassword:qt.target.value}),placeholder:"Confirm passwo
rd",required:!0})]}),e&&jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{h
tmlFor:"tenantId",children:"Tenant *"}),jsxRuntimeExports.jsxs("select",{id:"tenantId",value:xt.tenantId,onChange:qt=>y
t({...xt,tenantId:qt.target.value}),required:!0,children:[jsxRuntimeExports.jsx("option",{value:"",children:"Select a t
enant..."}),_.map(qt=>jsxRuntimeExports.jsx("option",{value:qt.id,children:qt.name||qt.id},qt.id))]})]}),jsxRuntimeExpo
rts.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"role",children:"Role"}),jsxRun
timeExports.jsx("select",{id:"role",value:xt.role,onChange:qt=>yt({...xt,role:qt.target.value}),children:c.length===0?j
sxRuntimeExports.jsx("option",{value:"salesperson",children:"Salesperson"}):c.map(qt=>jsxRuntimeExports.jsx("option",{v
alue:qt.id,children:qt.name},qt.id))})]}),e&&jsxRuntimeExports.jsxs("div",{className:"form-group checkbox-group",childr
en:[jsxRuntimeExports.jsxs("label",{children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:xt.isSystemAdmin,o
nChange:qt=>yt({...xt,isSystemAdmin:qt.target.checked})}),"Grant System Admin 
Access"]}),jsxRuntimeExports.jsx("span",{className:"hint-text",children:"System admins can manage all tenants and 
system 
settings"})]}),jsxRuntimeExports.jsx("div",{className:"form-info",children:jsxRuntimeExports.jsx("p",{children:"The 
user will be created immediately and can log in with the email and password you set."})}),jsxRuntimeExports.jsxs("div",
{className:"modal-actions",children:[jsxRuntimeExports.jsx("button",{type:"button",className:"cancel-btn",onClick:()=>{
it(!1),yt({email:"",displayName:"",password:"",confirmPassword:"",role:"salesperson",tenantId:"",isSystemAdmin:!1})},ch
ildren:"Cancel"}),jsxRuntimeExports.jsx("button",{type:"submit",className:"submit-btn",disabled:nt,children:nt?"Creatin
g...":"Create User"})]})]})]})})]})},validateFinancialYear=s=>{if(!s||typeof 
s!="string")return{isValid:!1,error:"Financial year is required"};const 
e=s.trim();if(!/^\d{4}\/\d{4}$/.test(e))return{isValid:!1,error:"Format must be YYYY/YYYY (e.g., 
2024/2025)"};const[a,o]=e.split("/").map(Number);return o!==a+1?{isValid:!1,error:"End year must be exactly one year 
after start year"}:a<2e3||a>2100?{isValid:!1,error:"Year must be between 2000 and 
2100"}:{isValid:!0,error:null}},validatePhoneNumber=s=>{if(!s||typeof 
s!="string")return{isValid:!0,error:null,formatted:null};const 
e=s.replace(/[^\d+]/g,"");if(e.length===0)return{isValid:!0,error:null,formatted:null};let i=e;return i.startsWith("+27
")?i="0"+i.substring(3):i.startsWith("27")&&i.length===11&&(i="0"+i.substring(2)),i.length!==10?{isValid:!1,error:"Phon
e number must be 10 digits",formatted:null}:i.startsWith("0")?{isValid:!0,error:null,formatted:`${i.substring(0,3)} 
${i.substring(3,6)} ${i.substring(6)}`}:{isValid:!1,error:"Phone number must start with 0 or 
+27",formatted:null}},validateEmail=s=>{if(!s||typeof s!="string")return{isValid:!0,error:null};const 
e=s.trim();return e.length===0?{isValid:!0,error:null}:/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)?{isValid:!0,error:null}:{is
Valid:!1,error:"Please enter a valid email address"}},FinancialYearEnd=()=>{const{getTenantId:s,currentTenant:e,isSyste
mAdmin:i}=useTenant(),a=s(),[o,c]=reactExports.useState(!0),[d,h]=reactExports.useState(!1),[j,_]=reactExports.useState
({currentFinancialYear:"",financialYearEnd:"",financialYearStart:"",reportingMonth:"",currencySymbol:"R"}),[$,rt]=react
Exports.useState({}),[tt,mt]=reactExports.useState(!1);reactExports.useEffect(()=>{a&&vt()},[a]);const 
vt=async()=>{try{const dt=await getFinancialYearSettings(a);_({currentFinancialYear:dt.currentFinancialYear||"",financi
alYearEnd:dt.financialYearEnd||"",financialYearStart:dt.financialYearStart||"",reportingMonth:dt.reportingMonth||dt.fin
ancialYearEnd||"",currencySymbol:dt.currencySymbol||"R"}),mt(dt.isSystemWide||!1),c(!1)}catch(dt){console.error("Error 
loading financial year data:",dt),c(!1)}},_t=dt=>{const{name:jt,value:bt}=dt.target;_(ut=>({...ut,[jt]:bt})),$[jt]&&rt(
ut=>({...ut,[jt]:null}))},wt=()=>{const dt={},jt=validateFinancialYear(j.currentFinancialYear);if(jt.isValid||(dt.curre
ntFinancialYear=jt.error),j.financialYearStart||(dt.financialYearStart="Please select a start 
month"),j.financialYearEnd||(dt.financialYearEnd="Please select an end 
month"),j.financialYearStart&&j.financialYearEnd){const bt=["January","February","March","April","May","June","July","A
ugust","September","October","November","December"],ut=bt.indexOf(j.financialYearStart),Rt=bt.indexOf(j.financialYearEn
d),st=(ut-1+12)%12;Rt!==st&&(dt.financialYearEnd=`For a 12-month FY starting in ${j.financialYearStart}, the end month 
should be ${bt[st]}`)}if(j.reportingMonth||(dt.reportingMonth="Please select a reporting 
month"),j.reportingMonth&&j.financialYearStart&&j.financialYearEnd){const bt=["January","February","March","April","May
","June","July","August","September","October","November","December"],ut=bt.indexOf(j.financialYearStart),Rt=bt.indexOf
(j.financialYearEnd),st=bt.indexOf(j.reportingMonth);let 
it=!1;ut<=Rt?it=st>=ut&&st<=Rt:it=st>=ut||st<=Rt,it||(dt.reportingMonth="Reporting month must be within the financial 
year period")}return rt(dt),Object.keys(dt).length===0},ht=async dt=>{if(dt.preventDefault(),!!wt()){h(!0);try{await 
saveFinancialYearSettings(j,a),mt(!1),alert(`Financial year settings saved successfully for ${(e==null?void 
0:e.name)||a}!`),h(!1)}catch(jt){console.error("Error saving financial year data:",jt),alert("Failed to save financial 
year settings. Please try again."),h(!1)}}};return o?jsxRuntimeExports.jsxs("div",{className:"financial-year-end",child
ren:[jsxRuntimeExports.jsx("h1",{children:"Financial Year End Management"}),jsxRuntimeExports.jsx("p",{children:"Loadin
g..."})]}):a?jsxRuntimeExports.jsxs("div",{className:"financial-year-end",children:[jsxRuntimeExports.jsxs("div",{class
Name:"fy-header",children:[jsxRuntimeExports.jsx("h1",{children:"Financial Year End 
Management"}),jsxRuntimeExports.jsxs("p",{className:"fy-description",children:["Configure the financial year settings 
for ",jsxRuntimeExports.jsx("strong",{children:(e==null?void 0:e.name)||a}),"."]}),tt&&jsxRuntimeExports.jsxs("div",{cl
assName:"info-banner",style:{background:"#e3f2fd",padding:"12px 
16px",borderRadius:"8px",marginTop:"12px",borderLeft:"4px solid 
#2196f3"},children:[jsxRuntimeExports.jsx("strong",{children:"Note:"})," Currently using system-wide defaults. Save to 
create tenant-specific settings."]})]}),jsxRuntimeExports.jsxs("form",{onSubmit:ht,className:"fy-form",children:[jsxRun
timeExports.jsxs("div",{className:"form-section",children:[jsxRuntimeExports.jsx("h2",{children:"Current Financial Year
"}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"currentFinan
cialYear",children:"Current Financial Year *"}),jsxRuntimeExports.jsx("input",{type:"text",id:"currentFinancialYear",na
me:"currentFinancialYear",value:j.currentFinancialYear,onChange:_t,placeholder:"e.g., 2024/2025",className:$.currentFin
ancialYear?"input-error":"",required:!0}),$.currentFinancialYear?jsxRuntimeExports.jsx("small",{className:"error-text",
children:$.currentFinancialYear}):jsxRuntimeExports.jsx("small",{children:"Format: YYYY/YYYY (e.g., 2024/2025)"})]})]})
,jsxRuntimeExports.jsxs("div",{className:"form-section",children:[jsxRuntimeExports.jsx("h2",{children:"Financial Year 
Period"}),jsxRuntimeExports.jsxs("div",{className:"form-row",children:[jsxRuntimeExports.jsxs("div",{className:"form-gr
oup",children:[jsxRuntimeExports.jsx("label",{htmlFor:"financialYearStart",children:"Financial Year Start *"}),jsxRunti
meExports.jsxs("select",{id:"financialYearStart",name:"financialYearStart",value:j.financialYearStart,onChange:_t,class
Name:$.financialYearStart?"input-error":"",required:!0,children:[jsxRuntimeExports.jsx("option",{value:"",children:"Sel
ect Month"}),jsxRuntimeExports.jsx("option",{value:"January",children:"January"}),jsxRuntimeExports.jsx("option",{value
:"February",children:"February"}),jsxRuntimeExports.jsx("option",{value:"March",children:"March"}),jsxRuntimeExports.js
x("option",{value:"April",children:"April"}),jsxRuntimeExports.jsx("option",{value:"May",children:"May"}),jsxRuntimeExp
orts.jsx("option",{value:"June",children:"June"}),jsxRuntimeExports.jsx("option",{value:"July",children:"July"}),jsxRun
timeExports.jsx("option",{value:"August",children:"August"}),jsxRuntimeExports.jsx("option",{value:"September",children
:"September"}),jsxRuntimeExports.jsx("option",{value:"October",children:"October"}),jsxRuntimeExports.jsx("option",{val
ue:"November",children:"November"}),jsxRuntimeExports.jsx("option",{value:"December",children:"December"})]}),$.financi
alYearStart&&jsxRuntimeExports.jsx("small",{className:"error-text",children:$.financialYearStart})]}),jsxRuntimeExports
.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"financialYearEnd",children:"Finan
cial Year End *"}),jsxRuntimeExports.jsxs("select",{id:"financialYearEnd",name:"financialYearEnd",value:j.financialYear
End,onChange:_t,className:$.financialYearEnd?"input-error":"",required:!0,children:[jsxRuntimeExports.jsx("option",{val
ue:"",children:"Select Month"}),jsxRuntimeExports.jsx("option",{value:"January",children:"January"}),jsxRuntimeExports.
jsx("option",{value:"February",children:"February"}),jsxRuntimeExports.jsx("option",{value:"March",children:"March"}),j
sxRuntimeExports.jsx("option",{value:"April",children:"April"}),jsxRuntimeExports.jsx("option",{value:"May",children:"M
ay"}),jsxRuntimeExports.jsx("option",{value:"June",children:"June"}),jsxRuntimeExports.jsx("option",{value:"July",child
ren:"July"}),jsxRuntimeExports.jsx("option",{value:"August",children:"August"}),jsxRuntimeExports.jsx("option",{value:"
September",children:"September"}),jsxRuntimeExports.jsx("option",{value:"October",children:"October"}),jsxRuntimeExport
s.jsx("option",{value:"November",children:"November"}),jsxRuntimeExports.jsx("option",{value:"December",children:"Decem
ber"})]}),$.financialYearEnd&&jsxRuntimeExports.jsx("small",{className:"error-text",children:$.financialYearEnd})]})]})
]}),jsxRuntimeExports.jsxs("div",{className:"form-section",children:[jsxRuntimeExports.jsx("h2",{children:"Reporting & 
Currency"}),jsxRuntimeExports.jsxs("div",{className:"form-row",children:[jsxRuntimeExports.jsxs("div",{className:"form-
group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"reportingMonth",children:"Reporting Month (latest YTD month) *
"}),jsxRuntimeExports.jsxs("select",{id:"reportingMonth",name:"reportingMonth",value:j.reportingMonth,onChange:_t,class
Name:$.reportingMonth?"input-error":"",required:!0,children:[jsxRuntimeExports.jsx("option",{value:"",children:"Select 
Month"}),jsxRuntimeExports.jsx("option",{value:"January",children:"January"}),jsxRuntimeExports.jsx("option",{value:"Fe
bruary",children:"February"}),jsxRuntimeExports.jsx("option",{value:"March",children:"March"}),jsxRuntimeExports.jsx("o
ption",{value:"April",children:"April"}),jsxRuntimeExports.jsx("option",{value:"May",children:"May"}),jsxRuntimeExports
.jsx("option",{value:"June",children:"June"}),jsxRuntimeExports.jsx("option",{value:"July",children:"July"}),jsxRuntime
Exports.jsx("option",{value:"August",children:"August"}),jsxRuntimeExports.jsx("option",{value:"September",children:"Se
ptember"}),jsxRuntimeExports.jsx("option",{value:"October",children:"October"}),jsxRuntimeExports.jsx("option",{value:"
November",children:"November"}),jsxRuntimeExports.jsx("option",{value:"December",children:"December"})]}),$.reportingMo
nth?jsxRuntimeExports.jsx("small",{className:"error-text",children:$.reportingMonth}):jsxRuntimeExports.jsx("small",{ch
ildren:"This is the last month for which actual YTD figures have been uploaded. Remaining months will be used for 
forecast entry."})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{htm
lFor:"currencySymbol",children:"Currency Symbol"}),jsxRuntimeExports.jsx("input",{type:"text",id:"currencySymbol",name:
"currencySymbol",value:j.currencySymbol,onChange:_t,maxLength:5}),jsxRuntimeExports.jsx("small",{children:"Displayed 
in financial dashboards (e.g. R, $, â‚¬)."})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"form-info",children:[jsx
RuntimeExports.jsx("h3",{children:"Information"}),jsxRuntimeExports.jsxs("ul",{children:[jsxRuntimeExports.jsxs("li",{c
hildren:["These settings are specific to ",jsxRuntimeExports.jsx("strong",{children:(e==null?void 0:e.name)||a})," and 
will not affect other tenants."]}),jsxRuntimeExports.jsx("li",{children:"The financial year settings are used for 
forecasting calculations and reporting."}),jsxRuntimeExports.jsx("li",{children:"All forecasts and reports will be 
based on these settings."}),jsxRuntimeExports.jsx("li",{children:"Changes to these settings will affect future 
forecasts and reports for this tenant only."})]})]}),jsxRuntimeExports.jsx("div",{className:"form-actions",children:jsx
RuntimeExports.jsx("button",{type:"submit",className:"save-btn",disabled:d,children:d?"Saving...":"Save Financial Year 
Settings"})})]})]}):jsxRuntimeExports.jsxs("div",{className:"financial-year-end",children:[jsxRuntimeExports.jsx("h1",{
children:"Financial Year End 
Management"}),jsxRuntimeExports.jsx("div",{className:"error-banner",children:jsxRuntimeExports.jsx("p",{children:"You 
are not assigned to a tenant. Please contact your administrator."})})]})},ConfirmDialog=({isOpen:s,title:e="Confirm Act
ion",message:i,confirmText:a="Confirm",cancelText:o="Cancel",variant:c="danger",onConfirm:d,onCancel:h,isLoading:j=!1})
=>{const _=reactExports.useRef(null),$=reactExports.useRef(null);if(reactExports.useEffect(()=>{var 
tt;if(s){(tt=$.current)==null||tt.focus();const mt=vt=>{vt.key==="Escape"&&!j&&(h==null||h())};return document.addEvent
Listener("keydown",mt),()=>document.removeEventListener("keydown",mt)}},[s,j,h]),reactExports.useEffect(()=>(s?document
.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[s]),!s)return 
null;const rt=tt=>{tt.target===tt.currentTarget&&!j&&(h==null||h())};return jsxRuntimeExports.jsx("div",{className:"con
firm-dialog-overlay",onClick:rt,role:"dialog","aria-modal":"true","aria-labelledby":"confirm-dialog-title",children:jsx
RuntimeExports.jsxs("div",{className:"confirm-dialog",ref:_,children:[jsxRuntimeExports.jsx("div",{className:`confirm-d
ialog-header ${c}`,children:jsxRuntimeExports.jsx("h3",{id:"confirm-dialog-title",children:e})}),jsxRuntimeExports.jsx(
"div",{className:"confirm-dialog-body",children:jsxRuntimeExports.jsx("p",{children:i})}),jsxRuntimeExports.jsxs("div",
{className:"confirm-dialog-footer",children:[jsxRuntimeExports.jsx("button",{type:"button",className:"confirm-dialog-bt
n 
cancel",onClick:h,disabled:j,children:o}),jsxRuntimeExports.jsx("button",{type:"button",className:`confirm-dialog-btn 
confirm ${c}`,onClick:d,disabled:j,ref:$,children:j?"Processing...":a})]})]})})},LoadingSkeleton=({type:s="text",count:
e=1,width:i,height:a,className:o=""})=>{const c={};i&&(c.width=i),a&&(c.height=a);const 
d=()=>{switch(s){case"title":return jsxRuntimeExports.jsx("div",{className:"skeleton 
skeleton-title",style:c});case"avatar":return jsxRuntimeExports.jsx("div",{className:"skeleton 
skeleton-avatar",style:c});case"button":return jsxRuntimeExports.jsx("div",{className:"skeleton 
skeleton-button",style:c});case"card":return 
jsxRuntimeExports.jsxs("div",{className:"skeleton-card",children:[jsxRuntimeExports.jsx("div",{className:"skeleton skel
eton-card-header"}),jsxRuntimeExports.jsxs("div",{className:"skeleton-card-body",children:[jsxRuntimeExports.jsx("div",
{className:"skeleton skeleton-text"}),jsxRuntimeExports.jsx("div",{className:"skeleton 
skeleton-text",style:{width:"80%"}}),jsxRuntimeExports.jsx("div",{className:"skeleton 
skeleton-text",style:{width:"60%"}})]})]});case"table":return jsxRuntimeExports.jsxs("div",{className:"skeleton-table",
children:[jsxRuntimeExports.jsx("div",{className:"skeleton-table-header",children:[...Array(4)].map((h,j)=>jsxRuntimeEx
ports.jsx("div",{className:"skeleton skeleton-table-cell"},j))}),[...Array(e)].map((h,j)=>jsxRuntimeExports.jsx("div",{
className:"skeleton-table-row",children:[...Array(4)].map((_,$)=>jsxRuntimeExports.jsx("div",{className:"skeleton 
skeleton-table-cell"},$))},j))]});case"list":return jsxRuntimeExports.jsx("div",{className:"skeleton-list",children:[..
.Array(e)].map((h,j)=>jsxRuntimeExports.jsxs("div",{className:"skeleton-list-item",children:[jsxRuntimeExports.jsx("div
",{className:"skeleton skeleton-avatar",style:{width:"40px",height:"40px"}}),jsxRuntimeExports.jsxs("div",{className:"s
keleton-list-content",children:[jsxRuntimeExports.jsx("div",{className:"skeleton 
skeleton-text",style:{width:"60%"}}),jsxRuntimeExports.jsx("div",{className:"skeleton 
skeleton-text",style:{width:"40%",height:"12px"}})]})]},j))});case"dashboard":return jsxRuntimeExports.jsxs("div",{clas
sName:"skeleton-dashboard",children:[jsxRuntimeExports.jsxs("div",{className:"skeleton-dashboard-header",children:[jsxR
untimeExports.jsx("div",{className:"skeleton 
skeleton-title",style:{width:"200px"}}),jsxRuntimeExports.jsx("div",{className:"skeleton skeleton-button"})]}),jsxRunti
meExports.jsx("div",{className:"skeleton-dashboard-cards",children:[...Array(4)].map((h,j)=>jsxRuntimeExports.jsxs("div
",{className:"skeleton-stat-card",children:[jsxRuntimeExports.jsx("div",{className:"skeleton 
skeleton-text",style:{width:"50%"}}),jsxRuntimeExports.jsx("div",{className:"skeleton 
skeleton-title",style:{width:"70%"}})]},j))})]});case"text":default:return e>1?jsxRuntimeExports.jsx("div",{className:"
skeleton-text-group",children:[...Array(e)].map((h,j)=>jsxRuntimeExports.jsx("div",{className:"skeleton skeleton-text",
style:{...c,width:j===e-1?"60%":c.width||"100%"}},j))}):jsxRuntimeExports.jsx("div",{className:"skeleton 
skeleton-text",style:c})}};return jsxRuntimeExports.jsx("div",{className:`loading-skeleton ${o}`,"aria-busy":"true","ar
ia-label":"Loading...",children:d()})},SkillsPartners=()=>{const{getTenantId:s,isSystemAdmin:e}=useTenant(),i=s(),[a,o]
=reactExports.useState([]),[c,d]=reactExports.useState([]),[h,j]=reactExports.useState([]),[_,$]=reactExports.useState(
!0),[rt,tt]=reactExports.useState(!1),[mt,vt]=reactExports.useState(null),[_t,wt]=reactExports.useState(!1),[ht,dt]=rea
ctExports.useState(!1),[jt,bt]=reactExports.useState(""),[ut,Rt]=reactExports.useState(""),[st,it]=reactExports.useStat
e(""),[nt,ct]=reactExports.useState({}),[xt,yt]=reactExports.useState({isOpen:!1,partner:null}),[Tt,fs]=reactExports.us
eState({name:"",email:"",phone:"",company:"",specialization:"",status:"Active",notes:"",agreementLink:"",commissionRate
s:{}});reactExports.useEffect(()=>{cs()},[i]);const cs=async()=>{bt("");try{const Ct=e?null:i,[Pt,$t,Bt]=await Promise.
all([getSkillsPartners$1(Ct),getClients(),getProductLines()]);o(Pt||[]),d($t||[]),j(Bt||[])}catch(Ct){console.error("Er
ror loading data:",Ct),bt("Failed to load data. Please try again.")}finally{$(!1)}},Es=Ct=>c.filter(Pt=>Pt.skillsPartne
rId===Ct).length,ls=Ct=>{const{name:Pt,value:$t}=Ct.target;fs(Bt=>({...Bt,[Pt]:$t})),nt[Pt]&&ct(Bt=>({...Bt,[Pt]:null})
)},Yt=(Ct,Pt)=>{const $t=parseFloat(Pt)||0;fs(Bt=>({...Bt,commissionRates:{...Bt.commissionRates,[Ct]:Math.min(100,Math
.max(0,$t))}}))},Mt=()=>{vt(null);const Ct={};h.forEach(Pt=>{Ct[Pt.id]=0}),fs({name:"",email:"",phone:"",company:"",spe
cialization:"",status:"Active",notes:"",agreementLink:"",commissionRates:Ct}),tt(!0),bt(""),ct({})},Gt=Ct=>{vt(Ct),fs({
name:Ct.name||"",email:Ct.email||"",phone:Ct.phone||"",company:Ct.company||"",specialization:Ct.specialization||"",stat
us:Ct.status||"Active",notes:Ct.notes||"",agreementLink:Ct.agreementLink||"",commissionRates:Ct.commissionRates||{}}),t
t(!0),bt(""),ct({})},Wt=()=>{tt(!1),vt(null),bt(""),ct({})},ms=()=>{const Ct={};Tt.name.trim()||(Ct.name="Partner name 
is required");const Pt=validateEmail(Tt.email);Pt.isValid||(Ct.email=Pt.error);const 
$t=validatePhoneNumber(Tt.phone);return $t.isValid||(Ct.phone=$t.error),ct(Ct),Object.keys(Ct).length===0},ss=async 
Ct=>{if(Ct.preventDefault(),!!ms()){wt(!0),bt("");try{const 
Pt=validatePhoneNumber(Tt.phone),$t={...Tt,phone:Pt.formatted||Tt.phone};mt?(await 
updateSkillsPartner(mt.id,$t),Rt("Skills partner updated successfully")):(await 
createSkillsPartner({...$t,tenantId:i}),Rt("Skills partner created successfully")),await 
cs(),Wt(),setTimeout(()=>Rt(""),3e3)}catch(Pt){console.error("Error saving partner:",Pt),bt("Failed to save skills part
ner")}finally{wt(!1)}}},ys=Ct=>{yt({isOpen:!0,partner:Ct})},Et=()=>{yt({isOpen:!1,partner:null})},gt=async()=>{const 
Ct=xt.partner;if(Ct){dt(!0);try{const Pt=await deleteSkillsPartner(Ct.id),$t=Pt.clientsUpdated>0?`Skills partner 
deleted. ${Pt.clientsUpdated} client(s) were unassigned.`:"Skills partner deleted successfully";Rt($t),Et(),await 
cs(),setTimeout(()=>Rt(""),3e3)}catch(Pt){console.error("Error deleting partner:",Pt),bt("Failed to delete skills 
partner"),Et()}finally{dt(!1)}}},ft=a.filter(Ct=>{var Pt,$t,Bt,Lt;return((Pt=Ct.name)==null?void 
0:Pt.toLowerCase().includes(st.toLowerCase()))||(($t=Ct.email)==null?void 
0:$t.toLowerCase().includes(st.toLowerCase()))||((Bt=Ct.company)==null?void 
0:Bt.toLowerCase().includes(st.toLowerCase()))||((Lt=Ct.specialization)==null?void 
0:Lt.toLowerCase().includes(st.toLowerCase()))}),zt=()=>{if(!xt.partner)return"";const Ct=Es(xt.partner.id);return 
Ct>0?`This skills partner is assigned to ${Ct} client(s). Deleting will remove this assignment from all affected 
clients. This action cannot be undone.`:`Are you sure you want to delete "${xt.partner.name}"? This action cannot be 
undone.`};return _?jsxRuntimeExports.jsxs("div",{className:"skills-partners",children:[jsxRuntimeExports.jsxs("div",{cl
assName:"page-header",children:[jsxRuntimeExports.jsx(LoadingSkeleton,{type:"title",width:"280px"}),jsxRuntimeExports.j
sx(LoadingSkeleton,{type:"button"})]}),jsxRuntimeExports.jsx("div",{className:"partners-toolbar",children:jsxRuntimeExp
orts.jsx(LoadingSkeleton,{type:"text",width:"200px",height:"40px"})}),jsxRuntimeExports.jsx("div",{className:"partners-
grid",children:[1,2,3,4].map(Ct=>jsxRuntimeExports.jsx(LoadingSkeleton,{type:"card"},Ct))})]}):jsxRuntimeExports.jsxs("
div",{className:"skills-partners",children:[jsxRuntimeExports.jsxs("div",{className:"page-header",children:[jsxRuntimeE
xports.jsx("h1",{children:"Skills Partner 
Management"}),jsxRuntimeExports.jsx("button",{className:"create-btn",onClick:Mt,children:"+ Add Skills Partner"})]}),ut
&&jsxRuntimeExports.jsx("div",{className:"success-message",children:ut}),jt&&!rt&&jsxRuntimeExports.jsx("div",{classNam
e:"error-message",children:jt}),jsxRuntimeExports.jsxs("div",{className:"partners-toolbar",children:[jsxRuntimeExports.
jsx("div",{className:"search-box",children:jsxRuntimeExports.jsx("input",{type:"text",placeholder:"Search partners...",
value:st,onChange:Ct=>it(Ct.target.value)})}),jsxRuntimeExports.jsxs("div",{className:"partner-stats",children:[jsxRunt
imeExports.jsxs("span",{className:"stat",children:[jsxRuntimeExports.jsx("strong",{children:a.length})," Total Partners
"]}),jsxRuntimeExports.jsxs("span",{className:"stat",children:[jsxRuntimeExports.jsx("strong",{children:a.filter(Ct=>Ct
.status==="Active").length})," Active"]})]})]}),ft.length===0?jsxRuntimeExports.jsx("div",{className:"empty-state",chil
dren:st?jsxRuntimeExports.jsx("p",{children:"No skills partners match your 
search."}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("p",{children:"No skills 
partners have been created yet."}),jsxRuntimeExports.jsx("button",{className:"create-btn",onClick:Mt,children:"Create 
your first Skills Partner"})]})}):jsxRuntimeExports.jsx("div",{className:"partners-grid",children:ft.map(Ct=>{var 
Pt,$t;return jsxRuntimeExports.jsxs("div",{className:`partner-card ${Ct.status==="Inactive"?"inactive":""}`,children:[j
sxRuntimeExports.jsxs("div",{className:"partner-card-header",children:[jsxRuntimeExports.jsx("div",{className:"partner-
avatar",children:((Pt=Ct.name)==null?void 0:Pt.charAt(0).toUpperCase())||"S"}),jsxRuntimeExports.jsxs("div",{className:
"partner-info",children:[jsxRuntimeExports.jsx("h3",{children:Ct.name}),Ct.company&&jsxRuntimeExports.jsx("span",{class
Name:"company",children:Ct.company})]}),jsxRuntimeExports.jsx("span",{className:`status-badge 
${($t=Ct.status)==null?void 0:$t.toLowerCase()}`,children:Ct.status})]}),jsxRuntimeExports.jsxs("div",{className:"partn
er-card-body",children:[Ct.email&&jsxRuntimeExports.jsxs("div",{className:"info-row",children:[jsxRuntimeExports.jsx("s
pan",{className:"label",children:"Email:"}),jsxRuntimeExports.jsx("a",{href:`mailto:${Ct.email}`,children:Ct.email})]})
,Ct.phone&&jsxRuntimeExports.jsxs("div",{className:"info-row",children:[jsxRuntimeExports.jsx("span",{className:"label"
,children:"Phone:"}),jsxRuntimeExports.jsx("span",{children:Ct.phone})]}),Ct.specialization&&jsxRuntimeExports.jsxs("di
v",{className:"info-row",children:[jsxRuntimeExports.jsx("span",{className:"label",children:"Specialization:"}),jsxRunt
imeExports.jsx("span",{children:Ct.specialization})]}),jsxRuntimeExports.jsxs("div",{className:"info-row 
clients-count",children:[jsxRuntimeExports.jsx("span",{className:"label",children:"Assigned Clients:"}),jsxRuntimeExpor
ts.jsx("span",{className:"count",children:Es(Ct.id)})]})]}),Ct.notes&&jsxRuntimeExports.jsx("div",{className:"partner-n
otes",children:jsxRuntimeExports.jsx("p",{children:Ct.notes})}),jsxRuntimeExports.jsxs("div",{className:"partner-card-a
ctions",children:[jsxRuntimeExports.jsx("button",{className:"edit-btn",onClick:()=>Gt(Ct),children:"Edit"}),jsxRuntimeE
xports.jsx("button",{className:"delete-btn",onClick:()=>ys(Ct),children:"Delete"})]})]},Ct.id)})}),rt&&jsxRuntimeExport
s.jsx("div",{className:"modal-backdrop",onClick:Wt,children:jsxRuntimeExports.jsxs("div",{className:"modal",onClick:Ct=
>Ct.stopPropagation(),children:[jsxRuntimeExports.jsxs("div",{className:"modal-header",children:[jsxRuntimeExports.jsx(
"h2",{children:mt?"Edit Skills Partner":"Add Skills Partner"}),jsxRuntimeExports.jsx("button",{className:"close-btn",on
Click:Wt,children:"Ã—"})]}),jsxRuntimeExports.jsxs("form",{onSubmit:ss,children:[jsxRuntimeExports.jsxs("div",{classNam
e:"modal-body",children:[jt&&jsxRuntimeExports.jsx("div",{className:"error-message",children:jt}),jsxRuntimeExports.jsx
s("div",{className:"form-row",children:[jsxRuntimeExports.jsxs("div",{className:"form-field",children:[jsxRuntimeExport
s.jsx("label",{children:"Name 
*"}),jsxRuntimeExports.jsx("input",{type:"text",name:"name",value:Tt.name,onChange:ls,placeholder:"Partner name",classN
ame:nt.name?"input-error":"",required:!0}),nt.name&&jsxRuntimeExports.jsx("small",{className:"field-error",children:nt.
name})]}),jsxRuntimeExports.jsxs("div",{className:"form-field",children:[jsxRuntimeExports.jsx("label",{children:"Compa
ny"}),jsxRuntimeExports.jsx("input",{type:"text",name:"company",value:Tt.company,onChange:ls,placeholder:"Company name"
})]})]}),jsxRuntimeExports.jsxs("div",{className:"form-row",children:[jsxRuntimeExports.jsxs("div",{className:"form-fie
ld",children:[jsxRuntimeExports.jsx("label",{children:"Email"}),jsxRuntimeExports.jsx("input",{type:"email",name:"email
",value:Tt.email,onChange:ls,placeholder:"email@example.com",className:nt.email?"input-error":""}),nt.email&&jsxRuntime
Exports.jsx("small",{className:"field-error",children:nt.email})]}),jsxRuntimeExports.jsxs("div",{className:"form-field
",children:[jsxRuntimeExports.jsx("label",{children:"Phone"}),jsxRuntimeExports.jsx("input",{type:"tel",name:"phone",va
lue:Tt.phone,onChange:ls,placeholder:"e.g., 012 345 6789",className:nt.phone?"input-error":""}),nt.phone&&jsxRuntimeExp
orts.jsx("small",{className:"field-error",children:nt.phone})]})]}),jsxRuntimeExports.jsxs("div",{className:"form-row",
children:[jsxRuntimeExports.jsxs("div",{className:"form-field",children:[jsxRuntimeExports.jsx("label",{children:"Speci
alization"}),jsxRuntimeExports.jsxs("select",{name:"specialization",value:Tt.specialization,onChange:ls,children:[jsxRu
ntimeExports.jsx("option",{value:"",children:"Select specialization"}),jsxRuntimeExports.jsx("option",{value:"Learnersh
ips",children:"Learnerships"}),jsxRuntimeExports.jsx("option",{value:"TAP Business",children:"TAP 
Business"}),jsxRuntimeExports.jsx("option",{value:"Compliance Training",children:"Compliance 
Training"}),jsxRuntimeExports.jsx("option",{value:"Other Courses",children:"Other 
Courses"}),jsxRuntimeExports.jsx("option",{value:"All",children:"All Product Lines"})]})]}),jsxRuntimeExports.jsxs("div
",{className:"form-field",children:[jsxRuntimeExports.jsx("label",{children:"Status"}),jsxRuntimeExports.jsxs("select",
{name:"status",value:Tt.status,onChange:ls,children:[jsxRuntimeExports.jsx("option",{value:"Active",children:"Active"})
,jsxRuntimeExports.jsx("option",{value:"Inactive",children:"Inactive"})]})]})]}),jsxRuntimeExports.jsxs("div",{classNam
e:"form-field full-width",children:[jsxRuntimeExports.jsx("label",{children:"Agreement Link (Google Drive/SharePoint)"}
),jsxRuntimeExports.jsx("input",{type:"url",name:"agreementLink",value:Tt.agreementLink,onChange:ls,placeholder:"https:
//drive.google.com/..."})]}),jsxRuntimeExports.jsxs("div",{className:"form-field 
full-width",children:[jsxRuntimeExports.jsx("label",{children:"Commission Rates by Product Line (%)"}),jsxRuntimeExport
s.jsx("div",{className:"commission-inputs",children:h.map(Ct=>jsxRuntimeExports.jsxs("div",{className:"commission-input
-row",children:[jsxRuntimeExports.jsx("label",{children:Ct.name}),jsxRuntimeExports.jsx("input",{type:"number",min:"0",
max:"100",step:"0.1",value:Tt.commissionRates[Ct.id]||0,onChange:Pt=>Yt(Ct.id,Pt.target.value),placeholder:"0.0"}),jsxR
untimeExports.jsx("span",{className:"percentage-symbol",children:"%"})]},Ct.id))})]}),jsxRuntimeExports.jsxs("div",{cla
ssName:"form-field full-width",children:[jsxRuntimeExports.jsx("label",{children:"Notes"}),jsxRuntimeExports.jsx("texta
rea",{name:"notes",value:Tt.notes,onChange:ls,placeholder:"Additional notes about this partner...",rows:3})]})]}),jsxRu
ntimeExports.jsxs("div",{className:"modal-footer",children:[jsxRuntimeExports.jsx("button",{type:"button",className:"ca
ncel-btn",onClick:Wt,children:"Cancel"}),jsxRuntimeExports.jsx("button",{type:"submit",className:"save-btn",disabled:_t
,children:_t?"Saving...":mt?"Update Partner":"Create 
Partner"})]})]})]})}),jsxRuntimeExports.jsx(ConfirmDialog,{isOpen:xt.isOpen,title:"Delete Skills Partner",message:zt(),
confirmText:"Delete",cancelText:"Cancel",variant:"danger",onConfirm:gt,onCancel:Et,isLoading:ht})]})},PRODUCT_CONFIG={l
earnerships:{name:"Learnerships",description:"SETA-funded and self-funded learnership 
programs",templateId:"learnership",icon:"ðŸ“š",demoValues:{dealName:"ABC Company 
Learnership",certaintyPercentage:80,description:"NQF Level 4 Generic 
Management",fundingType:"SETA",learnerCount:10,costPerLearner:25e3,paymentStartDate:new Date().toISOString().split("T")
[0],paymentFrequency:"Monthly",paymentMonths:12,facilitatorCost:5e4,facilitatorCostFrequency:"Monthly",commissionPercen
tage:5,commissionFrequency:"With 
Income",travelCost:15e3,travelCostFrequency:"Monthly",assessorCost:8e3,assessorCostFrequency:"End of 
Learnership",moderatorCost:5e3,moderatorCostFrequency:"End of Learnership",otherCost:0,otherCostFrequency:"Once-off",cu
stomLabel:"",customCost:0,customCostFrequency:"Once-off"},demoCalculation:s=>{const e=(s.learnerCount||0)*(s.costPerLea
rner||0),i=e*(s.commissionPercentage||0)/100,a=(s.facilitatorCost||0)+i+(s.travelCost||0)+(s.assessorCost||0)+(s.modera
torCost||0)+(s.otherCost||0)+(s.customCost||0),o=e-a,c=s.certaintyPercentage??100,d=o*(c/100),h=e>0?o/e*100:0;return{to
talIncome:e,totalCosts:a,grossProfit:o,adjustedGP:d,gpMargin:h,commissionAmount:i,certaintyPercentage:c,monthlyIncome:e
/(s.paymentMonths||12),formula:`${s.learnerCount||0} learners Ã— R${(s.costPerLearner||0).toLocaleString()} = Total 
Income`,distribution:s.paymentFrequency==="Once-off"?`Once-off payment starting 
${s.paymentStartDate||"TBD"}`:`R${(e/(s.paymentMonths||12)).toLocaleString()}/month over ${s.paymentMonths||12} 
months`}}},compliance:{name:"Compliance",description:"Compliance training courses (First Aid, Fire Safety, 
OHS)",templateId:"once-off-training",icon:"âœ“",demoValues:{dealName:"ABC Company First Aid 
Training",certaintyPercentage:100,description:"Annual first aid certification for staff",courseName:"First Aid Level 
1",customCourseName:"",trainingDate:new Date().toISOString().split("T")[0],numberOfTrainees:20,pricePerPerson:1500,comm
issionPercentage:5,commissionFrequency:"With Income",travelCost:2e3,travelCostFrequency:"Once-off",manualsCost:500,manu
alsCostFrequency:"Once-off",accommodationCost:0,accommodationCostFrequency:"Once-off",accreditationCost:1e3,accreditati
onCostFrequency:"Once-off",customCostLabel:"",customCost:0,customCostFrequency:"Once-off"},demoCalculation:s=>{const e=
(s.numberOfTrainees||0)*(s.pricePerPerson||0),i=e*(s.commissionPercentage||0)/100,a=i+(s.travelCost||0)+(s.manualsCost|
|0)+(s.accommodationCost||0)+(s.accreditationCost||0)+(s.customCost||0),o=e-a,c=s.certaintyPercentage??100,d=o*(c/100),
h=e>0?o/e*100:0;return{totalIncome:e,totalCosts:a,grossProfit:o,adjustedGP:d,gpMargin:h,commissionAmount:i,certaintyPer
centage:c,formula:`${s.numberOfTrainees||0} trainees Ã— R${(s.pricePerPerson||0).toLocaleString()} = Total 
Income`,distribution:`Once-off payment on training date: ${s.trainingDate||"TBD"}`}}},otherCourses:{name:"Other 
Courses",description:"General training courses and 
workshops",templateId:"once-off-training",icon:"ðŸŽ“",demoValues:{dealName:"Leadership Development 
Workshop",certaintyPercentage:80,description:"Management leadership training program",courseName:"Leadership 
Workshop",customCourseName:"",trainingDate:new Date().toISOString().split("T")[0],numberOfTrainees:15,pricePerPerson:25
00,commissionPercentage:5,commissionFrequency:"With Income",travelCost:3e3,travelCostFrequency:"Once-off",manualsCost:7
50,manualsCostFrequency:"Once-off",accommodationCost:5e3,accommodationCostFrequency:"Once-off",accreditationCost:0,accr
editationCostFrequency:"Once-off",customCostLabel:"",customCost:0,customCostFrequency:"Once-off"},demoCalculation:s=>{c
onst e=(s.numberOfTrainees||0)*(s.pricePerPerson||0),i=e*(s.commissionPercentage||0)/100,a=i+(s.travelCost||0)+(s.manua
lsCost||0)+(s.accommodationCost||0)+(s.accreditationCost||0)+(s.customCost||0),o=e-a,c=s.certaintyPercentage??100,d=o*(
c/100),h=e>0?o/e*100:0;return{totalIncome:e,totalCosts:a,grossProfit:o,adjustedGP:d,gpMargin:h,commissionAmount:i,certa
intyPercentage:c,formula:`${s.numberOfTrainees||0} trainees Ã— R${(s.pricePerPerson||0).toLocaleString()} = Total 
Income`,distribution:`Once-off payment on training date: ${s.trainingDate||"TBD"}`}}},tapBusiness:{name:"TAP 
Business",description:"Subscription-based TAP Business 
service",templateId:"subscription",icon:"ðŸ’¼",demoValues:{dealName:"XYZ Corp TAP 
Subscription",certaintyPercentage:90,description:"Annual TAP Business 
subscription",numberOfEmployees:50,costPerEmployeePerMonth:150,paymentType:"Monthly",paymentStartDate:new 
Date().toISOString().split("T")[0],contractMonths:12,commissionPercentage:5,commissionFrequency:"With 
Income",customCostLabel:"",customCost:0,customCostFrequency:"Once-off"},demoCalculation:s=>{const e=s.numberOfEmployees
||0,i=s.costPerEmployeePerMonth||0,a=s.paymentType||"Monthly",o=a==="Annual"?1:s.contractMonths||12;let 
c;a==="Annual"?c=e*i*12:c=e*i*o;const d=e*i,h=c*(s.commissionPercentage||0)/100,j=h+(s.customCost||0),_=c-j,$=s.certain
tyPercentage??100,rt=_*($/100),tt=c>0?_/c*100:0;return{totalIncome:c,totalCosts:j,grossProfit:_,adjustedGP:rt,gpMargin:
tt,monthlyIncome:d,commissionAmount:h,certaintyPercentage:$,formula:a==="Annual"?`${e} employees Ã— 
R${i.toLocaleString()}/month Ã— 12 months (Annual)`:`${e} employees Ã— R${i.toLocaleString()}/month Ã— ${o} 
months`,distribution:a==="Annual"?`Annual payment starting ${s.paymentStartDate||"TBD"}`:`Monthly payments of 
R${d.toLocaleString()}/month over ${o} months`}}}},ProductManagement=()=>{var Gt,Wt,ms,ss,ys;const{isSystemAdmin:s}=use
Tenant(),[e,i]=reactExports.useState([]),[a,o]=reactExports.useState([]),[c,d]=reactExports.useState(!0),[h,j]=reactExp
orts.useState(!1),[_,$]=reactExports.useState(""),[rt,tt]=reactExports.useState(!1),[mt,vt]=reactExports.useState(null)
,[_t,wt]=reactExports.useState("demo"),[ht,dt]=reactExports.useState({}),[jt,bt]=reactExports.useState([]),[ut,Rt]=reac
tExports.useState({});reactExports.useEffect(()=>{st()},[]);const st=async()=>{try{d(!0);const[Et,gt]=await 
Promise.all([getProductLines(),getCalculationTemplates()]);if(Et.length===0){$("Setting up default 
products...");try{await initializeProductCatalog(),await initializeCalculationTemplates();const[ft,zt]=await 
Promise.all([getProductLines(),getCalculationTemplates()]);i(ft),o(zt),$("Products initialized 
successfully!"),setTimeout(()=>$(""),5e3)}catch(ft){console.error("Error auto-initializing:",ft),$("Failed to 
initialize products.")}}else i(Et),o(gt)}catch(Et){console.error("Error loading data:",Et)}finally{d(!1)}},it=Et=>{var 
$t,Bt,Lt,Xt;const gt=e.find(Dt=>Dt.id===Et),ft=PRODUCT_CONFIG[Et],zt=a.find(Dt=>Dt.id===(ft==null?void 
0:ft.templateId))||DEFAULT_CALCULATION_TEMPLATES[ft==null?void 
0:ft.templateId];vt({...gt,id:Et,config:ft,template:zt}),Rt({...ft.demoValues});const 
Ct={};if(zt!=null&&zt.defaultCustomLists)for(const[Dt,Ht]of 
Object.entries(zt.defaultCustomLists))Ct[Dt]=((Bt=($t=gt==null?void 0:gt.customLists)==null?void 0:$t[Dt])==null?void 
0:Bt.defaultOptions)||((Lt=gt==null?void 0:gt.customLists)==null?void 0:Lt[Dt])||[...Ht];dt(Ct);const 
Pt=((Xt=zt==null?void 0:zt.costFields)==null?void 0:Xt.map(Dt=>{var os,Qt;const Ht=((os=gt==null?void 
0:gt.costFieldsConfig)==null?void 0:os[Dt.id])||{};return{...Dt,enabled:Ht.enabled!==!1,defaultValue:Ht.defaultValue||0
,defaultFrequency:Ht.defaultFrequency||((Qt=Dt.frequencyOptions)==null?void 0:Qt[0])||"Once-off"}}))||[];bt(Pt),wt("dem
o"),tt(!0)},nt=()=>{tt(!1),vt(null),dt({}),bt([]),Rt({})},ct=(Et,gt)=>{Rt(ft=>({...ft,[Et]:parseFloat(gt)||0}))},xt=(Et
,gt,ft)=>{dt(zt=>{const Ct={...zt};return Ct[Et]=[...Ct[Et]||[]],typeof Ct[Et][gt]=="string"?Ct[Et][gt]={id:`item-${gt}
`,name:ft,value:ft.toLowerCase().replace(/\s+/g,"-")}:(Ct[Et][gt]={...Ct[Et][gt],name:ft},(!Ct[Et][gt].value||Ct[Et][gt
].value==="")&&(Ct[Et][gt].value=ft.toLowerCase().replace(/\s+/g,"-"))),Ct})},yt=Et=>{const gt=`item-${Date.now()}`;dt(
ft=>({...ft,[Et]:[...ft[Et]||[],{id:gt,name:"",value:gt}]}))},Tt=(Et,gt)=>{dt(ft=>({...ft,[Et]:ft[Et].filter((zt,Ct)=>C
t!==gt)}))},fs=Et=>{bt(gt=>gt.map(ft=>ft.id===Et?{...ft,enabled:!ft.enabled}:ft))},cs=(Et,gt,ft)=>{bt(zt=>zt.map(Ct=>Ct
.id===Et?{...Ct,[gt]:ft}:Ct))},Es=async()=>{if(mt)try{j(!0);const Et={};for(const[ft,zt]of Object.entries(ht)){const 
Ct=zt.filter(Pt=>{const $t=typeof Pt=="string"?Pt:Pt.name;return $t&&$t.trim()}).map(Pt=>typeof Pt=="string"?{id:Pt.toL
owerCase().replace(/\s+/g,"-"),name:Pt,value:Pt.toLowerCase().replace(/\s+/g,"-")}:Pt);Ct.length>0&&(Et[ft]={listType:"
tenant-configurable",defaultOptions:Ct})}const gt={};for(const ft of jt)gt[ft.id]={enabled:ft.enabled,defaultValue:pars
eFloat(ft.defaultValue)||0,defaultFrequency:ft.defaultFrequency};await 
updateProductLine(mt.id,{customLists:Et,costFieldsConfig:gt}),await st(),$("Product saved 
successfully!"),setTimeout(()=>$(""),3e3),nt()}catch(Et){console.error("Error saving product:",Et),$("Failed to save 
product. Please try again.")}finally{j(!1)}},ls=Et=>({fundingTypes:"Funding Types",learnershipTypes:"Learnership 
Types",packageTypes:"Package Types",courseOptions:"Course Options",consultationTypes:"Consultation 
Types"})[Et]||Et.replace(/([A-Z])/g," $1").replace(/^./,ft=>ft.toUpperCase()),Yt=Et=>new 
Intl.NumberFormat("en-ZA",{style:"currency",currency:"ZAR",minimumFractionDigits:0}).format(Et||0),Mt=()=>{var 
Et;return(Et=mt==null?void 0:mt.config)!=null&&Et.demoCalculation?mt.config.demoCalculation(ut):null};return 
c?jsxRuntimeExports.jsx("div",{className:"page-loading",children:"Loading product management..."}):jsxRuntimeExports.js
xs("div",{className:"product-management-page",children:[jsxRuntimeExports.jsxs("div",{className:"page-header",children:
[jsxRuntimeExports.jsx("h1",{children:"Product Management"}),jsxRuntimeExports.jsx("p",{children:"Configure products, 
default lists and costing options for each product line"})]}),_&&jsxRuntimeExports.jsx("div",{className:`init-message $
{_.includes("Failed")?"error":"success"}`,children:_}),jsxRuntimeExports.jsx("div",{className:"product-cards-grid",chil
dren:Object.entries(PRODUCT_CONFIG).map(([Et,gt])=>{var Pt;e.find($t=>$t.id===Et);const ft=a.find($t=>$t.id===gt.templa
teId)||DEFAULT_CALCULATION_TEMPLATES[gt.templateId],zt=ft!=null&&ft.defaultCustomLists?Object.keys(ft.defaultCustomList
s).length:0,Ct=((Pt=ft==null?void 0:ft.costFields)==null?void 0:Pt.length)||0;return jsxRuntimeExports.jsxs("div",{clas
sName:"product-card",onClick:()=>it(Et),children:[jsxRuntimeExports.jsx("div",{className:"product-card-icon",children:g
t.icon}),jsxRuntimeExports.jsxs("div",{className:"product-card-content",children:[jsxRuntimeExports.jsx("h3",{children:
gt.name}),jsxRuntimeExports.jsx("p",{children:gt.description}),jsxRuntimeExports.jsxs("div",{className:"product-card-st
ats",children:[jsxRuntimeExports.jsxs("span",{className:"stat",children:[jsxRuntimeExports.jsx("strong",{children:zt}),
" list",zt!==1?"s":""]}),jsxRuntimeExports.jsxs("span",{className:"stat",children:[jsxRuntimeExports.jsx("strong",{chil
dren:Ct})," cost line",Ct!==1?"s":""]})]})]}),jsxRuntimeExports.jsx("div",{className:"product-card-arrow",children:"â†’
"})]},Et)})}),rt&&mt&&jsxRuntimeExports.jsx("div",{className:"modal-overlay",onClick:nt,children:jsxRuntimeExports.jsxs
("div",{className:"modal modal-xl",onClick:Et=>Et.stopPropagation(),children:[jsxRuntimeExports.jsxs("div",{className:"
modal-header",children:[jsxRuntimeExports.jsxs("div",{className:"modal-title-section",children:[jsxRuntimeExports.jsx("
span",{className:"modal-icon",children:(Gt=mt.config)==null?void 
0:Gt.icon}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{children:(Wt=mt.config)==null?void 
0:Wt.name}),jsxRuntimeExports.jsx("p",{className:"modal-subtitle",children:(ms=mt.config)==null?void 0:ms.description})
]})]}),jsxRuntimeExports.jsx("button",{className:"modal-close",onClick:nt,children:"Ã—"})]}),jsxRuntimeExports.jsxs("di
v",{className:"modal-tabs",children:[jsxRuntimeExports.jsx("button",{className:`modal-tab 
${_t==="demo"?"active":""}`,onClick:()=>wt("demo"),children:"Demo 
Calculation"}),jsxRuntimeExports.jsx("button",{className:`modal-tab 
${_t==="lists"?"active":""}`,onClick:()=>wt("lists"),children:"Default 
Lists"}),jsxRuntimeExports.jsx("button",{className:`modal-tab 
${_t==="costs"?"active":""}`,onClick:()=>wt("costs"),children:"Costing Lines"})]}),jsxRuntimeExports.jsxs("div",{classN
ame:"modal-body",children:[_t==="demo"&&jsxRuntimeExports.jsxs("div",{className:"demo-section",children:[jsxRuntimeExpo
rts.jsx("div",{className:"demo-intro",children:jsxRuntimeExports.jsxs("p",{children:["This is exactly how a 
salesperson will see the ",(ss=mt.config)==null?void 0:ss.name," deal form when adding a forecast."]})}),mt.id==="learn
erships"&&jsxRuntimeExports.jsxs("div",{className:"learnership-demo-form",children:[jsxRuntimeExports.jsx("div",{classN
ame:"demo-form-header",children:jsxRuntimeExports.jsxs("h4",{children:["Deal 1 - ",ut.dealName||"New Deal"]})}),jsxRunt
imeExports.jsxs("div",{className:"demo-vertical-grid",children:[jsxRuntimeExports.jsxs("div",{className:"demo-field",ch
ildren:[jsxRuntimeExports.jsx("label",{children:"Deal Name"}),jsxRuntimeExports.jsx("input",{type:"text",value:ut.dealN
ame||"",onChange:Et=>Rt(gt=>({...gt,dealName:Et.target.value})),placeholder:"e.g., ABC Company Learnership"})]}),jsxRun
timeExports.jsxs("div",{className:"demo-field",children:[jsxRuntimeExports.jsx("label",{children:"Deal Certainty %"}),j
sxRuntimeExports.jsx("input",{type:"number",min:"0",max:"100",value:ut.certaintyPercentage??100,onChange:Et=>ct("certai
ntyPercentage",Et.target.value),placeholder:"100"})]}),jsxRuntimeExports.jsxs("div",{className:"demo-field full-width",
children:[jsxRuntimeExports.jsx("label",{children:"Description"}),jsxRuntimeExports.jsx("textarea",{value:ut.descriptio
n||"",onChange:Et=>Rt(gt=>({...gt,description:Et.target.value})),placeholder:"Add notes about this deal...",rows:"2"})]
}),jsxRuntimeExports.jsxs("div",{className:"demo-field",children:[jsxRuntimeExports.jsx("label",{children:"Funding Type
"}),jsxRuntimeExports.jsxs("select",{value:ut.fundingType||"",onChange:Et=>Rt(gt=>({...gt,fundingType:Et.target.value})
),children:[jsxRuntimeExports.jsx("option",{value:"",children:"-- Select Funding Type 
--"}),(ht.fundingTypes||[]).map((Et,gt)=>{const ft=typeof Et=="string"?Et:Et.name,zt=typeof 
Et=="string"?Et:Et.value||Et.name;return jsxRuntimeExports.jsx("option",{value:zt,children:ft},Et.id||gt)})]})]}),jsxRu
ntimeExports.jsxs("div",{className:"demo-field",children:[jsxRuntimeExports.jsx("label",{children:"Learnership Type"}),
jsxRuntimeExports.jsxs("select",{value:ut.learnershipType||"",onChange:Et=>Rt(gt=>({...gt,learnershipType:Et.target.val
ue})),children:[jsxRuntimeExports.jsx("option",{value:"",children:"-- Select Learnership Type 
--"}),(ht.learnershipTypes||[]).map((Et,gt)=>{const ft=typeof Et=="string"?Et:Et.name,zt=typeof 
Et=="string"?Et:Et.value||Et.name;return jsxRuntimeExports.jsx("option",{value:zt,children:ft},Et.id||gt)})]})]}),jsxRu
ntimeExports.jsxs("div",{className:"demo-field",children:[jsxRuntimeExports.jsx("label",{children:"No. Learners"}),jsxR
untimeExports.jsx("input",{type:"number",min:"0",value:ut.learnerCount||"",onChange:Et=>ct("learnerCount",Et.target.val
ue)})]}),jsxRuntimeExports.jsxs("div",{className:"demo-field",children:[jsxRuntimeExports.jsx("label",{children:"Cost 
/ Learner"}),jsxRuntimeExports.jsx("input",{type:"number",min:"0",value:ut.costPerLearner||"",onChange:Et=>ct("costPerL
earner",Et.target.value)})]}),jsxRuntimeExports.jsxs("div",{className:"demo-field",children:[jsxRuntimeExports.jsx("lab
el",{children:"Total Amount"}),jsxRuntimeExports.jsx("div",{className:"demo-calculated-value",children:Yt((ut.learnerCo
unt||0)*(ut.costPerLearner||0))})]}),jsxRuntimeExports.jsxs("div",{className:"demo-field",children:[jsxRuntimeExports.j
sx("label",{children:"Payment Start Date"}),jsxRuntimeExports.jsx("input",{type:"date",value:ut.paymentStartDate||"",on
Change:Et=>Rt(gt=>({...gt,paymentStartDate:Et.target.value}))})]}),jsxRuntimeExports.jsxs("div",{className:"demo-field"
,children:[jsxRuntimeExports.jsx("label",{children:"Frequency"}),jsxRuntimeExports.jsxs("select",{value:ut.paymentFrequ
ency||"Monthly",onChange:Et=>Rt(gt=>({...gt,paymentFrequency:Et.target.value})),children:[jsxRuntimeExports.jsx("option
",{value:"Monthly",children:"Monthly"}),jsxRuntimeExports.jsx("option",{value:"Once-off",children:"Once-off"})]})]}),js
xRuntimeExports.jsxs("div",{className:"demo-field",children:[jsxRuntimeExports.jsx("label",{children:"Months"}),jsxRunt
imeExports.jsx("input",{type:"number",min:"1",value:ut.paymentFrequency==="Once-off"?1:ut.paymentMonths||12,onChange:Et
=>ct("paymentMonths",Et.target.value),disabled:ut.paymentFrequency==="Once-off"})]}),jsxRuntimeExports.jsxs("div",{clas
sName:"demo-costs-section",children:[jsxRuntimeExports.jsx("h5",{children:"Cost of 
Sales"}),jsxRuntimeExports.jsx("p",{className:"costs-hint",children:"Set when each cost will be paid to calculate GP 
correctly per period"}),jsxRuntimeExports.jsxs("div",{className:"cost-item-row",children:[jsxRuntimeExports.jsxs("div",
{className:"cost-amount-field",children:[jsxRuntimeExports.jsx("label",{children:"Facilitator Cost"}),jsxRuntimeExports
.jsx("input",{type:"number",value:ut.facilitatorCost||"",onChange:Et=>ct("facilitatorCost",Et.target.value)})]}),jsxRun
timeExports.jsxs("div",{className:"cost-frequency-field",children:[jsxRuntimeExports.jsx("label",{children:"When Paid"}
),jsxRuntimeExports.jsxs("select",{value:ut.facilitatorCostFrequency||"Monthly",onChange:Et=>Rt(gt=>({...gt,facilitator
CostFrequency:Et.target.value})),children:[jsxRuntimeExports.jsx("option",{value:"Monthly",children:"Monthly (spread 
over duration)"}),jsxRuntimeExports.jsx("option",{value:"Once-off",children:"Once-off (at 
start)"}),jsxRuntimeExports.jsx("option",{value:"End of Learnership",children:"End of Learnership"})]})]})]}),jsxRuntim
eExports.jsxs("div",{className:"cost-item-row",children:[jsxRuntimeExports.jsxs("div",{className:"cost-amount-field 
commission-field",children:[jsxRuntimeExports.jsx("label",{children:"Commission %"}),jsxRuntimeExports.jsx("input",{typ
e:"number",min:"0",max:"100",step:"0.01",value:ut.commissionPercentage||"",onChange:Et=>ct("commissionPercentage",Et.ta
rget.value),placeholder:"%"}),jsxRuntimeExports.jsxs("span",{className:"commission-amount",children:["= ",Yt((ut.learne
rCount||0)*(ut.costPerLearner||0)*(ut.commissionPercentage||0)/100)]})]}),jsxRuntimeExports.jsxs("div",{className:"cost
-frequency-field",children:[jsxRuntimeExports.jsx("label",{children:"When 
Paid"}),jsxRuntimeExports.jsxs("select",{value:ut.commissionFrequency||"With Income",onChange:Et=>Rt(gt=>({...gt,commis
sionFrequency:Et.target.value})),children:[jsxRuntimeExports.jsx("option",{value:"With Income",children:"With Income 
(same as revenue)"}),jsxRuntimeExports.jsx("option",{value:"Once-off",children:"Once-off (at 
start)"}),jsxRuntimeExports.jsx("option",{value:"End of Learnership",children:"End of Learnership"})]})]})]}),jsxRuntim
eExports.jsxs("div",{className:"cost-item-row",children:[jsxRuntimeExports.jsxs("div",{className:"cost-amount-field",ch
ildren:[jsxRuntimeExports.jsx("label",{children:"Travel Cost"}),jsxRuntimeExports.jsx("input",{type:"number",value:ut.t
ravelCost||"",onChange:Et=>ct("travelCost",Et.target.value)})]}),jsxRuntimeExports.jsxs("div",{className:"cost-frequenc
y-field",children:[jsxRuntimeExports.jsx("label",{children:"When Paid"}),jsxRuntimeExports.jsxs("select",{value:ut.trav
elCostFrequency||"Monthly",onChange:Et=>Rt(gt=>({...gt,travelCostFrequency:Et.target.value})),children:[jsxRuntimeExpor
ts.jsx("option",{value:"Monthly",children:"Monthly (spread over 
duration)"}),jsxRuntimeExports.jsx("option",{value:"Once-off",children:"Once-off (at 
start)"}),jsxRuntimeExports.jsx("option",{value:"End of Learnership",children:"End of Learnership"})]})]})]}),jsxRuntim
eExports.jsxs("div",{className:"cost-item-row",children:[jsxRuntimeExports.jsxs("div",{className:"cost-amount-field",ch
ildren:[jsxRuntimeExports.jsx("label",{children:"Assessor Cost"}),jsxRuntimeExports.jsx("input",{type:"number",value:ut
.assessorCost||"",onChange:Et=>ct("assessorCost",Et.target.value)})]}),jsxRuntimeExports.jsxs("div",{className:"cost-fr
equency-field",children:[jsxRuntimeExports.jsx("label",{children:"When 
Paid"}),jsxRuntimeExports.jsxs("select",{value:ut.assessorCostFrequency||"End of Learnership",onChange:Et=>Rt(gt=>({...
gt,assessorCostFrequency:Et.target.value})),children:[jsxRuntimeExports.jsx("option",{value:"Monthly",children:"Monthly
 (spread over duration)"}),jsxRuntimeExports.jsx("option",{value:"Once-off",children:"Once-off (at 
start)"}),jsxRuntimeExports.jsx("option",{value:"End of Learnership",children:"End of Learnership"})]})]})]}),jsxRuntim
eExports.jsxs("div",{className:"cost-item-row",children:[jsxRuntimeExports.jsxs("div",{className:"cost-amount-field",ch
ildren:[jsxRuntimeExports.jsx("label",{children:"Moderator Cost"}),jsxRuntimeExports.jsx("input",{type:"number",value:u
t.moderatorCost||"",onChange:Et=>ct("moderatorCost",Et.target.value)})]}),jsxRuntimeExports.jsxs("div",{className:"cost
-frequency-field",children:[jsxRuntimeExports.jsx("label",{children:"When 
Paid"}),jsxRuntimeExports.jsxs("select",{value:ut.moderatorCostFrequency||"End of Learnership",onChange:Et=>Rt(gt=>({..
.gt,moderatorCostFrequency:Et.target.value})),children:[jsxRuntimeExports.jsx("option",{value:"Monthly",children:"Month
ly (spread over duration)"}),jsxRuntimeExports.jsx("option",{value:"Once-off",children:"Once-off (at 
start)"}),jsxRuntimeExports.jsx("option",{value:"End of Learnership",children:"End of Learnership"})]})]})]}),jsxRuntim
eExports.jsxs("div",{className:"cost-item-row",children:[jsxRuntimeExports.jsxs("div",{className:"cost-amount-field",ch
ildren:[jsxRuntimeExports.jsx("label",{children:"Other Cost"}),jsxRuntimeExports.jsx("input",{type:"number",value:ut.ot
herCost||"",onChange:Et=>ct("otherCost",Et.target.value)})]}),jsxRuntimeExports.jsxs("div",{className:"cost-frequency-f
ield",children:[jsxRuntimeExports.jsx("label",{children:"When Paid"}),jsxRuntimeExports.jsxs("select",{value:ut.otherCo
stFrequency||"Once-off",onChange:Et=>Rt(gt=>({...gt,otherCostFrequency:Et.target.value})),children:[jsxRuntimeExports.j
sx("option",{value:"Monthly",children:"Monthly (spread over 
duration)"}),jsxRuntimeExports.jsx("option",{value:"Once-off",children:"Once-off (at 
start)"}),jsxRuntimeExports.jsx("option",{value:"End of Learnership",children:"End of 
Learnership"})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"cost-item-row custom-cost-row",children:[jsxRuntimeExp
orts.jsxs("div",{className:"cost-label-field",children:[jsxRuntimeExports.jsx("label",{children:"Custom Label"}),jsxRun
timeExports.jsx("input",{type:"text",value:ut.customLabel||"",onChange:Et=>Rt(gt=>({...gt,customLabel:Et.target.value})
),placeholder:"e.g., Materials"})]}),jsxRuntimeExports.jsxs("div",{className:"cost-amount-field",children:[jsxRuntimeEx
ports.jsx("label",{children:"Amount"}),jsxRuntimeExports.jsx("input",{type:"number",value:ut.customCost||"",onChange:Et
=>ct("customCost",Et.target.value)})]}),jsxRuntimeExports.jsxs("div",{className:"cost-frequency-field",children:[jsxRun
timeExports.jsx("label",{children:"When Paid"}),jsxRuntimeExports.jsxs("select",{value:ut.customCostFrequency||"Once-of
f",onChange:Et=>Rt(gt=>({...gt,customCostFrequency:Et.target.value})),children:[jsxRuntimeExports.jsx("option",{value:"
Monthly",children:"Monthly (spread over 
duration)"}),jsxRuntimeExports.jsx("option",{value:"Once-off",children:"Once-off (at 
start)"}),jsxRuntimeExports.jsx("option",{value:"End of Learnership",children:"End of Learnership"})]})]})]})]}),jsxRun
timeExports.jsxs("div",{className:"demo-calculation-result",children:[jsxRuntimeExports.jsx("h5",{children:"Calculation
 Result"}),(()=>{const Et=Mt();return Et?jsxRuntimeExports.jsxs("div",{className:"calc-result-content",children:[jsxRun
timeExports.jsxs("div",{className:"calc-formula",children:[jsxRuntimeExports.jsx("span",{className:"formula-label",chil
dren:"Formula:"}),jsxRuntimeExports.jsx("span",{className:"formula-text",children:Et.formula})]}),jsxRuntimeExports.jsx
s("div",{className:"calc-row",children:[jsxRuntimeExports.jsxs("div",{className:"calc-item 
income",children:[jsxRuntimeExports.jsx("label",{children:"Total Income"}),jsxRuntimeExports.jsx("div",{className:"calc
-value",children:Yt(Et.totalIncome)})]}),jsxRuntimeExports.jsxs("div",{className:"calc-item 
costs",children:[jsxRuntimeExports.jsx("label",{children:"Total 
Costs"}),jsxRuntimeExports.jsxs("div",{className:"calc-value 
negative",children:["-",Yt(Et.totalCosts)]})]}),jsxRuntimeExports.jsxs("div",{className:"calc-item 
gp",children:[jsxRuntimeExports.jsx("label",{children:"Gross 
Profit"}),jsxRuntimeExports.jsx("div",{className:`calc-value ${Et.grossProfit>=0?"positive":"negative"}`,children:Yt(Et
.grossProfit)})]})]}),Et.certaintyPercentage<100&&jsxRuntimeExports.jsxs("div",{className:"calc-certainty",children:[js
xRuntimeExports.jsxs("span",{className:"certainty-label",children:["With ",Et.certaintyPercentage,"% certainty:"]}),jsx
RuntimeExports.jsx("span",{className:"certainty-value",children:Yt(Et.adjustedGP)})]}),jsxRuntimeExports.jsxs("div",{cl
assName:"calc-breakdown",children:[jsxRuntimeExports.jsx("label",{children:"Distribution:"}),jsxRuntimeExports.jsx("spa
n",{className:"breakdown-text",children:Et.distribution})]}),jsxRuntimeExports.jsxs("div",{className:"calc-costs-summar
y",children:[jsxRuntimeExports.jsx("label",{children:"Costs Breakdown:"}),jsxRuntimeExports.jsxs("ul",{className:"costs
-list",children:[(ut.facilitatorCost||0)>0&&jsxRuntimeExports.jsxs("li",{children:["Facilitator: 
",Yt(ut.facilitatorCost)," (",ut.facilitatorCostFrequency||"Monthly",")"]}),Et.commissionAmount>0&&jsxRuntimeExports.js
xs("li",{children:["Commission (",ut.commissionPercentage,"%): ",Yt(Et.commissionAmount)," 
(",ut.commissionFrequency||"With Income",")"]}),(ut.travelCost||0)>0&&jsxRuntimeExports.jsxs("li",{children:["Travel: 
",Yt(ut.travelCost)," 
(",ut.travelCostFrequency||"Monthly",")"]}),(ut.assessorCost||0)>0&&jsxRuntimeExports.jsxs("li",{children:["Assessor: 
",Yt(ut.assessorCost)," (",ut.assessorCostFrequency||"End of 
Learnership",")"]}),(ut.moderatorCost||0)>0&&jsxRuntimeExports.jsxs("li",{children:["Moderator: 
",Yt(ut.moderatorCost)," (",ut.moderatorCostFrequency||"End of 
Learnership",")"]}),(ut.otherCost||0)>0&&jsxRuntimeExports.jsxs("li",{children:["Other: ",Yt(ut.otherCost)," (",ut.othe
rCostFrequency||"Once-off",")"]}),(ut.customCost||0)>0&&jsxRuntimeExports.jsxs("li",{children:[ut.customLabel||"Custom"
,": ",Yt(ut.customCost)," (",ut.customCostFrequency||"Once-off",")"]})]})]}),jsxRuntimeExports.jsxs("div",{className:"c
alc-gp-margin",children:[jsxRuntimeExports.jsx("label",{children:"GP 
Margin:"}),jsxRuntimeExports.jsx("span",{className:`margin-value ${Et.gpMargin>=0?"positive":"negative"}`,children:Et.t
otalIncome>0?`${Et.gpMargin.toFixed(1)}%`:"N/A"})]})]}):jsxRuntimeExports.jsx("p",{children:"No calculation available"}
)})()]})]})]}),(mt.id==="compliance"||mt.id==="otherCourses")&&jsxRuntimeExports.jsxs("div",{className:"learnership-dem
o-form",children:[jsxRuntimeExports.jsx("div",{className:"demo-form-header",children:jsxRuntimeExports.jsxs("h4",{child
ren:["Deal 1 - ",ut.dealName||ut.courseName||"New Training Deal"]})}),jsxRuntimeExports.jsxs("div",{className:"demo-ver
tical-grid",children:[jsxRuntimeExports.jsxs("div",{className:"demo-field",children:[jsxRuntimeExports.jsx("label",{chi
ldren:"Course"}),jsxRuntimeExports.jsxs("select",{value:ut.courseName||"",onChange:Et=>Rt(gt=>({...gt,courseName:Et.tar
get.value})),children:[jsxRuntimeExports.jsx("option",{value:"",children:"-- Select Course 
--"}),(ht.courseOptions||[]).map((Et,gt)=>{const ft=typeof Et=="string"?Et:Et.name,zt=typeof 
Et=="string"?Et:Et.value||Et.name;return jsxRuntimeExports.jsx("option",{value:zt,children:ft},Et.id||gt)})]})]}),ut.co
urseName==="Other"&&jsxRuntimeExports.jsxs("div",{className:"demo-field",children:[jsxRuntimeExports.jsx("label",{child
ren:"Custom Course Name"}),jsxRuntimeExports.jsx("input",{type:"text",value:ut.customCourseName||"",onChange:Et=>Rt(gt=
>({...gt,customCourseName:Et.target.value})),placeholder:"Enter course name"})]}),jsxRuntimeExports.jsxs("div",{classNa
me:"demo-field",children:[jsxRuntimeExports.jsx("label",{children:"Deal Certainty %"}),jsxRuntimeExports.jsx("input",{t
ype:"number",min:"0",max:"100",value:ut.certaintyPercentage??100,onChange:Et=>ct("certaintyPercentage",Et.target.value)
,placeholder:"100"})]}),jsxRuntimeExports.jsxs("div",{className:"demo-field full-width",children:[jsxRuntimeExports.jsx
("label",{children:"Description"}),jsxRuntimeExports.jsx("textarea",{value:ut.description||"",onChange:Et=>Rt(gt=>({...
gt,description:Et.target.value})),placeholder:"Add notes about this deal...",rows:"2"})]}),jsxRuntimeExports.jsxs("div"
,{className:"demo-field",children:[jsxRuntimeExports.jsx("label",{children:"Training Date"}),jsxRuntimeExports.jsx("inp
ut",{type:"date",value:ut.trainingDate||"",onChange:Et=>Rt(gt=>({...gt,trainingDate:Et.target.value}))})]}),jsxRuntimeE
xports.jsxs("div",{className:"demo-field",children:[jsxRuntimeExports.jsx("label",{children:"Number of Trainees"}),jsxR
untimeExports.jsx("input",{type:"number",min:"0",value:ut.numberOfTrainees||"",onChange:Et=>ct("numberOfTrainees",Et.ta
rget.value)})]}),jsxRuntimeExports.jsxs("div",{className:"demo-field",children:[jsxRuntimeExports.jsx("label",{children
:"Price per Person"}),jsxRuntimeExports.jsx("input",{type:"number",min:"0",value:ut.pricePerPerson||"",onChange:Et=>ct(
"pricePerPerson",Et.target.value)})]}),jsxRuntimeExports.jsxs("div",{className:"demo-field",children:[jsxRuntimeExports
.jsx("label",{children:"Total Income"}),jsxRuntimeExports.jsx("div",{className:"demo-calculated-value",children:Yt((ut.
numberOfTrainees||0)*(ut.pricePerPerson||0))})]}),jsxRuntimeExports.jsxs("div",{className:"demo-costs-section",children
:[jsxRuntimeExports.jsx("h5",{children:"Cost of 
Sales"}),jsxRuntimeExports.jsx("p",{className:"costs-hint",children:"Price can be zero for internal training - only 
costs will apply"}),jsxRuntimeExports.jsxs("div",{className:"cost-item-row",children:[jsxRuntimeExports.jsxs("div",{cla
ssName:"cost-amount-field commission-field",children:[jsxRuntimeExports.jsx("label",{children:"Commission %"}),jsxRunti
meExports.jsx("input",{type:"number",min:"0",max:"100",step:"0.01",value:ut.commissionPercentage||"",onChange:Et=>ct("c
ommissionPercentage",Et.target.value),placeholder:"%"}),jsxRuntimeExports.jsxs("span",{className:"commission-amount",ch
ildren:["= ",Yt((ut.numberOfTrainees||0)*(ut.pricePerPerson||0)*(ut.commissionPercentage||0)/100)]})]}),jsxRuntimeExpor
ts.jsxs("div",{className:"cost-frequency-field",children:[jsxRuntimeExports.jsx("label",{children:"When 
Paid"}),jsxRuntimeExports.jsxs("select",{value:ut.commissionFrequency||"With Income",onChange:Et=>Rt(gt=>({...gt,commis
sionFrequency:Et.target.value})),children:[jsxRuntimeExports.jsx("option",{value:"With Income",children:"With Income"})
,jsxRuntimeExports.jsx("option",{value:"Once-off",children:"Once-off"})]})]})]}),jsxRuntimeExports.jsxs("div",{classNam
e:"cost-item-row",children:[jsxRuntimeExports.jsxs("div",{className:"cost-amount-field",children:[jsxRuntimeExports.jsx
("label",{children:"Travel Cost"}),jsxRuntimeExports.jsx("input",{type:"number",value:ut.travelCost||"",onChange:Et=>ct
("travelCost",Et.target.value)})]}),jsxRuntimeExports.jsxs("div",{className:"cost-frequency-field",children:[jsxRuntime
Exports.jsx("label",{children:"When Paid"}),jsxRuntimeExports.jsx("select",{value:ut.travelCostFrequency||"Once-off",on
Change:Et=>Rt(gt=>({...gt,travelCostFrequency:Et.target.value})),children:jsxRuntimeExports.jsx("option",{value:"Once-o
ff",children:"Once-off"})})]})]}),jsxRuntimeExports.jsxs("div",{className:"cost-item-row",children:[jsxRuntimeExports.j
sxs("div",{className:"cost-amount-field",children:[jsxRuntimeExports.jsx("label",{children:"Manuals Cost"}),jsxRuntimeE
xports.jsx("input",{type:"number",value:ut.manualsCost||"",onChange:Et=>ct("manualsCost",Et.target.value)})]}),jsxRunti
meExports.jsxs("div",{className:"cost-frequency-field",children:[jsxRuntimeExports.jsx("label",{children:"When Paid"}),
jsxRuntimeExports.jsx("select",{value:ut.manualsCostFrequency||"Once-off",onChange:Et=>Rt(gt=>({...gt,manualsCostFreque
ncy:Et.target.value})),children:jsxRuntimeExports.jsx("option",{value:"Once-off",children:"Once-off"})})]})]}),jsxRunti
meExports.jsxs("div",{className:"cost-item-row",children:[jsxRuntimeExports.jsxs("div",{className:"cost-amount-field",c
hildren:[jsxRuntimeExports.jsx("label",{children:"Accommodation Cost"}),jsxRuntimeExports.jsx("input",{type:"number",va
lue:ut.accommodationCost||"",onChange:Et=>ct("accommodationCost",Et.target.value)})]}),jsxRuntimeExports.jsxs("div",{cl
assName:"cost-frequency-field",children:[jsxRuntimeExports.jsx("label",{children:"When Paid"}),jsxRuntimeExports.jsx("s
elect",{value:ut.accommodationCostFrequency||"Once-off",onChange:Et=>Rt(gt=>({...gt,accommodationCostFrequency:Et.targe
t.value})),children:jsxRuntimeExports.jsx("option",{value:"Once-off",children:"Once-off"})})]})]}),jsxRuntimeExports.js
xs("div",{className:"cost-item-row",children:[jsxRuntimeExports.jsxs("div",{className:"cost-amount-field",children:[jsx
RuntimeExports.jsx("label",{children:"Accreditation Cost"}),jsxRuntimeExports.jsx("input",{type:"number",value:ut.accre
ditationCost||"",onChange:Et=>ct("accreditationCost",Et.target.value)})]}),jsxRuntimeExports.jsxs("div",{className:"cos
t-frequency-field",children:[jsxRuntimeExports.jsx("label",{children:"When Paid"}),jsxRuntimeExports.jsx("select",{valu
e:ut.accreditationCostFrequency||"Once-off",onChange:Et=>Rt(gt=>({...gt,accreditationCostFrequency:Et.target.value})),c
hildren:jsxRuntimeExports.jsx("option",{value:"Once-off",children:"Once-off"})})]})]}),jsxRuntimeExports.jsxs("div",{cl
assName:"cost-item-row custom-cost-row",children:[jsxRuntimeExports.jsxs("div",{className:"cost-label-field",children:[
jsxRuntimeExports.jsx("label",{children:"Custom Label"}),jsxRuntimeExports.jsx("input",{type:"text",value:ut.customCost
Label||"",onChange:Et=>Rt(gt=>({...gt,customCostLabel:Et.target.value})),placeholder:"e.g., Catering"})]}),jsxRuntimeEx
ports.jsxs("div",{className:"cost-amount-field",children:[jsxRuntimeExports.jsx("label",{children:"Amount"}),jsxRuntime
Exports.jsx("input",{type:"number",value:ut.customCost||"",onChange:Et=>ct("customCost",Et.target.value)})]}),jsxRuntim
eExports.jsxs("div",{className:"cost-frequency-field",children:[jsxRuntimeExports.jsx("label",{children:"When Paid"}),j
sxRuntimeExports.jsx("select",{value:ut.customCostFrequency||"Once-off",onChange:Et=>Rt(gt=>({...gt,customCostFrequency
:Et.target.value})),children:jsxRuntimeExports.jsx("option",{value:"Once-off",children:"Once-off"})})]})]})]}),jsxRunti
meExports.jsxs("div",{className:"demo-calculation-result",children:[jsxRuntimeExports.jsx("h5",{children:"Calculation 
Result"}),(()=>{const Et=Mt();return Et?jsxRuntimeExports.jsxs("div",{className:"calc-result-content",children:[jsxRunt
imeExports.jsxs("div",{className:"calc-formula",children:[jsxRuntimeExports.jsx("span",{className:"formula-label",child
ren:"Formula:"}),jsxRuntimeExports.jsx("span",{className:"formula-text",children:Et.formula})]}),jsxRuntimeExports.jsxs
("div",{className:"calc-row",children:[jsxRuntimeExports.jsxs("div",{className:"calc-item 
income",children:[jsxRuntimeExports.jsx("label",{children:"Total Income"}),jsxRuntimeExports.jsx("div",{className:"calc
-value",children:Yt(Et.totalIncome)})]}),jsxRuntimeExports.jsxs("div",{className:"calc-item 
costs",children:[jsxRuntimeExports.jsx("label",{children:"Total 
Costs"}),jsxRuntimeExports.jsxs("div",{className:"calc-value 
negative",children:["-",Yt(Et.totalCosts)]})]}),jsxRuntimeExports.jsxs("div",{className:"calc-item 
gp",children:[jsxRuntimeExports.jsx("label",{children:"Gross 
Profit"}),jsxRuntimeExports.jsx("div",{className:`calc-value ${Et.grossProfit>=0?"positive":"negative"}`,children:Yt(Et
.grossProfit)})]})]}),Et.certaintyPercentage<100&&jsxRuntimeExports.jsxs("div",{className:"calc-certainty",children:[js
xRuntimeExports.jsxs("span",{className:"certainty-label",children:["With ",Et.certaintyPercentage,"% certainty:"]}),jsx
RuntimeExports.jsx("span",{className:"certainty-value",children:Yt(Et.adjustedGP)})]}),jsxRuntimeExports.jsxs("div",{cl
assName:"calc-breakdown",children:[jsxRuntimeExports.jsx("label",{children:"Distribution:"}),jsxRuntimeExports.jsx("spa
n",{className:"breakdown-text",children:Et.distribution})]}),jsxRuntimeExports.jsxs("div",{className:"calc-costs-summar
y",children:[jsxRuntimeExports.jsx("label",{children:"Costs Breakdown:"}),jsxRuntimeExports.jsxs("ul",{className:"costs
-list",children:[Et.commissionAmount>0&&jsxRuntimeExports.jsxs("li",{children:["Commission 
(",ut.commissionPercentage,"%): ",Yt(Et.commissionAmount)," (",ut.commissionFrequency||"With 
Income",")"]}),(ut.travelCost||0)>0&&jsxRuntimeExports.jsxs("li",{children:["Travel: ",Yt(ut.travelCost)," 
(",ut.travelCostFrequency||"Once-off",")"]}),(ut.manualsCost||0)>0&&jsxRuntimeExports.jsxs("li",{children:["Manuals: 
",Yt(ut.manualsCost)," (",ut.manualsCostFrequency||"Once-off",")"]}),(ut.accommodationCost||0)>0&&jsxRuntimeExports.jsx
s("li",{children:["Accommodation: ",Yt(ut.accommodationCost)," (",ut.accommodationCostFrequency||"Once-off",")"]}),(ut.
accreditationCost||0)>0&&jsxRuntimeExports.jsxs("li",{children:["Accreditation: ",Yt(ut.accreditationCost)," (",ut.accr
editationCostFrequency||"Once-off",")"]}),(ut.customCost||0)>0&&jsxRuntimeExports.jsxs("li",{children:[ut.customCostLab
el||"Custom",": ",Yt(ut.customCost)," (",ut.customCostFrequency||"Once-off",")"]})]})]}),jsxRuntimeExports.jsxs("div",{
className:"calc-gp-margin",children:[jsxRuntimeExports.jsx("label",{children:"GP 
Margin:"}),jsxRuntimeExports.jsx("span",{className:`margin-value ${Et.gpMargin>=0?"positive":"negative"}`,children:Et.t
otalIncome>0?`${Et.gpMargin.toFixed(1)}%`:"N/A"})]})]}):jsxRuntimeExports.jsx("p",{children:"No calculation available"}
)})()]})]})]}),mt.id==="tapBusiness"&&jsxRuntimeExports.jsxs("div",{className:"learnership-demo-form",children:[jsxRunt
imeExports.jsx("div",{className:"demo-form-header",children:jsxRuntimeExports.jsxs("h4",{children:["Deal 1 - 
",ut.dealName||"New TAP Business Deal"]})}),jsxRuntimeExports.jsxs("div",{className:"demo-vertical-grid",children:[jsxR
untimeExports.jsxs("div",{className:"demo-field",children:[jsxRuntimeExports.jsx("label",{children:"Deal Name"}),jsxRun
timeExports.jsx("input",{type:"text",value:ut.dealName||"",onChange:Et=>Rt(gt=>({...gt,dealName:Et.target.value})),plac
eholder:"e.g., Company ABC 
TAP"})]}),jsxRuntimeExports.jsxs("div",{className:"demo-field",children:[jsxRuntimeExports.jsx("label",{children:"Deal 
Certainty %"}),jsxRuntimeExports.jsx("input",{type:"number",min:"0",max:"100",value:ut.certaintyPercentage??100,onChang
e:Et=>ct("certaintyPercentage",Et.target.value),placeholder:"100"})]}),jsxRuntimeExports.jsxs("div",{className:"demo-fi
eld full-width",children:[jsxRuntimeExports.jsx("label",{children:"Description"}),jsxRuntimeExports.jsx("textarea",{val
ue:ut.description||"",onChange:Et=>Rt(gt=>({...gt,description:Et.target.value})),placeholder:"Add notes about this deal
...",rows:"2"})]}),jsxRuntimeExports.jsxs("div",{className:"demo-field",children:[jsxRuntimeExports.jsx("label",{childr
en:"Number of Employees"}),jsxRuntimeExports.jsx("input",{type:"number",min:"0",value:ut.numberOfEmployees||"",onChange
:Et=>ct("numberOfEmployees",Et.target.value),placeholder:"0"})]}),jsxRuntimeExports.jsxs("div",{className:"demo-field",
children:[jsxRuntimeExports.jsx("label",{children:"Cost per Employee / Month"}),jsxRuntimeExports.jsx("input",{type:"nu
mber",min:"0",value:ut.costPerEmployeePerMonth||"",onChange:Et=>ct("costPerEmployeePerMonth",Et.target.value)})]}),jsxR
untimeExports.jsxs("div",{className:"demo-field",children:[jsxRuntimeExports.jsx("label",{children:"Payment Type"}),jsx
RuntimeExports.jsxs("select",{value:ut.paymentType||"Monthly",onChange:Et=>Rt(gt=>({...gt,paymentType:Et.target.value})
),children:[jsxRuntimeExports.jsx("option",{value:"Monthly",children:"Monthly 
Fee"}),jsxRuntimeExports.jsx("option",{value:"Annual",children:"Annual Fee"})]})]}),jsxRuntimeExports.jsxs("div",{class
Name:"demo-field",children:[jsxRuntimeExports.jsx("label",{children:"Payment Start Date"}),jsxRuntimeExports.jsx("input
",{type:"date",value:ut.paymentStartDate||"",onChange:Et=>Rt(gt=>({...gt,paymentStartDate:Et.target.value}))})]}),jsxRu
ntimeExports.jsxs("div",{className:"demo-field",children:[jsxRuntimeExports.jsx("label",{children:"Contract Duration (M
onths)"}),jsxRuntimeExports.jsx("input",{type:"number",min:"1",value:ut.paymentType==="Annual"?1:ut.contractMonths||12,
onChange:Et=>ct("contractMonths",Et.target.value),disabled:ut.paymentType==="Annual",title:ut.paymentType==="Annual"?"D
uration is automatically set to 1 for Annual payments":""})]}),jsxRuntimeExports.jsxs("div",{className:"demo-field",chi
ldren:[jsxRuntimeExports.jsx("label",{children:"Total 
Income"}),jsxRuntimeExports.jsx("div",{className:"demo-calculated-value",children:(()=>{const Et=ut.numberOfEmployees||
0,gt=ut.costPerEmployeePerMonth||0,ft=ut.paymentType||"Monthly",zt=ft==="Annual"?1:ut.contractMonths||12,Ct=ft==="Annua
l"?Et*gt*12:Et*gt*zt;return Yt(Ct)})()})]}),jsxRuntimeExports.jsxs("div",{className:"demo-costs-section",children:[jsxR
untimeExports.jsx("h5",{children:"Cost of Sales"}),jsxRuntimeExports.jsx("p",{className:"costs-hint",children:"Set 
when each cost will be paid to calculate GP correctly per period"}),jsxRuntimeExports.jsxs("div",{className:"cost-item-
row",children:[jsxRuntimeExports.jsxs("div",{className:"cost-amount-field 
commission-field",children:[jsxRuntimeExports.jsx("label",{children:"Commission %"}),jsxRuntimeExports.jsx("input",{typ
e:"number",min:"0",max:"100",step:"0.01",value:ut.commissionPercentage||"",onChange:Et=>ct("commissionPercentage",Et.ta
rget.value),placeholder:"%"}),jsxRuntimeExports.jsxs("span",{className:"commission-amount",children:["= ",(()=>{const E
t=ut.numberOfEmployees||0,gt=ut.costPerEmployeePerMonth||0,ft=ut.paymentType||"Monthly",zt=ft==="Annual"?1:ut.contractM
onths||12,Ct=ft==="Annual"?Et*gt*12:Et*gt*zt;return Yt(Ct*(ut.commissionPercentage||0)/100)})()]})]}),jsxRuntimeExports
.jsxs("div",{className:"cost-frequency-field",children:[jsxRuntimeExports.jsx("label",{children:"When 
Paid"}),jsxRuntimeExports.jsxs("select",{value:ut.commissionFrequency||"With Income",onChange:Et=>Rt(gt=>({...gt,commis
sionFrequency:Et.target.value})),children:[jsxRuntimeExports.jsx("option",{value:"With Income",children:"With Income 
(same as revenue)"}),jsxRuntimeExports.jsx("option",{value:"Once-off",children:"Once-off (at 
start)"})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"cost-item-row custom-cost-row",children:[jsxRuntimeExports.
jsxs("div",{className:"cost-label-field",children:[jsxRuntimeExports.jsx("label",{children:"Custom Cost Label"}),jsxRun
timeExports.jsx("input",{type:"text",value:ut.customCostLabel||"",onChange:Et=>Rt(gt=>({...gt,customCostLabel:Et.target
.value})),placeholder:"e.g., Setup Fee"})]}),jsxRuntimeExports.jsxs("div",{className:"cost-amount-field",children:[jsxR
untimeExports.jsx("label",{children:"Amount"}),jsxRuntimeExports.jsx("input",{type:"number",value:ut.customCost||"",onC
hange:Et=>ct("customCost",Et.target.value)})]}),jsxRuntimeExports.jsxs("div",{className:"cost-frequency-field",children
:[jsxRuntimeExports.jsx("label",{children:"When Paid"}),jsxRuntimeExports.jsxs("select",{value:ut.customCostFrequency||
"Once-off",onChange:Et=>Rt(gt=>({...gt,customCostFrequency:Et.target.value})),children:[jsxRuntimeExports.jsx("option",
{value:"Once-off",children:"Once-off (at start)"}),jsxRuntimeExports.jsx("option",{value:"With Income",children:"With 
Income (same as revenue)"})]})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"demo-calculation-result",children:[jsx
RuntimeExports.jsx("h5",{children:"Calculation Result"}),(()=>{const Et=Mt();return Et?jsxRuntimeExports.jsxs("div",{cl
assName:"calc-result-content",children:[jsxRuntimeExports.jsxs("div",{className:"calc-formula",children:[jsxRuntimeExpo
rts.jsx("span",{className:"formula-label",children:"Formula:"}),jsxRuntimeExports.jsx("span",{className:"formula-text",
children:Et.formula})]}),jsxRuntimeExports.jsxs("div",{className:"calc-row",children:[jsxRuntimeExports.jsxs("div",{cla
ssName:"calc-item income",children:[jsxRuntimeExports.jsx("label",{children:"Total Income"}),jsxRuntimeExports.jsx("div
",{className:"calc-value",children:Yt(Et.totalIncome)})]}),jsxRuntimeExports.jsxs("div",{className:"calc-item 
costs",children:[jsxRuntimeExports.jsx("label",{children:"Total 
Costs"}),jsxRuntimeExports.jsxs("div",{className:"calc-value 
negative",children:["-",Yt(Et.totalCosts)]})]}),jsxRuntimeExports.jsxs("div",{className:"calc-item 
gp",children:[jsxRuntimeExports.jsx("label",{children:"Gross 
Profit"}),jsxRuntimeExports.jsx("div",{className:`calc-value ${Et.grossProfit>=0?"positive":"negative"}`,children:Yt(Et
.grossProfit)})]})]}),Et.certaintyPercentage<100&&jsxRuntimeExports.jsxs("div",{className:"calc-certainty",children:[js
xRuntimeExports.jsxs("span",{className:"certainty-label",children:["With ",Et.certaintyPercentage,"% certainty:"]}),jsx
RuntimeExports.jsx("span",{className:"certainty-value",children:Yt(Et.adjustedGP)})]}),Et.monthlyIncome>0&&jsxRuntimeEx
ports.jsxs("div",{className:"calc-monthly",children:[jsxRuntimeExports.jsx("label",{children:"Monthly Income:"}),jsxRun
timeExports.jsx("span",{className:"monthly-value",children:Yt(Et.monthlyIncome)})]}),jsxRuntimeExports.jsxs("div",{clas
sName:"calc-breakdown",children:[jsxRuntimeExports.jsx("label",{children:"Distribution:"}),jsxRuntimeExports.jsx("span"
,{className:"breakdown-text",children:Et.distribution})]}),jsxRuntimeExports.jsxs("div",{className:"calc-costs-summary"
,children:[jsxRuntimeExports.jsx("label",{children:"Costs Breakdown:"}),jsxRuntimeExports.jsxs("ul",{className:"costs-l
ist",children:[Et.commissionAmount>0&&jsxRuntimeExports.jsxs("li",{children:["Commission 
(",ut.commissionPercentage,"%): ",Yt(Et.commissionAmount)," (",ut.commissionFrequency||"With 
Income",")"]}),(ut.customCost||0)>0&&jsxRuntimeExports.jsxs("li",{children:[ut.customCostLabel||"Custom",": 
",Yt(ut.customCost)," (",ut.customCostFrequency||"Once-off",")"]})]})]}),jsxRuntimeExports.jsxs("div",{className:"calc-
gp-margin",children:[jsxRuntimeExports.jsx("label",{children:"GP 
Margin:"}),jsxRuntimeExports.jsx("span",{className:`margin-value ${Et.gpMargin>=0?"positive":"negative"}`,children:Et.t
otalIncome>0?`${Et.gpMargin.toFixed(1)}%`:"N/A"})]})]}):jsxRuntimeExports.jsx("p",{children:"No calculation available"}
)})()]})]})]}),jsxRuntimeExports.jsxs("div",{className:"demo-note",children:[jsxRuntimeExports.jsx("strong",{children:"
Note:"})," This demo shows exactly what salespeople will see when adding a ",(ys=mt.config)==null?void 0:ys.name," 
deal to their forecast."]})]}),_t==="lists"&&jsxRuntimeExports.jsx("div",{className:"lists-section",children:Object.key
s(ht).length===0?jsxRuntimeExports.jsx("div",{className:"empty-state",children:jsxRuntimeExports.jsx("p",{children:"No 
configurable lists for this product type."})}):Object.entries(ht).map(([Et,gt])=>jsxRuntimeExports.jsxs("div",{classNam
e:"list-editor",children:[jsxRuntimeExports.jsx("h4",{children:ls(Et)}),jsxRuntimeExports.jsx("p",{className:"list-hint
",children:"These options will appear in dropdown menus for this 
product"}),jsxRuntimeExports.jsx("div",{className:"list-items",children:gt.map((ft,zt)=>{const Ct=typeof 
ft=="string"?ft:ft.name;return jsxRuntimeExports.jsxs("div",{className:"list-item-row",children:[jsxRuntimeExports.jsx(
"input",{type:"text",value:Ct||"",onChange:Pt=>xt(Et,zt,Pt.target.value),placeholder:"Option 
name"}),jsxRuntimeExports.jsx("button",{type:"button",className:"btn btn-sm btn-danger",onClick:()=>Tt(Et,zt),children:
"Remove"})]},ft.id||zt)})}),jsxRuntimeExports.jsx("button",{type:"button",className:"btn btn-sm btn-secondary 
add-item-btn",onClick:()=>yt(Et),children:"+ Add Option"})]},Et))}),_t==="costs"&&jsxRuntimeExports.jsx("div",{classNam
e:"costs-section",children:jt.length===0?jsxRuntimeExports.jsx("div",{className:"empty-state",children:jsxRuntimeExport
s.jsx("p",{children:"No costing lines configured for this product type."})}):jsxRuntimeExports.jsx("div",{className:"co
st-fields-list",children:jt.map(Et=>jsxRuntimeExports.jsxs("div",{className:`cost-field-card ${Et.enabled?"":"disabled"
}`,children:[jsxRuntimeExports.jsxs("div",{className:"cost-field-header",children:[jsxRuntimeExports.jsxs("label",{clas
sName:"toggle-label",children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:Et.enabled,onChange:()=>fs(Et.id)
}),jsxRuntimeExports.jsx("span",{className:"cost-field-name",children:Et.name})]}),Et.isPercentage&&jsxRuntimeExports.j
sx("span",{className:"cost-type-badge 
percentage",children:"Percentage"}),Et.hasCustomLabel&&jsxRuntimeExports.jsx("span",{className:"cost-type-badge 
custom",children:"Custom Label"})]}),Et.enabled&&jsxRuntimeExports.jsx("div",{className:"cost-field-options",children:j
sxRuntimeExports.jsxs("div",{className:"cost-field-row",children:[jsxRuntimeExports.jsxs("div",{className:"form-group",
children:[jsxRuntimeExports.jsxs("label",{children:["Default ",Et.isPercentage?"%":"Amount (R)"]}),jsxRuntimeExports.js
x("input",{type:"number",value:Et.defaultValue||"",onChange:gt=>cs(Et.id,"defaultValue",gt.target.value),placeholder:Et
.isPercentage?"0":"0.00",min:"0",step:Et.isPercentage?"1":"0.01"})]}),Et.hasFrequency&&Et.frequencyOptions&&jsxRuntimeE
xports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Default Frequency"}),jsxRu
ntimeExports.jsx("select",{value:Et.defaultFrequency||"",onChange:gt=>cs(Et.id,"defaultFrequency",gt.target.value),chil
dren:Et.frequencyOptions.map(gt=>jsxRuntimeExports.jsx("option",{value:gt,children:gt},gt))})]})]})})]},Et.id))})})]}),
jsxRuntimeExports.jsxs("div",{className:"modal-footer",children:[jsxRuntimeExports.jsx("button",{type:"button",classNam
e:"btn btn-secondary",onClick:nt,children:_t==="demo"?"Close":"Cancel"}),_t!=="demo"&&jsxRuntimeExports.jsx("button",{t
ype:"button",className:"btn btn-primary",onClick:Es,disabled:h,children:h?"Saving...":"Save Changes"})]})]})})]})},Budg
etManagement=()=>{const{getTenantId:s,isSystemAdmin:e,accessibleUserIds:i}=useTenant(),a=s(),[o,c]=reactExports.useStat
e(!0),[d,h]=reactExports.useState(!1),[j,_]=reactExports.useState(!1),[$,rt]=reactExports.useState([]),[tt,mt]=reactExp
orts.useState([]),[vt,_t]=reactExports.useState([]),[wt,ht]=reactExports.useState(""),[dt,jt]=reactExports.useState(!1)
,[bt,ut]=reactExports.useState(null),[Rt,st]=reactExports.useState(""),[it,nt]=reactExports.useState(""),[ct,xt]=reactE
xports.useState(!1),[yt,Tt]=reactExports.useState({}),[fs,cs]=reactExports.useState({}),[Es,ls]=reactExports.useState(!
1),Yt=["Learnerships","TAP Business","Compliance Training","Other 
Courses"];reactExports.useEffect(()=>{Mt()},[]);const Mt=async()=>{var Dt,Ht;try{const 
os=auth.currentUser;if(os){ut(os.uid);const Qt=await getUserData(os.uid);if(Qt){const Ft=await getRole(Qt.role||"salesp
erson"),xs=Qt.role||"",Cs=Qt.salesLevel||"",gs=xs==="group-sales-manager"||xs==="sales_head"||xs==="admin"||Cs==="sales
_head";h(gs);const qt=Ft&&(((Dt=Ft.permissions)==null?void 
0:Dt.includes("manage_users"))||((Ht=Ft.permissions)==null?void 0:Ht.includes("manage_clients")))||gs;jt(qt),qt?await 
Gt(gs):(st("You do not have permission to access this page."),c(!1))}}}catch(os){console.error("Error checking user 
role:",os),st("Failed to load user permissions."),c(!1)}},Gt=async(Dt=d)=>{try{const os=(await 
getFinancialYearSettings(a)).currentFinancialYear||"2024/2025";ht(os);const Qt=e?null:a,[Ft,xs,Cs]=await 
Promise.all([getUsersByTenant(Qt),getBudgets(os),getBudgetVsForecast(os)]);let 
gs=Ft;!e&&!Dt&&i&&i.length>0&&(gs=Ft.filter(es=>i.includes(es.id)));const Os=e||Dt?Ft.map(es=>es.id):i,qt=xs.filter(es=
>Os.includes(es.salespersonId)),js=Cs.filter(es=>Os.includes(es.userId));rt(gs),mt(qt),_t(js),c(!1)}catch(Ht){console.e
rror("Error loading data:",Ht),st("Failed to load budget data."),c(!1)}},Wt=()=>{const 
Dt={},Ht={};$.forEach(os=>{Dt[os.id]={},Ht[os.id]={},Yt.forEach(Qt=>{const Ft=gt(os.id,Qt),xs=(Ft==null?void 
0:Ft.budgetAmount)||0;Dt[os.id][Qt]=xs,Ht[os.id][Qt]=xs>0?new 
Intl.NumberFormat("en-ZA").format(xs):""})}),Tt(Dt),cs(Ht),xt(!0)},ms=()=>{xt(!1),Tt({}),cs({}),st("")},ss=Dt=>new Intl
.NumberFormat("en-ZA",{style:"currency",currency:"ZAR",minimumFractionDigits:0}).format(Dt||0),ys=Dt=>{if(!Dt)return 
0;const Ht=Dt.toString().replace(/[^\d.]/g,"");return parseFloat(Ht)||0},Et=Dt=>Dt>0?"positive":Dt<0?"negative":"neutra
l",gt=(Dt,Ht)=>tt.find(os=>os.salespersonId===Dt&&os.productLine===Ht),ft=(Dt,Ht,os)=>{cs(Ft=>({...Ft,[Dt]:{...Ft[Dt],[
Ht]:os}}));const Qt=ys(os);Tt(Ft=>({...Ft,[Dt]:{...Ft[Dt],[Ht]:Qt}}))},zt=(Dt,Ht)=>{var Qt;const 
os=((Qt=yt[Dt])==null?void 0:Qt[Ht])||0;cs(Ft=>({...Ft,[Dt]:{...Ft[Dt],[Ht]:os>0?new 
Intl.NumberFormat("en-ZA").format(os):""}}))},Ct=(Dt,Ht)=>{var Qt;const os=((Qt=yt[Dt])==null?void 
0:Qt[Ht])||0;cs(Ft=>({...Ft,[Dt]:{...Ft[Dt],[Ht]:os>0?os.toString():""}}))},Pt=async()=>{ls(!0),st("");try{const 
Dt=[];Object.entries(yt).forEach(([Ht,os])=>{Object.entries(os).forEach(([Qt,Ft])=>{const 
xs=gt(Ht,Qt);(Ft>0||xs)&&Dt.push(saveBudget(Ht,Qt,wt,Ft,bt))})}),await Promise.all(Dt),nt("All budgets saved 
successfully!"),xt(!1),Tt({}),cs({}),await Gt(),setTimeout(()=>nt(""),3e3)}catch(Dt){console.error("Error saving 
budgets:",Dt),st("Failed to save some budgets. Please try again.")}finally{ls(!1)}},$t=Dt=>yt[Dt]?Object.values(yt[Dt])
.reduce((Ht,os)=>Ht+(parseFloat(os)||0),0):0,Bt=Dt=>Object.values(yt).reduce((Ht,os)=>Ht+(parseFloat(os[Dt])||0),0),Lt=
()=>Object.values(yt).reduce((Dt,Ht)=>Dt+Object.values(Ht).reduce((os,Qt)=>os+(parseFloat(Qt)||0),0),0),Xt=vt.reduce((D
t,Ht)=>(Dt.budget+=Ht.totalBudget,Dt.forecast+=Ht.totalForecast,Dt),{budget:0,forecast:0});return 
o?jsxRuntimeExports.jsxs("div",{className:"budget-management",children:[jsxRuntimeExports.jsx("h1",{children:"Budget Ma
nagement"}),jsxRuntimeExports.jsx("p",{children:"Loading..."})]}):dt?jsxRuntimeExports.jsxs("div",{className:"budget-ma
nagement",children:[jsxRuntimeExports.jsxs("div",{className:"page-header",children:[jsxRuntimeExports.jsx("h1",{childre
n:"Budget Management"}),jsxRuntimeExports.jsx("div",{className:"header-actions",children:jsxRuntimeExports.jsxs("span",
{className:"financial-year-badge",children:["FY ",wt]})})]}),it&&jsxRuntimeExports.jsx("div",{className:"success-messag
e",children:it}),Rt&&jsxRuntimeExports.jsx("div",{className:"error-message",children:Rt}),jsxRuntimeExports.jsxs("div",
{className:"budget-summary",children:[jsxRuntimeExports.jsxs("div",{className:"summary-card",children:[jsxRuntimeExport
s.jsx("div",{className:"summary-label",children:"Total Budget"}),jsxRuntimeExports.jsx("div",{className:"summary-value"
,children:ss(Xt.budget)})]}),jsxRuntimeExports.jsxs("div",{className:"summary-card",children:[jsxRuntimeExports.jsx("di
v",{className:"summary-label",children:"Full Year Forecast"}),jsxRuntimeExports.jsx("div",{className:"summary-value",ch
ildren:ss(Xt.forecast)})]}),jsxRuntimeExports.jsxs("div",{className:`summary-card variance ${Et(Xt.forecast-Xt.budget)}
`,children:[jsxRuntimeExports.jsx("div",{className:"summary-label",children:"Variance"}),jsxRuntimeExports.jsxs("div",{
className:"summary-value",children:[ss(Xt.forecast-Xt.budget),Xt.budget>0&&jsxRuntimeExports.jsxs("span",{className:"va
riance-percent",children:["(",((Xt.forecast-Xt.budget)/Xt.budget*100).toFixed(1),"%)"]})]})]})]}),jsxRuntimeExports.jsx
s("div",{className:"budget-table-container",children:[jsxRuntimeExports.jsx("h2",{children:"Budget vs Full Year 
Forecast by Salesperson"}),jsxRuntimeExports.jsxs("table",{className:"budget-table",children:[jsxRuntimeExports.jsx("th
ead",{children:jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("th",{}),jsxRuntimeExports.jsx("th",{childr
en:"Product Line"}),jsxRuntimeExports.jsx("th",{children:"Budget"}),jsxRuntimeExports.jsx("th",{children:"Full Year For
ecast"}),jsxRuntimeExports.jsx("th",{children:"Variance"})]})}),jsxRuntimeExports.jsx("tbody",{children:$.map(Dt=>{cons
t Ht=vt.find(xs=>xs.userId===Dt.id)||{productData:{},totalBudget:0,totalForecast:0},Qt=[...new 
Set([...Yt,...Object.keys(Ht.productData)])].filter(xs=>{const Cs=Ht.productData[xs]||{},gs=gt(Dt.id,xs);return 
Cs.budget>0||Cs.forecast>0||gs});if(Qt.length===0&&Ht.totalBudget===0&&Ht.totalForecast===0)return null;const 
Ft=Ht.totalForecast-Ht.totalBudget;return jsxRuntimeExports.jsxs(React.Fragment,{children:[jsxRuntimeExports.jsx("tr",{
className:"salesperson-header-row",children:jsxRuntimeExports.jsx("td",{colSpan:"5",className:"salesperson-header-cell"
,children:jsxRuntimeExports.jsx("strong",{children:Dt.displayName||Dt.email||"Unknown"})})}),Qt.map(xs=>{const 
Cs=Ht.productData[xs]||{budget:0,forecast:0},gs=Cs.forecast-Cs.budget;return jsxRuntimeExports.jsxs("tr",{children:[jsx
RuntimeExports.jsx("td",{}),jsxRuntimeExports.jsx("td",{children:xs}),jsxRuntimeExports.jsx("td",{className:"amount-cel
l",children:ss(Cs.budget)}),jsxRuntimeExports.jsx("td",{className:"amount-cell",children:ss(Cs.forecast)}),jsxRuntimeEx
ports.jsx("td",{className:`amount-cell variance ${Et(gs)}`,children:ss(gs)})]},`${Dt.id}-${xs}`)}),jsxRuntimeExports.js
xs("tr",{className:"salesperson-total-row",children:[jsxRuntimeExports.jsx("td",{}),jsxRuntimeExports.jsx("td",{classNa
me:"total-label",children:jsxRuntimeExports.jsx("strong",{children:"Total"})}),jsxRuntimeExports.jsx("td",{className:"a
mount-cell total-cell",children:ss(Ht.totalBudget)}),jsxRuntimeExports.jsx("td",{className:"amount-cell 
total-cell",children:ss(Ht.totalForecast)}),jsxRuntimeExports.jsx("td",{className:`amount-cell total-cell variance ${Et
(Ft)}`,children:ss(Ft)})]})]},Dt.id)}).filter(Boolean)})]}),vt.length===0&&tt.length===0&&jsxRuntimeExports.jsxs("div",
{className:"empty-state",children:[jsxRuntimeExports.jsxs("p",{children:["No budgets have been set for 
",wt,"."]}),jsxRuntimeExports.jsx("button",{className:"primary-btn",onClick:Wt,children:"Set Your First Budget"})]})]})
,jsxRuntimeExports.jsxs("div",{className:"quick-budget-section",children:[jsxRuntimeExports.jsxs("div",{className:"sect
ion-header",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{children:"Budget Entry by 
Salesperson"}),jsxRuntimeExports.jsx("p",{className:"section-description",children:ct?"Enter budget amounts for each 
salesperson and product line. Click Save when done.":'Click "Edit Budgets" to modify budget amounts.'})]}),jsxRuntimeEx
ports.jsx("div",{className:"section-actions",children:ct?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[j
sxRuntimeExports.jsx("button",{className:"cancel-btn",onClick:ms,disabled:Es,children:"Cancel"}),jsxRuntimeExports.jsx(
"button",{className:"save-btn",onClick:Pt,disabled:Es,children:Es?"Saving...":"Save 
All"})]}):jsxRuntimeExports.jsx("button",{className:"edit-all-btn",onClick:Wt,children:"Edit Budgets"})})]}),jsxRuntime
Exports.jsx("div",{className:"quick-budget-grid",children:jsxRuntimeExports.jsxs("table",{className:"quick-budget-table
",children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("th",{
children:"Salesperson"}),Yt.map(Dt=>jsxRuntimeExports.jsx("th",{children:Dt},Dt)),jsxRuntimeExports.jsx("th",{children:
"Total"})]})}),jsxRuntimeExports.jsx("tbody",{children:$.map(Dt=>{const Ht=ct?$t(Dt.id):Yt.reduce((os,Qt)=>{const 
Ft=gt(Dt.id,Qt);return os+((Ft==null?void 0:Ft.budgetAmount)||0)},0);return jsxRuntimeExports.jsxs("tr",{children:[jsxR
untimeExports.jsx("td",{className:"user-name",children:Dt.displayName||Dt.email||"Unknown"}),Yt.map(os=>{var 
Qt;if(ct)return jsxRuntimeExports.jsx("td",{className:"budget-cell 
editing",children:jsxRuntimeExports.jsx("input",{type:"text",inputMode:"numeric",value:((Qt=fs[Dt.id])==null?void 0:Qt[
os])||"",onChange:Ft=>ft(Dt.id,os,Ft.target.value),onBlur:()=>zt(Dt.id,os),onFocus:()=>Ct(Dt.id,os),className:"budget-i
nput",placeholder:"0"})},os);{const Ft=gt(Dt.id,os),xs=(Ft==null?void 0:Ft.budgetAmount)||0;return 
jsxRuntimeExports.jsx("td",{className:`budget-cell ${Ft?"has-budget":"no-budget"}`,children:xs>0?ss(xs):"-"},os)}}),jsx
RuntimeExports.jsx("td",{className:"total-cell",children:ss(Ht)})]},Dt.id)})}),ct&&jsxRuntimeExports.jsx("tfoot",{child
ren:jsxRuntimeExports.jsxs("tr",{className:"totals-row",children:[jsxRuntimeExports.jsx("td",{children:jsxRuntimeExport
s.jsx("strong",{children:"Total"})}),Yt.map(Dt=>jsxRuntimeExports.jsx("td",{className:"column-total",children:ss(Bt(Dt)
)},Dt)),jsxRuntimeExports.jsx("td",{className:"grand-total",children:jsxRuntimeExports.jsx("strong",{children:ss(Lt())}
)})]})})]})})]})]}):jsxRuntimeExports.jsxs("div",{className:"budget-management",children:[jsxRuntimeExports.jsx("h1",{c
hildren:"Budget Management"}),jsxRuntimeExports.jsx("div",{className:"error-message",children:Rt})]})},PipelineStatusMa
nagement=()=>{const[s,e]=reactExports.useState([]),[i,a]=reactExports.useState(!0),[o,c]=reactExports.useState(!1),[d,h
]=reactExports.useState(null),[j,_]=reactExports.useState({name:"",color:"#e3f2fd",isWon:!1,isLost:!1}),[$,rt]=reactExp
orts.useState(!1),[tt,mt]=reactExports.useState({name:"",color:"#e3f2fd",isWon:!1,isLost:!1});reactExports.useEffect(()
=>{vt()},[]);const vt=async()=>{try{const st=await getPipelineStatuses();e(st),a(!1)}catch(st){console.error("Error 
loading pipeline statuses:",st),a(!1)}},_t=st=>st.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,""),wt=async(
)=>{if(!tt.name.trim()){alert("Please enter a status name");return}const 
st=_t(tt.name);if(s.some(xt=>xt.id===st)){alert("A status with this name already exists");return}const it=Math.max(...s
.map(xt=>xt.order),0),nt={id:st,name:tt.name.trim(),color:tt.color,order:it+1,isWon:tt.isWon,isLost:tt.isLost},ct=[...s
,nt];await Rt(ct),mt({name:"",color:"#e3f2fd",isWon:!1,isLost:!1}),rt(!1)},ht=st=>{h(st.id),_({name:st.name,color:st.co
lor,isWon:st.isWon||!1,isLost:st.isLost||!1})},dt=async st=>{if(!j.name.trim()){alert("Please enter a status 
name");return}const 
it=s.map(nt=>nt.id===st?{...nt,name:j.name.trim(),color:j.color,isWon:j.isWon,isLost:j.isLost}:nt);await 
Rt(it),h(null)},jt=async st=>{const it=s.find(ct=>ct.id===st);if(it.isWon||it.isLost){alert("Cannot delete Won or Lost 
status. These are required for the pipeline to function correctly.");return}if(!confirm(`Are you sure you want to 
delete "${it.name}"? Clients with this status will retain their status value but it will no longer appear in the 
dropdown.`))return;const nt=s.filter(ct=>ct.id!==st);await Rt(nt)},bt=async st=>{if(st===0)return;const 
it=[...s],nt=it[st].order;it[st].order=it[st-1].order,it[st-1].order=nt;const 
ct=it[st];it[st]=it[st-1],it[st-1]=ct,await Rt(it)},ut=async st=>{if(st===s.length-1)return;const 
it=[...s],nt=it[st].order;it[st].order=it[st+1].order,it[st+1].order=nt;const 
ct=it[st];it[st]=it[st+1],it[st+1]=ct,await Rt(it)},Rt=async st=>{c(!0);try{await 
savePipelineStatuses(st),e(st.sort((it,nt)=>it.order-nt.order))}catch(it){console.error("Error saving 
statuses:",it),alert("Failed to save changes. Please try again.")}c(!1)};return i?jsxRuntimeExports.jsxs("div",{classNa
me:"pipeline-status-management",children:[jsxRuntimeExports.jsx("h1",{children:"Pipeline Status Management"}),jsxRuntim
eExports.jsx("p",{children:"Loading..."})]}):jsxRuntimeExports.jsxs("div",{className:"pipeline-status-management",child
ren:[jsxRuntimeExports.jsxs("div",{className:"page-header",children:[jsxRuntimeExports.jsx("h1",{children:"Pipeline 
Status Management"}),jsxRuntimeExports.jsx("p",{className:"page-description",children:"Configure the sales pipeline 
stages. Drag to reorder or use the arrows to change the display order."})]}),jsxRuntimeExports.jsxs("div",{className:"s
tatus-list-container",children:[jsxRuntimeExports.jsxs("div",{className:"status-list-header",children:[jsxRuntimeExport
s.jsx("h2",{children:"Pipeline 
Stages"}),jsxRuntimeExports.jsx("button",{className:"add-status-btn",onClick:()=>rt(!$),children:"+ Add New Status"})]}
),$&&jsxRuntimeExports.jsxs("div",{className:"add-status-form",children:[jsxRuntimeExports.jsxs("div",{className:"form-
row",children:[jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"
Status Name *"}),jsxRuntimeExports.jsx("input",{type:"text",value:tt.name,onChange:st=>mt({...tt,name:st.target.value})
,placeholder:"e.g., Demo Scheduled"})]}),jsxRuntimeExports.jsxs("div",{className:"form-group color-picker-group",childr
en:[jsxRuntimeExports.jsx("label",{children:"Color"}),jsxRuntimeExports.jsxs("div",{className:"color-picker-wrapper",ch
ildren:[jsxRuntimeExports.jsx("input",{type:"color",value:tt.color,onChange:st=>mt({...tt,color:st.target.value})}),jsx
RuntimeExports.jsx("span",{className:"color-preview",style:{backgroundColor:tt.color}})]})]})]}),jsxRuntimeExports.jsxs
("div",{className:"form-row checkbox-row",children:[jsxRuntimeExports.jsxs("label",{className:"checkbox-label",children
:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:tt.isWon,onChange:st=>mt({...tt,isWon:st.target.checked,isLost
:!1})}),'This is a "Won" status (deal closed successfully)']}),jsxRuntimeExports.jsxs("label",{className:"checkbox-labe
l",children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:tt.isLost,onChange:st=>mt({...tt,isLost:st.target.c
hecked,isWon:!1})}),'This is a "Lost" status (deal did not close)']})]}),jsxRuntimeExports.jsxs("div",{className:"form-
actions",children:[jsxRuntimeExports.jsx("button",{className:"cancel-btn",onClick:()=>rt(!1),children:"Cancel"}),jsxRun
timeExports.jsx("button",{className:"save-btn",onClick:wt,disabled:o,children:o?"Adding...":"Add Status"})]})]}),jsxRun
timeExports.jsx("div",{className:"status-list",children:s.map((st,it)=>jsxRuntimeExports.jsx("div",{className:"status-i
tem",style:{borderLeftColor:st.color},children:d===st.id?jsxRuntimeExports.jsxs("div",{className:"edit-form",children:[
jsxRuntimeExports.jsxs("div",{className:"form-row",children:[jsxRuntimeExports.jsx("div",{className:"form-group",childr
en:jsxRuntimeExports.jsx("input",{type:"text",value:j.name,onChange:nt=>_({...j,name:nt.target.value}),placeholder:"Sta
tus name"})}),jsxRuntimeExports.jsx("div",{className:"form-group color-picker-group",children:jsxRuntimeExports.jsxs("d
iv",{className:"color-picker-wrapper",children:[jsxRuntimeExports.jsx("input",{type:"color",value:j.color,onChange:nt=>
_({...j,color:nt.target.value})}),jsxRuntimeExports.jsx("span",{className:"color-preview",style:{backgroundColor:j.colo
r}})]})})]}),jsxRuntimeExports.jsxs("div",{className:"form-row checkbox-row",children:[jsxRuntimeExports.jsxs("label",{
className:"checkbox-label",children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:j.isWon,onChange:nt=>_({...
j,isWon:nt.target.checked,isLost:!1})}),"Won status"]}),jsxRuntimeExports.jsxs("label",{className:"checkbox-label",chil
dren:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:j.isLost,onChange:nt=>_({...j,isLost:nt.target.checked,isW
on:!1})}),"Lost status"]})]}),jsxRuntimeExports.jsxs("div",{className:"edit-actions",children:[jsxRuntimeExports.jsx("b
utton",{className:"cancel-btn",onClick:()=>h(null),children:"Cancel"}),jsxRuntimeExports.jsx("button",{className:"save-
btn",onClick:()=>dt(st.id),disabled:o,children:o?"Saving...":"Save"})]})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fr
agment,{children:[jsxRuntimeExports.jsxs("div",{className:"status-info",children:[jsxRuntimeExports.jsx("div",{classNam
e:"status-order",children:it+1}),jsxRuntimeExports.jsx("div",{className:"status-color-badge",style:{backgroundColor:st.
color}}),jsxRuntimeExports.jsxs("div",{className:"status-name",children:[st.name,st.isWon&&jsxRuntimeExports.jsx("span"
,{className:"status-tag won",children:"Won"}),st.isLost&&jsxRuntimeExports.jsx("span",{className:"status-tag lost",chil
dren:"Lost"})]}),jsxRuntimeExports.jsx("div",{className:"status-id",children:st.id})]}),jsxRuntimeExports.jsxs("div",{c
lassName:"status-actions",children:[jsxRuntimeExports.jsx("button",{className:"order-btn",onClick:()=>bt(it),disabled:i
t===0||o,title:"Move Up",children:"â†‘"}),jsxRuntimeExports.jsx("button",{className:"order-btn",onClick:()=>ut(it),disa
bled:it===s.length-1||o,title:"Move Down",children:"â†“"}),jsxRuntimeExports.jsx("button",{className:"edit-btn",onClick
:()=>ht(st),disabled:o,children:"Edit"}),jsxRuntimeExports.jsx("button",{className:"delete-btn",onClick:()=>jt(st.id),d
isabled:o||st.isWon||st.isLost,title:st.isWon||st.isLost?"Cannot delete Won/Lost status":"Delete",children:"Delete"})]}
)]})},st.id))}),jsxRuntimeExports.jsxs("div",{className:"info-section",children:[jsxRuntimeExports.jsx("h3",{children:"
Information"}),jsxRuntimeExports.jsxs("ul",{children:[jsxRuntimeExports.jsx("li",{children:"Pipeline statuses define 
the stages a client goes through in your sales process."}),jsxRuntimeExports.jsx("li",{children:"The order shown here 
is the order they will appear in dropdown menus."}),jsxRuntimeExports.jsx("li",{children:'You must have at least one 
"Won" and one "Lost" status for reporting to work correctly.'}),jsxRuntimeExports.jsx("li",{children:"Deleting a 
status will not change clients already in that status, but the status will no longer be available for selection."})]})]
})]})]})},LegalDocumentManagement=()=>{const[s,e]=reactExports.useState([]),[i,a]=reactExports.useState(!0),[o,c]=react
Exports.useState(!1),[d,h]=reactExports.useState(null),[j,_]=reactExports.useState({label:"",required:!1}),[$,rt]=react
Exports.useState(!1),[tt,mt]=reactExports.useState({label:"",required:!1});reactExports.useEffect(()=>{vt()},[]);const 
vt=async()=>{try{const st=await getLegalDocumentTypes();e(st),a(!1)}catch(st){console.error("Error loading legal 
document types:",st),a(!1)}},_t=st=>st.toLowerCase().replace(/\s+/g,"").replace(/[^a-z0-9]/g,""),wt=async()=>{if(!tt.la
bel.trim()){alert("Please enter a document name");return}const st=_t(tt.label);if(s.some(xt=>xt.key===st)){alert("A 
document with this name already exists");return}const it=Math.max(...s.map(xt=>xt.order||0),0),nt={key:st,label:tt.labe
l.trim(),required:tt.required,order:it+1},ct=[...s,nt];await 
Rt(ct),mt({label:"",required:!1}),rt(!1)},ht=st=>{h(st.key),_({label:st.label,required:st.required||!1})},dt=async 
st=>{if(!j.label.trim()){alert("Please enter a document name");return}const 
it=s.map(nt=>nt.key===st?{...nt,label:j.label.trim(),required:j.required}:nt);await Rt(it),h(null)},jt=async 
st=>{const it=s.find(ct=>ct.key===st);if(!confirm(`Are you sure you want to delete "${it.label}"? This will remove it 
from the checklist for all clients.`))return;const nt=s.filter(ct=>ct.key!==st);await Rt(nt)},bt=async 
st=>{if(st===0)return;const it=[...s],nt=it[st].order;it[st].order=it[st-1].order,it[st-1].order=nt;const 
ct=it[st];it[st]=it[st-1],it[st-1]=ct,await Rt(it)},ut=async st=>{if(st===s.length-1)return;const 
it=[...s],nt=it[st].order;it[st].order=it[st+1].order,it[st+1].order=nt;const 
ct=it[st];it[st]=it[st+1],it[st+1]=ct,await Rt(it)},Rt=async st=>{c(!0);try{await 
saveLegalDocumentTypes(st),e(st.sort((it,nt)=>(it.order||0)-(nt.order||0)))}catch(it){console.error("Error saving 
document types:",it),alert("Failed to save changes. Please try again.")}c(!1)};return i?jsxRuntimeExports.jsxs("div",{c
lassName:"legal-document-management",children:[jsxRuntimeExports.jsx("h1",{children:"Legal Document Checklist Managemen
t"}),jsxRuntimeExports.jsx("p",{children:"Loading..."})]}):jsxRuntimeExports.jsxs("div",{className:"legal-document-mana
gement",children:[jsxRuntimeExports.jsxs("div",{className:"page-header",children:[jsxRuntimeExports.jsx("h1",{children:
"Legal Document Checklist"}),jsxRuntimeExports.jsx("p",{className:"page-description",children:"Configure the legal 
documents that salespeople must check off for each client. Required documents will be highlighted in the client's 
Legal tab."})]}),jsxRuntimeExports.jsxs("div",{className:"document-list-container",children:[jsxRuntimeExports.jsxs("di
v",{className:"document-list-header",children:[jsxRuntimeExports.jsx("h2",{children:"Document 
Types"}),jsxRuntimeExports.jsx("button",{className:"add-document-btn",onClick:()=>rt(!$),children:"+ Add New Document"}
)]}),$&&jsxRuntimeExports.jsxs("div",{className:"add-document-form",children:[jsxRuntimeExports.jsx("div",{className:"f
orm-row",children:jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{childre
n:"Document Name *"}),jsxRuntimeExports.jsx("input",{type:"text",value:tt.label,onChange:st=>mt({...tt,label:st.target.
value}),placeholder:"e.g., NDA Signed"})]})}),jsxRuntimeExports.jsx("div",{className:"form-row checkbox-row",children:j
sxRuntimeExports.jsxs("label",{className:"checkbox-label",children:[jsxRuntimeExports.jsx("input",{type:"checkbox",chec
ked:tt.required,onChange:st=>mt({...tt,required:st.target.checked})}),"Required document (must be checked before 
client can be marked as complete)"]})}),jsxRuntimeExports.jsxs("div",{className:"form-actions",children:[jsxRuntimeExpo
rts.jsx("button",{className:"cancel-btn",onClick:()=>rt(!1),children:"Cancel"}),jsxRuntimeExports.jsx("button",{classNa
me:"save-btn",onClick:wt,disabled:o,children:o?"Adding...":"Add Document"})]})]}),jsxRuntimeExports.jsx("div",{classNam
e:"document-list",children:s.map((st,it)=>jsxRuntimeExports.jsx("div",{className:`document-item ${st.required?"required
":""}`,children:d===st.key?jsxRuntimeExports.jsxs("div",{className:"edit-form",children:[jsxRuntimeExports.jsx("div",{c
lassName:"form-row",children:jsxRuntimeExports.jsx("div",{className:"form-group",children:jsxRuntimeExports.jsx("input"
,{type:"text",value:j.label,onChange:nt=>_({...j,label:nt.target.value}),placeholder:"Document 
name"})})}),jsxRuntimeExports.jsx("div",{className:"form-row checkbox-row",children:jsxRuntimeExports.jsxs("label",{cla
ssName:"checkbox-label",children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:j.required,onChange:nt=>_({...
j,required:nt.target.checked})}),"Required document"]})}),jsxRuntimeExports.jsxs("div",{className:"edit-actions",childr
en:[jsxRuntimeExports.jsx("button",{className:"cancel-btn",onClick:()=>h(null),children:"Cancel"}),jsxRuntimeExports.js
x("button",{className:"save-btn",onClick:()=>dt(st.key),disabled:o,children:o?"Saving...":"Save"})]})]}):jsxRuntimeExpo
rts.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"document-info",children:[jsxRun
timeExports.jsx("div",{className:"document-order",children:it+1}),jsxRuntimeExports.jsx("div",{className:"document-icon
",children:st.required?"!":""}),jsxRuntimeExports.jsxs("div",{className:"document-name",children:[st.label,st.required&
&jsxRuntimeExports.jsx("span",{className:"required-tag",children:"Required"})]}),jsxRuntimeExports.jsx("div",{className
:"document-key",children:st.key})]}),jsxRuntimeExports.jsxs("div",{className:"document-actions",children:[jsxRuntimeExp
orts.jsx("button",{className:"order-btn",onClick:()=>bt(it),disabled:it===0||o,title:"Move Up",children:"â†‘"}),jsxRunt
imeExports.jsx("button",{className:"order-btn",onClick:()=>ut(it),disabled:it===s.length-1||o,title:"Move Down",childre
n:"â†“"}),jsxRuntimeExports.jsx("button",{className:"edit-btn",onClick:()=>ht(st),disabled:o,children:"Edit"}),jsxRunti
meExports.jsx("button",{className:"delete-btn",onClick:()=>jt(st.key),disabled:o,children:"Delete"})]})]})},st.key))}),
s.length===0&&jsxRuntimeExports.jsx("div",{className:"empty-state",children:jsxRuntimeExports.jsx("p",{children:"No 
document types configured yet. Add your first document to get started."})}),jsxRuntimeExports.jsxs("div",{className:"in
fo-section",children:[jsxRuntimeExports.jsx("h3",{children:"Information"}),jsxRuntimeExports.jsxs("ul",{children:[jsxRu
ntimeExports.jsx("li",{children:"These document types will appear as a checklist in each client's Legal Documents 
tab."}),jsxRuntimeExports.jsx("li",{children:"Salespeople can check off documents as they receive them from the 
client."}),jsxRuntimeExports.jsxs("li",{children:[jsxRuntimeExports.jsx("strong",{children:"Required"})," documents 
will be highlighted to indicate they must be obtained."]}),jsxRuntimeExports.jsx("li",{children:"The order shown here 
is the order they will appear in the checklist."}),jsxRuntimeExports.jsx("li",{children:"Deleting a document type will 
not remove existing check marks from clients."})]})]})]})]})},TenantManagement=()=>{const[s,e]=reactExports.useState([]
),[i,a]=reactExports.useState(!0),[o,c]=reactExports.useState(!1),[d,h]=reactExports.useState(null),[j,_]=reactExports.
useState(!1),[$,rt]=reactExports.useState(!1),[tt,mt]=reactExports.useState({}),[vt,_t]=reactExports.useState({name:"",
description:"",currencySymbol:"R",financialYearStart:"March",financialYearEnd:"February"});reactExports.useEffect(()=>{
wt()},[]);const wt=async()=>{try{a(!0);const it=await getTenants();e(it);const nt=it.map(async yt=>{const Tt=await 
getTenantStats(yt.id);return{tenantId:yt.id,...Tt}}),ct=await 
Promise.all(nt),xt={};ct.forEach(yt=>{xt[yt.tenantId]=yt}),mt(xt)}catch(it){console.error("Error loading 
tenants:",it)}finally{a(!1)}},ht=async()=>{if(!vt.name.trim()){alert("Please enter a tenant 
name");return}_(!0);try{await createTenant({name:vt.name.trim(),description:vt.description.trim(),currencySymbol:vt.cur
rencySymbol,financialYearStart:vt.financialYearStart,financialYearEnd:vt.financialYearEnd}),_t({name:"",description:"",
currencySymbol:"R",financialYearStart:"March",financialYearEnd:"February"}),c(!1),await wt()}catch(it){alert("Error 
creating tenant: "+it.message)}finally{_(!1)}},dt=async()=>{if(!vt.name.trim()){alert("Please enter a tenant 
name");return}_(!0);try{await updateTenant(d.id,{name:vt.name.trim(),description:vt.description.trim(),settings:{curren
cySymbol:vt.currencySymbol,financialYearStart:vt.financialYearStart,financialYearEnd:vt.financialYearEnd}}),h(null),_t(
{name:"",description:"",currencySymbol:"R",financialYearStart:"March",financialYearEnd:"February"}),await 
wt()}catch(it){alert("Error updating tenant: "+it.message)}finally{_(!1)}},jt=async it=>{const 
nt=tt[it.id]||{};if(nt.userCount>0||nt.clientCount>0){alert(`Cannot delete tenant with ${nt.userCount} users and 
${nt.clientCount} clients. Please remove all data first.`);return}if(confirm(`Are you sure you want to delete the 
tenant "${it.name}"? This action cannot be undone.`))try{await deleteTenant(it.id),await wt()}catch(ct){alert("Error 
deleting tenant: "+ct.message)}},bt=it=>{var 
nt,ct,xt;h(it),_t({name:it.name,description:it.description||"",currencySymbol:((nt=it.settings)==null?void 
0:nt.currencySymbol)||"R",financialYearStart:((ct=it.settings)==null?void 
0:ct.financialYearStart)||"March",financialYearEnd:((xt=it.settings)==null?void 0:xt.financialYearEnd)||"February"}),c(
!1)},ut=()=>{h(null),c(!1),_t({name:"",description:"",currencySymbol:"R",financialYearStart:"March",financialYearEnd:"F
ebruary"})},Rt=async()=>{if(confirm("This will create the Speccon tenant and migrate all existing data. 
Continue?")){rt(!0);try{await initializeSpecconTenant(),await migrateDataToTenant("speccon"),alert("Speccon tenant 
initialized and data migrated successfully!"),await wt()}catch(it){alert("Error initializing Speccon tenant: "+it.messa
ge)}finally{rt(!1)}}},st=["January","February","March","April","May","June","July","August","September","October","Nove
mber","December"];return 
i?jsxRuntimeExports.jsxs("div",{className:"tenant-management",children:[jsxRuntimeExports.jsx("h1",{children:"Tenant Ma
nagement"}),jsxRuntimeExports.jsx("p",{children:"Loading..."})]}):jsxRuntimeExports.jsxs("div",{className:"tenant-manag
ement",children:[jsxRuntimeExports.jsxs("div",{className:"page-header",children:[jsxRuntimeExports.jsx("h1",{children:"
Tenant Management"}),jsxRuntimeExports.jsx("p",{className:"page-description",children:"Manage tenants (organizations) 
in the system. Each tenant has isolated data."})]}),s.length===0&&jsxRuntimeExports.jsxs("div",{className:"no-tenants-w
arning",children:[jsxRuntimeExports.jsx("h3",{children:"No Tenants 
Configured"}),jsxRuntimeExports.jsx("p",{children:"The system does not have any tenants configured yet. Click the 
button below to initialize the Speccon tenant and migrate all existing data."}),jsxRuntimeExports.jsx("button",{classNa
me:"init-btn",onClick:Rt,disabled:$,children:$?"Initializing...":"Initialize Speccon Tenant & Migrate Data"})]}),jsxRun
timeExports.jsxs("div",{className:"tenant-list-container",children:[jsxRuntimeExports.jsxs("div",{className:"tenant-lis
t-header",children:[jsxRuntimeExports.jsxs("h2",{children:["Tenants (",s.length,")"]}),jsxRuntimeExports.jsx("button",{
className:"add-tenant-btn",onClick:()=>{c(!0),h(null),_t({name:"",description:"",currencySymbol:"R",financialYearStart:
"March",financialYearEnd:"February"})},children:"+ Add New Tenant"})]}),(o||d)&&jsxRuntimeExports.jsxs("div",{className
:"tenant-form",children:[jsxRuntimeExports.jsx("h3",{children:d?"Edit Tenant":"Create New Tenant"}),jsxRuntimeExports.j
sx("div",{className:"form-row",children:jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExport
s.jsx("label",{children:"Tenant Name *"}),jsxRuntimeExports.jsx("input",{type:"text",value:vt.name,onChange:it=>_t({...
vt,name:it.target.value}),placeholder:"e.g., Acme Corporation"})]})}),jsxRuntimeExports.jsx("div",{className:"form-row"
,children:jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Descr
iption"}),jsxRuntimeExports.jsx("textarea",{value:vt.description,onChange:it=>_t({...vt,description:it.target.value}),p
laceholder:"Brief description of the tenant",rows:3})]})}),jsxRuntimeExports.jsxs("div",{className:"form-row",children:
[jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Currency Symbo
l"}),jsxRuntimeExports.jsx("input",{type:"text",value:vt.currencySymbol,onChange:it=>_t({...vt,currencySymbol:it.target
.value}),placeholder:"R",maxLength:5})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExpo
rts.jsx("label",{children:"Financial Year Start"}),jsxRuntimeExports.jsx("select",{value:vt.financialYearStart,onChange
:it=>_t({...vt,financialYearStart:it.target.value}),children:st.map(it=>jsxRuntimeExports.jsx("option",{value:it,childr
en:it},it))})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children
:"Financial Year End"}),jsxRuntimeExports.jsx("select",{value:vt.financialYearEnd,onChange:it=>_t({...vt,financialYearE
nd:it.target.value}),children:st.map(it=>jsxRuntimeExports.jsx("option",{value:it,children:it},it))})]})]}),jsxRuntimeE
xports.jsxs("div",{className:"form-actions",children:[jsxRuntimeExports.jsx("button",{className:"cancel-btn",onClick:ut
,children:"Cancel"}),jsxRuntimeExports.jsx("button",{className:"save-btn",onClick:d?dt:ht,disabled:j,children:j?"Saving
...":d?"Update Tenant":"Create 
Tenant"})]})]}),jsxRuntimeExports.jsx("div",{className:"tenant-list",children:s.map(it=>{var ct,xt,yt;const 
nt=tt[it.id]||{};return jsxRuntimeExports.jsxs("div",{className:"tenant-card",children:[jsxRuntimeExports.jsxs("div",{c
lassName:"tenant-info",children:[jsxRuntimeExports.jsxs("div",{className:"tenant-header",children:[jsxRuntimeExports.js
x("h3",{children:it.name}),jsxRuntimeExports.jsx("span",{className:`tenant-status ${it.status||"active"}`,children:it.s
tatus||"Active"})]}),it.description&&jsxRuntimeExports.jsx("p",{className:"tenant-description",children:it.description}
),jsxRuntimeExports.jsxs("div",{className:"tenant-id",children:["ID: ",it.id]}),jsxRuntimeExports.jsxs("div",{className
:"tenant-stats",children:[jsxRuntimeExports.jsxs("span",{className:"stat",children:[jsxRuntimeExports.jsx("strong",{chi
ldren:nt.userCount||0})," Users"]}),jsxRuntimeExports.jsxs("span",{className:"stat",children:[jsxRuntimeExports.jsx("st
rong",{children:nt.clientCount||0})," Clients"]})]}),jsxRuntimeExports.jsxs("div",{className:"tenant-settings",children
:[jsxRuntimeExports.jsxs("span",{children:["Currency: ",((ct=it.settings)==null?void 
0:ct.currencySymbol)||"R"]}),jsxRuntimeExports.jsxs("span",{children:["FY: ",((xt=it.settings)==null?void 
0:xt.financialYearStart)||"March"," - ",((yt=it.settings)==null?void 0:yt.financialYearEnd)||"February"]})]})]}),jsxRun
timeExports.jsxs("div",{className:"tenant-actions",children:[jsxRuntimeExports.jsx(Link,{to:`/tenants/${it.id}/users`,c
lassName:"view-users-btn",children:"Manage Users"}),jsxRuntimeExports.jsx("button",{className:"edit-btn",onClick:()=>bt
(it),children:"Edit"}),jsxRuntimeExports.jsx("button",{className:"delete-btn",onClick:()=>jt(it),disabled:nt.userCount>
0||nt.clientCount>0,title:nt.userCount>0||nt.clientCount>0?"Cannot delete tenant with users or clients":"Delete tenant"
,children:"Delete"})]})]},it.id)})}),s.length===0&&!o&&jsxRuntimeExports.jsx("div",{className:"empty-state",children:js
xRuntimeExports.jsx("p",{children:"No tenants found. Create your first tenant to get started."})})]}),jsxRuntimeExports
.jsxs("div",{className:"info-section",children:[jsxRuntimeExports.jsx("h3",{children:"About 
Multi-Tenancy"}),jsxRuntimeExports.jsxs("ul",{children:[jsxRuntimeExports.jsx("li",{children:"Each tenant is a 
separate organization with isolated data."}),jsxRuntimeExports.jsx("li",{children:"Users belong to one tenant and can 
only see that tenant's data."}),jsxRuntimeExports.jsx("li",{children:"System admins can manage all tenants and switch 
between them."}),jsxRuntimeExports.jsx("li",{children:"Tenant settings (currency, financial year) apply to all users 
in that tenant."})]})]})]})},TenantUsers=()=>{const{tenantId:s}=useParams(),e=useNavigate(),{currentUser:i}=useTenant()
,[a,o]=reactExports.useState(null),[c,d]=reactExports.useState([]),[h,j]=reactExports.useState([]),[_,$]=reactExports.u
seState([]),[rt,tt]=reactExports.useState(!0),[mt,vt]=reactExports.useState(!1),[_t,wt]=reactExports.useState(!1),[ht,d
t]=reactExports.useState(!1),[jt,bt]=reactExports.useState(""),[ut,Rt]=reactExports.useState("salesperson"),[st,it]=rea
ctExports.useState(!1),[nt,ct]=reactExports.useState({email:"",displayName:"",password:"",confirmPassword:"",role:"sale
sperson"}),[xt,yt]=reactExports.useState([]),[Tt,fs]=reactExports.useState([]),[cs,Es]=reactExports.useState(""),[ls,Yt
]=reactExports.useState({current:0,total:0,results:[]}),[Mt,Gt]=reactExports.useState(!1),Wt=reactExports.useRef(null);
reactExports.useEffect(()=>{ms()},[s]);const ms=async()=>{try{tt(!0);const[Bt,Lt,Xt,Dt]=await Promise.all([getTenant(s)
,getTenantUsers(s),getUsers$1(),getRoles()]);if(!Bt){e("/tenants");return}o(Bt),d(Lt),j(Xt),$(Dt.filter(Ht=>!Ht.deleted
))}catch(Bt){console.error("Error loading 
data:",Bt)}finally{tt(!1)}},ss=h.filter(Bt=>!Bt.tenantId||Bt.tenantId!==s),ys=async()=>{if(!jt){alert("Please select a 
user");return}it(!0);try{await assignUserToTenant(jt,s,ut),vt(!1),bt(""),Rt("salesperson"),await 
ms()}catch(Bt){alert("Error adding user: "+Bt.message)}finally{it(!1)}},Et=async(Bt,Lt)=>{if(confirm(`Remove "${Lt}" 
from this tenant? They will lose access to all tenant data.`))try{await removeUserFromTenant(Bt),await 
ms()}catch(Xt){alert("Error removing user: "+Xt.message)}},gt=async(Bt,Lt)=>{try{await 
assignUserToTenant(Bt,s,Lt),await ms()}catch(Xt){alert("Error updating role: "+Xt.message)}},ft=async 
Bt=>{if(Bt.preventDefault(),!nt.email){alert("Email is required");return}if(!nt.password){alert("Password is 
required");return}if(nt.password.length<6){alert("Password must be at least 6 
characters");return}if(nt.password!==nt.confirmPassword){alert("Passwords do not match");return}it(!0);try{await create
UserAccount({email:nt.email,password:nt.password,displayName:nt.displayName,role:nt.role,tenantId:s,isSystemAdmin:!1},i
==null?void 0:i.uid),alert(`User ${nt.email} created successfully! They can now log in with the password you set.`),wt(
!1),ct({email:"",displayName:"",password:"",confirmPassword:"",role:"salesperson"}),ms()}catch(Lt){console.error("Error
 creating user:",Lt),alert(Lt.message||"Failed to create user")}finally{it(!1)}},zt=Bt=>{const 
Lt=Bt.target.files[0];if(!Lt)return;const Xt=new FileReader;Xt.onload=Dt=>{const 
Ht=Dt.target.result;Ct(Ht)},Xt.readAsText(Lt)},Ct=Bt=>{const Lt=Bt.split(`
  `).filter(os=>os.trim()),Xt=[],Dt=[],Ht=Lt[0].toLowerCase().includes("email")?1:0;for(let 
os=Ht;os<Lt.length;os++){const Qt=Lt[os].trim();if(!Qt)continue;const Ft=Qt.split(",").map(js=>js.trim().replace(/^["']
|["']$/g,"")),xs=Ft[0],Cs=Ft[1]||"",gs=Ft[2]||"",Os=Ft[3]||"";if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(xs)){Xt.push(`Row 
${os+1}: Invalid email "${xs}"`);continue}if(gs&&gs.length<6){Xt.push(`Row ${os+1}: Password must be at least 6 
characters for "${xs}"`);continue}if(!Os){Xt.push(`Row ${os+1}: Role is required for "${xs}". Valid roles: 
${_.map(js=>js.id).join(", 
")}`);continue}if(_.length>0&&!_.find(es=>es.id===Os||es.name.toLowerCase()===Os.toLowerCase())){Xt.push(`Row ${os+1}: 
Invalid role "${Os}" for "${xs}". Valid roles: ${_.map(es=>es.id).join(", ")}`);continue}Dt.push({email:xs,displayName:
Cs||xs.split("@")[0],password:gs||"",role:Os||"",row:os+1})}yt(Dt),fs(Xt)},Pt=async()=>{if(xt.length===0){alert("No 
valid users to upload");return}const Bt=xt.filter(Ht=>!Ht.password);if(Bt.length>0&&!cs){alert(`${Bt.length} user(s) 
don't have a password in the CSV. Please set a default password.`);return}if(cs&&cs.length<6){alert("Default password 
must be at least 6 characters");return}Gt(!0),Yt({current:0,total:xt.length,results:[]});const Lt=[];for(let 
Ht=0;Ht<xt.length;Ht++){const os=xt[Ht];Yt(Cs=>({...Cs,current:Ht+1}));const Qt=os.password||cs,Ft=_.find(Cs=>Cs.id===o
s.role||Cs.name.toLowerCase()===os.role.toLowerCase()),xs=Ft?Ft.id:os.role;try{await createUserAccount({email:os.email,
password:Qt,displayName:os.displayName,role:xs,tenantId:s,isSystemAdmin:!1},i==null?void 0:i.uid),Lt.push({email:os.ema
il,success:!0})}catch(Cs){Lt.push({email:os.email,success:!1,error:Cs.message})}}Yt(Ht=>({...Ht,results:Lt})),Gt(!1);co
nst Xt=Lt.filter(Ht=>Ht.success).length,Dt=Lt.filter(Ht=>!Ht.success).length;Dt===0?(alert(`Successfully created ${Xt} 
users!`),$t(),ms()):alert(`Created ${Xt} users. ${Dt} failed. Check the results below.`)},$t=()=>{yt([]),fs([]),Es(""),
Yt({current:0,total:0,results:[]}),dt(!1),Wt.current&&(Wt.current.value="")};return rt?jsxRuntimeExports.jsx("div",{cla
ssName:"tenant-users",children:jsxRuntimeExports.jsx("h1",{children:"Loading..."})}):jsxRuntimeExports.jsxs("div",{clas
sName:"tenant-users",children:[jsxRuntimeExports.jsxs("div",{className:"page-header",children:[jsxRuntimeExports.jsxs("
div",{className:"header-breadcrumb",children:[jsxRuntimeExports.jsx(Link,{to:"/tenants",className:"back-link",children:
"â† Back to Tenants"}),jsxRuntimeExports.jsxs("h1",{children:[a==null?void 0:a.name," - 
Users"]})]}),jsxRuntimeExports.jsx("p",{className:"page-description",children:"Manage users for this tenant. Users can 
only access data within their assigned tenant."})]}),jsxRuntimeExports.jsxs("div",{className:"users-container",children
:[jsxRuntimeExports.jsxs("div",{className:"users-header",children:[jsxRuntimeExports.jsxs("h2",{children:["Tenant 
Users (",c.length,")"]}),jsxRuntimeExports.jsxs("div",{className:"header-buttons",children:[jsxRuntimeExports.jsx("butt
on",{className:"invite-user-btn",onClick:()=>wt(!0),children:"+ Create New 
User"}),jsxRuntimeExports.jsx("button",{className:"csv-upload-btn",onClick:()=>dt(!0),children:"Upload 
CSV"}),jsxRuntimeExports.jsx("button",{className:"add-user-btn",onClick:()=>vt(!0),children:"+ Add Existing User"})]})]
}),mt&&jsxRuntimeExports.jsxs("div",{className:"add-user-form",children:[jsxRuntimeExports.jsx("h3",{children:"Add 
User to Tenant"}),ss.length===0?jsxRuntimeExports.jsx("p",{className:"no-users-message",children:"All users are 
already assigned to tenants. Create new users in Firebase Authentication first."}):jsxRuntimeExports.jsxs(jsxRuntimeExp
orts.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"form-row",children:[jsxRuntimeExports.jsxs("div",{cla
ssName:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Select User"}),jsxRuntimeExports.jsxs("select",{
value:jt,onChange:Bt=>bt(Bt.target.value),children:[jsxRuntimeExports.jsx("option",{value:"",children:"-- Select a 
user --"}),ss.map(Bt=>jsxRuntimeExports.jsxs("option",{value:Bt.id,children:[Bt.displayName||Bt.email," (",Bt.email,")"
]},Bt.id))]})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children
:"Assign Role"}),jsxRuntimeExports.jsx("select",{value:ut,onChange:Bt=>Rt(Bt.target.value),children:_.map(Bt=>jsxRuntim
eExports.jsx("option",{value:Bt.id,children:Bt.name},Bt.id))})]})]}),jsxRuntimeExports.jsxs("div",{className:"form-acti
ons",children:[jsxRuntimeExports.jsx("button",{className:"cancel-btn",onClick:()=>{vt(!1),bt(""),Rt("salesperson")},chi
ldren:"Cancel"}),jsxRuntimeExports.jsx("button",{className:"save-btn",onClick:ys,disabled:st||!jt,children:st?"Adding..
.":"Add User"})]})]})]}),_t&&jsxRuntimeExports.jsxs("div",{className:"invite-user-form",children:[jsxRuntimeExports.jsx
("h3",{children:"Create New User"}),jsxRuntimeExports.jsxs("form",{onSubmit:ft,children:[jsxRuntimeExports.jsxs("div",{
className:"form-row",children:[jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("la
bel",{children:"Email *"}),jsxRuntimeExports.jsx("input",{type:"email",value:nt.email,onChange:Bt=>ct({...nt,email:Bt.t
arget.value}),placeholder:"user@example.com",required:!0})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",chil
dren:[jsxRuntimeExports.jsx("label",{children:"Display Name"}),jsxRuntimeExports.jsx("input",{type:"text",value:nt.disp
layName,onChange:Bt=>ct({...nt,displayName:Bt.target.value}),placeholder:"John Doe"})]})]}),jsxRuntimeExports.jsxs("div
",{className:"form-row",children:[jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx(
"label",{children:"Password *"}),jsxRuntimeExports.jsx("input",{type:"password",value:nt.password,onChange:Bt=>ct({...n
t,password:Bt.target.value}),placeholder:"Minimum 6 characters",required:!0})]}),jsxRuntimeExports.jsxs("div",{classNam
e:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Confirm Password *"}),jsxRuntimeExports.jsx("input",{
type:"password",value:nt.confirmPassword,onChange:Bt=>ct({...nt,confirmPassword:Bt.target.value}),placeholder:"Confirm 
password",required:!0})]})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("lab
el",{children:"Role"}),jsxRuntimeExports.jsx("select",{value:nt.role,onChange:Bt=>ct({...nt,role:Bt.target.value}),chil
dren:_.length===0?jsxRuntimeExports.jsx("option",{value:"salesperson",children:"Salesperson"}):_.map(Bt=>jsxRuntimeExpo
rts.jsx("option",{value:Bt.id,children:Bt.name},Bt.id))})]}),jsxRuntimeExports.jsx("p",{className:"form-hint",children:
"The user will be created immediately and can log in with the email and password you set."}),jsxRuntimeExports.jsxs("di
v",{className:"form-actions",children:[jsxRuntimeExports.jsx("button",{type:"button",className:"cancel-btn",onClick:()=
>{wt(!1),ct({email:"",displayName:"",password:"",confirmPassword:"",role:"salesperson"})},children:"Cancel"}),jsxRuntim
eExports.jsx("button",{type:"submit",className:"save-btn",disabled:st,children:st?"Creating...":"Create User"})]})]})]}
),ht&&jsxRuntimeExports.jsxs("div",{className:"csv-upload-form",children:[jsxRuntimeExports.jsx("h3",{children:"Bulk 
Upload Users via CSV"}),jsxRuntimeExports.jsxs("p",{className:"form-hint",children:["Upload a CSV file with columns: 
",jsxRuntimeExports.jsx("strong",{children:"email"}),", ",jsxRuntimeExports.jsx("strong",{children:"displayName"})," 
(optional), ",jsxRuntimeExports.jsx("strong",{children:"password"})," (optional), 
",jsxRuntimeExports.jsx("strong",{children:"role"}),". If password is not provided in the CSV, the default password 
below will be 
used."]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"CSV F
ile"}),jsxRuntimeExports.jsx("input",{type:"file",accept:".csv",ref:Wt,onChange:zt,className:"file-input"})]}),jsxRunti
meExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Default Password (for 
users without password in 
CSV)"}),jsxRuntimeExports.jsx("input",{type:"password",value:cs,onChange:Bt=>Es(Bt.target.value),placeholder:"Minimum 
6 characters"}),jsxRuntimeExports.jsx("span",{className:"form-field-hint",children:xt.length>0&&`${xt.filter(Bt=>!Bt.pa
ssword).length} of ${xt.length} users will use this password`})]}),Tt.length>0&&jsxRuntimeExports.jsxs("div",{className
:"csv-errors",children:[jsxRuntimeExports.jsx("strong",{children:"Validation Errors:"}),jsxRuntimeExports.jsx("ul",{chi
ldren:Tt.map((Bt,Lt)=>jsxRuntimeExports.jsx("li",{children:Bt},Lt))})]}),xt.length>0&&jsxRuntimeExports.jsxs("div",{cla
ssName:"csv-preview",children:[jsxRuntimeExports.jsxs("h4",{children:["Preview (",xt.length," users to create)"]}),jsxR
untimeExports.jsx("div",{className:"csv-table-wrapper",children:jsxRuntimeExports.jsxs("table",{className:"csv-table",c
hildren:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("th",{chi
ldren:"Row"}),jsxRuntimeExports.jsx("th",{children:"Email"}),jsxRuntimeExports.jsx("th",{children:"Display Name"}),jsxR
untimeExports.jsx("th",{children:"Password"}),jsxRuntimeExports.jsx("th",{children:"Role"}),ls.results.length>0&&jsxRun
timeExports.jsx("th",{children:"Status"})]})}),jsxRuntimeExports.jsx("tbody",{children:xt.map((Bt,Lt)=>{const Xt=ls.res
ults.find(Ht=>Ht.email===Bt.email),Dt=Bt.role?_.find(Ht=>Ht.id===Bt.role||Ht.name.toLowerCase()===Bt.role.toLowerCase()
):null;return jsxRuntimeExports.jsxs("tr",{className:Xt?Xt.success?"success-row":"error-row":"",children:[jsxRuntimeExp
orts.jsx("td",{children:Bt.row}),jsxRuntimeExports.jsx("td",{children:Bt.email}),jsxRuntimeExports.jsx("td",{children:B
t.displayName}),jsxRuntimeExports.jsx("td",{children:Bt.password?jsxRuntimeExports.jsx("span",{className:"password-set"
,children:"Set in CSV"}):jsxRuntimeExports.jsx("span",{className:"password-default",children:"Using default"})}),jsxRun
timeExports.jsx("td",{children:Dt?jsxRuntimeExports.jsx("span",{className:"role-set",children:Dt.name}):jsxRuntimeExpor
ts.jsx("span",{className:"status-error",children:"Missing"})}),ls.results.length>0&&jsxRuntimeExports.jsx("td",{childre
n:Xt?Xt.success?jsxRuntimeExports.jsx("span",{className:"status-success",children:"Created"}):jsxRuntimeExports.jsx("sp
an",{className:"status-error",title:Xt.error,children:"Failed"}):jsxRuntimeExports.jsx("span",{className:"status-pendin
g",children:"Pending"})})]},Lt)})})]})})]}),Mt&&jsxRuntimeExports.jsxs("div",{className:"upload-progress",children:[jsx
RuntimeExports.jsx("div",{className:"progress-bar",children:jsxRuntimeExports.jsx("div",{className:"progress-fill",styl
e:{width:`${ls.current/ls.total*100}%`}})}),jsxRuntimeExports.jsxs("span",{children:["Processing ",ls.current," of ",ls
.total,"..."]})]}),jsxRuntimeExports.jsxs("div",{className:"form-actions",children:[jsxRuntimeExports.jsx("button",{typ
e:"button",className:"cancel-btn",onClick:$t,disabled:Mt,children:"Cancel"}),jsxRuntimeExports.jsx("button",{type:"butt
on",className:"save-btn",onClick:Pt,disabled:Mt||xt.length===0||!cs,children:Mt?"Creating Users...":`Create 
${xt.length} Users`})]})]}),jsxRuntimeExports.jsx("div",{className:"users-list",children:c.length===0?jsxRuntimeExports
.jsx("div",{className:"empty-state",children:jsxRuntimeExports.jsx("p",{children:"No users in this tenant yet. Add 
users to give them access."})}):c.map(Bt=>{var Lt,Xt;return jsxRuntimeExports.jsxs("div",{className:"user-card",childre
n:[jsxRuntimeExports.jsxs("div",{className:"user-info",children:[jsxRuntimeExports.jsx("div",{className:"user-avatar",c
hildren:Bt.photoURL?jsxRuntimeExports.jsx("img",{src:Bt.photoURL,alt:Bt.displayName}):jsxRuntimeExports.jsx("span",{chi
ldren:(Bt.displayName||Bt.email||"U")[0].toUpperCase()})}),jsxRuntimeExports.jsxs("div",{className:"user-details",child
ren:[jsxRuntimeExports.jsx("div",{className:"user-name",children:Bt.displayName||"No name"}),jsxRuntimeExports.jsx("div
",{className:"user-email",children:Bt.email}),jsxRuntimeExports.jsxs("div",{className:"user-meta",children:[jsxRuntimeE
xports.jsxs("span",{className:"user-id",children:["ID: 
",Bt.id.substring(0,8),"..."]}),Bt.lastLogin&&jsxRuntimeExports.jsxs("span",{className:"user-login",children:["Last 
login: ",((Xt=(Lt=Bt.lastLogin).toDate)==null?void 0:Xt.call(Lt).toLocaleDateString())||"N/A"]})]})]})]}),jsxRuntimeExp
orts.jsxs("div",{className:"user-actions",children:[jsxRuntimeExports.jsxs("div",{className:"role-select",children:[jsx
RuntimeExports.jsx("label",{children:"Role:"}),jsxRuntimeExports.jsx("select",{value:Bt.role||"salesperson",onChange:Dt
=>gt(Bt.id,Dt.target.value),children:_.map(Dt=>jsxRuntimeExports.jsx("option",{value:Dt.id,children:Dt.name},Dt.id))})]
}),jsxRuntimeExports.jsx("button",{className:"remove-btn",onClick:()=>Et(Bt.id,Bt.displayName||Bt.email),children:"Remo
ve"})]})]},Bt.id)})})]}),jsxRuntimeExports.jsxs("div",{className:"info-section",children:[jsxRuntimeExports.jsx("h3",{c
hildren:"About Tenant Users"}),jsxRuntimeExports.jsxs("ul",{children:[jsxRuntimeExports.jsx("li",{children:"Users must 
be assigned to a tenant to access the system."}),jsxRuntimeExports.jsx("li",{children:"Each user can only belong to 
one tenant at a time."}),jsxRuntimeExports.jsx("li",{children:"The role determines what permissions the user has 
within the tenant."}),jsxRuntimeExports.jsx("li",{children:"Removing a user from a tenant revokes their access to all 
tenant data."})]})]})]})},clearAllData=async()=>{try{const s=writeBatch(db),e=await 
getDocs(collection(db,"clients"));for(const a of e.docs)(await getDocs(collection(db,"clients",a.id,"products"))).docs.
forEach(j=>{s.delete(doc(db,"clients",a.id,"products",j.id))}),(await getDocs(collection(db,"clients",a.id,"contracts")
)).docs.forEach(j=>{s.delete(doc(db,"clients",a.id,"contracts",j.id))}),(await getDocs(collection(db,"clients",a.id,"ac
tivities"))).docs.forEach(j=>{s.delete(doc(db,"clients",a.id,"activities",j.id))}),(await getDocs(collection(db,"client
s",a.id,"interactions"))).docs.forEach(j=>{s.delete(doc(db,"clients",a.id,"interactions",j.id))}),s.delete(doc(db,"clie
nts",a.id));const i=["deals","quotes","invoices","messages","forecasts","feedback","financialDashboard","clientFinancia
ls","followUpTasks"];for(const a of i)(await getDocs(collection(db,a))).docs.forEach(c=>{s.delete(c.ref)});await 
s.commit(),console.log("All data cleared successfully")}catch(s){throw console.error("Error clearing 
data:",s),s}},seedAllData=async(s={})=>{var e,i,a,o,c,d,h,j;try{let 
_=s.salesPerson1,$=s.salesPerson2,rt=s.admin,tt=s.manager;if(!_||!$){const nt=(await 
getDocs(collection(db,"users"))).docs.map(ct=>({id:ct.id,...ct.data()}));_||(_=((e=nt.find(ct=>{var 
xt,yt;return((xt=ct.email)==null?void 0:xt.toLowerCase().includes("sales"))||((yt=ct.title)==null?void 
0:yt.toLowerCase().includes("sales"))}))==null?void 0:e.id)||((i=nt[0])==null?void 
0:i.id)||"salesperson1"),$||($=((a=nt.find(ct=>{var xt,yt;return ct.id!==_&&(((xt=ct.email)==null?void 
0:xt.toLowerCase().includes("sales"))||((yt=ct.title)==null?void 0:yt.toLowerCase().includes("sales")))}))==null?void 
0:a.id)||((o=nt[1])==null?void 0:o.id)||"salesperson2"),rt||(rt=((c=nt.find(ct=>{var 
xt,yt;return((xt=ct.email)==null?void 0:xt.toLowerCase().includes("admin"))||((yt=ct.title)==null?void 
0:yt.toLowerCase().includes("admin"))}))==null?void 0:c.id)||((d=nt[2])==null?void 
0:d.id)||"admin"),tt||(tt=((h=nt.find(ct=>{var xt,yt;return((xt=ct.email)==null?void 
0:xt.toLowerCase().includes("manager"))||((yt=ct.title)==null?void 
0:yt.toLowerCase().includes("manager"))}))==null?void 0:h.id)||((j=nt[3])==null?void 
0:j.id)||"manager")}console.log("Using user IDs:",{salesPerson1:_,salesPerson2:$,admin:rt,manager:tt});const mt=writeBa
tch(db),vt={learnerships:{previousYear:28e5,ytd:185e4,forecast:21e5,fullYear:395e4},tapBusiness:{previousYear:19e5,ytd:
125e4,forecast:145e4,fullYear:27e5},compliance:{previousYear:92e4,ytd:58e4,forecast:68e4,fullYear:126e4},otherCourses:{
previousYear:42e4,ytd:26e4,forecast:33e4,fullYear:59e4},createdAt:serverTimestamp(),updatedAt:serverTimestamp()};mt.set
(doc(db,"financialDashboard","main"),vt);const _t=[{id:"client1",name:"ABC Manufacturing",legalName:"ABC Manufacturing 
(Pty) Ltd",tradingName:"ABC Manufacturing",type:"Corporate",status:"Active",industry:"Manufacturing",sector:"Heavy 
Industry",seta:"MERSETA",bbbeeLevel:"Level 2",vatNumber:"4123456789",address:"123 Industrial Road, Johannesburg, 
2000",physicalAddress:"123 Industrial Road, Johannesburg, 2000",country:"South 
Africa",financialYearEnd:"February",sharePointLink:"https://sharepoint.com/abc-manufacturing",primaryContact:"John 
Smith",contactEmail:"john.smith@abcmanufacturing.co.za",phone:"011 555 1234",hrContactPerson:"Sarah 
Williams",hrContactEmail:"s.williams@abcmanufacturing.co.za",hrContactPhone:"011 555 1235",sdfName:"Michael 
Jones",sdfEmail:"m.jones@abcmanufacturing.co.za",sdfPhone:"011 555 1236",decisionMakerName:"Peter van der 
Berg",decisionMakerEmail:"p.vanderberg@abcmanufacturing.co.za",decisionMakerPhone:"011 555 
1237",currentLmsUsage:"Yes",lmsId:"LMS-1001",ytdRevenue:125e4,pipelineValue:45e4,lastContact:Timestamp.fromDate(new 
Date("2025-01-15")),assignedSalesPerson:_,notes:"Key manufacturing client. Strong learnership 
pipeline.",createdAt:Timestamp.fromDate(new Date("2024-01-10")),updatedAt:serverTimestamp()},{id:"client2",name:"Tech 
Solutions SA",legalName:"Tech Solutions South Africa (Pty) Ltd",tradingName:"Tech 
Solutions",type:"Corporate",status:"Active",industry:"Technology",sector:"IT Services",seta:"MICT 
SETA",bbbeeLevel:"Level 1",vatNumber:"4234567890",address:"456 Innovation Drive, Cape Town, 8001",physicalAddress:"456 
Innovation Drive, Cape Town, 8001",country:"South 
Africa",financialYearEnd:"December",sharePointLink:"https://sharepoint.com/tech-solutions",primaryContact:"Sarah 
Johnson",contactEmail:"sarah.j@techsolutions.co.za",phone:"021 555 2345",hrContactPerson:"David 
Brown",hrContactEmail:"d.brown@techsolutions.co.za",hrContactPhone:"021 555 2346",sdfName:"Emily 
Davis",sdfEmail:"e.davis@techsolutions.co.za",sdfPhone:"021 555 2347",decisionMakerName:"Robert 
Chen",decisionMakerEmail:"r.chen@techsolutions.co.za",decisionMakerPhone:"021 555 
2348",currentLmsUsage:"Yes",lmsId:"LMS-1002",ytdRevenue:98e4,pipelineValue:32e4,lastContact:Timestamp.fromDate(new 
Date("2025-01-20")),assignedSalesPerson:_,notes:"Growing tech company with focus on digital skills 
training.",createdAt:Timestamp.fromDate(new 
Date("2024-02-15")),updatedAt:serverTimestamp()},{id:"client3",name:"Greenfield High School",legalName:"Greenfield 
High School",tradingName:"Greenfield High",type:"School",status:"Active",industry:"Education",sector:"Secondary 
Education",seta:"ETDP SETA",bbbeeLevel:"Level 3",vatNumber:"4345678901",address:"789 Education Street, Durban, 
4001",physicalAddress:"789 Education Street, Durban, 4001",country:"South 
Africa",financialYearEnd:"December",sharePointLink:"https://sharepoint.com/greenfield-high",primaryContact:"Michael 
Brown",contactEmail:"m.brown@greenfieldhigh.co.za",phone:"031 555 3456",hrContactPerson:"Lisa 
Anderson",hrContactEmail:"l.anderson@greenfieldhigh.co.za",hrContactPhone:"031 555 3457",sdfName:"James 
Wilson",sdfEmail:"j.wilson@greenfieldhigh.co.za",sdfPhone:"031 555 3458",decisionMakerName:"Principal 
Nkosi",decisionMakerEmail:"principal@greenfieldhigh.co.za",decisionMakerPhone:"031 555 
3459",currentLmsUsage:"No",lmsId:"",ytdRevenue:45e4,pipelineValue:18e4,lastContact:Timestamp.fromDate(new 
Date("2025-01-18")),assignedSalesPerson:$,notes:"School client focused on compliance and staff 
training.",createdAt:Timestamp.fromDate(new Date("2024-03-01")),updatedAt:serverTimestamp()},{id:"client4",name:"Metro 
Logistics",legalName:"Metro Logistics Group (Pty) Ltd",tradingName:"Metro 
Logistics",type:"Corporate",status:"Active",industry:"Transport & 
Logistics",sector:"Freight",seta:"TETA",bbbeeLevel:"Level 2",vatNumber:"4456789012",address:"321 Transport Avenue, 
Pretoria, 0001",physicalAddress:"321 Transport Avenue, Pretoria, 0001",country:"South 
Africa",financialYearEnd:"June",sharePointLink:"https://sharepoint.com/metro-logistics",primaryContact:"Lisa 
Williams",contactEmail:"l.williams@metrologistics.co.za",phone:"012 555 4567",hrContactPerson:"Thomas 
Moore",hrContactEmail:"t.moore@metrologistics.co.za",hrContactPhone:"012 555 4568",sdfName:"Patricia 
Taylor",sdfEmail:"p.taylor@metrologistics.co.za",sdfPhone:"012 555 4569",decisionMakerName:"CEO 
Molefe",decisionMakerEmail:"ceo@metrologistics.co.za",decisionMakerPhone:"012 555 
4570",currentLmsUsage:"Yes",lmsId:"LMS-1004",ytdRevenue:78e4,pipelineValue:25e4,lastContact:Timestamp.fromDate(new 
Date("2025-01-10")),assignedSalesPerson:$,notes:"Strong compliance training needs for drivers and warehouse 
staff.",createdAt:Timestamp.fromDate(new Date("2024-04-20")),updatedAt:serverTimestamp()},{id:"client5",name:"Premier 
Academy",legalName:"Premier Academy Trust",tradingName:"Premier 
Academy",type:"School",status:"Prospect",industry:"Education",sector:"Primary & Secondary Education",seta:"ETDP 
SETA",bbbeeLevel:"Level 4",vatNumber:"4567890123",address:"654 Learning Lane, Port Elizabeth, 
6001",physicalAddress:"654 Learning Lane, Port Elizabeth, 6001",country:"South 
Africa",financialYearEnd:"December",sharePointLink:"",primaryContact:"David 
Miller",contactEmail:"d.miller@premieracademy.co.za",phone:"041 555 5678",hrContactPerson:"Jennifer 
Clark",hrContactEmail:"j.clark@premieracademy.co.za",hrContactPhone:"041 555 5679",sdfName:"Richard 
Harris",sdfEmail:"r.harris@premieracademy.co.za",sdfPhone:"041 555 5680",decisionMakerName:"Board Chair 
Dlamini",decisionMakerEmail:"board@premieracademy.co.za",decisionMakerPhone:"041 555 
5681",currentLmsUsage:"No",lmsId:"",ytdRevenue:0,pipelineValue:15e4,lastContact:Timestamp.fromDate(new 
Date("2025-01-05")),assignedSalesPerson:_,notes:"New prospect - interested in full training 
solution.",createdAt:Timestamp.fromDate(new Date("2024-12-15")),updatedAt:serverTimestamp()}];for(const it of 
_t){const{id:nt,...ct}=it;mt.set(doc(db,"clients",nt),ct)}const 
wt=2025,ht=[{id:"client1_2025_Learnerships",clientId:"client1",clientName:"ABC Manufacturing",financialYear:2025,produc
tLine:"Learnerships",history:{yearMinus3:28e4,yearMinus2:35e4,yearMinus1:42e4,currentYearYTD:32e4},fullYearForecast:52e
4,learnershipDetails:[{id:"L1",name:"NQF4 Business Admin Learnership",description:"15 learners in business administrati
on",certaintyPercentage:100,learners:15,costPerLearner:28e3,fundingType:"SETA",paymentStartDate:"2024-04-01",paymentFre
quency:"Monthly",paymentMonths:12}],months:{},comments:"Strong learnership uptake expected",createdAt:serverTimestamp()
,lastUpdatedAt:serverTimestamp()},{id:"client1_2025_TAP_Business",clientId:"client1",clientName:"ABC 
Manufacturing",financialYear:2025,productLine:"TAP Business",history:{yearMinus3:18e4,yearMinus2:22e4,yearMinus1:28e4,c
urrentYearYTD:18e4},fullYearForecast:35e4,tapBusinessDetails:[{id:"TAP1",name:"TAP Premium Package",description:"28 
employees on TAP platform",certaintyPercentage:100,numberOfEmployees:28,costPerEmployeePerMonth:250,paymentStartDate:"2
024-02-01",paymentType:"Monthly",contractMonths:18}],months:{},comments:"Renewal pending",createdAt:serverTimestamp(),l
astUpdatedAt:serverTimestamp()},{id:"client1_2025_Compliance_Training",clientId:"client1",clientName:"ABC 
Manufacturing",financialYear:2025,productLine:"Compliance Training",history:{yearMinus3:85e3,yearMinus2:95e3,yearMinus1
:12e4,currentYearYTD:75e3},fullYearForecast:18e4,complianceDetails:[{id:"COMP1",name:"First Aid Level 1 
Training",description:"25 trainees",certaintyPercentage:100,courseName:"First Aid Level 
1",numberOfTrainees:25,pricePerPerson:2800,trainingDate:"2024-06-15"}],months:{},comments:"Annual compliance cycle",cre
atedAt:serverTimestamp(),lastUpdatedAt:serverTimestamp()},{id:"client1_2025_Other_Courses",clientId:"client1",clientNam
e:"ABC Manufacturing",financialYear:2025,productLine:"Other Courses",history:{yearMinus3:45e3,yearMinus2:55e3,yearMinus
1:65e3,currentYearYTD:35e3},fullYearForecast:95e3,otherCoursesDetails:[{id:"COURSE1",name:"Excel Advanced 
Training",description:"12 participants",certaintyPercentage:80,courseName:"Excel 
Advanced",numberOfTrainees:12,pricePerPerson:3500,trainingDate:"2025-03-20"}],months:{},comments:"Skills development fo
cus",createdAt:serverTimestamp(),lastUpdatedAt:serverTimestamp()},{id:"client2_2025_Learnerships",clientId:"client2",cl
ientName:"Tech Solutions SA",financialYear:2025,productLine:"Learnerships",history:{yearMinus3:15e4,yearMinus2:2e5,year
Minus1:28e4,currentYearYTD:22e4},fullYearForecast:38e4,learnershipDetails:[{id:"L2",name:"IT Support 
Learnership",description:"10 learners in IT 
support",certaintyPercentage:100,learners:10,costPerLearner:32e3,fundingType:"Self 
Funded",paymentStartDate:"2024-05-01",paymentFrequency:"Monthly",paymentMonths:12}],months:{},comments:"Tech focused le
arnerships",createdAt:serverTimestamp(),lastUpdatedAt:serverTimestamp()},{id:"client2_2025_TAP_Business",clientId:"clie
nt2",clientName:"Tech Solutions SA",financialYear:2025,productLine:"TAP Business",history:{yearMinus3:22e4,yearMinus2:2
8e4,yearMinus1:35e4,currentYearYTD:28e4},fullYearForecast:45e4,tapBusinessDetails:[{id:"TAP2",name:"TAP Enterprise 
Package",description:"35 employees on TAP platform",certaintyPercentage:100,numberOfEmployees:35,costPerEmployeePerMont
h:300,paymentStartDate:"2024-03-01",paymentType:"Monthly",contractMonths:18}],months:{},comments:"Growing user base",cr
eatedAt:serverTimestamp(),lastUpdatedAt:serverTimestamp()},{id:"client2_2025_Other_Courses",clientId:"client2",clientNa
me:"Tech Solutions SA",financialYear:2025,productLine:"Other Courses",history:{yearMinus3:6e4,yearMinus2:8e4,yearMinus1
:95e3,currentYearYTD:65e3},fullYearForecast:12e4,otherCoursesDetails:[{id:"COURSE2",name:"Project Management 
Fundamentals",description:"15 participants",certaintyPercentage:90,courseName:"Project 
Management",numberOfTrainees:15,pricePerPerson:4500,trainingDate:"2025-02-28"}],months:{},comments:"Digital skills focu
s",createdAt:serverTimestamp(),lastUpdatedAt:serverTimestamp()},{id:"client3_2025_Learnerships",clientId:"client3",clie
ntName:"Greenfield High School",financialYear:2025,productLine:"Learnerships",history:{yearMinus3:12e4,yearMinus2:15e4,
yearMinus1:18e4,currentYearYTD:14e4},fullYearForecast:25e4,learnershipDetails:[{id:"L3",name:"Education Support 
Learnership",description:"8 teacher assistants",certaintyPercentage:100,learners:8,costPerLearner:25e3,fundingType:"SET
A",paymentStartDate:"2024-03-01",paymentFrequency:"Monthly",paymentMonths:12}],months:{},comments:"School learnership p
rogram",createdAt:serverTimestamp(),lastUpdatedAt:serverTimestamp()},{id:"client3_2025_Compliance_Training",clientId:"c
lient3",clientName:"Greenfield High School",financialYear:2025,productLine:"Compliance Training",history:{yearMinus3:55
e3,yearMinus2:65e3,yearMinus1:8e4,currentYearYTD:5e4},fullYearForecast:12e4,complianceDetails:[{id:"COMP2",name:"OHS 
Representative Training",description:"19 staff members",certaintyPercentage:100,courseName:"OHS 
Representative",numberOfTrainees:19,pricePerPerson:3200,trainingDate:"2024-08-10"}],months:{},comments:"Annual 
compliance requirements",createdAt:serverTimestamp(),lastUpdatedAt:serverTimestamp()},{id:"client4_2025_Learnerships",c
lientId:"client4",clientName:"Metro Logistics",financialYear:2025,productLine:"Learnerships",history:{yearMinus3:18e4,y
earMinus2:22e4,yearMinus1:28e4,currentYearYTD:2e5},fullYearForecast:38e4,learnershipDetails:[{id:"L4",name:"Freight 
Handling Learnership",description:"12 warehouse staff",certaintyPercentage:100,learners:12,costPerLearner:26e3,fundingT
ype:"SETA",paymentStartDate:"2024-04-15",paymentFrequency:"Monthly",paymentMonths:12}],months:{},comments:"Transport 
sector focus",createdAt:serverTimestamp(),lastUpdatedAt:serverTimestamp()},{id:"client4_2025_TAP_Business",clientId:"cl
ient4",clientName:"Metro Logistics",financialYear:2025,productLine:"TAP Business",history:{yearMinus3:12e4,yearMinus2:1
5e4,yearMinus1:18e4,currentYearYTD:14e4},fullYearForecast:25e4,tapBusinessDetails:[{id:"TAP3",name:"TAP Standard 
Package",description:"45 employees",certaintyPercentage:100,numberOfEmployees:45,costPerEmployeePerMonth:180,paymentSta
rtDate:"2024-05-01",paymentType:"Monthly",contractMonths:12}],months:{},comments:"Driver training focus",createdAt:serv
erTimestamp(),lastUpdatedAt:serverTimestamp()},{id:"client4_2025_Compliance_Training",clientId:"client4",clientName:"Me
tro Logistics",financialYear:2025,productLine:"Compliance Training",history:{yearMinus3:95e3,yearMinus2:12e4,yearMinus1
:15e4,currentYearYTD:11e4},fullYearForecast:2e5,complianceDetails:[{id:"COMP3",name:"Forklift Operation 
Training",description:"30 warehouse operators",certaintyPercentage:100,courseName:"Forklift 
Operation",numberOfTrainees:30,pricePerPerson:3500,trainingDate:"2024-07-20"},{id:"COMP4",name:"Fire Fighter 
Training",description:"20 safety officers",certaintyPercentage:90,courseName:"Fire 
Fighter",numberOfTrainees:20,pricePerPerson:2800,trainingDate:"2025-02-15"}],months:{},comments:"Strong compliance need
s",createdAt:serverTimestamp(),lastUpdatedAt:serverTimestamp()},{id:"client5_2025_Learnerships",clientId:"client5",clie
ntName:"Premier Academy",financialYear:2025,productLine:"Learnerships",history:{yearMinus3:0,yearMinus2:0,yearMinus1:0,
currentYearYTD:0},fullYearForecast:15e4,learnershipDetails:[{id:"L5",name:"Teaching Assistant 
Learnership",description:"Proposed 6 learners",certaintyPercentage:60,learners:6,costPerLearner:25e3,fundingType:"SETA"
,paymentStartDate:"2025-06-01",paymentFrequency:"Monthly",paymentMonths:12}],months:{},comments:"Prospect - in 
negotiation",createdAt:serverTimestamp(),lastUpdatedAt:serverTimestamp()}];for(const it of 
ht){const{id:nt,...ct}=it;mt.set(doc(db,"clientFinancials",nt),ct)}const 
dt=[{id:"quote1",quoteNumber:"Q-2024-001",clientId:"client1",clientName:"ABC Manufacturing",product:"Learnerships - 
NQF4 Business Admin",date:Timestamp.fromDate(new Date("2024-01-15")),amount:42e4,validUntil:Timestamp.fromDate(new Date
("2024-02-15")),status:"Accepted",createdAt:serverTimestamp()},{id:"quote2",quoteNumber:"Q-2024-015",clientId:"client1"
,clientName:"ABC Manufacturing",product:"TAP Business Premium Package",date:Timestamp.fromDate(new 
Date("2024-02-01")),amount:151200,validUntil:Timestamp.fromDate(new Date("2024-03-01")),status:"Accepted",createdAt:ser
verTimestamp()},{id:"quote3",quoteNumber:"Q-2024-028",clientId:"client1",clientName:"ABC Manufacturing",product:"First 
Aid Level 1 Training",date:Timestamp.fromDate(new Date("2024-05-20")),amount:7e4,validUntil:Timestamp.fromDate(new Date
("2024-06-20")),status:"Accepted",createdAt:serverTimestamp()},{id:"quote4",quoteNumber:"Q-2025-001",clientId:"client1"
,clientName:"ABC Manufacturing",product:"Excel Advanced Training",date:Timestamp.fromDate(new 
Date("2025-01-10")),amount:42e3,validUntil:Timestamp.fromDate(new Date("2025-02-10")),status:"Sent",createdAt:serverTim
estamp()},{id:"quote5",quoteNumber:"Q-2024-008",clientId:"client2",clientName:"Tech Solutions SA",product:"IT Support 
Learnership",date:Timestamp.fromDate(new Date("2024-03-10")),amount:32e4,validUntil:Timestamp.fromDate(new Date("2024-0
4-10")),status:"Accepted",createdAt:serverTimestamp()},{id:"quote6",quoteNumber:"Q-2024-012",clientId:"client2",clientN
ame:"Tech Solutions SA",product:"TAP Enterprise Package",date:Timestamp.fromDate(new 
Date("2024-02-15")),amount:189e3,validUntil:Timestamp.fromDate(new Date("2024-03-15")),status:"Accepted",createdAt:serv
erTimestamp()},{id:"quote7",quoteNumber:"Q-2025-003",clientId:"client2",clientName:"Tech Solutions 
SA",product:"Project Management Training",date:Timestamp.fromDate(new 
Date("2025-01-15")),amount:67500,validUntil:Timestamp.fromDate(new Date("2025-02-15")),status:"Pending",createdAt:serve
rTimestamp()},{id:"quote8",quoteNumber:"Q-2024-005",clientId:"client3",clientName:"Greenfield High 
School",product:"Education Support Learnership",date:Timestamp.fromDate(new 
Date("2024-02-01")),amount:2e5,validUntil:Timestamp.fromDate(new Date("2024-03-01")),status:"Accepted",createdAt:server
Timestamp()},{id:"quote9",quoteNumber:"Q-2024-022",clientId:"client3",clientName:"Greenfield High School",product:"OHS 
Representative Training",date:Timestamp.fromDate(new 
Date("2024-07-05")),amount:60800,validUntil:Timestamp.fromDate(new Date("2024-08-05")),status:"Accepted",createdAt:serv
erTimestamp()},{id:"quote10",quoteNumber:"Q-2025-005",clientId:"client3",clientName:"Greenfield High 
School",product:"Leadership Development",date:Timestamp.fromDate(new 
Date("2025-01-18")),amount:45e3,validUntil:Timestamp.fromDate(new Date("2025-02-18")),status:"Sent",createdAt:serverTim
estamp()},{id:"quote11",quoteNumber:"Q-2024-010",clientId:"client4",clientName:"Metro Logistics",product:"Freight 
Handling Learnership",date:Timestamp.fromDate(new Date("2024-03-20")),amount:312e3,validUntil:Timestamp.fromDate(new Da
te("2024-04-20")),status:"Accepted",createdAt:serverTimestamp()},{id:"quote12",quoteNumber:"Q-2024-018",clientId:"clien
t4",clientName:"Metro Logistics",product:"TAP Standard Package",date:Timestamp.fromDate(new 
Date("2024-04-15")),amount:97200,validUntil:Timestamp.fromDate(new Date("2024-05-15")),status:"Accepted",createdAt:serv
erTimestamp()},{id:"quote13",quoteNumber:"Q-2024-025",clientId:"client4",clientName:"Metro 
Logistics",product:"Forklift Operation Training",date:Timestamp.fromDate(new 
Date("2024-06-25")),amount:105e3,validUntil:Timestamp.fromDate(new Date("2024-07-25")),status:"Accepted",createdAt:serv
erTimestamp()},{id:"quote14",quoteNumber:"Q-2025-002",clientId:"client4",clientName:"Metro Logistics",product:"Fire 
Fighter Training",date:Timestamp.fromDate(new Date("2025-01-12")),amount:56e3,validUntil:Timestamp.fromDate(new Date("2
025-02-12")),status:"Sent",createdAt:serverTimestamp()},{id:"quote15",quoteNumber:"Q-2025-008",clientId:"client5",clien
tName:"Premier Academy",product:"Teaching Assistant Learnership",date:Timestamp.fromDate(new 
Date("2025-01-05")),amount:15e4,validUntil:Timestamp.fromDate(new 
Date("2025-02-05")),status:"Pending",createdAt:serverTimestamp()}];for(const it of 
dt){const{id:nt,...ct}=it;mt.set(doc(db,"quotes",nt),ct)}const 
jt=[{id:"inv1",invoiceNumber:"INV-2024-001",clientId:"client1",clientName:"ABC Manufacturing",product:"Learnerships - 
NQF4 Business Admin (Month 1)",issueDate:Timestamp.fromDate(new 
Date("2024-04-05")),amount:35e3,dueDate:Timestamp.fromDate(new Date("2024-05-05")),status:"Paid",createdAt:serverTimest
amp()},{id:"inv2",invoiceNumber:"INV-2024-015",clientId:"client1",clientName:"ABC Manufacturing",product:"Learnerships 
- NQF4 Business Admin (Month 2)",issueDate:Timestamp.fromDate(new 
Date("2024-05-05")),amount:35e3,dueDate:Timestamp.fromDate(new Date("2024-06-05")),status:"Paid",createdAt:serverTimest
amp()},{id:"inv3",invoiceNumber:"INV-2024-028",clientId:"client1",clientName:"ABC Manufacturing",product:"Learnerships 
- NQF4 Business Admin (Month 3)",issueDate:Timestamp.fromDate(new 
Date("2024-06-05")),amount:35e3,dueDate:Timestamp.fromDate(new Date("2024-07-05")),status:"Paid",createdAt:serverTimest
amp()},{id:"inv4",invoiceNumber:"INV-2024-041",clientId:"client1",clientName:"ABC Manufacturing",product:"TAP Business 
Premium (Q1)",issueDate:Timestamp.fromDate(new Date("2024-05-01")),amount:21e3,dueDate:Timestamp.fromDate(new Date("202
4-06-01")),status:"Paid",createdAt:serverTimestamp()},{id:"inv5",invoiceNumber:"INV-2024-055",clientId:"client1",client
Name:"ABC Manufacturing",product:"TAP Business Premium (Q2)",issueDate:Timestamp.fromDate(new 
Date("2024-08-01")),amount:21e3,dueDate:Timestamp.fromDate(new Date("2024-09-01")),status:"Paid",createdAt:serverTimest
amp()},{id:"inv6",invoiceNumber:"INV-2024-068",clientId:"client1",clientName:"ABC Manufacturing",product:"First Aid 
Level 1 Training",issueDate:Timestamp.fromDate(new Date("2024-06-20")),amount:7e4,dueDate:Timestamp.fromDate(new Date("
2024-07-20")),status:"Paid",createdAt:serverTimestamp()},{id:"inv7",invoiceNumber:"INV-2025-001",clientId:"client1",cli
entName:"ABC Manufacturing",product:"Learnerships - NQF4 Business Admin (Month 10)",issueDate:Timestamp.fromDate(new 
Date("2025-01-05")),amount:35e3,dueDate:Timestamp.fromDate(new Date("2025-02-05")),status:"Pending",createdAt:serverTim
estamp()},{id:"inv8",invoiceNumber:"INV-2024-008",clientId:"client2",clientName:"Tech Solutions SA",product:"IT 
Support Learnership (Month 1)",issueDate:Timestamp.fromDate(new 
Date("2024-05-10")),amount:26667,dueDate:Timestamp.fromDate(new Date("2024-06-10")),status:"Paid",createdAt:serverTimes
tamp()},{id:"inv9",invoiceNumber:"INV-2024-022",clientId:"client2",clientName:"Tech Solutions SA",product:"IT Support 
Learnership (Month 2)",issueDate:Timestamp.fromDate(new 
Date("2024-06-10")),amount:26667,dueDate:Timestamp.fromDate(new Date("2024-07-10")),status:"Paid",createdAt:serverTimes
tamp()},{id:"inv10",invoiceNumber:"INV-2024-035",clientId:"client2",clientName:"Tech Solutions SA",product:"TAP 
Enterprise Package (Q1)",issueDate:Timestamp.fromDate(new 
Date("2024-06-01")),amount:31500,dueDate:Timestamp.fromDate(new Date("2024-07-01")),status:"Paid",createdAt:serverTimes
tamp()},{id:"inv11",invoiceNumber:"INV-2024-048",clientId:"client2",clientName:"Tech Solutions SA",product:"TAP 
Enterprise Package (Q2)",issueDate:Timestamp.fromDate(new 
Date("2024-09-01")),amount:31500,dueDate:Timestamp.fromDate(new Date("2024-10-01")),status:"Paid",createdAt:serverTimes
tamp()},{id:"inv12",invoiceNumber:"INV-2025-003",clientId:"client2",clientName:"Tech Solutions SA",product:"TAP 
Enterprise Package (Q4)",issueDate:Timestamp.fromDate(new 
Date("2025-01-05")),amount:31500,dueDate:Timestamp.fromDate(new Date("2025-02-05")),status:"Unpaid",createdAt:serverTim
estamp()},{id:"inv13",invoiceNumber:"INV-2024-005",clientId:"client3",clientName:"Greenfield High 
School",product:"Education Support Learnership (Month 1)",issueDate:Timestamp.fromDate(new 
Date("2024-03-10")),amount:16667,dueDate:Timestamp.fromDate(new Date("2024-04-10")),status:"Paid",createdAt:serverTimes
tamp()},{id:"inv14",invoiceNumber:"INV-2024-018",clientId:"client3",clientName:"Greenfield High 
School",product:"Education Support Learnership (Month 2)",issueDate:Timestamp.fromDate(new 
Date("2024-04-10")),amount:16667,dueDate:Timestamp.fromDate(new Date("2024-05-10")),status:"Paid",createdAt:serverTimes
tamp()},{id:"inv15",invoiceNumber:"INV-2024-042",clientId:"client3",clientName:"Greenfield High School",product:"OHS 
Representative Training",issueDate:Timestamp.fromDate(new 
Date("2024-08-15")),amount:60800,dueDate:Timestamp.fromDate(new Date("2024-09-15")),status:"Paid",createdAt:serverTimes
tamp()},{id:"inv16",invoiceNumber:"INV-2025-005",clientId:"client3",clientName:"Greenfield High 
School",product:"Education Support Learnership (Month 11)",issueDate:Timestamp.fromDate(new 
Date("2025-01-10")),amount:16667,dueDate:Timestamp.fromDate(new Date("2025-02-10")),status:"Pending",createdAt:serverTi
mestamp()},{id:"inv17",invoiceNumber:"INV-2024-010",clientId:"client4",clientName:"Metro Logistics",product:"Freight 
Handling Learnership (Month 1)",issueDate:Timestamp.fromDate(new 
Date("2024-04-20")),amount:26e3,dueDate:Timestamp.fromDate(new Date("2024-05-20")),status:"Paid",createdAt:serverTimest
amp()},{id:"inv18",invoiceNumber:"INV-2024-024",clientId:"client4",clientName:"Metro Logistics",product:"Freight 
Handling Learnership (Month 2)",issueDate:Timestamp.fromDate(new 
Date("2024-05-20")),amount:26e3,dueDate:Timestamp.fromDate(new Date("2024-06-20")),status:"Paid",createdAt:serverTimest
amp()},{id:"inv19",invoiceNumber:"INV-2024-037",clientId:"client4",clientName:"Metro Logistics",product:"TAP Standard 
Package (Month 1-3)",issueDate:Timestamp.fromDate(new Date("2024-08-01")),amount:24300,dueDate:Timestamp.fromDate(new D
ate("2024-09-01")),status:"Paid",createdAt:serverTimestamp()},{id:"inv20",invoiceNumber:"INV-2024-050",clientId:"client
4",clientName:"Metro Logistics",product:"Forklift Operation Training",issueDate:Timestamp.fromDate(new 
Date("2024-07-25")),amount:105e3,dueDate:Timestamp.fromDate(new Date("2024-08-25")),status:"Paid",createdAt:serverTimes
tamp()},{id:"inv21",invoiceNumber:"INV-2024-063",clientId:"client4",clientName:"Metro Logistics",product:"TAP Standard 
Package (Month 4-6)",issueDate:Timestamp.fromDate(new Date("2024-11-01")),amount:24300,dueDate:Timestamp.fromDate(new D
ate("2024-12-01")),status:"Paid",createdAt:serverTimestamp()},{id:"inv22",invoiceNumber:"INV-2025-002",clientId:"client
4",clientName:"Metro Logistics",product:"Freight Handling Learnership (Month 9)",issueDate:Timestamp.fromDate(new 
Date("2025-01-15")),amount:26e3,dueDate:Timestamp.fromDate(new 
Date("2025-02-15")),status:"Pending",createdAt:serverTimestamp()}];for(const it of 
jt){const{id:nt,...ct}=it;mt.set(doc(db,"invoices",nt),ct)}const bt=[{id:"deal1",name:"ABC Manufacturing - 2025 
Learnership Expansion",clientId:"client1",clientName:"ABC 
Manufacturing",product:"Learnerships",value:52e4,stage:"negotiation",probability:85,lastContact:Timestamp.fromDate(new 
Date("2025-01-15")),expectedCloseDate:Timestamp.fromDate(new Date("2025-03-15")),assignedTo:_,nextAction:"Finalize 
contract terms",createdAt:serverTimestamp()},{id:"deal2",name:"Tech Solutions - TAP 
Renewal",clientId:"client2",clientName:"Tech Solutions SA",product:"TAP 
Business",value:45e4,stage:"proposal",probability:75,lastContact:Timestamp.fromDate(new 
Date("2025-01-20")),expectedCloseDate:Timestamp.fromDate(new Date("2025-02-28")),assignedTo:_,nextAction:"Send renewal 
proposal",createdAt:serverTimestamp()},{id:"deal3",name:"Greenfield High - Leadership 
Program",clientId:"client3",clientName:"Greenfield High School",product:"Other 
Courses",value:45e3,stage:"qualification",probability:60,lastContact:Timestamp.fromDate(new 
Date("2025-01-18")),expectedCloseDate:Timestamp.fromDate(new Date("2025-04-01")),assignedTo:$,nextAction:"Schedule 
needs assessment",createdAt:serverTimestamp()},{id:"deal4",name:"Metro Logistics - Fire Fighter 
Training",clientId:"client4",clientName:"Metro Logistics",product:"Compliance 
Training",value:56e3,stage:"proposal",probability:80,lastContact:Timestamp.fromDate(new 
Date("2025-01-12")),expectedCloseDate:Timestamp.fromDate(new Date("2025-02-15")),assignedTo:$,nextAction:"Await quote 
approval",createdAt:serverTimestamp()},{id:"deal5",name:"Premier Academy - Full Training 
Solution",clientId:"client5",clientName:"Premier 
Academy",product:"Learnerships",value:15e4,stage:"discovery",probability:40,lastContact:Timestamp.fromDate(new 
Date("2025-01-05")),expectedCloseDate:Timestamp.fromDate(new Date("2025-06-30")),assignedTo:_,nextAction:"Schedule 
discovery meeting",createdAt:serverTimestamp()}];for(const it of 
bt){const{id:nt,...ct}=it;mt.set(doc(db,"deals",nt),ct)}const ut=[{id:"task1",clientId:"client1",clientName:"ABC 
Manufacturing",description:"Send Excel training 
proposal",type:"document",status:"pending",priority:"Medium",dueDate:Timestamp.fromDate(new 
Date("2025-01-25")),assignedTo:_,assignedToName:"Sales Person 1",notes:"Client requested quote for 12 
participants",createdAt:serverTimestamp(),updatedAt:serverTimestamp()},{id:"task2",clientId:"client2",clientName:"Tech 
Solutions SA",description:"Follow up on TAP 
renewal",type:"call",status:"pending",priority:"High",dueDate:Timestamp.fromDate(new 
Date("2025-01-22")),assignedTo:_,assignedToName:"Sales Person 1",notes:"Contract expires end of 
March",createdAt:serverTimestamp(),updatedAt:serverTimestamp()},{id:"task3",clientId:"client3",clientName:"Greenfield 
High School",description:"Schedule leadership training needs 
assessment",type:"meeting",status:"pending",priority:"Medium",dueDate:Timestamp.fromDate(new 
Date("2025-01-30")),assignedTo:$,assignedToName:"Sales Person 2",notes:"Principal interested in staff 
development",createdAt:serverTimestamp(),updatedAt:serverTimestamp()},{id:"task4",clientId:"client4",clientName:"Metro 
Logistics",description:"Check invoice payment 
status",type:"review",status:"pending",priority:"High",dueDate:Timestamp.fromDate(new 
Date("2025-01-20")),assignedTo:$,assignedToName:"Sales Person 2",notes:"January invoice still 
pending",createdAt:serverTimestamp(),updatedAt:serverTimestamp()},{id:"task5",clientId:"client5",clientName:"Premier 
Academy",description:"Send introductory 
presentation",type:"email",status:"pending",priority:"Medium",dueDate:Timestamp.fromDate(new 
Date("2025-01-28")),assignedTo:_,assignedToName:"Sales Person 1",notes:"New prospect - requires education on 
services",createdAt:serverTimestamp(),updatedAt:serverTimestamp()}];for(const it of 
ut){const{id:nt,...ct}=it;mt.set(doc(db,"followUpTasks",nt),ct)}const Rt=[{id:"fb1",clientId:"client1",clientName:"ABC 
Manufacturing",type:"comment",content:"Excellent learnership results - 95% pass rate. Client very 
satisfied.",date:Timestamp.fromDate(new Date("2024-12-15")),userName:"Sales Person 
1",userId:_,createdAt:serverTimestamp(),updatedAt:serverTimestamp()},{id:"fb2",clientId:"client2",clientName:"Tech 
Solutions SA",type:"feedback",content:"TAP platform usage has increased significantly. Client considering 
expansion.",date:Timestamp.fromDate(new Date("2025-01-10")),userName:"Sales Person 1",userId:_,createdAt:serverTimestam
p(),updatedAt:serverTimestamp()},{id:"fb3",clientId:"client3",clientName:"Greenfield High 
School",type:"note",content:"Budget approval pending for next quarter training. Follow up in 
February.",date:Timestamp.fromDate(new Date("2025-01-18")),userName:"Sales Person 
2",userId:$,createdAt:serverTimestamp(),updatedAt:serverTimestamp()},{id:"fb4",clientId:"client4",clientName:"Metro 
Logistics",type:"comment",content:"Forklift training received excellent feedback from warehouse 
supervisors.",date:Timestamp.fromDate(new Date("2024-08-20")),userName:"Sales Person 
2",userId:$,createdAt:serverTimestamp(),updatedAt:serverTimestamp()}];for(const it of 
Rt){const{id:nt,...ct}=it;mt.set(doc(db,"feedback",nt),ct)}const st=[{id:"msg1",subject:"New Quote Request - ABC 
Manufacturing",from:"john.smith@abcmanufacturing.co.za",to:_,content:"Hi, we need a quote for Excel Advanced training 
for 12 staff members. Please advise on 
availability.",status:"unread",priority:"normal",clientId:"client1",date:Timestamp.fromDate(new 
Date("2025-01-19")),createdAt:serverTimestamp()},{id:"msg2",subject:"TAP Renewal 
Discussion",from:"sarah.j@techsolutions.co.za",to:_,content:"Our TAP contract is up for renewal. Can we schedule a 
call to discuss pricing?",status:"read",priority:"high",clientId:"client2",date:Timestamp.fromDate(new 
Date("2025-01-17")),createdAt:serverTimestamp()},{id:"msg3",subject:"Leadership Training 
Inquiry",from:"principal@greenfieldhigh.co.za",to:$,content:"We are interested in leadership development programs for 
our senior staff. Please provide 
information.",status:"unread",priority:"normal",clientId:"client3",date:Timestamp.fromDate(new 
Date("2025-01-18")),createdAt:serverTimestamp()},{id:"msg4",subject:"Invoice 
Query",from:"l.williams@metrologistics.co.za",to:$,content:"Please provide a breakdown of the January invoice for 
learnership training.",status:"read",priority:"normal",clientId:"client4",date:Timestamp.fromDate(new 
Date("2025-01-15")),createdAt:serverTimestamp()}];for(const it of 
st){const{id:nt,...ct}=it;mt.set(doc(db,"messages",nt),ct)}return await mt.commit(),console.log("Seed data created 
successfully!"),{success:!0,message:"Seed data with 5 clients created successfully!"}}catch(_){throw 
console.error("Error seeding data:",_),_}},resetAndSeed=async(s={})=>{try{await clearAllData();const e=await 
seedAllData(s);return{success:!0,message:"Data reset and seeded successfully with 5 clients!"}}catch(e){throw 
console.error("Error in reset and seed:",e),e}},PRODUCT_LINE_TO_TEMPLATE_MAP={learnerships:"learnership",tapBusiness:"s
ubscription",compliance:"once-off-training",otherCourses:"once-off-training",consulting:"consulting"},DEFAULT_VALUES_BY
_TEMPLATE={learnership:{duration:12,costPerLearner:35e3},subscription:{contractMonths:12,monthlyFee:5e3},"once-off-trai
ning":{attendees:1,costPerAttendee:3500},consulting:{hours:8,ratePerHour:1500}},getMigrationStatus=async()=>{try{const 
s=collection(db,"products"),i=(await getDocs(s)).docs.map(c=>({id:c.id,...c.data()})),a=i.filter(c=>c.calculationTempla
teId),o=i.filter(c=>!c.calculationTemplateId);return{total:i.length,migratedCount:a.length,notMigratedCount:o.length,mi
grated:a.map(c=>({id:c.id,name:c.name,templateId:c.calculationTemplateId})),notMigrated:o.map(c=>({id:c.id,name:c.name,
productLineId:c.productLineId,suggestedTemplate:PRODUCT_LINE_TO_TEMPLATE_MAP[c.productLineId]||"once-off-training"}))}}
catch(s){throw console.error("Error getting migration status:",s),s}},migrateAllProducts=async(s=!1)=>{try{const 
e=collection(db,"products"),i=await 
getDocs(e),a={total:i.docs.length,migrated:[],skipped:[],errors:[]},o=writeBatch(db);let c=0;const d=500;for(const h 
of i.docs){const j=h.data();if(j.calculationTemplateId){a.skipped.push({id:h.id,name:j.name,reason:"Already 
migrated"});continue}const _=PRODUCT_LINE_TO_TEMPLATE_MAP[j.productLineId]||"once-off-training";if(!DEFAULT_CALCULATION
_TEMPLATES[_]){a.errors.push({id:h.id,name:j.name,error:`Unknown template: ${_}`});continue}const $=DEFAULT_VALUES_BY_T
EMPLATE[_]||{};if(s)a.migrated.push({id:h.id,name:j.name,templateId:_,defaultValues:$,dryRun:!0});else{const rt=doc(db,
"products",h.id);o.update(rt,{calculationTemplateId:_,defaultValues:$,customLists:{},migratedAt:serverTimestamp(),migra
tedFrom:"legacy-system"}),a.migrated.push({id:h.id,name:j.name,templateId:_,defaultValues:$}),c++,c>=d&&(await 
o.commit(),c=0)}}return!s&&c>0&&await o.commit(),a}catch(e){throw console.error("Error migrating all 
products:",e),e}},verifyMigration=async()=>{try{const s=collection(db,"products"),e=await 
getDocs(s),i={valid:[],invalid:[],missing:[]};for(const a of e.docs){const o=a.data();if(!o.calculationTemplateId){i.mi
ssing.push({id:a.id,name:o.name,productLineId:o.productLineId});continue}const c=DEFAULT_CALCULATION_TEMPLATES[o.calcul
ationTemplateId];if(!c){i.invalid.push({id:a.id,name:o.name,templateId:o.calculationTemplateId,error:"Template not foun
d"});continue}i.valid.push({id:a.id,name:o.name,templateId:o.calculationTemplateId,templateName:c.name})}return{isCompl
ete:i.missing.length===0&&i.invalid.length===0,summary:{valid:i.valid.length,invalid:i.invalid.length,missing:i.missing
.length},details:i}}catch(s){throw console.error("Error verifying migration:",s),s}},SeedData=()=>{var ct,xt;const[s,e]
=reactExports.useState(!1),[i,a]=reactExports.useState(!0),[o,c]=reactExports.useState(""),[d,h]=reactExports.useState(
""),[j,_]=reactExports.useState([]),[$,rt]=reactExports.useState({salesPerson1:"",salesPerson2:"",admin:"",manager:""})
,[tt,mt]=reactExports.useState(null),[vt,_t]=reactExports.useState(!1),[wt,ht]=reactExports.useState("");reactExports.u
seEffect(()=>{dt()},[]);const dt=async()=>{var yt,Tt,fs,cs;a(!0),h("");try{const 
Es=auth.currentUser;if(console.log("=== DEBUGGING USER LOAD ==="),console.log("Current authenticated 
user:",Es?{uid:Es.uid,email:Es.email,displayName:Es.displayName}:"NOT LOGGED IN"),console.log("Firebase config 
check:",{projectId:"speccon-crm",authDomain:"speccon-crm.firebaseapp.com",hasConfig:!0}),!Es)throw new Error("You must 
be logged in to load users. Please log in first.");console.log("Attempting to query Firestore users 
collection...");const ls=await getDocs(collection(db,"users"));console.log("Users query result:",{size:ls.size,empty:ls
.empty,docs:ls.docs.map(ss=>({id:ss.id,email:ss.data().email,displayName:ss.data().displayName}))});const 
Yt=ls.docs.map(ss=>({id:ss.id,...ss.data()}));console.log("Processed users list:",Yt),_(Yt);const Mt=Yt.find(ss=>{var 
ys,Et;return((ys=ss.email)==null?void 0:ys.toLowerCase().includes("sales"))||((Et=ss.title)==null?void 
0:Et.toLowerCase().includes("sales"))}),Gt=Yt.find(ss=>{var ys,Et;return ss.id!==(Mt==null?void 
0:Mt.id)&&(((ys=ss.email)==null?void 0:ys.toLowerCase().includes("sales"))||((Et=ss.title)==null?void 
0:Et.toLowerCase().includes("sales")))}),Wt=Yt.find(ss=>{var ys,Et;return((ys=ss.email)==null?void 
0:ys.toLowerCase().includes("admin"))||((Et=ss.title)==null?void 
0:Et.toLowerCase().includes("admin"))}),ms=Yt.find(ss=>{var ys,Et;return((ys=ss.email)==null?void 
0:ys.toLowerCase().includes("manager"))||((Et=ss.title)==null?void 
0:Et.toLowerCase().includes("manager"))});rt({salesPerson1:(Mt==null?void 0:Mt.id)||((yt=Yt[0])==null?void 
0:yt.id)||"",salesPerson2:(Gt==null?void 0:Gt.id)||((Tt=Yt[1])==null?void 0:Tt.id)||"",admin:(Wt==null?void 
0:Wt.id)||((fs=Yt[2])==null?void 0:fs.id)||"",manager:(ms==null?void 0:ms.id)||((cs=Yt[3])==null?void 
0:cs.id)||""}),console.log("=== END DEBUG ===")}catch(Es){console.error("=== ERROR LOADING USERS 
==="),console.error("Error:",Es),console.error("Error 
details:",{code:Es.code,message:Es.message,stack:Es.stack}),console.error("=== END ERROR ===");let ls=`Failed to load 
users: ${Es.message||"Unknown error"}. `;Es.code==="permission-denied"?ls+="Permission denied. Check Firestore 
security rules allow reading users collection.":Es.code==="unavailable"&&(ls+="Firestore is unavailable. Check your 
internet connection and Firebase configuration."),ls+=" Check browser console (F12) for detailed error 
information.",h(ls)}finally{a(!1)}},jt=yt=>{if(!yt)return null;const Tt=j.find(fs=>fs.id===yt);return 
Tt?Tt.displayName||Tt.email||Tt.id:null},bt=async()=>{if(window.confirm("This will DELETE all existing data and 
replace it with seed data. Are you sure?")){if(!$.salesPerson1||!$.salesPerson2){h("Please select at least two 
salesperson users");return}e(!0),c(""),h("");try{const yt=await resetAndSeed($);c(yt.message||"Data reset and seeded 
successfully!")}catch(yt){h(yt.message||"Failed to reset and seed 
data")}finally{e(!1)}}},ut=async()=>{if(window.confirm("This will add seed data without deleting existing data. 
Continue?")){if(!$.salesPerson1||!$.salesPerson2){h("Please select at least two salesperson 
users");return}e(!0),c(""),h("");try{const yt=await seedAllData($);c(yt.message||"Seed data added 
successfully!")}catch(yt){h(yt.message||"Failed to seed data")}finally{e(!1)}}},Rt=async()=>{if(window.confirm("This 
will DELETE ALL DATA. This action cannot be undone. Are you absolutely sure?")){e(!0),c(""),h("");try{await 
clearAllData(),c("All data cleared successfully!")}catch(yt){h(yt.message||"Failed to clear 
data")}finally{e(!1)}}},st=async()=>{_t(!0),ht("");try{const yt=await getMigrationStatus();mt(yt)}catch(yt){ht(`Error 
checking status: ${yt.message}`)}finally{_t(!1)}},it=async(yt=!1)=>{if(!(!yt&&!window.confirm("This will update all 
products to use the new template system. Continue?"))){_t(!0),ht("");try{const Tt=await 
migrateAllProducts(yt);ht(yt?`Dry run complete: ${Tt.migrated.length} products would be migrated`:`Migration complete: 
${Tt.migrated.length} products migrated, ${Tt.skipped.length} skipped, ${Tt.errors.length} errors`),await 
st()}catch(Tt){ht(`Migration failed: ${Tt.message}`)}finally{_t(!1)}}},nt=async()=>{_t(!0),ht("");try{const yt=await 
verifyMigration();yt.isComplete?ht(`Verification passed: All ${yt.summary.valid} products have valid 
templates`):ht(`Verification issues: ${yt.summary.invalid} invalid, ${yt.summary.missing} missing 
templates`)}catch(yt){ht(`Verification failed: ${yt.message}`)}finally{_t(!1)}};return 
jsxRuntimeExports.jsxs("div",{className:"seed-data",children:[jsxRuntimeExports.jsx("h1",{children:"Seed Data Managemen
t"}),jsxRuntimeExports.jsxs("div",{className:"seed-data-content",children:[jsxRuntimeExports.jsxs("div",{className:"war
ning-box",children:[jsxRuntimeExports.jsx("h3",{children:"âšï¸ Warning"}),jsxRuntimeExports.jsx("p",{children:"These 
operations will modify your Firestore database. Use with caution in production environments."})]}),jsxRuntimeExports.js
xs("div",{className:"seed-info",children:[jsxRuntimeExports.jsx("h2",{children:"Seed Data Includes:"}),jsxRuntimeExport
s.jsxs("ul",{children:[jsxRuntimeExports.jsxs("li",{children:[jsxRuntimeExports.jsx("strong",{children:"5 Clients"})," 
- Mix of Corporate and School types with different statuses (Active, 
Prospect)"]}),jsxRuntimeExports.jsxs("li",{children:[jsxRuntimeExports.jsx("strong",{children:"13 Client 
Financials"})," - Detailed forecasts per product line with deal 
details"]}),jsxRuntimeExports.jsxs("li",{children:[jsxRuntimeExports.jsx("strong",{children:"5 Deals"})," - 
Distributed across pipeline stages (Discovery, Qualification, Proposal, 
Negotiation)"]}),jsxRuntimeExports.jsxs("li",{children:[jsxRuntimeExports.jsx("strong",{children:"15 Quotes"})," - 
Historical quotes with Accepted, Sent, and Pending 
statuses"]}),jsxRuntimeExports.jsxs("li",{children:[jsxRuntimeExports.jsx("strong",{children:"22 Invoices"})," - 
Comprehensive history with Paid, Pending, and Unpaid 
statuses"]}),jsxRuntimeExports.jsxs("li",{children:[jsxRuntimeExports.jsx("strong",{children:"5 Follow-Up Tasks"})," - 
Pending tasks with varying 
priorities"]}),jsxRuntimeExports.jsxs("li",{children:[jsxRuntimeExports.jsx("strong",{children:"4 Messages"})," - 
Different statuses and 
priorities"]}),jsxRuntimeExports.jsxs("li",{children:[jsxRuntimeExports.jsx("strong",{children:"4 Feedback"})," - 
Client comments and notes"]})]})]}),jsxRuntimeExports.jsxs("div",{className:"action-buttons",children:[jsxRuntimeExport
s.jsx("button",{className:"btn btn-primary",onClick:bt,disabled:s,children:s?"Processing...":"Reset & Seed 
Data"}),jsxRuntimeExports.jsx("button",{className:"btn 
btn-secondary",onClick:ut,disabled:s,children:s?"Processing...":"Add Seed Data 
Only"}),jsxRuntimeExports.jsx("button",{className:"btn 
btn-danger",onClick:Rt,disabled:s,children:s?"Processing...":"Clear All 
Data"})]}),o&&jsxRuntimeExports.jsxs("div",{className:"success-message",children:["âœ“ 
",o]}),d&&jsxRuntimeExports.jsxs("div",{className:"error-message",children:["âœ— 
",d]}),jsxRuntimeExports.jsxs("div",{className:"user-selection",children:[jsxRuntimeExports.jsx("h3",{children:"Select 
User IDs for Seed Data"}),jsxRuntimeExports.jsx("p",{className:"user-note",children:"The seed data will assign clients 
and deals to these users. Select the appropriate users:"}),jsxRuntimeExports.jsxs("div",{style:{marginBottom:"15px",dis
play:"flex",gap:"10px",alignItems:"center"},children:[jsxRuntimeExports.jsx("button",{onClick:dt,className:"refresh-btn
",disabled:i,children:i?"Loading...":"ðŸ”„ Refresh 
Users"}),jsxRuntimeExports.jsx("span",{style:{color:"#666",fontSize:"0.9rem"},children:j.length>0?`Found ${j.length} 
user(s)`:"No users loaded"})]}),i?jsxRuntimeExports.jsx("div",{className:"loading-users",children:"Loading users from F
irestore..."}):j.length===0?jsxRuntimeExports.jsxs("div",{className:"no-users-warning",children:[jsxRuntimeExports.jsx(
"p",{children:"âšï¸ No users found in the 
database."}),jsxRuntimeExports.jsx("p",{children:jsxRuntimeExports.jsx("strong",{children:"Possible issues:"})}),jsxRun
timeExports.jsxs("ul",{style:{marginLeft:"20px",marginTop:"10px"},children:[jsxRuntimeExports.jsx("li",{children:"Fireb
ase connection may not be configured correctly"}),jsxRuntimeExports.jsx("li",{children:"Users may not exist in the 
Firestore 'users' collection"}),jsxRuntimeExports.jsx("li",{children:"Firestore security rules may be blocking 
access"}),jsxRuntimeExports.jsx("li",{children:"You may not be logged 
in"})]}),jsxRuntimeExports.jsxs("p",{style:{marginTop:"15px"},children:[jsxRuntimeExports.jsx("strong",{children:"To 
fix:"})," Check your browser console (F12) for error messages. Users are automatically created when you log in. Make 
sure you have logged in at least once."]}),jsxRuntimeExports.jsxs("div",{style:{marginTop:"15px",padding:"10px",backgro
und:"#f0f0f0",borderRadius:"5px"},children:[jsxRuntimeExports.jsxs("p",{style:{margin:"5px 
0"},children:[jsxRuntimeExports.jsx("strong",{children:"Firebase Project:"})," 
","speccon-crm"]}),jsxRuntimeExports.jsxs("p",{style:{margin:"5px 
0"},children:[jsxRuntimeExports.jsx("strong",{children:"Auth Domain:"})," 
","speccon-crm.firebaseapp.com"]}),jsxRuntimeExports.jsxs("p",{style:{margin:"5px 
0"},children:[jsxRuntimeExports.jsx("strong",{children:"Logged in as:"})," ",((ct=auth.currentUser)==null?void 
0:ct.email)||"Not logged in"]})]})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.js
xs("div",{className:"user-inputs",children:[jsxRuntimeExports.jsxs("div",{className:"user-input-group",children:[jsxRun
timeExports.jsxs("label",{children:["Sales Person 1: ",jsxRuntimeExports.jsx("span",{className:"required",children:"*"}
)]}),jsxRuntimeExports.jsxs("select",{value:$.salesPerson1,onChange:yt=>rt({...$,salesPerson1:yt.target.value}),classNa
me:"user-select",children:[jsxRuntimeExports.jsx("option",{value:"",children:"Select user..."}),j.map(yt=>jsxRuntimeExp
orts.jsx("option",{value:yt.id,children:yt.displayName||yt.email||yt.id},yt.id))]}),$.salesPerson1&&jsxRuntimeExports.j
sxs("div",{className:"selected-user-info",children:["Selected: ",jsxRuntimeExports.jsx("strong",{children:jt($.salesPer
son1)})]})]}),jsxRuntimeExports.jsxs("div",{className:"user-input-group",children:[jsxRuntimeExports.jsxs("label",{chil
dren:["Sales Person 2: ",jsxRuntimeExports.jsx("span",{className:"required",children:"*"})]}),jsxRuntimeExports.jsxs("s
elect",{value:$.salesPerson2,onChange:yt=>rt({...$,salesPerson2:yt.target.value}),className:"user-select",children:[jsx
RuntimeExports.jsx("option",{value:"",children:"Select user..."}),j.map(yt=>jsxRuntimeExports.jsx("option",{value:yt.id
,children:yt.displayName||yt.email||yt.id},yt.id))]}),$.salesPerson2&&jsxRuntimeExports.jsxs("div",{className:"selected
-user-info",children:["Selected: ",jsxRuntimeExports.jsx("strong",{children:jt($.salesPerson2)})]})]}),jsxRuntimeExport
s.jsxs("div",{className:"user-input-group",children:[jsxRuntimeExports.jsxs("label",{children:["Admin: ",jsxRuntimeExpo
rts.jsx("span",{className:"optional",children:"(Optional)"})]}),jsxRuntimeExports.jsxs("select",{value:$.admin,onChange
:yt=>rt({...$,admin:yt.target.value}),className:"user-select",children:[jsxRuntimeExports.jsx("option",{value:"",childr
en:"Select user..."}),j.map(yt=>jsxRuntimeExports.jsx("option",{value:yt.id,children:yt.displayName||yt.email||yt.id},y
t.id))]}),$.admin&&jsxRuntimeExports.jsxs("div",{className:"selected-user-info",children:["Selected: ",jsxRuntimeExport
s.jsx("strong",{children:jt($.admin)})]})]}),jsxRuntimeExports.jsxs("div",{className:"user-input-group",children:[jsxRu
ntimeExports.jsxs("label",{children:["Manager: ",jsxRuntimeExports.jsx("span",{className:"optional",children:"(Optional
)"})]}),jsxRuntimeExports.jsxs("select",{value:$.manager,onChange:yt=>rt({...$,manager:yt.target.value}),className:"use
r-select",children:[jsxRuntimeExports.jsx("option",{value:"",children:"Select user..."}),j.map(yt=>jsxRuntimeExports.js
x("option",{value:yt.id,children:yt.displayName||yt.email||yt.id},yt.id))]}),$.manager&&jsxRuntimeExports.jsxs("div",{c
lassName:"selected-user-info",children:["Selected: ",jsxRuntimeExports.jsx("strong",{children:jt($.manager)})]})]})]}),
($.salesPerson1||$.salesPerson2)&&jsxRuntimeExports.jsxs("div",{className:"selected-users-summary",children:[jsxRuntime
Exports.jsx("h4",{children:"Selected Users Summary:"}),jsxRuntimeExports.jsxs("ul",{children:[$.salesPerson1&&jsxRuntim
eExports.jsxs("li",{children:[jsxRuntimeExports.jsx("strong",{children:"Sales Person 1:"})," ",jt($.salesPerson1)]}),$.
salesPerson2&&jsxRuntimeExports.jsxs("li",{children:[jsxRuntimeExports.jsx("strong",{children:"Sales Person 2:"})," ",j
t($.salesPerson2)]}),$.admin&&jsxRuntimeExports.jsxs("li",{children:[jsxRuntimeExports.jsx("strong",{children:"Admin:"}
)," ",jt($.admin)]}),$.manager&&jsxRuntimeExports.jsxs("li",{children:[jsxRuntimeExports.jsx("strong",{children:"Manage
r:"})," ",jt($.manager)]})]})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"instructions",children:[jsxRuntimeExpor
ts.jsx("h3",{children:"Instructions:"}),jsxRuntimeExports.jsxs("ol",{children:[jsxRuntimeExports.jsxs("li",{children:[j
sxRuntimeExports.jsx("strong",{children:"Select Users:"})," Choose the users above that will be assigned to seed data 
(at least Sales Person 1 and 2 are 
required)."]}),jsxRuntimeExports.jsxs("li",{children:[jsxRuntimeExports.jsx("strong",{children:"Reset & Seed 
Data:"})," Deletes all existing data and creates fresh seed data. Use this for a clean 
start."]}),jsxRuntimeExports.jsxs("li",{children:[jsxRuntimeExports.jsx("strong",{children:"Add Seed Data Only:"})," 
Adds seed data without deleting existing data. Useful if you want to keep some existing 
data."]}),jsxRuntimeExports.jsxs("li",{children:[jsxRuntimeExports.jsx("strong",{children:"Clear All Data:"})," 
Deletes all data without adding seed data. Use with extreme caution!"]})]}),jsxRuntimeExports.jsxs("p",{className:"note
",children:[jsxRuntimeExports.jsx("strong",{children:"Note:"})," The system will automatically try to detect users 
based on email/title, but you can manually select them above."]})]}),jsxRuntimeExports.jsxs("div",{className:"migration
-section",style:{marginTop:"40px",padding:"20px",background:"#f0f7ff",borderRadius:"8px",border:"1px solid 
#c0d8f0"},children:[jsxRuntimeExports.jsx("h2",{style:{marginTop:0,color:"#12265E"},children:"Product Template 
Migration"}),jsxRuntimeExports.jsx("p",{style:{color:"#666"},children:"Migrate existing products to use the new 
calculation template system. This assigns a calculation template to each product based on its product line."}),jsxRunti
meExports.jsxs("div",{style:{display:"flex",gap:"10px",marginBottom:"20px",flexWrap:"wrap"},children:[jsxRuntimeExports
.jsx("button",{className:"btn btn-secondary",onClick:st,disabled:vt,children:vt?"Loading...":"Check 
Status"}),jsxRuntimeExports.jsx("button",{className:"btn btn-secondary",onClick:()=>it(!0),disabled:vt,children:"Dry 
Run"}),jsxRuntimeExports.jsx("button",{className:"btn 
btn-primary",onClick:()=>it(!1),disabled:vt,children:vt?"Migrating...":"Migrate All 
Products"}),jsxRuntimeExports.jsx("button",{className:"btn 
btn-secondary",onClick:nt,disabled:vt,children:"Verify"})]}),wt&&jsxRuntimeExports.jsx("div",{style:{padding:"12px 16px
",borderRadius:"6px",marginBottom:"16px",background:wt.includes("failed")||wt.includes("Error")?"#ffebee":"#e8f5e9",col
or:wt.includes("failed")||wt.includes("Error")?"#c62828":"#2e7d32"},children:wt}),tt&&jsxRuntimeExports.jsxs("div",{sty
le:{background:"#fff",padding:"16px",borderRadius:"6px",border:"1px solid 
#ddd"},children:[jsxRuntimeExports.jsx("h4",{style:{margin:"0 0 12px 0"},children:"Migration 
Status"}),jsxRuntimeExports.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"16px",marginBot
tom:"16px"},children:[jsxRuntimeExports.jsxs("div",{style:{textAlign:"center",padding:"12px",background:"#e3f2fd",borde
rRadius:"6px"},children:[jsxRuntimeExports.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"#1565c0"},child
ren:tt.total}),jsxRuntimeExports.jsx("div",{style:{fontSize:"0.85rem",color:"#666"},children:"Total Products"})]}),jsxR
untimeExports.jsxs("div",{style:{textAlign:"center",padding:"12px",background:"#e8f5e9",borderRadius:"6px"},children:[j
sxRuntimeExports.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"#2e7d32"},children:tt.migratedCount}),jsx
RuntimeExports.jsx("div",{style:{fontSize:"0.85rem",color:"#666"},children:"Migrated"})]}),jsxRuntimeExports.jsxs("div"
,{style:{textAlign:"center",padding:"12px",background:tt.notMigratedCount>0?"#fff3e0":"#e8f5e9",borderRadius:"6px"},chi
ldren:[jsxRuntimeExports.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"bold",color:tt.notMigratedCount>0?"#ef6c00":"#
2e7d32"},children:tt.notMigratedCount}),jsxRuntimeExports.jsx("div",{style:{fontSize:"0.85rem",color:"#666"},children:"
Not Migrated"})]})]}),((xt=tt.notMigrated)==null?void 
0:xt.length)>0&&jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h5",{style:{margin:"12px 0 
8px"},children:"Products Pending Migration:"}),jsxRuntimeExports.jsxs("ul",{style:{margin:0,paddingLeft:"20px",maxHeigh
t:"150px",overflowY:"auto"},children:[tt.notMigrated.slice(0,10).map(yt=>jsxRuntimeExports.jsxs("li",{style:{fontSize:"
0.9rem",marginBottom:"4px"},children:[yt.name," 
",jsxRuntimeExports.jsxs("span",{style:{color:"#666"},children:["(suggested: ",yt.suggestedTemplate,")"]})]},yt.id)),tt
.notMigrated.length>10&&jsxRuntimeExports.jsxs("li",{style:{color:"#666",fontStyle:"italic"},children:["...and 
",tt.notMigrated.length-10," more"]})]})]})]})]})]})]})},CalculationTemplateManagement=()=>{var Mt,Gt,Wt,ms,ss,ys,Et,gt
;const{isSystemAdmin:s}=useTenant(),[e,i]=reactExports.useState([]),[a,o]=reactExports.useState(!0),[c,d]=reactExports.
useState(!1),[h,j]=reactExports.useState("list"),[_,$]=reactExports.useState(null),[rt,tt]=reactExports.useState(!1),[m
t,vt]=reactExports.useState({}),[_t,wt]=reactExports.useState({}),[ht,dt]=reactExports.useState(""),[jt,bt]=reactExport
s.useState(null),[ut,Rt]=reactExports.useState({name:"",description:"",status:"active",version:"1.0",fields:[],costFiel
ds:[],formula:{type:"simple",expression:"",description:""},distributionType:"once-off",hasPaymentFrequency:!1,hasCertai
ntyPercentage:!0,hasContractDuration:!1,modalWidth:"standard",showBreakdownPreview:!0,systemLists:{},defaultCustomLists
:{}});reactExports.useEffect(()=>{st()},[]);const st=async()=>{try{o(!0);const ft=await 
getCalculationTemplates();i(ft)}catch(ft){console.error("Error loading 
templates:",ft)}finally{o(!1)}},it=async()=>{if(window.confirm("This will create the default calculation templates. 
Continue?"))try{d(!0);const ft=await initializeCalculationTemplates();await st(),dt(`Successfully initialized ${ft} 
calculation templates!`),setTimeout(()=>dt(""),5e3)}catch(ft){console.error("Error initializing 
templates:",ft),dt("Failed to initialize templates. Please try again.")}finally{d(!1)}},nt=async ft=>{try{const 
zt=await getCalculationTemplate(ft);$(zt),j("view");const 
Ct={},Pt={};zt.fields&&zt.fields.forEach($t=>{Ct[$t.id]=$t.default||""}),zt.costFields&&zt.costFields.forEach($t=>{var 
Bt;Pt[$t.id]=0,$t.hasFrequency&&(Pt[`${$t.id}Frequency`]=((Bt=$t.frequencyOptions)==null?void 
0:Bt[0])||"Once-off")}),vt(Ct),wt(Pt)}catch(zt){console.error("Error viewing template:",zt)}},ct=ft=>{bt(ft),Rt({name:f
t.name||"",description:ft.description||"",status:ft.status||"active",version:ft.version||"1.0",fields:ft.fields||[],cos
tFields:ft.costFields||[],formula:ft.formula||{type:"simple",expression:"",description:""},distributionType:ft.distribu
tionType||"once-off",hasPaymentFrequency:ft.hasPaymentFrequency||!1,hasCertaintyPercentage:ft.hasCertaintyPercentage!==
!1,hasContractDuration:ft.hasContractDuration||!1,modalWidth:ft.modalWidth||"standard",showBreakdownPreview:ft.showBrea
kdownPreview!==!1,systemLists:ft.systemLists||{},defaultCustomLists:ft.defaultCustomLists||{}}),j("edit")},xt=async 
ft=>{if(window.confirm("Are you sure you want to archive this template? It will no longer be available for new 
products."))try{d(!0),await archiveCalculationTemplate(ft),await st(),(_==null?void 
0:_.id)===ft&&($(null),j("list"))}catch(zt){console.error("Error archiving 
template:",zt)}finally{d(!1)}},yt=async()=>{if(!ut.name.trim()){alert("Template name is 
required");return}try{if(d(!0),jt)await updateCalculationTemplate(jt.id,ut);else{const 
ft=ut.name.toLowerCase().replace(/\s+/g,"-");await createCalculationTemplateWithId(ft,ut)}await 
st(),j("list"),bt(null),dt("Template saved successfully!"),setTimeout(()=>dt(""),3e3)}catch(ft){console.error("Error 
saving template:",ft),alert("Failed to save template. Please try again.")}finally{d(!1)}},Tt=(ft,zt)=>{vt(Ct=>({...Ct,[
ft]:zt}))},fs=(ft,zt)=>{wt(Ct=>({...Ct,[ft]:zt}))},cs=()=>_?calculateTemplateTotal(_,mt):0,Es=()=>{if(!_)return{totalCo
sts:0,breakdown:{}};const ft=cs();return calculateTemplateCosts(_,_t,ft)},ls=ft=>new Intl.NumberFormat("en-ZA",{style:"
currency",currency:"ZAR",minimumFractionDigits:0}).format(ft||0),Yt=ft=>({text:"Text",number:"Number",currency:"Currenc
y (R)",percentage:"Percentage (%)",date:"Date",select:"Dropdown List"})[ft]||ft;return 
s?a?jsxRuntimeExports.jsx("div",{className:"page-loading",children:"Loading calculation templates..."}):jsxRuntimeExpor
ts.jsxs("div",{className:"calculation-template-management-page",children:[jsxRuntimeExports.jsxs("div",{className:"page
-header",children:[jsxRuntimeExports.jsxs("div",{className:"header-content",children:[jsxRuntimeExports.jsx("h1",{child
ren:"Calculation Templates"}),jsxRuntimeExports.jsx("p",{children:"Define calculation methods that can be used by 
products across all tenants"})]}),jsxRuntimeExports.jsx("div",{className:"header-actions",children:e.length===0&&jsxRun
timeExports.jsx("button",{className:"btn btn-primary",onClick:it,disabled:c,children:c?"Initializing...":"Initialize 
Default Templates"})})]}),ht&&jsxRuntimeExports.jsx("div",{className:`init-message ${ht.includes("Failed")?"error":"suc
cess"}`,children:ht}),jsxRuntimeExports.jsxs("div",{className:"tabs",children:[jsxRuntimeExports.jsx("button",{classNam
e:`tab ${h==="list"?"active":""}`,onClick:()=>j("list"),children:"All 
Templates"}),_&&jsxRuntimeExports.jsxs("button",{className:`tab 
${h==="view"?"active":""}`,onClick:()=>j("view"),children:["View: 
",_.name]}),jt&&jsxRuntimeExports.jsxs("button",{className:`tab 
${h==="edit"?"active":""}`,onClick:()=>j("edit"),children:["Edit: ",jt.name]})]}),h==="list"&&jsxRuntimeExports.jsx("di
v",{className:"tab-content",children:e.length===0?jsxRuntimeExports.jsxs("div",{className:"empty-state",children:[jsxRu
ntimeExports.jsx("h3",{children:"No Calculation Templates"}),jsxRuntimeExports.jsx("p",{children:'Click "Initialize 
Default Templates" to create the standard templates, or create a new template 
manually.'})]}):jsxRuntimeExports.jsx("div",{className:"templates-grid",children:e.map(ft=>{var zt,Ct,Pt,$t;return 
jsxRuntimeExports.jsxs("div",{className:`template-card ${ft.status==="archived"?"archived":""}`,children:[jsxRuntimeExp
orts.jsxs("div",{className:"template-card-header",children:[jsxRuntimeExports.jsx("h3",{children:ft.name}),jsxRuntimeEx
ports.jsx("span",{className:`status-badge ${ft.status}`,children:ft.status})]}),jsxRuntimeExports.jsx("p",{className:"t
emplate-description",children:ft.description||"No description"}),jsxRuntimeExports.jsxs("div",{className:"template-meta
",children:[jsxRuntimeExports.jsxs("span",{className:"meta-item",children:[jsxRuntimeExports.jsx("strong",{children:"Ve
rsion:"})," ",ft.version||"1.0"]}),jsxRuntimeExports.jsxs("span",{className:"meta-item",children:[jsxRuntimeExports.jsx
("strong",{children:"Distribution:"})," ",ft.distributionType||"once-off"]}),jsxRuntimeExports.jsxs("span",{className:"
meta-item",children:[jsxRuntimeExports.jsx("strong",{children:"Fields:"})," ",((zt=ft.fields)==null?void 0:zt.length)||
0]}),jsxRuntimeExports.jsxs("span",{className:"meta-item",children:[jsxRuntimeExports.jsx("strong",{children:"Cost 
Items:"})," ",((Ct=ft.costFields)==null?void 0:Ct.length)||0]})]}),jsxRuntimeExports.jsxs("div",{className:"template-fo
rmula",children:[jsxRuntimeExports.jsx("strong",{children:"Formula:"})," ",((Pt=ft.formula)==null?void 
0:Pt.description)||(($t=ft.formula)==null?void 0:$t.expression)||"Not defined"]}),jsxRuntimeExports.jsxs("div",{classNa
me:"template-actions",children:[jsxRuntimeExports.jsx("button",{className:"btn btn-secondary 
btn-sm",onClick:()=>nt(ft.id),children:"View & Test"}),jsxRuntimeExports.jsx("button",{className:"btn btn-secondary 
btn-sm",onClick:()=>ct(ft),children:"Edit"}),ft.status!=="archived"&&jsxRuntimeExports.jsx("button",{className:"btn 
btn-danger btn-sm",onClick:()=>xt(ft.id),disabled:c,children:"Archive"})]})]},ft.id)})})}),h==="view"&&_&&jsxRuntimeExp
orts.jsx("div",{className:"tab-content",children:jsxRuntimeExports.jsxs("div",{className:"template-view",children:[jsxR
untimeExports.jsxs("div",{className:"view-header",children:[jsxRuntimeExports.jsx("h2",{children:_.name}),jsxRuntimeExp
orts.jsxs("div",{className:"view-actions",children:[jsxRuntimeExports.jsx("button",{className:"btn 
btn-secondary",onClick:()=>tt(!rt),children:rt?"Hide Preview":"Show Calculation 
Preview"}),jsxRuntimeExports.jsx("button",{className:"btn btn-primary",onClick:()=>ct(_),children:"Edit Template"})]})]
}),jsxRuntimeExports.jsxs("div",{className:"template-details",children:[jsxRuntimeExports.jsxs("div",{className:"detail
-section",children:[jsxRuntimeExports.jsx("h3",{children:"Basic Information"}),jsxRuntimeExports.jsxs("div",{className:
"detail-grid",children:[jsxRuntimeExports.jsxs("div",{className:"detail-item",children:[jsxRuntimeExports.jsx("label",{
children:"Description"}),jsxRuntimeExports.jsx("p",{children:_.description||"No description"})]}),jsxRuntimeExports.jsx
s("div",{className:"detail-item",children:[jsxRuntimeExports.jsx("label",{children:"Version"}),jsxRuntimeExports.jsx("p
",{children:_.version})]}),jsxRuntimeExports.jsxs("div",{className:"detail-item",children:[jsxRuntimeExports.jsx("label
",{children:"Status"}),jsxRuntimeExports.jsx("p",{children:jsxRuntimeExports.jsx("span",{className:`status-badge ${_.st
atus}`,children:_.status})})]}),jsxRuntimeExports.jsxs("div",{className:"detail-item",children:[jsxRuntimeExports.jsx("
label",{children:"Distribution Type"}),jsxRuntimeExports.jsx("p",{children:_.distributionType})]})]})]}),jsxRuntimeExpo
rts.jsxs("div",{className:"detail-section",children:[jsxRuntimeExports.jsxs("h3",{children:["Input Fields 
(",((Mt=_.fields)==null?void 0:Mt.length)||0,")"]}),jsxRuntimeExports.jsxs("table",{className:"fields-table",children:[
jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("th",{children:"Fi
eld ID"}),jsxRuntimeExports.jsx("th",{children:"Display Name"}),jsxRuntimeExports.jsx("th",{children:"Type"}),jsxRuntim
eExports.jsx("th",{children:"Required"}),jsxRuntimeExports.jsx("th",{children:"Default"}),jsxRuntimeExports.jsx("th",{c
hildren:"List Key"})]})}),jsxRuntimeExports.jsx("tbody",{children:(Gt=_.fields)==null?void 0:Gt.map(ft=>jsxRuntimeExpor
ts.jsxs("tr",{children:[jsxRuntimeExports.jsx("td",{children:jsxRuntimeExports.jsx("code",{children:ft.id})}),jsxRuntim
eExports.jsx("td",{children:ft.name}),jsxRuntimeExports.jsx("td",{children:Yt(ft.type)}),jsxRuntimeExports.jsx("td",{ch
ildren:ft.required?"Yes":"No"}),jsxRuntimeExports.jsx("td",{children:ft.default!==void 0?String(ft.default):"-"}),jsxRu
ntimeExports.jsx("td",{children:ft.listKey?jsxRuntimeExports.jsx("code",{children:ft.listKey}):"-"})]},ft.id))})]})]}),
jsxRuntimeExports.jsxs("div",{className:"detail-section",children:[jsxRuntimeExports.jsxs("h3",{children:["Cost Fields 
(",((Wt=_.costFields)==null?void 0:Wt.length)||0,")"]}),jsxRuntimeExports.jsxs("table",{className:"fields-table",childr
en:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("th",{children
:"Field ID"}),jsxRuntimeExports.jsx("th",{children:"Display 
Name"}),jsxRuntimeExports.jsx("th",{children:"Type"}),jsxRuntimeExports.jsx("th",{children:"Has 
Frequency"}),jsxRuntimeExports.jsx("th",{children:"Is 
Percentage"})]})}),jsxRuntimeExports.jsx("tbody",{children:(ms=_.costFields)==null?void 0:ms.map(ft=>jsxRuntimeExports.
jsxs("tr",{children:[jsxRuntimeExports.jsx("td",{children:jsxRuntimeExports.jsx("code",{children:ft.id})}),jsxRuntimeEx
ports.jsx("td",{children:ft.name}),jsxRuntimeExports.jsx("td",{children:Yt(ft.type)}),jsxRuntimeExports.jsx("td",{child
ren:ft.hasFrequency?"Yes":"No"}),jsxRuntimeExports.jsx("td",{children:ft.isPercentage?`Yes (of ${ft.percentageOf})`:"No
"})]},ft.id))})]})]}),jsxRuntimeExports.jsxs("div",{className:"detail-section",children:[jsxRuntimeExports.jsx("h3",{ch
ildren:"Formula"}),jsxRuntimeExports.jsxs("div",{className:"formula-display",children:[jsxRuntimeExports.jsxs("div",{cl
assName:"formula-expression",children:[jsxRuntimeExports.jsx("label",{children:"Expression:"}),jsxRuntimeExports.jsx("c
ode",{children:(ss=_.formula)==null?void 0:ss.expression})]}),jsxRuntimeExports.jsxs("div",{className:"formula-descript
ion",children:[jsxRuntimeExports.jsx("label",{children:"Description:"}),jsxRuntimeExports.jsx("p",{children:(ys=_.formu
la)==null?void 0:ys.description})]})]})]}),(Object.keys(_.systemLists||{}).length>0||Object.keys(_.defaultCustomLists||
{}).length>0)&&jsxRuntimeExports.jsxs("div",{className:"detail-section",children:[jsxRuntimeExports.jsx("h3",{children:
"Lists"}),Object.entries(_.systemLists||{}).map(([ft,zt])=>jsxRuntimeExports.jsxs("div",{className:"list-display",child
ren:[jsxRuntimeExports.jsxs("label",{children:[ft," 
",jsxRuntimeExports.jsx("span",{className:"list-type",children:"(System - Read Only)"})]}),jsxRuntimeExports.jsx("ul",{
children:zt.map(Ct=>jsxRuntimeExports.jsx("li",{children:Ct.name},Ct.id))})]},ft)),Object.entries(_.defaultCustomLists|
|{}).map(([ft,zt])=>jsxRuntimeExports.jsxs("div",{className:"list-display",children:[jsxRuntimeExports.jsxs("label",{ch
ildren:[ft," ",jsxRuntimeExports.jsx("span",{className:"list-type",children:"(Tenant Configurable)"})]}),jsxRuntimeExpo
rts.jsx("ul",{children:zt.map(Ct=>jsxRuntimeExports.jsx("li",{children:Ct.name},Ct.id))})]},ft))]})]}),rt&&jsxRuntimeEx
ports.jsxs("div",{className:"calculation-preview",children:[jsxRuntimeExports.jsx("h3",{children:"Calculation 
Preview"}),jsxRuntimeExports.jsx("p",{className:"preview-description",children:"Test the calculation by entering 
values below. This shows how the calculation modal will work."}),jsxRuntimeExports.jsxs("div",{className:"preview-grid"
,children:[jsxRuntimeExports.jsxs("div",{className:"preview-inputs",children:[jsxRuntimeExports.jsx("h4",{children:"Inp
ut Values"}),(Et=_.fields)==null?void 0:Et.map(ft=>{var zt,Ct;return 
jsxRuntimeExports.jsxs("div",{className:"preview-field",children:[jsxRuntimeExports.jsxs("label",{children:[ft.name," "
,ft.required&&jsxRuntimeExports.jsx("span",{className:"required",children:"*"})]}),ft.type==="select"?jsxRuntimeExports
.jsxs("select",{value:mt[ft.id]||"",onChange:Pt=>Tt(ft.id,Pt.target.value),children:[jsxRuntimeExports.jsx("option",{va
lue:"",children:"Select..."}),(((zt=_.defaultCustomLists)==null?void 0:zt[ft.listKey])||((Ct=_.systemLists)==null?void 
0:Ct[ft.listKey])||[]).map(Pt=>jsxRuntimeExports.jsx("option",{value:Pt.value,children:Pt.name},Pt.id))]}):ft.type==="d
ate"?jsxRuntimeExports.jsx("input",{type:"date",value:mt[ft.id]||"",onChange:Pt=>Tt(ft.id,Pt.target.value)}):jsxRuntime
Exports.jsx("input",{type:ft.type==="currency"||ft.type==="number"||ft.type==="percentage"?"number":"text",value:mt[ft.
id]||"",onChange:Pt=>Tt(ft.id,Pt.target.value),placeholder:ft.helpText})]},ft.id)}),jsxRuntimeExports.jsx("h4",{childre
n:"Cost Values"}),(gt=_.costFields)==null?void 0:gt.map(ft=>{var zt;return jsxRuntimeExports.jsxs("div",{className:"pre
view-field",children:[jsxRuntimeExports.jsx("label",{children:ft.name}),jsxRuntimeExports.jsxs("div",{className:"cost-f
ield-row",children:[jsxRuntimeExports.jsx("input",{type:"number",value:_t[ft.id]||"",onChange:Ct=>fs(ft.id,Ct.target.va
lue),placeholder:ft.isPercentage?"%":"R"}),ft.hasFrequency&&jsxRuntimeExports.jsx("select",{value:_t[`${ft.id}Frequency
`]||"",onChange:Ct=>fs(`${ft.id}Frequency`,Ct.target.value),children:(zt=ft.frequencyOptions)==null?void 0:zt.map(Ct=>j
sxRuntimeExports.jsx("option",{value:Ct,children:Ct},Ct))})]})]},ft.id)})]}),jsxRuntimeExports.jsxs("div",{className:"p
review-results",children:[jsxRuntimeExports.jsx("h4",{children:"Calculated Results"}),jsxRuntimeExports.jsxs("div",{cla
ssName:"result-card",children:[jsxRuntimeExports.jsx("label",{children:"Total 
Income"}),jsxRuntimeExports.jsx("span",{className:"result-value income",children:ls(cs())})]}),jsxRuntimeExports.jsxs("
div",{className:"result-card",children:[jsxRuntimeExports.jsx("label",{children:"Total 
Costs"}),jsxRuntimeExports.jsx("span",{className:"result-value 
costs",children:ls(Es().totalCosts)})]}),jsxRuntimeExports.jsxs("div",{className:"result-card 
highlight",children:[jsxRuntimeExports.jsx("label",{children:"Gross 
Profit"}),jsxRuntimeExports.jsx("span",{className:"result-value profit",children:ls(cs()-Es().totalCosts)})]}),Object.k
eys(Es().breakdown).length>0&&jsxRuntimeExports.jsxs("div",{className:"costs-breakdown",children:[jsxRuntimeExports.jsx
("h5",{children:"Cost Breakdown"}),Object.entries(Es().breakdown).map(([ft,zt])=>jsxRuntimeExports.jsxs("div",{classNam
e:"breakdown-item",children:[jsxRuntimeExports.jsx("span",{children:zt.label}),jsxRuntimeExports.jsx("span",{children:l
s(zt.amount)})]},ft))]})]})]})]})]})}),h==="edit"&&jsxRuntimeExports.jsx("div",{className:"tab-content",children:jsxRun
timeExports.jsxs("div",{className:"template-editor",children:[jsxRuntimeExports.jsxs("div",{className:"editor-header",c
hildren:[jsxRuntimeExports.jsx("h2",{children:jt?`Edit: ${jt.name}`:"New Template"}),jsxRuntimeExports.jsxs("div",{clas
sName:"editor-actions",children:[jsxRuntimeExports.jsx("button",{className:"btn 
btn-secondary",onClick:()=>{j("list"),bt(null)},children:"Cancel"}),jsxRuntimeExports.jsx("button",{className:"btn 
btn-primary",onClick:yt,disabled:c,children:c?"Saving...":"Save Template"})]})]}),jsxRuntimeExports.jsxs("div",{classNa
me:"editor-form",children:[jsxRuntimeExports.jsxs("div",{className:"form-section",children:[jsxRuntimeExports.jsx("h3",
{children:"Basic Information"}),jsxRuntimeExports.jsxs("div",{className:"form-grid",children:[jsxRuntimeExports.jsxs("d
iv",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Template Name *"}),jsxRuntimeExports.jsx
("input",{type:"text",value:ut.name,onChange:ft=>Rt(zt=>({...zt,name:ft.target.value})),placeholder:"e.g., Consulting S
ervice"})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Ve
rsion"}),jsxRuntimeExports.jsx("input",{type:"text",value:ut.version,onChange:ft=>Rt(zt=>({...zt,version:ft.target.valu
e})),placeholder:"1.0"})]}),jsxRuntimeExports.jsxs("div",{className:"form-group full-width",children:[jsxRuntimeExports
.jsx("label",{children:"Description"}),jsxRuntimeExports.jsx("textarea",{value:ut.description,onChange:ft=>Rt(zt=>({...
zt,description:ft.target.value})),placeholder:"Describe when this calculation template should be used",rows:"2"})]})]})
]}),jsxRuntimeExports.jsxs("div",{className:"form-section",children:[jsxRuntimeExports.jsx("h3",{children:"Calculation 
Settings"}),jsxRuntimeExports.jsxs("div",{className:"form-grid",children:[jsxRuntimeExports.jsxs("div",{className:"form
-group",children:[jsxRuntimeExports.jsx("label",{children:"Distribution Type"}),jsxRuntimeExports.jsxs("select",{value:
ut.distributionType,onChange:ft=>Rt(zt=>({...zt,distributionType:ft.target.value})),children:[jsxRuntimeExports.jsx("op
tion",{value:"once-off",children:"Once-off (single 
payment)"}),jsxRuntimeExports.jsx("option",{value:"monthly",children:"Monthly (distributed over 
time)"}),jsxRuntimeExports.jsx("option",{value:"annual",children:"Annual (yearly payments)"})]})]}),jsxRuntimeExports.j
sxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Modal Width"}),jsxRuntimeExports.j
sxs("select",{value:ut.modalWidth,onChange:ft=>Rt(zt=>({...zt,modalWidth:ft.target.value})),children:[jsxRuntimeExports
.jsx("option",{value:"standard",children:"Standard"}),jsxRuntimeExports.jsx("option",{value:"wide",children:"Wide"})]})
]}),jsxRuntimeExports.jsx("div",{className:"form-group checkbox-group",children:jsxRuntimeExports.jsxs("label",{childre
n:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:ut.hasCertaintyPercentage,onChange:ft=>Rt(zt=>({...zt,hasCert
aintyPercentage:ft.target.checked}))}),"Include Certainty 
Percentage"]})}),jsxRuntimeExports.jsx("div",{className:"form-group checkbox-group",children:jsxRuntimeExports.jsxs("la
bel",{children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:ut.hasPaymentFrequency,onChange:ft=>Rt(zt=>({...
zt,hasPaymentFrequency:ft.target.checked}))}),"Include Payment 
Frequency"]})}),jsxRuntimeExports.jsx("div",{className:"form-group checkbox-group",children:jsxRuntimeExports.jsxs("lab
el",{children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:ut.hasContractDuration,onChange:ft=>Rt(zt=>({...z
t,hasContractDuration:ft.target.checked}))}),"Include Contract 
Duration"]})}),jsxRuntimeExports.jsx("div",{className:"form-group checkbox-group",children:jsxRuntimeExports.jsxs("labe
l",{children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:ut.showBreakdownPreview,onChange:ft=>Rt(zt=>({...z
t,showBreakdownPreview:ft.target.checked}))}),"Show Breakdown Preview"]})})]})]}),jsxRuntimeExports.jsxs("div",{classNa
me:"form-section",children:[jsxRuntimeExports.jsx("h3",{children:"Formula"}),jsxRuntimeExports.jsxs("div",{className:"f
orm-grid",children:[jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{child
ren:"Formula Expression"}),jsxRuntimeExports.jsx("input",{type:"text",value:ut.formula.expression,onChange:ft=>Rt(zt=>(
{...zt,formula:{...zt.formula,expression:ft.target.value}})),placeholder:"e.g., quantity * 
ratePerUnit"}),jsxRuntimeExports.jsx("small",{children:"Use field IDs from the input fields. Supported operators: + - 
* / ( )"})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"F
ormula Description"}),jsxRuntimeExports.jsx("input",{type:"text",value:ut.formula.description,onChange:ft=>Rt(zt=>({...
zt,formula:{...zt.formula,description:ft.target.value}})),placeholder:"e.g., Hours Ã— Rate"})]})]})]}),jsxRuntimeExport
s.jsxs("div",{className:"form-section",children:[jsxRuntimeExports.jsx("h3",{children:"Input 
Fields"}),jsxRuntimeExports.jsx("p",{className:"section-description",children:"Define the input fields that users will 
fill in. These field IDs can be used in the formula."}),jsxRuntimeExports.jsxs("div",{className:"fields-list",children:
[ut.fields.map((ft,zt)=>jsxRuntimeExports.jsxs("div",{className:"field-editor",children:[jsxRuntimeExports.jsxs("div",{
className:"field-row",children:[jsxRuntimeExports.jsx("input",{type:"text",value:ft.id,onChange:Ct=>{const 
Pt=[...ut.fields];Pt[zt]={...ft,id:Ct.target.value},Rt($t=>({...$t,fields:Pt}))},placeholder:"Field ID (e.g., 
quantity)"}),jsxRuntimeExports.jsx("input",{type:"text",value:ft.name,onChange:Ct=>{const 
Pt=[...ut.fields];Pt[zt]={...ft,name:Ct.target.value},Rt($t=>({...$t,fields:Pt}))},placeholder:"Display 
Name"}),jsxRuntimeExports.jsxs("select",{value:ft.type,onChange:Ct=>{const Pt=[...ut.fields];Pt[zt]={...ft,type:Ct.targ
et.value},Rt($t=>({...$t,fields:Pt}))},children:[jsxRuntimeExports.jsx("option",{value:"text",children:"Text"}),jsxRunt
imeExports.jsx("option",{value:"number",children:"Number"}),jsxRuntimeExports.jsx("option",{value:"currency",children:"
Currency"}),jsxRuntimeExports.jsx("option",{value:"percentage",children:"Percentage"}),jsxRuntimeExports.jsx("option",{
value:"date",children:"Date"}),jsxRuntimeExports.jsx("option",{value:"select",children:"Dropdown"})]}),jsxRuntimeExport
s.jsxs("label",{className:"checkbox-inline",children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:ft.require
d,onChange:Ct=>{const Pt=[...ut.fields];Pt[zt]={...ft,required:Ct.target.checked},Rt($t=>({...$t,fields:Pt}))}}),"Requi
red"]}),jsxRuntimeExports.jsx("button",{type:"button",className:"btn btn-danger btn-sm",onClick:()=>{const Ct=ut.fields
.filter((Pt,$t)=>$t!==zt);Rt(Pt=>({...Pt,fields:Ct}))},children:"Remove"})]}),ft.type==="select"&&jsxRuntimeExports.jsx
s("div",{className:"field-options",children:[jsxRuntimeExports.jsx("input",{type:"text",value:ft.listKey||"",onChange:C
t=>{const Pt=[...ut.fields];Pt[zt]={...ft,listKey:Ct.target.value},Rt($t=>({...$t,fields:Pt}))},placeholder:"List Key 
(e.g., 
consultationTypes)"}),jsxRuntimeExports.jsxs("select",{value:ft.listType||"tenant-configurable",onChange:Ct=>{const Pt=
[...ut.fields];Pt[zt]={...ft,listType:Ct.target.value},Rt($t=>({...$t,fields:Pt}))},children:[jsxRuntimeExports.jsx("op
tion",{value:"system",children:"System 
(Fixed)"}),jsxRuntimeExports.jsx("option",{value:"tenant-configurable",children:"Tenant 
Configurable"})]})]})]},zt)),jsxRuntimeExports.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>{R
t(ft=>({...ft,fields:[...ft.fields,{id:"",name:"",type:"text",required:!1}]}))},children:"+ Add Field"})]})]}),jsxRunti
meExports.jsxs("div",{className:"form-section",children:[jsxRuntimeExports.jsx("h3",{children:"Cost 
Fields"}),jsxRuntimeExports.jsx("p",{className:"section-description",children:"Define the cost items that can be 
entered for this calculation."}),jsxRuntimeExports.jsxs("div",{className:"fields-list",children:[ut.costFields.map((ft,
zt)=>jsxRuntimeExports.jsx("div",{className:"field-editor",children:jsxRuntimeExports.jsxs("div",{className:"field-row"
,children:[jsxRuntimeExports.jsx("input",{type:"text",value:ft.id,onChange:Ct=>{const 
Pt=[...ut.costFields];Pt[zt]={...ft,id:Ct.target.value},Rt($t=>({...$t,costFields:Pt}))},placeholder:"Field 
ID"}),jsxRuntimeExports.jsx("input",{type:"text",value:ft.name,onChange:Ct=>{const 
Pt=[...ut.costFields];Pt[zt]={...ft,name:Ct.target.value},Rt($t=>({...$t,costFields:Pt}))},placeholder:"Display Name"})
,jsxRuntimeExports.jsxs("label",{className:"checkbox-inline",children:[jsxRuntimeExports.jsx("input",{type:"checkbox",c
hecked:ft.isPercentage,onChange:Ct=>{const 
Pt=[...ut.costFields];Pt[zt]={...ft,isPercentage:Ct.target.checked},Rt($t=>({...$t,costFields:Pt}))}}),"Is %"]}),jsxRun
timeExports.jsxs("label",{className:"checkbox-inline",children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:
ft.hasFrequency,onChange:Ct=>{const 
Pt=[...ut.costFields];Pt[zt]={...ft,hasFrequency:Ct.target.checked},Rt($t=>({...$t,costFields:Pt}))}}),"Has 
Frequency"]}),jsxRuntimeExports.jsx("button",{type:"button",className:"btn btn-danger btn-sm",onClick:()=>{const Ct=ut.
costFields.filter((Pt,$t)=>$t!==zt);Rt(Pt=>({...Pt,costFields:Ct}))},children:"Remove"})]})},zt)),jsxRuntimeExports.jsx
("button",{type:"button",className:"btn btn-secondary",onClick:()=>{Rt(ft=>({...ft,costFields:[...ft.costFields,{id:"",
name:"",type:"currency",hasFrequency:!1}]}))},children:"+ Add Cost Field"})]})]})]})]})})]}):jsxRuntimeExports.jsx("div
",{className:"calculation-template-management-page",children:jsxRuntimeExports.jsxs("div",{className:"access-denied",ch
ildren:[jsxRuntimeExports.jsx("h2",{children:"Access Denied"}),jsxRuntimeExports.jsx("p",{children:"Only system 
administrators can manage calculation templates."})]})})},TenantProductManagement=()=>{var ft,zt;const{currentTenant:s,
currentUser:e,isSystemAdmin:i,userRole:a}=useTenant(),[o,c]=reactExports.useState([]),[d,h]=reactExports.useState([]),[
j,_]=reactExports.useState(!0),[$,rt]=reactExports.useState(!1),[tt,mt]=reactExports.useState("all"),[vt,_t]=reactExpor
ts.useState(""),[wt,ht]=reactExports.useState(!1),[dt,jt]=reactExports.useState(null),[bt,ut]=reactExports.useState(nul
l),[Rt,st]=reactExports.useState([]),[it,nt]=reactExports.useState([]),[ct,xt]=reactExports.useState(null),yt=s==null?v
oid 0:s.id,Tt=i||((ft=a==null?void 0:a.permissions)==null?void 0:ft.includes("manage_clients"))||((zt=a==null?void 
0:a.permissions)==null?void 0:zt.includes("manage_users"));reactExports.useEffect(()=>{yt&&fs()},[yt]);const 
fs=async()=>{try{_(!0);const[Ct,Pt,$t]=await Promise.all([getAllProductsWithEnabledStatus(yt),getProductLines(),getTena
ntProductConfig(yt)]);c(Ct),h(Pt),xt($t)}catch(Ct){console.error("Error loading data:",Ct),_t("Failed to load product 
data")}finally{_(!1)}},cs=async Ct=>{try{rt(!0),Ct.isEnabled?await disableProductForTenant(yt,Ct.id):await 
enableProductForTenant(yt,Ct.id,e==null?void 0:e.uid),await fs(),_t(`${Ct.name} has been 
${Ct.isEnabled?"disabled":"enabled"}`),setTimeout(()=>_t(""),3e3)}catch(Pt){console.error("Error toggling 
product:",Pt),_t("Failed to update product status")}finally{rt(!1)}},Es=async()=>{if(window.confirm("Enable all 
products for this tenant?"))try{rt(!0);for(const Ct of o.filter(Pt=>!Pt.isEnabled))await 
enableProductForTenant(yt,Ct.id,e==null?void 0:e.uid);await fs(),_t("All products have been 
enabled"),setTimeout(()=>_t(""),3e3)}catch(Ct){console.error("Error enabling all products:",Ct),_t("Failed to enable 
all products")}finally{rt(!1)}},ls=async()=>{if(window.confirm("Disable all products for this tenant? Salespeople will 
not be able to use any products."))try{rt(!0);for(const Ct of o.filter(Pt=>Pt.isEnabled))await 
disableProductForTenant(yt,Ct.id);await fs(),_t("All products have been 
disabled"),setTimeout(()=>_t(""),3e3)}catch(Ct){console.error("Error disabling all products:",Ct),_t("Failed to 
disable all products")}finally{rt(!1)}},Yt=async(Ct,Pt)=>{var $t,Bt,Lt,Xt,Dt,Ht,os;try{jt(Ct),ut(Pt);let 
Qt=[];if((Bt=($t=ct==null?void 0:ct.listOverrides)==null?void 
0:$t[Ct.id])!=null&&Bt[Pt])Qt=[...ct.listOverrides[Ct.id][Pt]];else if((Xt=(Lt=Ct.customLists)==null?void 
0:Lt[Pt])!=null&&Xt.defaultOptions)Qt=[...Ct.customLists[Pt].defaultOptions];else 
if((Ht=(Dt=Ct.customLists)==null?void 0:Dt[Pt])!=null&&Ht.options)Qt=[...Ct.customLists[Pt].options];else 
if(Ct.calculationTemplateId){const Ft=await getCalculationTemplate(Ct.calculationTemplateId);(os=Ft==null?void 0:Ft.def
aultCustomLists)!=null&&os[Pt]&&(Qt=[...Ft.defaultCustomLists[Pt]])}st(Qt),nt(JSON.stringify(Qt)),ht(!0)}catch(Qt){cons
ole.error("Error opening list editor:",Qt),_t("Failed to load list options")}},Mt=()=>{const 
Ct=`option-${Date.now()}`;st(Pt=>[...Pt,{id:Ct,name:"",value:Ct}])},Gt=(Ct,Pt,$t)=>{st(Bt=>{const Lt=[...Bt];return Lt[
Ct]={...Lt[Ct],[Pt]:$t},Lt[Ct].value||(Lt[Ct].value=$t.toLowerCase().replace(/\s+/g,"-")),Lt})},Wt=Ct=>{st(Pt=>Pt.filte
r(($t,Bt)=>Bt!==Ct))},ms=async()=>{if(!(!dt||!bt))try{rt(!0);const Ct=Rt.filter(Pt=>Pt.name&&Pt.name.trim());await 
saveTenantListOverride(yt,dt.id,bt,Ct),await fs(),ht(!1),jt(null),ut(null),st([]),_t("List options saved 
successfully"),setTimeout(()=>_t(""),3e3)}catch(Ct){console.error("Error saving list options:",Ct),_t("Failed to save 
list options")}finally{rt(!1)}},ss=async()=>{if(!(!dt||!bt)&&window.confirm("Reset this list to the default options? 
Your customizations will be removed."))try{rt(!0),await removeTenantListOverride(yt,dt.id,bt),await 
fs(),ht(!1),jt(null),ut(null),st([]),_t("List reset to 
defaults"),setTimeout(()=>_t(""),3e3)}catch(Ct){console.error("Error resetting list:",Ct),_t("Failed to reset 
list")}finally{rt(!1)}},ys=Ct=>{var $t,Bt;const Pt=[];if(Ct.customLists)for(const[Lt,Xt]of 
Object.entries(Ct.customLists))Xt.listType==="tenant-configurable"&&Pt.push({key:Lt,name:Lt.replace(/([A-Z])/g," 
$1").replace(/^./,Dt=>Dt.toUpperCase()),hasOverride:!!((Bt=($t=ct==null?void 0:ct.listOverrides)==null?void 
0:$t[Ct.id])!=null&&Bt[Lt])});return 
Pt},Et=tt==="all"?o:o.filter(Ct=>Ct.productLineId===tt),gt=Et.reduce((Ct,Pt)=>{const 
$t=Pt.productLineId||"other";return 
Ct[$t]||(Ct[$t]={name:Pt.productLineName||"Other",products:[]}),Ct[$t].products.push(Pt),Ct},{});return 
yt?Tt?j?jsxRuntimeExports.jsx("div",{className:"page-loading",children:"Loading product configuration..."}):jsxRuntimeE
xports.jsxs("div",{className:"tenant-product-management-page",children:[jsxRuntimeExports.jsx("div",{className:"page-he
ader",children:jsxRuntimeExports.jsxs("div",{className:"header-content",children:[jsxRuntimeExports.jsx("h1",{children:
"Enabled Products"}),jsxRuntimeExports.jsxs("p",{children:["Select which products are available for salespeople in"," 
",jsxRuntimeExports.jsx("strong",{children:(s==null?void 0:s.name)||"this 
tenant"})]})]})}),vt&&jsxRuntimeExports.jsx("div",{className:`message ${vt.includes("Failed")?"error":"success"}`,child
ren:vt}),jsxRuntimeExports.jsxs("div",{className:"toolbar",children:[jsxRuntimeExports.jsxs("div",{className:"filter-gr
oup",children:[jsxRuntimeExports.jsx("label",{children:"Filter by Product Line:"}),jsxRuntimeExports.jsxs("select",{val
ue:tt,onChange:Ct=>mt(Ct.target.value),children:[jsxRuntimeExports.jsx("option",{value:"all",children:"All Product Line
s"}),d.map(Ct=>jsxRuntimeExports.jsx("option",{value:Ct.id,children:Ct.name},Ct.id))]})]}),jsxRuntimeExports.jsxs("div"
,{className:"bulk-actions",children:[jsxRuntimeExports.jsx("button",{className:"btn btn-secondary 
btn-sm",onClick:Es,disabled:$,children:"Enable All"}),jsxRuntimeExports.jsx("button",{className:"btn btn-secondary 
btn-sm",onClick:ls,disabled:$,children:"Disable All"})]})]}),jsxRuntimeExports.jsxs("div",{className:"products-summary"
,children:[jsxRuntimeExports.jsxs("div",{className:"summary-stat",children:[jsxRuntimeExports.jsx("span",{className:"st
at-value",children:o.filter(Ct=>Ct.isEnabled).length}),jsxRuntimeExports.jsx("span",{className:"stat-label",children:"E
nabled"})]}),jsxRuntimeExports.jsxs("div",{className:"summary-stat",children:[jsxRuntimeExports.jsx("span",{className:"
stat-value",children:o.filter(Ct=>!Ct.isEnabled).length}),jsxRuntimeExports.jsx("span",{className:"stat-label",children
:"Disabled"})]}),jsxRuntimeExports.jsxs("div",{className:"summary-stat",children:[jsxRuntimeExports.jsx("span",{classNa
me:"stat-value",children:o.filter(Ct=>Ct.hasListOverrides).length}),jsxRuntimeExports.jsx("span",{className:"stat-label
",children:"With Custom Lists"})]})]}),jsxRuntimeExports.jsxs("div",{className:"products-container",children:[Object.en
tries(gt).map(([Ct,Pt])=>jsxRuntimeExports.jsxs("div",{className:"product-line-group",children:[jsxRuntimeExports.jsx("
h3",{className:"product-line-header",children:Pt.name}),jsxRuntimeExports.jsx("div",{className:"products-list",children
:Pt.products.map($t=>{const Bt=ys($t);return jsxRuntimeExports.jsxs("div",{className:`product-card ${$t.isEnabled?"enab
led":"disabled"}`,children:[jsxRuntimeExports.jsxs("div",{className:"product-main",children:[jsxRuntimeExports.jsx("div
",{className:"product-toggle",children:jsxRuntimeExports.jsxs("label",{className:"toggle-switch",children:[jsxRuntimeEx
ports.jsx("input",{type:"checkbox",checked:$t.isEnabled,onChange:()=>cs($t),disabled:$}),jsxRuntimeExports.jsx("span",{
className:"toggle-slider"})]})}),jsxRuntimeExports.jsxs("div",{className:"product-info",children:[jsxRuntimeExports.jsx
("h4",{children:$t.name}),$t.description&&jsxRuntimeExports.jsx("p",{className:"product-description",children:$t.descri
ption}),jsxRuntimeExports.jsxs("div",{className:"product-meta",children:[$t.hasListOverrides&&jsxRuntimeExports.jsx("sp
an",{className:"meta-badge customized",children:"Custom 
Lists"}),$t.hasDefaultOverrides&&jsxRuntimeExports.jsx("span",{className:"meta-badge customized",children:"Custom Defau
lts"})]})]})]}),$t.isEnabled&&Bt.length>0&&jsxRuntimeExports.jsxs("div",{className:"product-lists",children:[jsxRuntime
Exports.jsx("div",{className:"lists-header",children:jsxRuntimeExports.jsx("span",{children:"Configurable Lists:"})}),j
sxRuntimeExports.jsx("div",{className:"lists-buttons",children:Bt.map(Lt=>jsxRuntimeExports.jsxs("button",{className:`b
tn btn-sm 
${Lt.hasOverride?"btn-primary":"btn-secondary"}`,onClick:()=>Yt($t,Lt.key),children:[Lt.name,Lt.hasOverride&&" âœ“"]},L
t.key))})]})]},$t.id)})})]},Ct)),Et.length===0&&jsxRuntimeExports.jsx("div",{className:"empty-state",children:jsxRuntim
eExports.jsx("p",{children:"No products found for this filter."})})]}),wt&&dt&&jsxRuntimeExports.jsx("div",{className:"
modal-overlay",onClick:()=>ht(!1),children:jsxRuntimeExports.jsxs("div",{className:"modal list-editor-modal",onClick:Ct
=>Ct.stopPropagation(),children:[jsxRuntimeExports.jsxs("div",{className:"modal-header",children:[jsxRuntimeExports.jsx
s("h2",{children:["Edit ",bt==null?void 0:bt.replace(/([A-Z])/g," $1")," for ",dt.name]}),jsxRuntimeExports.jsx("button
",{className:"modal-close",onClick:()=>ht(!1),children:"Ã—"})]}),jsxRuntimeExports.jsxs("div",{className:"modal-body",c
hildren:[jsxRuntimeExports.jsx("p",{className:"modal-description",children:"Customize the dropdown options for this 
product. Changes only apply to your tenant."}),jsxRuntimeExports.jsxs("div",{className:"list-options-editor",children:[
Rt.map((Ct,Pt)=>jsxRuntimeExports.jsxs("div",{className:"list-option-row",children:[jsxRuntimeExports.jsx("input",{type
:"text",value:Ct.name||"",onChange:$t=>Gt(Pt,"name",$t.target.value),placeholder:"Option 
name"}),jsxRuntimeExports.jsx("button",{type:"button",className:"btn btn-danger btn-sm",onClick:()=>Wt(Pt),children:"Re
move"})]},Ct.id||Pt)),jsxRuntimeExports.jsx("button",{type:"button",className:"btn btn-secondary 
add-option-btn",onClick:Mt,children:"+ Add Option"})]})]}),jsxRuntimeExports.jsxs("div",{className:"modal-footer",child
ren:[jsxRuntimeExports.jsx("button",{className:"btn btn-secondary",onClick:ss,disabled:$,children:"Reset to Default"}),
jsxRuntimeExports.jsxs("div",{className:"footer-right",children:[jsxRuntimeExports.jsx("button",{className:"btn 
btn-secondary",onClick:()=>ht(!1),children:"Cancel"}),jsxRuntimeExports.jsx("button",{className:"btn 
btn-primary",onClick:ms,disabled:$,children:$?"Saving...":"Save Changes"})]})]})]})})]}):jsxRuntimeExports.jsx("div",{c
lassName:"tenant-product-management-page",children:jsxRuntimeExports.jsxs("div",{className:"access-denied",children:[js
xRuntimeExports.jsx("h2",{children:"Access Denied"}),jsxRuntimeExports.jsx("p",{children:"You do not have permission 
to manage products."})]})}):jsxRuntimeExports.jsx("div",{className:"tenant-product-management-page",children:jsxRuntime
Exports.jsxs("div",{className:"access-denied",children:[jsxRuntimeExports.jsx("h2",{children:"No Tenant 
Selected"}),jsxRuntimeExports.jsx("p",{children:"Please select a tenant to manage 
products."})]})})},buildTeamHierarchy=async s=>{try{const e=await getUsersByTenant(s),i=new 
Map(e.map(c=>[c.id,c])),a=e.filter(c=>!c.managerId||!i.has(c.managerId)),o=c=>{const d=e.filter(h=>h.managerId===c.id);
return{id:c.id,name:c.displayName||c.email,email:c.email,role:c.role,salesLevel:c.salesLevel,assignedProductLineIds:c.a
ssignedProductLineIds||[],children:d.map(h=>o(h))}};return{tenantId:s,roots:a.map(c=>o(c)),totalUsers:e.length,unassign
ed:e.filter(c=>!c.managerId&&c.role==="salesperson").length}}catch(e){throw console.error("Error building team 
hierarchy:",e),e}},getTeamStats=async s=>{try{const e=await getTeamMembers(s),i=await 
getDirectReports(s);return{totalTeamSize:e.length,directReports:i.length,byRole:e.reduce((a,o)=>{const 
c=o.role||"salesperson";return a[c]=(a[c]||0)+1,a},{}),bySalesLevel:e.reduce((a,o)=>{const 
c=o.salesLevel||"unassigned";return a[c]=(a[c]||0)+1,a},{})}}catch(e){throw console.error("Error getting team 
stats:",e),e}},getUnassignedSalespeople=async s=>{try{return(await 
getUsersByTenant(s)).filter(i=>!i.managerId&&(i.role==="salesperson"||i.salesLevel==="salesperson"))}catch(e){throw 
console.error("Error getting unassigned 
salespeople:",e),e}},validateTeamAssignment=async(s,e)=>{try{if(s===e)return{valid:!1,error:"User cannot be their own 
manager"};if((await getTeamMembers(s)).map(j=>j.id).includes(e))return{valid:!1,error:"This assignment would create a 
circular reference (the proposed manager reports to this user)"};const o=await 
getUserData(e);if(!o)return{valid:!1,error:"Proposed manager not found"};const c=await getUserData(s);let 
d=[];return(c==null?void 0:c.role)==="salesperson"?d=["manager"]:(c==null?void 
0:c.role)==="manager"&&(d=["group-sales-manager"]),d.includes(o.role)?{valid:!0}:{valid:!1,error:"Proposed manager 
does not have a valid manager role for this user"}}catch(i){return console.error("Error validating team 
assignment:",i),{valid:!1,error:"Validation error: "+i.message}}},useTeamHierarchy=()=>{const{currentUser:s,userData:e,
userRole:i,isSystemAdmin:a,currentTenant:o,accessibleUserIds:c,teamMembers:d,effectiveProductLineIds:h,hierarchyLoading
:j,isTeamManager:_,isSalesHead:$,canAccessUserData:rt,refreshHierarchyData:tt,getTenantId:mt}=useTenant(),[vt,_t]=react
Exports.useState(null),[wt,ht]=reactExports.useState([]),[dt,jt]=reactExports.useState([]),[bt,ut]=reactExports.useStat
e(null),[Rt,st]=reactExports.useState(!1),[it,nt]=reactExports.useState(null),ct=mt(),xt=reactExports.useCallback(async
()=>{if(ct)try{st(!0),nt(null);const Wt=await buildTeamHierarchy(ct);_t(Wt)}catch(Wt){console.error("Error loading 
hierarchy:",Wt),nt(Wt.message)}finally{st(!1)}},[ct]),yt=reactExports.useCallback(async()=>{if(ct)try{const Wt=await 
getManagersInTenant(ct);ht(Wt)}catch(Wt){console.error("Error loading 
managers:",Wt)}},[ct]),Tt=reactExports.useCallback(async()=>{if(ct)try{const Wt=await 
getUnassignedSalespeople(ct);jt(Wt)}catch(Wt){console.error("Error loading 
unassigned:",Wt)}},[ct]),fs=reactExports.useCallback(async()=>{if(!(!s||!_()))try{const Wt=await 
getTeamStats(s.uid);ut(Wt)}catch(Wt){console.error("Error loading 
stats:",Wt)}},[s,_]),cs=reactExports.useCallback(async(Wt,ms)=>{try{nt(null);const ss=await 
validateTeamAssignment(Wt,ms);if(!ss.valid)throw new Error(ss.error);return await 
assignSalespersonToManager(Wt,ms),await Promise.all([xt(),Tt(),tt()]),{success:!0}}catch(ss){return 
console.error("Error assigning to 
manager:",ss),nt(ss.message),{success:!1,error:ss.message}}},[xt,Tt,tt]),Es=reactExports.useCallback(async 
Wt=>{try{return nt(null),await removeSalespersonFromManager(Wt),await 
Promise.all([xt(),Tt(),tt()]),{success:!0}}catch(ms){return console.error("Error removing from manager:",ms),nt(ms.mess
age),{success:!1,error:ms.message}}},[xt,Tt,tt]),ls=reactExports.useCallback(async(Wt,ms)=>{try{return nt(null),await 
updateUserHierarchy(Wt,{salesLevel:ms}),await xt(),await yt(),{success:!0}}catch(ss){return console.error("Error 
updating sales level:",ss),nt(ss.message),{success:!1,error:ss.message}}},[xt,yt]),Yt=reactExports.useCallback(async(Wt
,ms)=>{try{return nt(null),await assignProductLinesToManager(Wt,ms),await tt(),{success:!0}}catch(ss){return 
console.error("Error assigning product lines:",ss),nt(ss.message),{success:!1,error:ss.message}}},[tt]),Mt=reactExports
.useCallback(Wt=>a||$()?!0:_()?rt(Wt):!1,[a,$,_,rt]),Gt=reactExports.useCallback(async()=>{if(!(e!=null&&e.managerId))r
eturn null;try{return wt.find(ms=>ms.id===e.managerId)||null}catch(Wt){return console.error("Error getting 
manager:",Wt),null}},[e,wt]);return reactExports.useEffect(()=>{ct&&yt()},[ct,yt]),{accessibleUserIds:c,teamMembers:d,e
ffectiveProductLineIds:h,hierarchyLoading:j,hierarchy:vt,managers:wt,unassigned:dt,stats:bt,loading:Rt,error:it,isTeamM
anager:_,isSalesHead:$,canAccessUserData:rt,loadHierarchy:xt,loadManagers:yt,loadUnassigned:Tt,loadStats:fs,assignToMan
ager:cs,removeFromManager:Es,updateSalesLevel:ls,assignProductLines:Yt,canManage:Mt,getMyManager:Gt,refreshHierarchyDat
a:tt}},SalesTeamManagement=()=>{var gt;const{currentTenant:s,isSystemAdmin:e,hasPermission:i,getTenantId:a}=useTenant()
,{hierarchy:o,managers:c,unassigned:d,stats:h,loading:j,error:_,loadHierarchy:$,loadManagers:rt,loadUnassigned:tt,loadS
tats:mt,assignToManager:vt,assignProductLines:_t}=useTeamHierarchy(),[wt,ht]=reactExports.useState([]),[dt,jt]=reactExp
orts.useState(null),[bt,ut]=reactExports.useState(!1),[Rt,st]=reactExports.useState(!1),[it,nt]=reactExports.useState("
"),[ct,xt]=reactExports.useState([]),[yt,Tt]=reactExports.useState(""),[fs,cs]=reactExports.useState(!1),Es=a(),ls=e||i
("manage_all_teams")||i("manage_team")||i("manage_users");reactExports.useEffect(()=>{Es&&ls&&Yt()},[Es,ls]);const 
Yt=async()=>{await Promise.all([$(),rt(),tt(),mt(),Mt()])},Mt=async()=>{try{const ft=await 
getProductLines();ht(ft)}catch(ft){console.error("Error loading product lines:",ft)}},Gt=ft=>{jt(ft),nt(""),ut(!0)},Wt=
ft=>{jt(ft),xt(ft.assignedProductLineIds||[]),st(!0)},ms=async()=>{if(!dt||!it)return;cs(!0);const ft=await 
vt(dt.id,it);ft.success?(Tt(`${dt.name||dt.email} assigned successfully`),ut(!1),jt(null)):Tt(`Error: 
${ft.error}`),cs(!1),setTimeout(()=>Tt(""),3e3)},ss=async()=>{if(!dt)return;cs(!0);const ft=await 
_t(dt.id,ct);ft.success?(Tt("Product lines updated successfully"),st(!1),jt(null),await $()):Tt(`Error: ${ft.error}`),c
s(!1),setTimeout(()=>Tt(""),3e3)},ys=ft=>{xt(zt=>zt.includes(ft)?zt.filter(Ct=>Ct!==ft):[...zt,ft])},Et=(ft,zt=0)=>{var
 Pt,$t;const Ct=ft.salesLevel==="sales_manager"||ft.salesLevel==="sales_head"||ft.role==="sales_manager"||ft.role==="sa
les_head";return jsxRuntimeExports.jsxs("div",{className:"team-node",style:{marginLeft:zt*24},children:[jsxRuntimeExpor
ts.jsxs("div",{className:`team-member ${Ct?"is-manager":""}`,children:[jsxRuntimeExports.jsxs("div",{className:"member-
info",children:[jsxRuntimeExports.jsx("div",{className:"member-avatar",children:(ft.name||ft.email||"?")[0].toUpperCase
()}),jsxRuntimeExports.jsxs("div",{className:"member-details",children:[jsxRuntimeExports.jsx("span",{className:"member
-name",children:ft.name||ft.email}),jsxRuntimeExports.jsx("span",{className:"member-role",children:ft.salesLevel==="sal
es_head"?"Sales Head":ft.salesLevel==="sales_manager"?"Sales 
Manager":ft.role||"Salesperson"}),((Pt=ft.assignedProductLineIds)==null?void 0:Pt.length)>0&&jsxRuntimeExports.jsxs("sp
an",{className:"member-products",children:[ft.assignedProductLineIds.length," product line(s)"]})]})]}),jsxRuntimeExpor
ts.jsxs("div",{className:"member-actions",children:[Ct&&jsxRuntimeExports.jsx("button",{className:"btn btn-sm 
btn-secondary",onClick:()=>Wt(ft),children:"Product Lines"}),jsxRuntimeExports.jsx("button",{className:"btn btn-sm 
btn-secondary",onClick:()=>Gt(ft),children:"Reassign"})]})]}),(($t=ft.children)==null?void 0:$t.length)>0&&jsxRuntimeEx
ports.jsx("div",{className:"team-children",children:ft.children.map(Bt=>Et(Bt,zt+1))})]},ft.id)};return Es?ls?jsxRuntim
eExports.jsxs("div",{className:"sales-team-management-page",children:[jsxRuntimeExports.jsxs("div",{className:"page-hea
der",children:[jsxRuntimeExports.jsx("h1",{children:"Sales Team 
Management"}),jsxRuntimeExports.jsxs("p",{children:["Manage team structure and assignments for"," 
",jsxRuntimeExports.jsx("strong",{children:(s==null?void 0:s.name)||"this 
tenant"})]})]}),yt&&jsxRuntimeExports.jsx("div",{className:`message 
${yt.includes("Error")?"error":"success"}`,children:yt}),_&&jsxRuntimeExports.jsx("div",{className:"message error",chil
dren:_}),h&&jsxRuntimeExports.jsxs("div",{className:"stats-summary",children:[jsxRuntimeExports.jsxs("div",{className:"
stat-card",children:[jsxRuntimeExports.jsx("span",{className:"stat-value",children:h.totalTeamSize}),jsxRuntimeExports.
jsx("span",{className:"stat-label",children:"Total Team Size"})]}),jsxRuntimeExports.jsxs("div",{className:"stat-card",
children:[jsxRuntimeExports.jsx("span",{className:"stat-value",children:h.directReports}),jsxRuntimeExports.jsx("span",
{className:"stat-label",children:"Direct Reports"})]}),jsxRuntimeExports.jsxs("div",{className:"stat-card",children:[js
xRuntimeExports.jsx("span",{className:"stat-value",children:(d==null?void 0:d.length)||0}),jsxRuntimeExports.jsx("span"
,{className:"stat-label",children:"Unassigned"})]}),jsxRuntimeExports.jsxs("div",{className:"stat-card",children:[jsxRu
ntimeExports.jsx("span",{className:"stat-value",children:(c==null?void 0:c.length)||0}),jsxRuntimeExports.jsx("span",{c
lassName:"stat-label",children:"Managers"})]})]}),jsxRuntimeExports.jsxs("div",{className:"content-grid",children:[jsxR
untimeExports.jsxs("div",{className:"panel unassigned-panel",children:[jsxRuntimeExports.jsxs("div",{className:"panel-h
eader",children:[jsxRuntimeExports.jsx("h2",{children:"Unassigned 
Salespeople"}),jsxRuntimeExports.jsx("button",{className:"btn btn-sm btn-secondary",onClick:tt,disabled:j,children:"Ref
resh"})]}),jsxRuntimeExports.jsx("div",{className:"panel-body",children:j?jsxRuntimeExports.jsx("div",{className:"loadi
ng",children:"Loading..."}):(d==null?void 
0:d.length)===0?jsxRuntimeExports.jsx("div",{className:"empty-state",children:"All salespeople are assigned to 
managers."}):jsxRuntimeExports.jsx("div",{className:"unassigned-list",children:d==null?void 0:d.map(ft=>jsxRuntimeExpor
ts.jsxs("div",{className:"unassigned-item",children:[jsxRuntimeExports.jsxs("div",{className:"member-info",children:[js
xRuntimeExports.jsx("div",{className:"member-avatar",children:(ft.displayName||ft.email||"?")[0].toUpperCase()}),jsxRun
timeExports.jsxs("div",{className:"member-details",children:[jsxRuntimeExports.jsx("span",{className:"member-name",chil
dren:ft.displayName||ft.email}),jsxRuntimeExports.jsx("span",{className:"member-role",children:ft.role||"Salesperson"})
]})]}),jsxRuntimeExports.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>Gt({id:ft.id,name:ft.displayName,
email:ft.email}),children:"Assign"})]},ft.id))})})]}),jsxRuntimeExports.jsxs("div",{className:"panel hierarchy-panel",c
hildren:[jsxRuntimeExports.jsxs("div",{className:"panel-header",children:[jsxRuntimeExports.jsx("h2",{children:"Team 
Structure"}),jsxRuntimeExports.jsx("button",{className:"btn btn-sm btn-secondary",onClick:$,disabled:j,children:"Refres
h"})]}),jsxRuntimeExports.jsx("div",{className:"panel-body",children:j?jsxRuntimeExports.jsx("div",{className:"loading"
,children:"Loading team structure..."}):(gt=o==null?void 0:o.roots)!=null&&gt.length?jsxRuntimeExports.jsx("div",{class
Name:"team-hierarchy",children:o.roots.map(ft=>Et(ft,0))}):jsxRuntimeExports.jsx("div",{className:"empty-state",childre
n:"No team structure configured yet."})})]})]}),bt&&dt&&jsxRuntimeExports.jsx("div",{className:"modal-overlay",onClick:
()=>ut(!1),children:jsxRuntimeExports.jsxs("div",{className:"modal",onClick:ft=>ft.stopPropagation(),children:[jsxRunti
meExports.jsxs("div",{className:"modal-header",children:[jsxRuntimeExports.jsx("h2",{children:"Assign to Manager"}),jsx
RuntimeExports.jsx("button",{className:"modal-close",onClick:()=>ut(!1),children:"Ã—"})]}),jsxRuntimeExports.jsxs("div"
,{className:"modal-body",children:[jsxRuntimeExports.jsxs("p",{children:["Assign 
",jsxRuntimeExports.jsx("strong",{children:dt.name||dt.email})," to a manager:"]}),jsxRuntimeExports.jsxs("div",{classN
ame:"form-field",children:[jsxRuntimeExports.jsx("label",{children:"Select Manager"}),jsxRuntimeExports.jsxs("select",{
value:it,onChange:ft=>nt(ft.target.value),children:[jsxRuntimeExports.jsx("option",{value:"",children:"-- Select a 
Manager --"}),c.map(ft=>jsxRuntimeExports.jsxs("option",{value:ft.id,children:[ft.displayName||ft.email," 
","(",ft.salesLevel==="sales_head"?"Sales Head":ft.salesLevel==="sales_manager"?"Sales Manager":ft.role,")"]},ft.id))]}
)]})]}),jsxRuntimeExports.jsxs("div",{className:"modal-footer",children:[jsxRuntimeExports.jsx("button",{className:"btn
 btn-secondary",onClick:()=>ut(!1),children:"Cancel"}),jsxRuntimeExports.jsx("button",{className:"btn btn-primary",onCl
ick:ms,disabled:!it||fs,children:fs?"Assigning...":"Assign"})]})]})}),Rt&&dt&&jsxRuntimeExports.jsx("div",{className:"m
odal-overlay",onClick:()=>st(!1),children:jsxRuntimeExports.jsxs("div",{className:"modal",onClick:ft=>ft.stopPropagatio
n(),children:[jsxRuntimeExports.jsxs("div",{className:"modal-header",children:[jsxRuntimeExports.jsx("h2",{children:"As
sign Product Lines"}),jsxRuntimeExports.jsx("button",{className:"modal-close",onClick:()=>st(!1),children:"Ã—"})]}),jsx
RuntimeExports.jsxs("div",{className:"modal-body",children:[jsxRuntimeExports.jsxs("p",{children:["Select product 
lines for ",jsxRuntimeExports.jsx("strong",{children:dt.name||dt.email}),":"]}),jsxRuntimeExports.jsx("p",{className:"h
elp-text",children:"Salespeople under this manager will only see these product lines. Leave empty for access to all pro
ducts."}),jsxRuntimeExports.jsx("div",{className:"product-line-list",children:wt.map(ft=>jsxRuntimeExports.jsxs("label"
,{className:"product-line-option",children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:ct.includes(ft.id),o
nChange:()=>ys(ft.id)}),jsxRuntimeExports.jsx("span",{children:ft.name})]},ft.id))})]}),jsxRuntimeExports.jsxs("div",{c
lassName:"modal-footer",children:[jsxRuntimeExports.jsx("button",{className:"btn 
btn-secondary",onClick:()=>st(!1),children:"Cancel"}),jsxRuntimeExports.jsx("button",{className:"btn btn-primary",onCli
ck:ss,disabled:fs,children:fs?"Saving...":"Save"})]})]})})]}):jsxRuntimeExports.jsx("div",{className:"sales-team-manage
ment-page",children:jsxRuntimeExports.jsxs("div",{className:"access-denied",children:[jsxRuntimeExports.jsx("h2",{child
ren:"Access Denied"}),jsxRuntimeExports.jsx("p",{children:"You do not have permission to manage sales teams."})]})}):js
xRuntimeExports.jsx("div",{className:"sales-team-management-page",children:jsxRuntimeExports.jsxs("div",{className:"acc
ess-denied",children:[jsxRuntimeExports.jsx("h2",{children:"No Tenant 
Selected"}),jsxRuntimeExports.jsx("p",{children:"Please select a tenant to manage sales teams."})]})})},AccountantUploa
d=()=>{const{getTenantId:s,currentUser:e,isSystemAdmin:i}=useTenant(),a=s(),o=reactExports.useRef(null),[c,d]=reactExpo
rts.useState(!0),[h,j]=reactExports.useState(!1),[_,$]=reactExports.useState([]),[rt,tt]=reactExports.useState([]),[mt,
vt]=reactExports.useState(""),[_t,wt]=reactExports.useState([]),[ht,dt]=reactExports.useState(""),[jt,bt]=reactExports.
useState(""),[ut,Rt]=reactExports.useState(""),[st,it]=reactExports.useState(""),[nt,ct]=reactExports.useState(null),[x
t,yt]=reactExports.useState(null),[Tt,fs]=reactExports.useState(!1),[cs,Es]=reactExports.useState([]),[ls,Yt]=reactExpo
rts.useState("upload"),[Mt,Gt]=reactExports.useState(!1),[Wt,ms]=reactExports.useState({companyName:"",contactPerson:""
,email:"",phone:""}),[ss,ys]=reactExports.useState(!1),[Et,gt]=reactExports.useState("");reactExports.useEffect(()=>{ft
()},[a]);const ft=async()=>{try{if(d(!0),dt(""),!a){console.warn("AccountantUpload - No tenantId available. User may 
not be assigned to a tenant."),dt("Your user account is not assigned to a tenant. Please contact an administrator to 
assign you to a tenant."),d(!1);return}const[Ft,xs,Cs]=await Promise.all([getClients({},a),getProductLines(),getFinanci
alYearSettings(a)]);if($(Ft),tt(xs),vt(Cs.currentFinancialYear),a)try{const qt=await 
getUploadHistory(a);wt(qt)}catch(qt){console.warn("Could not load upload 
history:",qt.message),wt([]),qt.code==="permission-denied"&&console.info("Firebase rules for financialUploads 
collection need to be configured")}const 
gs=Cs.currentFinancialYear,Os=[{value:calculateFinancialYear(gs,-3),label:`YTD-3: 
${calculateFinancialYear(gs,-3)}`,type:UPLOAD_TYPES.YTD_3},{value:calculateFinancialYear(gs,-2),label:`YTD-2: 
${calculateFinancialYear(gs,-2)}`,type:UPLOAD_TYPES.YTD_2},{value:calculateFinancialYear(gs,-1),label:`YTD-1: 
${calculateFinancialYear(gs,-1)}`,type:UPLOAD_TYPES.YTD_1},{value:gs,label:`Budget: 
${gs}`,type:UPLOAD_TYPES.BUDGET},{value:gs,label:`YTD Actual: 
${gs}`,type:UPLOAD_TYPES.YTD_ACTUAL}];Es(Os)}catch(Ft){console.error("Error loading data:",Ft),dt("Failed to load 
data. Please try again.")}finally{d(!1)}},zt=async()=>{if(!Wt.companyName.trim()){dt("Company name is 
required");return}ys(!0),dt("");try{await createClient({companyName:Wt.companyName.trim(),contactPerson:Wt.contactPerso
n.trim()||"",email:Wt.email.trim()||"",phone:Wt.phone.trim()||"",status:"active"},a),bt(`Client "${Wt.companyName}" 
created successfully!`),Gt(!1),ms({companyName:"",contactPerson:"",email:"",phone:""});const Ft=await 
getClients({},a);$(Ft),setTimeout(()=>bt(""),3e3)}catch(Ft){console.error("Error creating client:",Ft),dt(`Failed to 
create client: ${Ft.message}`)}finally{ys(!1)}},Ct=()=>{const Ft=["Client Name","Contact Person","Email","Phone","Statu
s"],xs=_.map(js=>[js.name||js.companyName||js.legalName||"",js.contactPerson||js.contactName||"",js.email||js.contactEm
ail||"",js.phone||js.contactPhone||"",js.status||"active"]),Cs=[Ft.join(","),...xs.map(js=>js.map(es=>`"${(es||"").repl
ace(/"/g,'""')}"`).join(","))].join(`
  `),gs=new Blob([Cs],{type:"text/csv"}),Os=window.URL.createObjectURL(gs),qt=document.createElement("a");qt.href=Os,qt
.download=`clients_${new 
Date().toISOString().split("T")[0]}.csv`,qt.click(),window.URL.revokeObjectURL(Os)},Pt=_.filter(Ft=>{const xs=Et.toLowe
rCase(),Cs=(Ft.name||Ft.companyName||Ft.legalName||"").toLowerCase(),gs=(Ft.contactPerson||Ft.contactName||"").toLowerC
ase();return Cs.includes(xs)||gs.includes(xs)}),$t=async Ft=>{const xs=Ft.target.files[0];if(xs){if(!ut){dt("Please 
select an upload type first");return}dt(""),bt(""),ct(null),yt(null);try{const Cs=await 
Bt(xs),gs=parseCSV(Cs);ct(gs);const Os=validateUploadData(gs.rows,_,rt);yt(Os),fs(!0)}catch(Cs){console.error("Error 
parsing CSV:",Cs),dt(`Error parsing CSV: ${Cs.message}`)}o.current&&(o.current.value="")}},Bt=Ft=>new 
Promise((xs,Cs)=>{const gs=new FileReader;gs.onload=Os=>xs(Os.target.result),gs.onerror=Os=>Cs(new Error("Failed to 
read file")),gs.readAsText(Ft)}),Lt=Ft=>{const xs=Ft.target.value;Rt(xs);const Cs=cs.find(gs=>gs.type===xs);Cs&&it(Cs.v
alue),ct(null),yt(null),fs(!1)},Xt=async()=>{if(!xt||!xt.matchedRows.length){dt("No valid data to 
upload");return}if(!a){dt("No tenant selected");return}j(!0),dt("");try{const Ft=await 
saveFinancialUpload(xt.matchedRows,ut,st,e==null?void 0:e.uid,a);bt(`Successfully uploaded ${Ft.successCount} 
records!`);const xs=await getUploadHistory(a);wt(xs),ct(null),yt(null),fs(!1),Rt(""),it(""),setTimeout(()=>bt(""),5e3)}
catch(Ft){console.error("Error uploading data:",Ft),dt(`Upload failed: ${Ft.message}`)}finally{j(!1)}},Dt=async 
Ft=>{if(window.confirm("Are you sure you want to delete this upload? This will remove all associated financial 
data."))try{await deleteFinancialUpload(Ft,a),bt("Upload deleted successfully");const xs=await 
getUploadHistory(a);wt(xs),setTimeout(()=>bt(""),3e3)}catch(xs){console.error("Error deleting upload:",xs),dt(`Failed 
to delete upload: ${xs.message}`)}},Ht=Ft=>new Intl.NumberFormat("en-ZA",{style:"currency",currency:"ZAR",minimumFracti
onDigits:0}).format(Ft||0),os=Ft=>Ft?(Ft.toDate?Ft.toDate():new Date(Ft)).toLocaleDateString("en-ZA",{year:"numeric",mo
nth:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A",Qt=Ft=>{switch(Ft){case 
UPLOAD_TYPES.YTD_3:return"YTD-3 (3 Years Ago)";case UPLOAD_TYPES.YTD_2:return"YTD-2 (2 Years Ago)";case 
UPLOAD_TYPES.YTD_1:return"YTD-1 (Prior Year)";case UPLOAD_TYPES.BUDGET:return"Budget";case 
UPLOAD_TYPES.YTD_ACTUAL:return"YTD Actual (Current Year)";default:return Ft}};return c?jsxRuntimeExports.jsxs("div",{cl
assName:"accountant-upload",children:[jsxRuntimeExports.jsx("h1",{children:"Financial Data Upload"}),jsxRuntimeExports.
jsx("div",{className:"loading",children:"Loading..."})]}):jsxRuntimeExports.jsxs("div",{className:"accountant-upload",c
hildren:[jsxRuntimeExports.jsxs("div",{className:"page-header",children:[jsxRuntimeExports.jsx("h1",{children:"Accounta
nt Portal"}),jsxRuntimeExports.jsx("p",{className:"page-description",children:"Upload financial data (YTD actuals, 
budgets) and manage clients."})]}),ht&&jsxRuntimeExports.jsx("div",{className:"error-message",children:ht}),jt&&jsxRunt
imeExports.jsx("div",{className:"success-message",children:jt}),jsxRuntimeExports.jsxs("div",{className:"accountant-tab
s",children:[jsxRuntimeExports.jsx("button",{className:`tab-btn 
${ls==="upload"?"active":""}`,onClick:()=>Yt("upload"),children:"Upload 
Data"}),jsxRuntimeExports.jsxs("button",{className:`tab-btn 
${ls==="clients"?"active":""}`,onClick:()=>Yt("clients"),children:["Client Management (",_.length,")"]})]}),ls==="uploa
d"&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"upload-sectio
n",children:[jsxRuntimeExports.jsx("h2",{children:"Upload New Data"}),jsxRuntimeExports.jsxs("div",{className:"upload-f
orm",children:[jsxRuntimeExports.jsxs("div",{className:"form-row",children:[jsxRuntimeExports.jsxs("div",{className:"fo
rm-group",children:[jsxRuntimeExports.jsx("label",{children:"Upload Type"}),jsxRuntimeExports.jsxs("select",{value:ut,o
nChange:Lt,children:[jsxRuntimeExports.jsx("option",{value:"",children:"Select upload 
type..."}),jsxRuntimeExports.jsx("option",{value:UPLOAD_TYPES.YTD_ACTUAL,children:"YTD Actual: Current Year 
Actuals"}),jsxRuntimeExports.jsx("option",{value:UPLOAD_TYPES.BUDGET,children:"Budget: Current Year 
Budget"}),jsxRuntimeExports.jsx("option",{value:UPLOAD_TYPES.YTD_1,children:"YTD-1: Prior Year Actuals (Last 
year)"}),jsxRuntimeExports.jsx("option",{value:UPLOAD_TYPES.YTD_2,children:"YTD-2: Prior Year Actuals (2 years 
ago)"}),jsxRuntimeExports.jsx("option",{value:UPLOAD_TYPES.YTD_3,children:"YTD-3: Prior Year Actuals (3 years ago)"})]}
)]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Financial 
Year"}),jsxRuntimeExports.jsx("input",{type:"text",value:st,readOnly:!0,placeholder:"Select upload type first"})]})]}),
jsxRuntimeExports.jsxs("div",{className:"upload-instructions",children:[jsxRuntimeExports.jsx("h3",{children:"CSV 
Format Requirements"}),jsxRuntimeExports.jsxs("ul",{children:[jsxRuntimeExports.jsxs("li",{children:[jsxRuntimeExports.
jsx("strong",{children:"Column A:"})," Client Name (must match existing 
clients)"]}),jsxRuntimeExports.jsxs("li",{children:[jsxRuntimeExports.jsx("strong",{children:"Column B:"})," Product 
Name (must match existing 
products)"]}),jsxRuntimeExports.jsxs("li",{children:[jsxRuntimeExports.jsx("strong",{children:"Columns C-N:"})," 
Monthly amounts (Month 1, Month 2, Month 3, Month 4, Month 5, Month 6, Month 7, Month 8, Month 9, Month 10, Month 11, 
Month 12)"]})]}),jsxRuntimeExports.jsx("div",{className:"template-download",children:jsxRuntimeExports.jsx("button",{cl
assName:"secondary-btn",onClick:()=>downloadTemplate(),children:"Download CSV Template"})})]}),jsxRuntimeExports.jsxs("
div",{className:"file-upload-area",children:[jsxRuntimeExports.jsx("input",{type:"file",ref:o,accept:".csv",onChange:$t
,disabled:!ut}),jsxRuntimeExports.jsx("p",{children:"Select a CSV file to upload"})]})]})]}),Tt&&xt&&jsxRuntimeExports.
jsxs("div",{className:"validation-section",children:[jsxRuntimeExports.jsx("h2",{children:"Validation Results"}),jsxRun
timeExports.jsxs("div",{className:"validation-summary",children:[jsxRuntimeExports.jsxs("div",{className:"summary-grid"
,children:[jsxRuntimeExports.jsxs("div",{className:"summary-item",children:[jsxRuntimeExports.jsx("span",{className:"su
mmary-label",children:"Total Rows"}),jsxRuntimeExports.jsx("span",{className:"summary-value",children:xt.summary.totalR
ows})]}),jsxRuntimeExports.jsxs("div",{className:"summary-item success",children:[jsxRuntimeExports.jsx("span",{classNa
me:"summary-label",children:"Matched"}),jsxRuntimeExports.jsx("span",{className:"summary-value",children:xt.summary.mat
chedCount})]}),jsxRuntimeExports.jsxs("div",{className:"summary-item 
warning",children:[jsxRuntimeExports.jsx("span",{className:"summary-label",children:"Unmatched Clients"}),jsxRuntimeExp
orts.jsx("span",{className:"summary-value",children:xt.summary.unmatchedClientCount})]}),jsxRuntimeExports.jsxs("div",{
className:"summary-item warning",children:[jsxRuntimeExports.jsx("span",{className:"summary-label",children:"Unmatched 
Products"}),jsxRuntimeExports.jsx("span",{className:"summary-value",children:xt.summary.unmatchedProductCount})]}),xt.s
ummary.duplicateCount>0&&jsxRuntimeExports.jsxs("div",{className:"summary-item error",children:[jsxRuntimeExports.jsx("
span",{className:"summary-label",children:"Duplicates"}),jsxRuntimeExports.jsx("span",{className:"summary-value",childr
en:xt.summary.duplicateCount})]})]}),jsxRuntimeExports.jsxs("div",{className:"amount-summary",children:[jsxRuntimeExpor
ts.jsxs("div",{className:"amount-item",children:[jsxRuntimeExports.jsx("span",{children:"Total Amount in File:"}),jsxRu
ntimeExports.jsx("strong",{children:Ht(xt.summary.totalAmount)})]}),jsxRuntimeExports.jsxs("div",{className:"amount-ite
m success",children:[jsxRuntimeExports.jsx("span",{children:"Matched Amount:"}),jsxRuntimeExports.jsx("strong",{childre
n:Ht(xt.summary.matchedAmount)})]}),jsxRuntimeExports.jsxs("div",{className:"amount-item 
warning",children:[jsxRuntimeExports.jsx("span",{children:"Unmatched Amount:"}),jsxRuntimeExports.jsx("strong",{childre
n:Ht(xt.summary.unmatchedAmount)})]})]})]}),xt.unmatchedClients.length>0&&jsxRuntimeExports.jsxs("div",{className:"vali
dation-errors",children:[jsxRuntimeExports.jsxs("h3",{children:["Unmatched Clients 
(",xt.unmatchedClients.length,")"]}),jsxRuntimeExports.jsx("p",{className:"help-text",children:"These clients were not 
found in the system. Please add them or correct the names in your CSV."}),jsxRuntimeExports.jsxs("table",{className:"va
lidation-table",children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExpo
rts.jsx("th",{children:"Row"}),jsxRuntimeExports.jsx("th",{children:"Client Name"}),jsxRuntimeExports.jsx("th",{childre
n:"Product"}),jsxRuntimeExports.jsx("th",{children:"Amount"})]})}),jsxRuntimeExports.jsxs("tbody",{children:[xt.unmatch
edClients.slice(0,20).map((Ft,xs)=>jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("td",{children:Ft.rowIn
dex}),jsxRuntimeExports.jsx("td",{className:"highlight-cell",children:Ft.clientName}),jsxRuntimeExports.jsx("td",{child
ren:Ft.productName}),jsxRuntimeExports.jsx("td",{className:"amount-cell",children:Ht(Ft.total)})]},xs)),xt.unmatchedCli
ents.length>20&&jsxRuntimeExports.jsx("tr",{className:"more-row",children:jsxRuntimeExports.jsxs("td",{colSpan:"4",chil
dren:["...and ",xt.unmatchedClients.length-20," more unmatched clients"]})})]})]})]}),xt.unmatchedProducts.length>0&&js
xRuntimeExports.jsxs("div",{className:"validation-errors",children:[jsxRuntimeExports.jsxs("h3",{children:["Unmatched 
Products (",xt.unmatchedProducts.length,")"]}),jsxRuntimeExports.jsx("p",{className:"help-text",children:"These 
products were not found in the system. Please add them or correct the names in your CSV."}),jsxRuntimeExports.jsx("div"
,{className:"unmatched-products-list",children:xt.unmatchedProducts.map((Ft,xs)=>jsxRuntimeExports.jsx("span",{classNam
e:"unmatched-product-badge",children:Ft.productName},xs))})]}),xt.duplicateRows&&xt.duplicateRows.length>0&&jsxRuntimeE
xports.jsxs("div",{className:"validation-errors 
duplicate-section",children:[jsxRuntimeExports.jsxs("h3",{children:["Duplicate Rows 
(",xt.duplicateRows.length,")"]}),jsxRuntimeExports.jsx("p",{className:"help-text",children:"These rows have the same 
Client + Product combination as earlier rows and will be skipped. Each client/product combination should appear only 
once with all 12 months in columns."}),jsxRuntimeExports.jsxs("table",{className:"validation-table",children:[jsxRuntim
eExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("th",{children:"Row"}),jsxR
untimeExports.jsx("th",{children:"Client Name"}),jsxRuntimeExports.jsx("th",{children:"Product"}),jsxRuntimeExports.jsx
("th",{children:"Amount"}),jsxRuntimeExports.jsx("th",{children:"Reason"})]})}),jsxRuntimeExports.jsxs("tbody",{childre
n:[xt.duplicateRows.slice(0,10).map((Ft,xs)=>jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("td",{childre
n:Ft.rowIndex}),jsxRuntimeExports.jsx("td",{children:Ft.clientName}),jsxRuntimeExports.jsx("td",{children:Ft.productNam
e}),jsxRuntimeExports.jsx("td",{className:"amount-cell",children:Ht(Ft.total)}),jsxRuntimeExports.jsx("td",{className:"
reason-cell",children:Ft.reason})]},xs)),xt.duplicateRows.length>10&&jsxRuntimeExports.jsx("tr",{className:"more-row",c
hildren:jsxRuntimeExports.jsxs("td",{colSpan:"5",children:["...and ",xt.duplicateRows.length-10," more duplicate rows"]
})})]})]})]}),xt.matchedRows.length>0&&jsxRuntimeExports.jsxs("div",{className:"matched-preview",children:[jsxRuntimeEx
ports.jsxs("h3",{children:["Preview of Matched Data (",xt.matchedRows.length," records)"]}),jsxRuntimeExports.jsxs("tab
le",{className:"validation-table",children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{childr
en:[jsxRuntimeExports.jsx("th",{children:"Client"}),jsxRuntimeExports.jsx("th",{children:"Product"}),jsxRuntimeExports.
jsx("th",{children:"Total"})]})}),jsxRuntimeExports.jsxs("tbody",{children:[xt.matchedRows.slice(0,10).map((Ft,xs)=>jsx
RuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("td",{children:Ft.clientName}),jsxRuntimeExports.jsx("td",{ch
ildren:Ft.productLine}),jsxRuntimeExports.jsx("td",{className:"amount-cell",children:Ht(Ft.total)})]},xs)),xt.matchedRo
ws.length>10&&jsxRuntimeExports.jsx("tr",{className:"more-row",children:jsxRuntimeExports.jsxs("td",{colSpan:"3",childr
en:["...and ",xt.matchedRows.length-10," more matched records"]})})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"v
alidation-actions",children:[jsxRuntimeExports.jsx("button",{className:"cancel-btn",onClick:()=>{fs(!1),ct(null),yt(nul
l)},children:"Cancel"}),jsxRuntimeExports.jsx("button",{className:"primary-btn",onClick:Xt,disabled:h||xt.matchedRows.l
ength===0,children:h?"Uploading...":`Upload ${xt.matchedRows.length} Records`})]}),xt.summary.unmatchedAmount>0&&jsxRun
timeExports.jsxs("div",{className:"upload-warning",children:[jsxRuntimeExports.jsx("strong",{children:"Warning:"})," 
",Ht(xt.summary.unmatchedAmount)," will NOT be uploaded due to unmatched clients/products."]})]}),jsxRuntimeExports.jsx
s("div",{className:"history-section",children:[jsxRuntimeExports.jsx("h2",{children:"Upload 
History"}),_t.length===0?jsxRuntimeExports.jsx("p",{className:"no-history",children:"No uploads yet."}):jsxRuntimeExpor
ts.jsxs("table",{className:"history-table",children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr
",{children:[jsxRuntimeExports.jsx("th",{children:"Date"}),jsxRuntimeExports.jsx("th",{children:"Type"}),jsxRuntimeExpo
rts.jsx("th",{children:"Financial 
Year"}),jsxRuntimeExports.jsx("th",{children:"Records"}),jsxRuntimeExports.jsx("th",{children:"Total Amount"}),jsxRunti
meExports.jsx("th",{children:"Status"}),jsxRuntimeExports.jsx("th",{children:"Actions"})]})}),jsxRuntimeExports.jsx("tb
ody",{children:_t.map(Ft=>jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("td",{children:os(Ft.uploadedAt)
}),jsxRuntimeExports.jsx("td",{children:Qt(Ft.uploadType)}),jsxRuntimeExports.jsx("td",{children:Ft.financialYear}),jsx
RuntimeExports.jsx("td",{children:Ft.rowCount||Ft.successCount||0}),jsxRuntimeExports.jsx("td",{className:"amount-cell"
,children:Ht(Ft.totalAmount)}),jsxRuntimeExports.jsx("td",{children:jsxRuntimeExports.jsx("span",{className:`status-bad
ge ${Ft.status}`,children:Ft.status||"completed"})}),jsxRuntimeExports.jsx("td",{children:jsxRuntimeExports.jsx("button
",{className:"delete-btn",onClick:()=>Dt(Ft.id),title:"Delete this upload",children:"Delete"})})]},Ft.id))})]})]})]}),l
s==="clients"&&jsxRuntimeExports.jsxs("div",{className:"clients-section",children:[jsxRuntimeExports.jsxs("div",{classN
ame:"clients-header",children:[jsxRuntimeExports.jsxs("h2",{children:["All Clients (",_.length,")"]}),jsxRuntimeExports
.jsxs("div",{className:"clients-actions",children:[jsxRuntimeExports.jsx("input",{type:"text",placeholder:"Search clien
ts...",value:Et,onChange:Ft=>gt(Ft.target.value),className:"search-input"}),jsxRuntimeExports.jsx("button",{className:"
secondary-btn",onClick:Ct,children:"Download 
CSV"}),jsxRuntimeExports.jsx("button",{className:"primary-btn",onClick:()=>Gt(!0),children:"+ Add Client"})]})]}),jsxRu
ntimeExports.jsx("div",{className:"clients-table-container",children:jsxRuntimeExports.jsxs("table",{className:"clients
-table",children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx(
"th",{children:"Company Name"}),jsxRuntimeExports.jsx("th",{children:"Contact Person"}),jsxRuntimeExports.jsx("th",{chi
ldren:"Email"}),jsxRuntimeExports.jsx("th",{children:"Phone"}),jsxRuntimeExports.jsx("th",{children:"Status"})]})}),jsx
RuntimeExports.jsx("tbody",{children:Pt.length===0?jsxRuntimeExports.jsx("tr",{children:jsxRuntimeExports.jsx("td",{col
Span:"5",className:"no-data",children:Et?"No clients match your search.":"No clients found."})}):Pt.map(Ft=>jsxRuntimeE
xports.jsxs("tr",{children:[jsxRuntimeExports.jsx("td",{className:"client-name",children:Ft.name||Ft.companyName||Ft.le
galName||"-"}),jsxRuntimeExports.jsx("td",{children:Ft.contactPerson||Ft.contactName||"-"}),jsxRuntimeExports.jsx("td",
{children:Ft.email||Ft.contactEmail||"-"}),jsxRuntimeExports.jsx("td",{children:Ft.phone||Ft.contactPhone||"-"}),jsxRun
timeExports.jsx("td",{children:jsxRuntimeExports.jsx("span",{className:`status-badge ${Ft.status||"active"}`,children:F
t.status||"active"})})]},Ft.id))})]})})]}),Mt&&jsxRuntimeExports.jsx("div",{className:"modal-overlay",onClick:()=>Gt(!1
),children:jsxRuntimeExports.jsxs("div",{className:"modal",onClick:Ft=>Ft.stopPropagation(),children:[jsxRuntimeExports
.jsxs("div",{className:"modal-header",children:[jsxRuntimeExports.jsx("h2",{children:"Add New Client"}),jsxRuntimeExpor
ts.jsx("button",{className:"modal-close",onClick:()=>Gt(!1),children:"Ã—"})]}),jsxRuntimeExports.jsxs("div",{className:
"modal-body",children:[jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{ch
ildren:"Company Name *"}),jsxRuntimeExports.jsx("input",{type:"text",value:Wt.companyName,onChange:Ft=>ms(xs=>({...xs,c
ompanyName:Ft.target.value})),placeholder:"Enter company name"})]}),jsxRuntimeExports.jsxs("div",{className:"form-group
",children:[jsxRuntimeExports.jsx("label",{children:"Contact Person"}),jsxRuntimeExports.jsx("input",{type:"text",value
:Wt.contactPerson,onChange:Ft=>ms(xs=>({...xs,contactPerson:Ft.target.value})),placeholder:"Enter contact person name"}
)]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Email"}),j
sxRuntimeExports.jsx("input",{type:"email",value:Wt.email,onChange:Ft=>ms(xs=>({...xs,email:Ft.target.value})),placehol
der:"Enter email address"})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("la
bel",{children:"Phone"}),jsxRuntimeExports.jsx("input",{type:"tel",value:Wt.phone,onChange:Ft=>ms(xs=>({...xs,phone:Ft.
target.value})),placeholder:"Enter phone number"})]})]}),jsxRuntimeExports.jsxs("div",{className:"modal-footer",childre
n:[jsxRuntimeExports.jsx("button",{className:"cancel-btn",onClick:()=>Gt(!1),children:"Cancel"}),jsxRuntimeExports.jsx(
"button",{className:"primary-btn",onClick:zt,disabled:ss||!Wt.companyName.trim(),children:ss?"Adding...":"Add 
Client"})]})]})})]})},downloadTemplate=()=>{const s=["Client Name","Product Name","Month 1","Month 2","Month 3","Month 
4","Month 5","Month 6","Month 7","Month 8","Month 9","Month 10","Month 11","Month 12"],e=["Sample Company","Learnership
s","10000","15000","12000","18000","20000","22000","25000","23000","28000","30000","32000","35000"],i=[s.join(","),e.jo
in(",")].join(`
  `),a=new Blob([i],{type:"text/csv"}),o=window.URL.createObjectURL(a),c=document.createElement("a");c.href=o,c.downloa
d="financial_upload_template.csv",c.click(),window.URL.revokeObjectURL(o)},FinancialDashboard=()=>{var Zt,Is;const s=us
eNavigate(),{getTenantId:e,isSystemAdmin:i,isSalesHead:a,accessibleUserIds:o,userData:c,currentTenant:d,hierarchyLoadin
g:h}=useTenant(),j=e();console.log("Financial Dashboard - TenantId:",j),console.log("Financial Dashboard - 
UserData:",{email:c==null?void 0:c.email,tenantId:c==null?void 0:c.tenantId,role:c==null?void 
0:c.role,salesLevel:c==null?void 0:c.salesLevel,hierarchyLoading:h,accessibleUserIdsLength:o==null?void 0:o.length});co
nst[_,$]=reactExports.useState(!0),[rt,tt]=reactExports.useState(""),[mt,vt]=reactExports.useState([]),[_t,wt]=reactExp
orts.useState(""),[ht,dt]=reactExports.useState([]),[jt,bt]=reactExports.useState([]),[ut,Rt]=reactExports.useState([])
,[st,it]=reactExports.useState(""),[nt,ct]=reactExports.useState([]),[xt,yt]=reactExports.useState([]),[Tt,fs]=reactExp
orts.useState([]),[cs,Es]=reactExports.useState([]),[ls,Yt]=reactExports.useState([]),[Mt,Gt]=reactExports.useState("ov
erview"),[Wt,ms]=reactExports.useState("all"),ss=a?a():!1,ys=typeof i=="function"?i():i,Et=(c==null?void 
0:c.role)==="accountant"||(c==null?void 0:c.role)==="Accountant",gt=((c==null?void 0:c.role)||"").toLowerCase().replace
(/[\s_-]/g,""),ft=gt==="groupsalesmanager"||gt==="groupsalesmanagers"||gt==="saleshead"||(c==null?void 0:c.salesLevel)=
=="sales_head",zt=gt==="manager"||gt==="managers"||gt==="salesmanager"||gt==="salesmanagers"||(c==null?void 
0:c.salesLevel)==="sales_manager",Ct=ys||ss||ft||Et||zt;console.log("Financial Dashboard - Permissions:",{isSystemAdmin
:i,isAdmin:ys,isGroupSalesManager:ss,isGroupSalesManagerByRole:ft,isAccountant:Et,isManager:zt,userRole:c==null?void 
0:c.role,userRoleLower:gt,salesLevel:c==null?void 
0:c.salesLevel,canViewAllData:Ct,accessibleUserIds:o}),reactExports.useEffect(()=>{Pt()},[j]);const Pt=async()=>{var 
ns,ts,_s;try{$(!0),it("");const[Ns,Gs,Qs,qs]=await Promise.all([getFinancialYearSettings(j),calculateFinancialYearMonth
s(j),getClients({},j),j?getUsersByTenant(j):Promise.resolve([])]),sn=Ns.currentFinancialYear;if(tt(sn),vt(Gs.months||[]
),wt(Ns.reportingMonth||""),dt(Gs.ytdMonths||[]),bt(Qs),Rt(qs),console.log("Financial Dashboard - FY Settings:",{curren
tFY:sn,reportingMonth:Ns.reportingMonth,fyStartMonth:Ns.financialYearStart,fyEndMonth:Ns.financialYearEnd,ytdMonthsCoun
t:(ns=Gs.ytdMonths)==null?void 0:ns.length,ytdMonthNames:(ts=Gs.ytdMonths)==null?void 
0:ts.map(tn=>tn.name),allMonths:(_s=Gs.months)==null?void 0:_s.map(tn=>tn.name)}),j){const tn=calculateFinancialYear(sn
,-1),Dn=calculateFinancialYear(sn,-2),Un=calculateFinancialYear(sn,-3);console.log("Financial Dashboard - Loading 
data:",{tenantId:j,currentFY:sn,fy1:tn,fy2:Dn,fy3:Un,uploadTypes:UPLOAD_TYPES});const[Zn,gr,hr,Er,yr]=await Promise.all
([getFinancialData(UPLOAD_TYPES.YTD_ACTUAL,sn,j),getFinancialData(UPLOAD_TYPES.BUDGET,sn,j),getFinancialData(UPLOAD_TYP
ES.YTD_1,tn,j),getFinancialData(UPLOAD_TYPES.YTD_2,Dn,j),getFinancialData(UPLOAD_TYPES.YTD_3,Un,j)]);console.log("Finan
cial Dashboard - Data loaded:",{ytdActualCount:Zn.length,budgetCount:gr.length,ytd1Count:hr.length,ytd2Count:Er.length,
ytd3Count:yr.length,sampleYtdActual:Zn[0],sampleBudget:gr[0]}),ct(Zn),yt(gr),fs(hr),Es(Er),Yt(yr)}}catch(Ns){console.er
ror("Error loading data:",Ns),it("Failed to load financial 
data")}finally{$(!1)}},$t=reactExports.useMemo(()=>jt?Wt==="all"?Ct?jt:jt.filter(ns=>(o==null?void 
0:o.includes(ns.assignedSalesPerson))||(o==null?void 0:o.includes(ns.createdBy))):jt.filter(ns=>ns.assignedSalesPerson=
==Wt):[],[jt,Wt,Ct,o]),Bt=reactExports.useMemo(()=>$t.map(ns=>ns.id),[$t]);console.log("FinancialDashboard - Client 
filtering:",{totalClients:jt==null?void 0:jt.length,filteredClientsCount:$t.length,filteredClientIds:Bt.slice(0,5),acce
ssibleUserIds:o,selectedSalesperson:Wt,canViewAllData:Ct,sampleClient:jt!=null&&jt[0]?{id:jt[0].id,assignedSalesPerson:
jt[0].assignedSalesPerson,createdBy:jt[0].createdBy}:null});const Lt=reactExports.useMemo(()=>new Set($t.map(ns=>(ns.na
me||"").toLowerCase().trim())),[$t]),Xt=ns=>!ns||!ns.length?[]:Ct&&Wt==="all"?ns:ns.filter(_s=>!!(Bt.includes(_s.client
Id)||_s.clientName&&Lt.has(_s.clientName.toLowerCase().trim()))),Dt=reactExports.useMemo(()=>Xt(nt),[nt,Bt,Lt,Ct,Wt]),H
t=reactExports.useMemo(()=>Xt(xt),[xt,Bt,Lt,Ct,Wt]),os=reactExports.useMemo(()=>Xt(Tt),[Tt,Bt,Lt,Ct,Wt]),Qt=reactExport
s.useMemo(()=>Xt(cs),[cs,Bt,Lt,Ct,Wt]),Ft=reactExports.useMemo(()=>Xt(ls),[ls,Bt,Lt,Ct,Wt]),xs=ns=>ns.reduce((ts,_s)=>t
s+(_s.total||0),0),Cs=reactExports.useMemo(()=>xs(Dt),[Dt]),gs=reactExports.useMemo(()=>xs(Ht),[Ht]),Os=reactExports.us
eMemo(()=>xs(os),[os]),qt=reactExports.useMemo(()=>xs(Qt),[Qt]);reactExports.useMemo(()=>xs(Ft),[Ft]);const 
js=(ns,ts,_s="")=>{if(!ns||!ts||ts.length===0)return console.log(`calculateYtdTotal [${_s}]: No data or 
ytdMonths`,{dataLength:ns==null?void 0:ns.length,ytdMonthsLength:ts==null?void 0:ts.length}),0;const 
Ns=ts.map(Qs=>Qs.name);if(_s&&ns.length>0){const 
Qs=ns[0],qs=Qs.monthlyData||Qs.monthlyValues||{};console.log(`calculateYtdTotal [${_s}]:`,{ytdMonthNames:Ns,recordCount
:ns.length,sampleMonthDataKeys:Object.keys(qs),sampleMonthDataValues:qs,sampleRecordTotal:Qs.total})}const 
Gs=ns.reduce((Qs,qs)=>{const sn=qs.monthlyData||qs.monthlyValues||{};let tn=0;return 
Ns.forEach(Dn=>{tn+=sn[Dn]||0}),Qs+tn},0);return _s&&console.log(`calculateYtdTotal [${_s}]: YTD Total = ${Gs}`),Gs},es
=reactExports.useMemo(()=>js(Dt,ht,"YTD-Actual"),[Dt,ht]),vs=reactExports.useMemo(()=>js(Ht,ht,"Budget"),[Ht,ht]),Rs=re
actExports.useMemo(()=>js(os,ht,"YTD-1"),[os,ht]),Tn=reactExports.useMemo(()=>js(Qt,ht,"YTD-2"),[Qt,ht]);reactExports.u
seMemo(()=>js(Ft,ht,"YTD-3"),[Ft,ht]);const Hs=ns=>{const ts={};return ns.forEach(_s=>{const Ns=_s.productLine||"Unknow
n";ts[Ns]||(ts[Ns]={productLine:Ns,total:0,count:0}),ts[Ns].total+=_s.total||0,ts[Ns].count+=1}),Object.values(ts).sort
((_s,Ns)=>Ns.total-_s.total)},En=(ns,ts)=>{if(!ts||ts.length===0)return Hs(ns);const 
_s=ts.map(Gs=>Gs.name),Ns={};return ns.forEach(Gs=>{const 
Qs=Gs.productLine||"Unknown";Ns[Qs]||(Ns[Qs]={productLine:Qs,total:0,count:0});const 
qs=Gs.monthlyData||Gs.monthlyValues||{};let sn=0;_s.forEach(tn=>{sn+=qs[tn]||0}),Ns[Qs].total+=sn,Ns[Qs].count+=1}),Obj
ect.values(Ns).sort((Gs,Qs)=>Qs.total-Gs.total)},Hn=reactExports.useMemo(()=>En(Dt,ht),[Dt,ht]),Ps=reactExports.useMemo
(()=>En(Ht,ht),[Ht,ht]),Ts=reactExports.useMemo(()=>En(os,ht),[os,ht]);reactExports.useMemo(()=>En(Qt,ht),[Qt,ht]),reac
tExports.useMemo(()=>En(Ft,ht),[Ft,ht]);const ks=reactExports.useMemo(()=>{const ns=new Set;return[...Dt,...Ht,...os,..
.Qt,...Ft].forEach(ts=>{ts.productLine&&ns.add(ts.productLine)}),Array.from(ns).sort()},[Dt,Ht,os,Qt,Ft]),Ln=ns=>{const
 ts={};return ns.forEach(_s=>{const Ns=_s.clientId;ts[Ns]||(ts[Ns]={clientId:Ns,clientName:_s.clientName||"Unknown",tot
al:0}),ts[Ns].total+=_s.total||0}),Object.values(ts).sort((_s,Ns)=>Ns.total-_s.total)},hn=(ns,ts)=>{if(!ts||ts.length==
=0)return Ln(ns);const _s=ts.map(Gs=>Gs.name),Ns={};return ns.forEach(Gs=>{const 
Qs=Gs.clientId;Ns[Qs]||(Ns[Qs]={clientId:Qs,clientName:Gs.clientName||"Unknown",total:0});const 
qs=Gs.monthlyData||Gs.monthlyValues||{};let sn=0;_s.forEach(tn=>{sn+=qs[tn]||0}),Ns[Qs].total+=sn}),Object.values(Ns).s
ort((Gs,Qs)=>Qs.total-Gs.total)},Jn=reactExports.useMemo(()=>hn(Dt,ht),[Dt,ht]),nr=reactExports.useMemo(()=>hn(Ht,ht),[
Ht,ht]),Ls=reactExports.useMemo(()=>hn(os,ht),[os,ht]),Vn=reactExports.useMemo(()=>{const ns={};return[...Dt,...Ht,...o
s,...Qt,...Ft].forEach(ts=>{ts.clientId&&!ns[ts.clientId]&&(ns[ts.clientId]={clientId:ts.clientId,clientName:ts.clientN
ame||"Unknown"})}),Object.values(ns).sort((ts,_s)=>ts.clientName.localeCompare(_s.clientName))},[Dt,Ht,os,Qt,Ft]),Yn=ns
=>{const ts={};return ns.forEach(_s=>{const Ns=_s.monthlyData||_s.monthlyValues;Ns&&Object.entries(Ns).forEach(([Gs,Qs]
)=>{ts[Gs]||(ts[Gs]=0),ts[Gs]+=Qs||0})}),ts},Kn=reactExports.useMemo(()=>Yn(Dt),[Dt]),$n=reactExports.useMemo(()=>Yn(Ht
),[Ht]),Cn=reactExports.useMemo(()=>Yn(os),[os]);reactExports.useMemo(()=>Yn(Qt),[Qt]),reactExports.useMemo(()=>Yn(Ft),
[Ft]);const zs=ns=>new Intl.NumberFormat("en-ZA",{style:"currency",currency:"ZAR",minimumFractionDigits:0,maximumFracti
onDigits:0}).format(Math.round(ns||0)),Xs=(ns,ts)=>{if(!ts)return"-";const _s=(ns-ts)/Math.abs(ts)*100;return`${_s>=0?"
+":""}${_s.toFixed(1)}%`},mn=(ns,ts)=>ts?ns>=ts?"positive":"negative":"",On=ns=>{s(`/financial-editor/${ns}`)},As=nt.le
ngth>0||xt.length>0||Tt.length>0||cs.length>0||ls.length>0;return _?jsxRuntimeExports.jsxs("div",{className:"financial-
dashboard",children:[jsxRuntimeExports.jsx("h1",{children:"Financial 
Dashboard"}),jsxRuntimeExports.jsx("div",{className:"loading",children:"Loading financial data..."})]}):jsxRuntimeExpor
ts.jsxs("div",{className:"financial-dashboard",children:[jsxRuntimeExports.jsxs("div",{className:"page-header",children
:[jsxRuntimeExports.jsxs("div",{className:"header-left",children:[jsxRuntimeExports.jsx("h1",{children:"Financial 
Dashboard"}),jsxRuntimeExports.jsxs("span",{className:"financial-year-badge",children:["FY ",rt]}),d&&jsxRuntimeExports
.jsx("span",{className:"tenant-badge",style:{marginLeft:"8px",background:"#e3f2fd",padding:"4px 12px",borderRadius:"12p
x",fontSize:"0.85rem"},children:d.name||j})]}),jsxRuntimeExports.jsxs("div",{className:"header-controls",children:[Ct&&
ut.length>0&&jsxRuntimeExports.jsxs("div",{className:"filter-group",children:[jsxRuntimeExports.jsx("label",{children:"
Salesperson:"}),jsxRuntimeExports.jsxs("select",{value:Wt,onChange:ns=>ms(ns.target.value),children:[jsxRuntimeExports.
jsx("option",{value:"all",children:"All Salespeople"}),ut.map(ns=>jsxRuntimeExports.jsx("option",{value:ns.id,children:
ns.displayName||ns.email},ns.id))]})]}),jsxRuntimeExports.jsxs("div",{className:"view-tabs",children:[jsxRuntimeExports
.jsx("button",{className:Mt==="overview"?"active":"",onClick:()=>Gt("overview"),children:"Overview"}),jsxRuntimeExports
.jsx("button",{className:Mt==="byClient"?"active":"",onClick:()=>Gt("byClient"),children:"By Client"}),jsxRuntimeExport
s.jsx("button",{className:Mt==="byProduct"?"active":"",onClick:()=>Gt("byProduct"),children:"By Product"}),jsxRuntimeEx
ports.jsx("button",{className:Mt==="byMonth"?"active":"",onClick:()=>Gt("byMonth"),children:"Monthly"})]})]})]}),st&&js
xRuntimeExports.jsx("div",{className:"error-message",children:st}),Mt==="overview"&&jsxRuntimeExports.jsxs(jsxRuntimeEx
ports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"section",children:[jsxRuntimeExports.jsxs("h2",{chil
dren:["Year-to-Date (YTD) - ",_t]}),jsxRuntimeExports.jsxs("div",{className:"summary-cards",children:[jsxRuntimeExports
.jsxs("div",{className:"summary-card actual",children:[jsxRuntimeExports.jsxs("div",{className:"card-header",children:[
jsxRuntimeExports.jsx("h3",{children:"Actual YTD"}),jsxRuntimeExports.jsx("span",{className:"year-label",children:rt})]
}),jsxRuntimeExports.jsx("div",{className:"card-value",children:zs(es)})]}),jsxRuntimeExports.jsxs("div",{className:"su
mmary-card budget",children:[jsxRuntimeExports.jsxs("div",{className:"card-header",children:[jsxRuntimeExports.jsx("h3"
,{children:"Budget YTD"}),jsxRuntimeExports.jsx("span",{className:"year-label",children:rt})]}),jsxRuntimeExports.jsx("
div",{className:"card-value",children:zs(vs)})]}),jsxRuntimeExports.jsxs("div",{className:"summary-card ytd1",children:
[jsxRuntimeExports.jsxs("div",{className:"card-header",children:[jsxRuntimeExports.jsx("h3",{children:"Prior Year YTD"}
),jsxRuntimeExports.jsx("span",{className:"year-label",children:calculateFinancialYear(rt,-1)})]}),jsxRuntimeExports.js
x("div",{className:"card-value",children:zs(Rs)})]}),jsxRuntimeExports.jsxs("div",{className:"summary-card ytd2",childr
en:[jsxRuntimeExports.jsxs("div",{className:"card-header",children:[jsxRuntimeExports.jsx("h3",{children:"2 Years Ago Y
TD"}),jsxRuntimeExports.jsx("span",{className:"year-label",children:calculateFinancialYear(rt,-2)})]}),jsxRuntimeExport
s.jsx("div",{className:"card-value",children:zs(Tn)})]})]})]}),As&&jsxRuntimeExports.jsxs("div",{className:"section",ch
ildren:[jsxRuntimeExports.jsx("h2",{children:"YTD Comparison"}),jsxRuntimeExports.jsxs("div",{className:"comparison-gri
d",children:[jsxRuntimeExports.jsxs("div",{className:`comparison-item 
${mn(es,vs)}`,children:[jsxRuntimeExports.jsx("span",{className:"comparison-label",children:"Actual YTD vs Budget YTD"}
),jsxRuntimeExports.jsx("span",{className:"comparison-value",children:Xs(es,vs)}),jsxRuntimeExports.jsx("span",{classNa
me:"comparison-detail",children:zs(es-vs)})]}),jsxRuntimeExports.jsxs("div",{className:`comparison-item 
${mn(es,Rs)}`,children:[jsxRuntimeExports.jsx("span",{className:"comparison-label",children:"Actual YTD vs Prior Year Y
TD"}),jsxRuntimeExports.jsx("span",{className:"comparison-value",children:Xs(es,Rs)}),jsxRuntimeExports.jsx("span",{cla
ssName:"comparison-detail",children:zs(es-Rs)})]}),jsxRuntimeExports.jsxs("div",{className:`comparison-item 
${mn(vs,Rs)}`,children:[jsxRuntimeExports.jsx("span",{className:"comparison-label",children:"Budget YTD vs Prior Year Y
TD"}),jsxRuntimeExports.jsx("span",{className:"comparison-value",children:Xs(vs,Rs)}),jsxRuntimeExports.jsx("span",{cla
ssName:"comparison-detail",children:zs(vs-Rs)})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"section",children:[js
xRuntimeExports.jsx("h2",{children:"Full Year Totals"}),jsxRuntimeExports.jsxs("div",{className:"summary-cards",childre
n:[jsxRuntimeExports.jsxs("div",{className:"summary-card actual",children:[jsxRuntimeExports.jsxs("div",{className:"car
d-header",children:[jsxRuntimeExports.jsx("h3",{children:"Actual Full Year"}),jsxRuntimeExports.jsx("span",{className:"
year-label",children:rt})]}),jsxRuntimeExports.jsx("div",{className:"card-value",children:zs(Cs)}),jsxRuntimeExports.js
xs("div",{className:"card-label",children:[Dt.length," 
records"]})]}),jsxRuntimeExports.jsxs("div",{className:"summary-card budget",children:[jsxRuntimeExports.jsxs("div",{cl
assName:"card-header",children:[jsxRuntimeExports.jsx("h3",{children:"Budget Full Year"}),jsxRuntimeExports.jsx("span",
{className:"year-label",children:rt})]}),jsxRuntimeExports.jsx("div",{className:"card-value",children:zs(gs)}),jsxRunti
meExports.jsxs("div",{className:"card-label",children:[Ht.length," 
records"]})]}),jsxRuntimeExports.jsxs("div",{className:"summary-card ytd1",children:[jsxRuntimeExports.jsxs("div",{clas
sName:"card-header",children:[jsxRuntimeExports.jsx("h3",{children:"Prior Year Full"}),jsxRuntimeExports.jsx("span",{cl
assName:"year-label",children:calculateFinancialYear(rt,-1)})]}),jsxRuntimeExports.jsx("div",{className:"card-value",ch
ildren:zs(Os)}),jsxRuntimeExports.jsxs("div",{className:"card-label",children:[os.length," 
records"]})]}),jsxRuntimeExports.jsxs("div",{className:"summary-card ytd2",children:[jsxRuntimeExports.jsxs("div",{clas
sName:"card-header",children:[jsxRuntimeExports.jsx("h3",{children:"2 Years Ago Full"}),jsxRuntimeExports.jsx("span",{c
lassName:"year-label",children:calculateFinancialYear(rt,-2)})]}),jsxRuntimeExports.jsx("div",{className:"card-value",c
hildren:zs(qt)}),jsxRuntimeExports.jsxs("div",{className:"card-label",children:[Qt.length," records"]})]})]})]}),As&&js
xRuntimeExports.jsxs("div",{className:"section",children:[jsxRuntimeExports.jsx("h2",{children:"Full Year Comparison"})
,jsxRuntimeExports.jsxs("div",{className:"comparison-grid",children:[jsxRuntimeExports.jsxs("div",{className:`compariso
n-item ${mn(Cs,gs)}`,children:[jsxRuntimeExports.jsx("span",{className:"comparison-label",children:"Actual vs Budget"})
,jsxRuntimeExports.jsx("span",{className:"comparison-value",children:Xs(Cs,gs)}),jsxRuntimeExports.jsx("span",{classNam
e:"comparison-detail",children:zs(Cs-gs)})]}),jsxRuntimeExports.jsxs("div",{className:`comparison-item 
${mn(Cs,Os)}`,children:[jsxRuntimeExports.jsx("span",{className:"comparison-label",children:"Actual vs Prior Year"}),js
xRuntimeExports.jsx("span",{className:"comparison-value",children:Xs(Cs,Os)}),jsxRuntimeExports.jsx("span",{className:"
comparison-detail",children:zs(Cs-Os)})]}),jsxRuntimeExports.jsxs("div",{className:`comparison-item 
${mn(gs,Os)}`,children:[jsxRuntimeExports.jsx("span",{className:"comparison-label",children:"Budget vs Prior Year"}),js
xRuntimeExports.jsx("span",{className:"comparison-value",children:Xs(gs,Os)}),jsxRuntimeExports.jsx("span",{className:"
comparison-detail",children:zs(gs-Os)})]})]})]})]}),Mt==="byClient"&&jsxRuntimeExports.jsxs("div",{className:"section",
children:[jsxRuntimeExports.jsxs("h2",{children:["Financial Data by Client (YTD to 
",_t,")"]}),Vn.length===0?jsxRuntimeExports.jsx("div",{className:"no-data",children:"No financial data available. 
Upload data in the Accountant Portal."}):jsxRuntimeExports.jsx("div",{className:"data-table-container",children:jsxRunt
imeExports.jsxs("table",{className:"data-table",children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsx
s("tr",{children:[jsxRuntimeExports.jsx("th",{children:"Client"}),jsxRuntimeExports.jsxs("th",{className:"amount",child
ren:["YTD Actual ",rt]}),jsxRuntimeExports.jsxs("th",{className:"amount",children:["YTD Budget 
",rt]}),jsxRuntimeExports.jsx("th",{className:"amount",children:"Actual vs 
Budget"}),jsxRuntimeExports.jsx("th",{className:"amount",children:"YTD Prior 
Year"}),jsxRuntimeExports.jsx("th",{className:"amount",children:"Actual vs 
PY"})]})}),jsxRuntimeExports.jsx("tbody",{children:Vn.map(ns=>{var Gs,Qs,qs;const 
ts=((Gs=Jn.find(sn=>sn.clientId===ns.clientId))==null?void 
0:Gs.total)||0,_s=((Qs=nr.find(sn=>sn.clientId===ns.clientId))==null?void 
0:Qs.total)||0,Ns=((qs=Ls.find(sn=>sn.clientId===ns.clientId))==null?void 0:qs.total)||0;return jsxRuntimeExports.jsxs(
"tr",{onClick:()=>On(ns.clientId),className:"clickable-row",children:[jsxRuntimeExports.jsx("td",{children:ns.clientNam
e}),jsxRuntimeExports.jsx("td",{className:"amount",children:zs(ts)}),jsxRuntimeExports.jsx("td",{className:"amount",chi
ldren:zs(_s)}),jsxRuntimeExports.jsx("td",{className:`amount ${mn(ts,_s)}`,children:Xs(ts,_s)}),jsxRuntimeExports.jsx("
td",{className:"amount",children:zs(Ns)}),jsxRuntimeExports.jsx("td",{className:`amount ${mn(ts,Ns)}`,children:Xs(ts,Ns
)})]},ns.clientId)})}),jsxRuntimeExports.jsx("tfoot",{children:jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports
.jsxs("th",{children:["Total (",Vn.length," clients)"]}),jsxRuntimeExports.jsx("th",{className:"amount",children:zs(es)
}),jsxRuntimeExports.jsx("th",{className:"amount",children:zs(vs)}),jsxRuntimeExports.jsx("th",{className:`amount ${mn(
es,vs)}`,children:Xs(es,vs)}),jsxRuntimeExports.jsx("th",{className:"amount",children:zs(Rs)}),jsxRuntimeExports.jsx("t
h",{className:`amount ${mn(es,Rs)}`,children:Xs(es,Rs)})]})})]})})]}),Mt==="byProduct"&&jsxRuntimeExports.jsxs("div",{c
lassName:"section",children:[jsxRuntimeExports.jsxs("h2",{children:["Financial Data by Product Line (YTD to 
",_t,")"]}),ks.length===0?jsxRuntimeExports.jsx("div",{className:"no-data",children:"No financial data available. 
Upload data in the Accountant Portal."}):jsxRuntimeExports.jsx("div",{className:"data-table-container",children:jsxRunt
imeExports.jsxs("table",{className:"data-table",children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsx
s("tr",{children:[jsxRuntimeExports.jsx("th",{children:"Product 
Line"}),jsxRuntimeExports.jsxs("th",{className:"amount",children:["YTD Actual 
",rt]}),jsxRuntimeExports.jsxs("th",{className:"amount",children:["YTD Budget 
",rt]}),jsxRuntimeExports.jsx("th",{className:"amount",children:"Actual vs 
Budget"}),jsxRuntimeExports.jsx("th",{className:"amount",children:"YTD Prior 
Year"}),jsxRuntimeExports.jsx("th",{className:"amount",children:"Actual vs 
PY"})]})}),jsxRuntimeExports.jsx("tbody",{children:ks.map(ns=>{var Gs,Qs,qs;const 
ts=((Gs=Hn.find(sn=>sn.productLine===ns))==null?void 
0:Gs.total)||0,_s=((Qs=Ps.find(sn=>sn.productLine===ns))==null?void 
0:Qs.total)||0,Ns=((qs=Ts.find(sn=>sn.productLine===ns))==null?void 0:qs.total)||0;return jsxRuntimeExports.jsxs("tr",{
children:[jsxRuntimeExports.jsx("td",{children:ns}),jsxRuntimeExports.jsx("td",{className:"amount",children:zs(ts)}),js
xRuntimeExports.jsx("td",{className:"amount",children:zs(_s)}),jsxRuntimeExports.jsx("td",{className:`amount ${mn(ts,_s
)}`,children:Xs(ts,_s)}),jsxRuntimeExports.jsx("td",{className:"amount",children:zs(Ns)}),jsxRuntimeExports.jsx("td",{c
lassName:`amount ${mn(ts,Ns)}`,children:Xs(ts,Ns)})]},ns)})}),jsxRuntimeExports.jsx("tfoot",{children:jsxRuntimeExports
.jsxs("tr",{children:[jsxRuntimeExports.jsx("th",{children:"Total"}),jsxRuntimeExports.jsx("th",{className:"amount",chi
ldren:zs(es)}),jsxRuntimeExports.jsx("th",{className:"amount",children:zs(vs)}),jsxRuntimeExports.jsx("th",{className:`
amount ${mn(es,vs)}`,children:Xs(es,vs)}),jsxRuntimeExports.jsx("th",{className:"amount",children:zs(Rs)}),jsxRuntimeEx
ports.jsx("th",{className:`amount ${mn(es,Rs)}`,children:Xs(es,Rs)})]})})]})})]}),Mt==="byMonth"&&jsxRuntimeExports.jsx
s("div",{className:"section",children:[jsxRuntimeExports.jsx("h2",{children:"Monthly 
Comparison"}),jsxRuntimeExports.jsxs("p",{className:"section-subtitle",children:["Month 1 = ",((Zt=mt[0])==null?void 
0:Zt.calendarMonthName)||"First month of FY",", Month 12 = ",((Is=mt[11])==null?void 0:Is.calendarMonthName)||"Last 
month of FY"]}),mt.length===0?jsxRuntimeExports.jsx("div",{className:"no-data",children:"No monthly data available."}):
jsxRuntimeExports.jsx("div",{className:"data-table-container",children:jsxRuntimeExports.jsxs("table",{className:"data-
table",children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("
th",{children:"Month"}),jsxRuntimeExports.jsx("th",{children:"Calendar"}),jsxRuntimeExports.jsxs("th",{className:"amoun
t",children:["Actual ",rt]}),jsxRuntimeExports.jsxs("th",{className:"amount",children:["Budget 
",rt]}),jsxRuntimeExports.jsx("th",{className:"amount",children:"Prior 
Year"})]})}),jsxRuntimeExports.jsx("tbody",{children:mt.map(ns=>{const ts=ns.name,_s=ns.isYTD;return jsxRuntimeExports.
jsxs("tr",{className:_s?"ytd-row":"remaining-row",children:[jsxRuntimeExports.jsxs("td",{children:[ts,_s&&jsxRuntimeExp
orts.jsx("span",{className:"ytd-badge",children:"YTD"})]}),jsxRuntimeExports.jsx("td",{className:"calendar-month",child
ren:ns.calendarMonthName}),jsxRuntimeExports.jsx("td",{className:"amount",children:zs(Kn[ts]||0)}),jsxRuntimeExports.js
x("td",{className:"amount",children:zs($n[ts]||0)}),jsxRuntimeExports.jsx("td",{className:"amount",children:zs(Cn[ts]||
0)})]},ts)})}),jsxRuntimeExports.jsxs("tfoot",{children:[jsxRuntimeExports.jsxs("tr",{className:"ytd-total-row",childre
n:[jsxRuntimeExports.jsx("th",{colSpan:"2",children:"YTD Total"}),jsxRuntimeExports.jsx("th",{className:"amount",childr
en:zs(es)}),jsxRuntimeExports.jsx("th",{className:"amount",children:zs(vs)}),jsxRuntimeExports.jsx("th",{className:"amo
unt",children:zs(Rs)})]}),jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("th",{colSpan:"2",children:"Full
 Year Total"}),jsxRuntimeExports.jsx("th",{className:"amount",children:zs(Cs)}),jsxRuntimeExports.jsx("th",{className:"
amount",children:zs(gs)}),jsxRuntimeExports.jsx("th",{className:"amount",children:zs(Os)})]})]})]})})]}),!j&&!_&&jsxRun
timeExports.jsxs("div",{className:"no-data-container",children:[jsxRuntimeExports.jsx("h2",{children:"No Tenant 
Assigned"}),jsxRuntimeExports.jsx("p",{children:"Your account is not assigned to a tenant. Please contact your administ
rator."}),jsxRuntimeExports.jsxs("p",{className:"debug-info",style:{fontSize:"0.85rem",color:"#888",marginTop:"16px"},c
hildren:["Debug: User email: ",c==null?void 0:c.email,", TenantId from user: ",(c==null?void 0:c.tenantId)||"none"]})]}
),j&&!As&&!_&&jsxRuntimeExports.jsxs("div",{className:"no-data-container",children:[jsxRuntimeExports.jsx("h2",{childre
n:"No Financial Data Uploaded"}),jsxRuntimeExports.jsxs("p",{children:["No budget or historical data has been uploaded 
yet for tenant: ",jsxRuntimeExports.jsx("strong",{children:(d==null?void 0:d.name)||j})]}),(ys||Et)&&jsxRuntimeExports.
jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("p",{children:"Use the Accountant Portal to upload 
YTD Actual, Budget, and prior year 
data."}),jsxRuntimeExports.jsx("button",{className:"primary-btn",onClick:()=>s("/accountant-upload"),children:"Go to 
Accountant Portal"})]}),!ys&&!Et&&jsxRuntimeExports.jsx("p",{style:{marginTop:"16px",color:"#666"},children:"Please 
contact your accountant to upload financial data for your tenant."})]})]})},DEFAULT_TENANT_ID="speccon",TENANT_COLLECTI
ONS=["users","clients","deals","messages","followUpTasks","quotes","invoices","forecasts","feedback","clientFinancials"
,"budgets","skillsPartners","tenantProductConfigs","financialData","financialUploads","salesTeams","pipelineStatuses"],
SYSTEM_COLLECTIONS=["tenants","roles","calculationOptions","products","productLines","calculationTemplates"],INVALID_TE
NANT_IDS=["null","undefined","",null,void 0],isValidTenantId=s=>!(!s||typeof s!="string"||INVALID_TENANT_IDS.includes(s
)||s.trim()===""),fixCollectionTenantIds=async(s,e=DEFAULT_TENANT_ID)=>{const 
i={collection:s,totalRecords:0,validRecords:0,fixedRecords:0,errors:[]};try{const a=collection(db,s),o=await 
getDocs(a);i.totalRecords=o.docs.length;const c=writeBatch(db);let d=0;const h=500;for(const j of o.docs){const 
$=j.data().tenantId;if(isValidTenantId($))i.validRecords++;else try{const 
rt=doc(db,s,j.id);c.update(rt,{tenantId:e}),d++,i.fixedRecords++,d>=h&&(await 
c.commit(),d=0)}catch(rt){i.errors.push({docId:j.id,error:rt.message})}}return d>0&&await c.commit(),i}catch(a){return 
console.error(`Error fixing collection 
${s}:`,a),i.errors.push({error:a.message}),i}},fixAllTenantIds=async(s=DEFAULT_TENANT_ID)=>{console.log("Starting 
tenant ID fix for all collections..."),console.log(`Target tenant ID: ${s}`);const e={targetTenantId:s,startTime:new 
Date().toISOString(),collections:{},totalFixed:0,totalErrors:0};for(const i of 
TENANT_COLLECTIONS){console.log(`Processing collection: ${i}`);const a=await fixCollectionTenantIds(i,s);e.collections[
i]=a,e.totalFixed+=a.fixedRecords,e.totalErrors+=a.errors.length,console.log(`  - Total: ${a.totalRecords}, Valid: 
${a.validRecords}, Fixed: ${a.fixedRecords}, Errors: ${a.errors.length}`)}return e.endTime=new 
Date().toISOString(),console.log(`
  === TENANT FIX COMPLETE ===`),console.log(`Total records fixed: ${e.totalFixed}`),console.log(`Total errors: 
${e.totalErrors}`),e},auditTenantIds=async()=>{console.log("Auditing tenant IDs across all collections...");const 
s={timestamp:new Date().toISOString(),collections:{},totalIssues:0,invalidTenantIds:{}};for(const e of 
TENANT_COLLECTIONS){const i=collection(db,e),a=await getDocs(i),o=[],c={};for(const d of a.docs){const h=d.data(),j=h.t
enantId,_=j==null?"null/undefined":String(j);c[_]=(c[_]||0)+1,isValidTenantId(j)||o.push({docId:d.id,currentTenantId:j,
email:h.email||h.name||h.clientName||"N/A"})}s.collections[e]={totalRecords:a.docs.length,issueCount:o.length,tenantIdD
istribution:c,sampleIssues:o.slice(0,5)},s.totalIssues+=o.length;for(const[d,h]of Object.entries(c))isValidTenantId(d==
="null/undefined"?null:d)||(s.invalidTenantIds[d]=(s.invalidTenantIds[d]||0)+h)}return console.log(`
  === AUDIT COMPLETE ===`),console.log(`Total issues found: ${s.totalIssues}`),console.log("Invalid tenant IDs 
found:",s.invalidTenantIds),s},fixInfinityUsers=async()=>{console.log("Fixing Infinity users...");const 
s={totalUsers:0,alreadyCorrect:0,fixed:0,errors:[],fixedUsers:[]};try{const e=collection(db,"users"),i=await 
getDocs(e);s.totalUsers=i.docs.length;const a=writeBatch(db);let o=0;const c=500;for(const d of i.docs){const 
h=d.data(),j=h.email||"";if(j.toLowerCase().includes("infinity"))if(h.tenantId==="infinity")s.alreadyCorrect++;else 
try{const _=doc(db,"users",d.id);a.update(_,{tenantId:"infinity"}),o++,s.fixed++,s.fixedUsers.push({id:d.id,email:j,pre
viousTenantId:h.tenantId}),o>=c&&(await 
a.commit(),o=0)}catch(_){s.errors.push({userId:d.id,email:j,error:_.message})}}return o>0&&await 
a.commit(),console.log(`
  === INFINITY USERS FIX COMPLETE ===`),console.log(`Total users scanned: ${s.totalUsers}`),console.log(`Already 
correct: ${s.alreadyCorrect}`),console.log(`Fixed: ${s.fixed}`),console.log(`Errors: 
${s.errors.length}`),s}catch(e){return console.error("Error fixing Infinity users:",e),s.errors.push({error:e.message})
,s}},getSystemCollections=()=>({collections:SYSTEM_COLLECTIONS,description:"These collections are system-wide 
defaults. Tenants customize via tenantProductConfigs.",details:{tenants:"Tenant definitions - the root of all tenant 
data",roles:"Role definitions shared across the entire system",calculationOptions:"Dropdown options for calculations 
(shared)",products:"System product catalog - tenants enable/customize via tenantProductConfigs",productLines:"Product 
categories - shared across all tenants",calculationTemplates:"Calculation logic templates - shared, customized per prod
uct"}}),TenantFixAdmin=()=>{const{isSystemAdmin:s}=useTenant(),[e,i]=reactExports.useState(!1),[a,o]=reactExports.useSt
ate(null),[c,d]=reactExports.useState(null),[h,j]=reactExports.useState(null),[_,$]=reactExports.useState("speccon"),[r
t,tt]=reactExports.useState("");if(!s)return 
jsxRuntimeExports.jsxs("div",{className:"tenant-fix-admin",children:[jsxRuntimeExports.jsx("h1",{children:"Access 
Denied"}),jsxRuntimeExports.jsx("p",{children:"You must be a system administrator to access this page."})]});const 
mt=async()=>{i(!0),tt(""),o(null);try{const ht=await auditTenantIds();o(ht)}catch(ht){tt(`Audit failed: 
${ht.message}`)}finally{i(!1)}},vt=async()=>{if(!_.trim()){tt("Please enter a valid target tenant 
ID");return}if(window.confirm(`Are you sure you want to fix all invalid tenant IDs to "${_}"? This cannot be 
undone.`)){i(!0),tt(""),d(null);try{const ht=await fixAllTenantIds(_);d(ht)}catch(ht){tt(`Fix failed: 
${ht.message}`)}finally{i(!1)}}},_t=async()=>{if(window.confirm('Are you sure you want to fix all Infinity users? This 
will set tenantId to "infinity" for all users with "Infinity" in their email. This cannot be 
undone.')){i(!0),tt(""),j(null);try{const ht=await fixInfinityUsers();j(ht)}catch(ht){tt(`Fix Infinity users failed: 
${ht.message}`)}finally{i(!1)}}},wt=getSystemCollections();return 
jsxRuntimeExports.jsxs("div",{className:"tenant-fix-admin",children:[jsxRuntimeExports.jsx("h1",{children:"Tenant Data 
Fix Tool"}),jsxRuntimeExports.jsx("p",{className:"description",children:"This tool audits and fixes tenant ID issues 
across all collections in the database."}),rt&&jsxRuntimeExports.jsx("div",{className:"error-message",children:rt}),jsx
RuntimeExports.jsxs("div",{className:"info-section",children:[jsxRuntimeExports.jsx("h2",{children:"Collections Overvie
w"}),jsxRuntimeExports.jsxs("div",{className:"collections-grid",children:[jsxRuntimeExports.jsxs("div",{className:"coll
ection-list",children:[jsxRuntimeExports.jsxs("h3",{children:["Require Tenant ID (",TENANT_COLLECTIONS.length,")"]}),js
xRuntimeExports.jsx("ul",{children:TENANT_COLLECTIONS.map(ht=>jsxRuntimeExports.jsx("li",{children:ht},ht))})]}),jsxRun
timeExports.jsxs("div",{className:"collection-list system",children:[jsxRuntimeExports.jsx("h3",{children:"System-Wide 
Defaults (No Tenant ID)"}),jsxRuntimeExports.jsx("p",{className:"detail",style:{marginBottom:"12px"},children:wt.descri
ption}),jsxRuntimeExports.jsxs("ul",{children:[SYSTEM_COLLECTIONS.map(ht=>jsxRuntimeExports.jsxs("li",{children:[jsxRun
timeExports.jsx("strong",{children:ht}),jsxRuntimeExports.jsx("span",{className:"detail",children:wt.details[ht]})]},ht
)),jsxRuntimeExports.jsxs("li",{children:[jsxRuntimeExports.jsx("strong",{children:"systemSettings"}),jsxRuntimeExports
.jsx("span",{className:"detail",children:"Uses document ID pattern (e.g., setting_tenantId)"})]})]})]})]})]}),jsxRuntim
eExports.jsxs("div",{className:"actions-section",children:[jsxRuntimeExports.jsx("h2",{children:"Actions"}),jsxRuntimeE
xports.jsxs("div",{className:"action-card",children:[jsxRuntimeExports.jsx("h3",{children:"1. Audit Tenant 
IDs"}),jsxRuntimeExports.jsx("p",{children:"Scan all collections and report any invalid or missing tenant 
IDs."}),jsxRuntimeExports.jsx("button",{className:"primary-btn",onClick:mt,disabled:e,children:e?"Running 
Audit...":"Run 
Audit"})]}),jsxRuntimeExports.jsxs("div",{className:"action-card",children:[jsxRuntimeExports.jsx("h3",{children:"2. 
Fix Tenant IDs"}),jsxRuntimeExports.jsx("p",{children:"Update all invalid tenant IDs to the specified target tenant."})
,jsxRuntimeExports.jsxs("div",{className:"input-group",children:[jsxRuntimeExports.jsx("label",{children:"Target 
Tenant ID:"}),jsxRuntimeExports.jsx("input",{type:"text",value:_,onChange:ht=>$(ht.target.value),placeholder:"e.g., spe
ccon"})]}),jsxRuntimeExports.jsx("button",{className:"danger-btn",onClick:vt,disabled:e||!_.trim(),children:e?"Fixing..
.":"Fix All Invalid Tenant 
IDs"})]}),jsxRuntimeExports.jsxs("div",{className:"action-card",children:[jsxRuntimeExports.jsx("h3",{children:"3. Fix 
Infinity Users"}),jsxRuntimeExports.jsx("p",{children:'Find all users with "Infinity" in their email and set their 
tenantId to "infinity".'}),jsxRuntimeExports.jsx("button",{className:"warning-btn",onClick:_t,disabled:e,children:e?"Fi
xing...":"Fix Infinity Users"})]})]}),a&&jsxRuntimeExports.jsxs("div",{className:"results-section",children:[jsxRuntime
Exports.jsx("h2",{children:"Audit Report"}),jsxRuntimeExports.jsxs("p",{className:"timestamp",children:["Generated: ",a
.timestamp]}),jsxRuntimeExports.jsxs("div",{className:"summary-card",children:[jsxRuntimeExports.jsx("h3",{children:"Su
mmary"}),jsxRuntimeExports.jsxs("p",{children:[jsxRuntimeExports.jsx("strong",{children:"Total Issues Found:"})," 
",a.totalIssues]}),jsxRuntimeExports.jsx("p",{children:jsxRuntimeExports.jsx("strong",{children:"Invalid Tenant IDs:"})
}),jsxRuntimeExports.jsx("ul",{children:Object.entries(a.invalidTenantIds).map(([ht,dt])=>jsxRuntimeExports.jsxs("li",{
children:[jsxRuntimeExports.jsx("code",{children:ht}),": ",dt," 
records"]},ht))})]}),jsxRuntimeExports.jsx("h3",{children:"By Collection"}),jsxRuntimeExports.jsxs("table",{className:"
audit-table",children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports
.jsx("th",{children:"Collection"}),jsxRuntimeExports.jsx("th",{children:"Total 
Records"}),jsxRuntimeExports.jsx("th",{children:"Issues"}),jsxRuntimeExports.jsx("th",{children:"Tenant Distribution"})
]})}),jsxRuntimeExports.jsx("tbody",{children:Object.entries(a.collections).map(([ht,dt])=>jsxRuntimeExports.jsxs("tr",
{className:dt.issueCount>0?"has-issues":"",children:[jsxRuntimeExports.jsx("td",{children:ht}),jsxRuntimeExports.jsx("t
d",{children:dt.totalRecords}),jsxRuntimeExports.jsx("td",{className:dt.issueCount>0?"issue-count":"",children:dt.issue
Count}),jsxRuntimeExports.jsx("td",{children:Object.entries(dt.tenantIdDistribution).map(([jt,bt])=>jsxRuntimeExports.j
sxs("span",{className:"tenant-badge",children:[jt,": ",bt]},jt))})]},ht))})]})]}),c&&jsxRuntimeExports.jsxs("div",{clas
sName:"results-section",children:[jsxRuntimeExports.jsx("h2",{children:"Fix 
Results"}),jsxRuntimeExports.jsxs("p",{className:"timestamp",children:["Completed: 
",c.endTime]}),jsxRuntimeExports.jsxs("div",{className:"summary-card success",children:[jsxRuntimeExports.jsx("h3",{chi
ldren:"Summary"}),jsxRuntimeExports.jsxs("p",{children:[jsxRuntimeExports.jsx("strong",{children:"Target Tenant 
ID:"})," ",c.targetTenantId]}),jsxRuntimeExports.jsxs("p",{children:[jsxRuntimeExports.jsx("strong",{children:"Total 
Records Fixed:"})," 
",c.totalFixed]}),jsxRuntimeExports.jsxs("p",{children:[jsxRuntimeExports.jsx("strong",{children:"Total Errors:"})," 
",c.totalErrors]})]}),jsxRuntimeExports.jsx("h3",{children:"By Collection"}),jsxRuntimeExports.jsxs("table",{className:
"audit-table",children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExport
s.jsx("th",{children:"Collection"}),jsxRuntimeExports.jsx("th",{children:"Total"}),jsxRuntimeExports.jsx("th",{children
:"Already Valid"}),jsxRuntimeExports.jsx("th",{children:"Fixed"}),jsxRuntimeExports.jsx("th",{children:"Errors"})]})}),
jsxRuntimeExports.jsx("tbody",{children:Object.entries(c.collections).map(([ht,dt])=>jsxRuntimeExports.jsxs("tr",{child
ren:[jsxRuntimeExports.jsx("td",{children:ht}),jsxRuntimeExports.jsx("td",{children:dt.totalRecords}),jsxRuntimeExports
.jsx("td",{children:dt.validRecords}),jsxRuntimeExports.jsx("td",{className:dt.fixedRecords>0?"fixed-count":"",children
:dt.fixedRecords}),jsxRuntimeExports.jsx("td",{className:dt.errors.length>0?"error-count":"",children:dt.errors.length}
)]},ht))})]})]}),h&&jsxRuntimeExports.jsxs("div",{className:"results-section",children:[jsxRuntimeExports.jsx("h2",{chi
ldren:"Infinity Users Fix Results"}),jsxRuntimeExports.jsxs("div",{className:"summary-card success",children:[jsxRuntim
eExports.jsx("h3",{children:"Summary"}),jsxRuntimeExports.jsxs("p",{children:[jsxRuntimeExports.jsx("strong",{children:
"Total Users Scanned:"})," 
",h.totalUsers]}),jsxRuntimeExports.jsxs("p",{children:[jsxRuntimeExports.jsx("strong",{children:"Already 
Correct:"})," 
",h.alreadyCorrect]}),jsxRuntimeExports.jsxs("p",{children:[jsxRuntimeExports.jsx("strong",{children:"Fixed:"})," 
",h.fixed]}),jsxRuntimeExports.jsxs("p",{children:[jsxRuntimeExports.jsx("strong",{children:"Errors:"})," ",h.errors.le
ngth]})]}),h.fixedUsers.length>0&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("h
3",{children:"Fixed Users"}),jsxRuntimeExports.jsxs("table",{className:"audit-table",children:[jsxRuntimeExports.jsx("t
head",{children:jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("th",{children:"Email"}),jsxRuntimeExports
.jsx("th",{children:"Previous Tenant ID"}),jsxRuntimeExports.jsx("th",{children:"New Tenant ID"})]})}),jsxRuntimeExport
s.jsx("tbody",{children:h.fixedUsers.map(ht=>jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("td",{childre
n:ht.email}),jsxRuntimeExports.jsx("td",{className:"issue-count",children:ht.previousTenantId||"none"}),jsxRuntimeExpor
ts.jsx("td",{className:"fixed-count",children:"infinity"})]},ht.id))})]})]}),h.errors.length>0&&jsxRuntimeExports.jsxs(
jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("h3",{children:"Errors"}),jsxRuntimeExports.jsx("ul",{child
ren:h.errors.map((ht,dt)=>jsxRuntimeExports.jsxs("li",{className:"error-count",children:[ht.email,": ",ht.error]},dt))}
)]})]})]})},SetaManagement=()=>{const[s,e]=reactExports.useState([]),[i,a]=reactExports.useState(!0),[o,c]=reactExports
.useState(!1),[d,h]=reactExports.useState(!1),[j,_]=reactExports.useState(null),[$,rt]=reactExports.useState(""),[tt,mt
]=reactExports.useState({shortName:"",fullName:""}),{isSystemAdmin:vt}=useTenant();reactExports.useEffect(()=>{_t()},[]
);const _t=async()=>{try{a(!0);const st=await getSetas();e(st||[])}catch(st){console.error("Error loading SETAs:",st),e
([])}finally{a(!1)}},wt=(st=null)=>{st?(_(st),mt({shortName:st.shortName,fullName:st.fullName})):(_(null),mt({shortName
:"",fullName:""})),h(!0)},ht=()=>{h(!1),_(null),mt({shortName:"",fullName:""})},dt=st=>{const{name:it,value:nt}=st.targ
et;mt(ct=>({...ct,[it]:nt}))},jt=async 
st=>{if(st.preventDefault(),!tt.shortName.trim()||!tt.fullName.trim()){alert("Please fill in all 
fields");return}c(!0);try{j?await updateSeta(j.id,tt):await createSeta(tt),await 
_t(),ht()}catch(it){console.error("Error saving SETA:",it),alert("Failed to save 
SETA")}finally{c(!1)}},bt=async(st,it)=>{if(window.confirm(`Are you sure you want to delete "${it}"? This action 
cannot be undone.`)){c(!0);try{await deleteSeta(st),await _t()}catch(nt){console.error("Error deleting 
SETA:",nt),alert("Failed to delete SETA")}finally{c(!1)}}},ut=async()=>{if(window.confirm("This will add all standard 
SETAs to the database. Continue?")){c(!0);try{await seedSetas(),await _t(),alert("SETAs seeded 
successfully")}catch(st){console.error("Error seeding SETAs:",st),alert("Failed to seed SETAs")}finally{c(!1)}}},Rt=s.f
ilter(st=>st.shortName.toLowerCase().includes($.toLowerCase())||st.fullName.toLowerCase().includes($.toLowerCase()));re
turn 
vt?i?jsxRuntimeExports.jsxs("div",{className:"seta-management",children:[jsxRuntimeExports.jsx("h1",{children:"SETA Man
agement"}),jsxRuntimeExports.jsx("p",{children:"Loading..."})]}):jsxRuntimeExports.jsxs("div",{className:"seta-manageme
nt",children:[jsxRuntimeExports.jsxs("div",{className:"page-header",children:[jsxRuntimeExports.jsx("h1",{children:"SET
A Management"}),jsxRuntimeExports.jsxs("div",{className:"header-actions",children:[s.length===0&&jsxRuntimeExports.jsx(
"button",{className:"seed-btn",onClick:ut,disabled:o,children:"Seed Standard 
SETAs"}),jsxRuntimeExports.jsx("button",{className:"add-btn",onClick:()=>wt(),disabled:o,children:"+ Add SETA"})]})]}),
jsxRuntimeExports.jsx("div",{className:"search-bar",children:jsxRuntimeExports.jsx("input",{type:"text",placeholder:"Se
arch SETAs...",value:$,onChange:st=>rt(st.target.value)})}),jsxRuntimeExports.jsxs("div",{className:"seta-stats",childr
en:[jsxRuntimeExports.jsxs("div",{className:"stat-card",children:[jsxRuntimeExports.jsx("span",{className:"stat-value",
children:s.length}),jsxRuntimeExports.jsx("span",{className:"stat-label",children:"Total SETAs"})]}),jsxRuntimeExports.
jsxs("div",{className:"stat-card",children:[jsxRuntimeExports.jsx("span",{className:"stat-value",children:Rt.length}),j
sxRuntimeExports.jsx("span",{className:"stat-label",children:"Showing"})]})]}),jsxRuntimeExports.jsx("div",{className:"
seta-list",children:Rt.length===0?jsxRuntimeExports.jsxs("div",{className:"empty-state",children:[jsxRuntimeExports.jsx
("p",{children:"No SETAs 
found"}),s.length===0&&jsxRuntimeExports.jsx("button",{className:"seed-btn-large",onClick:ut,disabled:o,children:"Seed 
Standard SETAs"})]}):jsxRuntimeExports.jsxs("table",{className:"seta-table",children:[jsxRuntimeExports.jsx("thead",{ch
ildren:jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("th",{children:"Short 
Name"}),jsxRuntimeExports.jsx("th",{children:"Full Name"}),jsxRuntimeExports.jsx("th",{children:"Actions"})]})}),jsxRun
timeExports.jsx("tbody",{children:Rt.map(st=>jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("td",{classNa
me:"seta-short-name",children:st.shortName}),jsxRuntimeExports.jsx("td",{className:"seta-full-name",children:st.fullNam
e}),jsxRuntimeExports.jsxs("td",{className:"seta-actions",children:[jsxRuntimeExports.jsx("button",{className:"edit-btn
-small",onClick:()=>wt(st),disabled:o,children:"Edit"}),jsxRuntimeExports.jsx("button",{className:"delete-btn-small",on
Click:()=>bt(st.id,st.shortName),disabled:o,children:"Delete"})]})]},st.id))})]})}),d&&jsxRuntimeExports.jsx("div",{cla
ssName:"modal-backdrop",onClick:ht,children:jsxRuntimeExports.jsxs("div",{className:"modal-content",onClick:st=>st.stop
Propagation(),children:[jsxRuntimeExports.jsxs("div",{className:"modal-header",children:[jsxRuntimeExports.jsx("h2",{ch
ildren:j?"Edit SETA":"Add New SETA"}),jsxRuntimeExports.jsx("button",{className:"close-btn",onClick:ht,children:"Ã—"})]
}),jsxRuntimeExports.jsxs("form",{onSubmit:jt,children:[jsxRuntimeExports.jsxs("div",{className:"form-group",children:[
jsxRuntimeExports.jsx("label",{htmlFor:"shortName",children:"Short Name *"}),jsxRuntimeExports.jsx("input",{type:"text"
,id:"shortName",name:"shortName",value:tt.shortName,onChange:dt,placeholder:"e.g., BANKSETA",required:!0})]}),jsxRuntim
eExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"fullName",children:"Full 
Name *"}),jsxRuntimeExports.jsx("input",{type:"text",id:"fullName",name:"fullName",value:tt.fullName,onChange:dt,placeh
older:"e.g., Banking Sector Education and Training Authority",required:!0})]}),jsxRuntimeExports.jsxs("div",{className:
"modal-actions",children:[jsxRuntimeExports.jsx("button",{type:"button",className:"cancel-btn",onClick:ht,disabled:o,ch
ildren:"Cancel"}),jsxRuntimeExports.jsx("button",{type:"submit",className:"save-btn",disabled:o,children:o?"Saving...":
j?"Update SETA":"Add SETA"})]})]})]})})]}):jsxRuntimeExports.jsxs("div",{className:"seta-management",children:[jsxRunti
meExports.jsx("h1",{children:"Access Denied"}),jsxRuntimeExports.jsx("p",{children:"You do not have permission to 
access this page."})]})},JobTitlesManagement=()=>{const[s,e]=reactExports.useState([]),[i,a]=reactExports.useState(!0),
[o,c]=reactExports.useState(!1),[d,h]=reactExports.useState(!1),[j,_]=reactExports.useState(null),[$,rt]=reactExports.u
seState(""),[tt,mt]=reactExports.useState({title:""}),{isSystemAdmin:vt}=useTenant();reactExports.useEffect(()=>{_t()},
[]);const _t=async()=>{try{a(!0);const st=await getJobTitles();e(st||[])}catch(st){console.error("Error loading job tit
les:",st),e([])}finally{a(!1)}},wt=(st=null)=>{st?(_(st),mt({title:st.title})):(_(null),mt({title:""})),h(!0)},ht=()=>{
h(!1),_(null),mt({title:""})},dt=st=>{const{name:it,value:nt}=st.target;mt(ct=>({...ct,[it]:nt}))},jt=async 
st=>{if(st.preventDefault(),!tt.title.trim()){alert("Please fill in the job title");return}c(!0);try{j?await 
updateJobTitle(j.id,tt):await createJobTitle(tt),await _t(),ht()}catch(it){console.error("Error saving job 
title:",it),alert("Failed to save job title")}finally{c(!1)}},bt=async(st,it)=>{if(window.confirm(`Are you sure you 
want to delete "${it}"? This action cannot be undone.`)){c(!0);try{await deleteJobTitle(st),await 
_t()}catch(nt){console.error("Error deleting job title:",nt),alert("Failed to delete job 
title")}finally{c(!1)}}},ut=async()=>{if(window.confirm("This will add all standard job titles to the database. 
Continue?")){c(!0);try{await seedJobTitles(),await _t(),alert("Job titles seeded 
successfully")}catch(st){console.error("Error seeding job titles:",st),alert("Failed to seed job 
titles")}finally{c(!1)}}},Rt=s.filter(st=>st.title.toLowerCase().includes($.toLowerCase()));return vt?i?jsxRuntimeExpor
ts.jsxs("div",{className:"job-titles-management",children:[jsxRuntimeExports.jsx("h1",{children:"Job Titles Management"
}),jsxRuntimeExports.jsx("p",{children:"Loading..."})]}):jsxRuntimeExports.jsxs("div",{className:"job-titles-management
",children:[jsxRuntimeExports.jsxs("div",{className:"page-header",children:[jsxRuntimeExports.jsx("h1",{children:"Job 
Titles Management"}),jsxRuntimeExports.jsxs("div",{className:"header-actions",children:[s.length===0&&jsxRuntimeExports
.jsx("button",{className:"seed-btn",onClick:ut,disabled:o,children:"Seed Standard Job 
Titles"}),jsxRuntimeExports.jsx("button",{className:"add-btn",onClick:()=>wt(),disabled:o,children:"+ Add Job Title"})]
})]}),jsxRuntimeExports.jsx("div",{className:"search-bar",children:jsxRuntimeExports.jsx("input",{type:"text",placehold
er:"Search job titles...",value:$,onChange:st=>rt(st.target.value)})}),jsxRuntimeExports.jsxs("div",{className:"job-tit
le-stats",children:[jsxRuntimeExports.jsxs("div",{className:"stat-card",children:[jsxRuntimeExports.jsx("span",{classNa
me:"stat-value",children:s.length}),jsxRuntimeExports.jsx("span",{className:"stat-label",children:"Total Job Titles"})]
}),jsxRuntimeExports.jsxs("div",{className:"stat-card",children:[jsxRuntimeExports.jsx("span",{className:"stat-value",c
hildren:Rt.length}),jsxRuntimeExports.jsx("span",{className:"stat-label",children:"Showing"})]})]}),jsxRuntimeExports.j
sx("div",{className:"job-title-list",children:Rt.length===0?jsxRuntimeExports.jsxs("div",{className:"empty-state",child
ren:[jsxRuntimeExports.jsx("p",{children:"No job titles 
found"}),s.length===0&&jsxRuntimeExports.jsx("button",{className:"seed-btn-large",onClick:ut,disabled:o,children:"Seed 
Standard Job Titles"})]}):jsxRuntimeExports.jsxs("table",{className:"job-title-table",children:[jsxRuntimeExports.jsx("
thead",{children:jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("th",{children:"Job Title"}),jsxRuntimeEx
ports.jsx("th",{children:"Actions"})]})}),jsxRuntimeExports.jsx("tbody",{children:Rt.map(st=>jsxRuntimeExports.jsxs("tr
",{children:[jsxRuntimeExports.jsx("td",{className:"job-title-name",children:st.title}),jsxRuntimeExports.jsxs("td",{cl
assName:"job-title-actions",children:[jsxRuntimeExports.jsx("button",{className:"edit-btn-small",onClick:()=>wt(st),dis
abled:o,children:"Edit"}),jsxRuntimeExports.jsx("button",{className:"delete-btn-small",onClick:()=>bt(st.id,st.title),d
isabled:o,children:"Delete"})]})]},st.id))})]})}),d&&jsxRuntimeExports.jsx("div",{className:"modal-backdrop",onClick:ht
,children:jsxRuntimeExports.jsxs("div",{className:"modal-content",onClick:st=>st.stopPropagation(),children:[jsxRuntime
Exports.jsxs("div",{className:"modal-header",children:[jsxRuntimeExports.jsx("h2",{children:j?"Edit Job Title":"Add 
New Job Title"}),jsxRuntimeExports.jsx("button",{className:"close-btn",onClick:ht,children:"Ã—"})]}),jsxRuntimeExports.
jsxs("form",{onSubmit:jt,children:[jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx
("label",{htmlFor:"title",children:"Job Title 
*"}),jsxRuntimeExports.jsx("input",{type:"text",id:"title",name:"title",value:tt.title,onChange:dt,placeholder:"e.g., 
HR Manager",required:!0})]}),jsxRuntimeExports.jsxs("div",{className:"modal-actions",children:[jsxRuntimeExports.jsx("b
utton",{type:"button",className:"cancel-btn",onClick:ht,disabled:o,children:"Cancel"}),jsxRuntimeExports.jsx("button",{
type:"submit",className:"save-btn",disabled:o,children:o?"Saving...":j?"Update Job Title":"Add Job Title"})]})]})]})})]
}):jsxRuntimeExports.jsxs("div",{className:"job-titles-management",children:[jsxRuntimeExports.jsx("h1",{children:"Acce
ss Denied"}),jsxRuntimeExports.jsx("p",{children:"You do not have permission to access this page."})]})},Login=()=>{con
st[s,e]=reactExports.useState(""),[i,a]=reactExports.useState(""),[o,c]=reactExports.useState(!1),[d,h]=reactExports.us
eState(""),[j,_]=reactExports.useState(!1),[$,rt]=reactExports.useState(!1),[tt,mt]=reactExports.useState(!1),[vt,_t]=r
eactExports.useState(""),[wt,ht]=reactExports.useState(""),[dt,jt]=reactExports.useState(!1),bt=async()=>{h(""),rt(!0);
try{const st=new OAuthProvider("microsoft.com");await 
signInWithPopup(auth,st)}catch(st){h(st.message),rt(!1)}},ut=async st=>{st.preventDefault(),h(""),_(!0);try{const 
it=await signInWithEmailAndPassword(auth,s,i),nt=await getDoc(doc(db,"users",it.user.uid));if(nt.exists()&&nt.data().re
quirePasswordChange){mt(!0),_(!1);return}}catch(it){h(it.message),_(!1)}},Rt=async 
st=>{if(st.preventDefault(),h(""),vt.length<6){h("New password must be at least 6 
characters");return}if(vt!==wt){h("Passwords do not match");return}if(vt===i){h("New password must be different from 
the current password");return}jt(!0);try{const it=auth.currentUser;if(!it)throw new Error("No user logged in");await 
updatePassword(it,vt),await updateDoc(doc(db,"users",it.uid),{requirePasswordChange:!1,passwordChangedAt:serverTimestam
p(),updatedAt:serverTimestamp()}),mt(!1)}catch(it){console.error("Error changing 
password:",it),it.code==="auth/requires-recent-login"?h("For security reasons, please log out and log in again before 
changing your password."):h(it.message||"Failed to change password"),jt(!1)}};return jsxRuntimeExports.jsxs("div",{clas
sName:"login-container",children:[jsxRuntimeExports.jsxs("div",{className:"login-box",children:[jsxRuntimeExports.jsx("
h1",{children:"Speccon CRM"}),jsxRuntimeExports.jsx("h2",{children:"Login"}),d&&jsxRuntimeExports.jsx("div",{className:
"error-message",children:d}),jsxRuntimeExports.jsx("button",{onClick:bt,disabled:$||j,className:"microsoft-login-button
",children:$?jsxRuntimeExports.jsx("span",{children:"Signing in..."}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment
,{children:[jsxRuntimeExports.jsxs("svg",{width:"21",height:"21",viewBox:"0 0 21 21",fill:"none",xmlns:"http://www.w3.o
rg/2000/svg",children:[jsxRuntimeExports.jsx("rect",{x:"0",y:"0",width:"10",height:"10",fill:"#F25022"}),jsxRuntimeExpo
rts.jsx("rect",{x:"11",y:"0",width:"10",height:"10",fill:"#7FBA00"}),jsxRuntimeExports.jsx("rect",{x:"0",y:"11",width:"
10",height:"10",fill:"#00A4EF"}),jsxRuntimeExports.jsx("rect",{x:"11",y:"11",width:"10",height:"10",fill:"#FFB900"})]})
,jsxRuntimeExports.jsx("span",{children:"Sign in with Microsoft"})]})}),jsxRuntimeExports.jsx("div",{className:"divider
",children:jsxRuntimeExports.jsx("span",{children:"OR"})}),jsxRuntimeExports.jsxs("form",{onSubmit:ut,children:[jsxRunt
imeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"email",children:"Email"
}),jsxRuntimeExports.jsx("input",{type:"email",id:"email",value:s,onChange:st=>e(st.target.value),required:!0,placehold
er:"Enter your email",disabled:j||$})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExpor
ts.jsx("label",{htmlFor:"password",children:"Password"}),jsxRuntimeExports.jsxs("div",{className:"password-input-wrappe
r",children:[jsxRuntimeExports.jsx("input",{type:o?"text":"password",id:"password",value:i,onChange:st=>a(st.target.val
ue),required:!0,placeholder:"Enter your password",disabled:j||$}),jsxRuntimeExports.jsx("button",{type:"button",classNa
me:"password-toggle",onClick:()=>c(!o),disabled:j||$,"aria-label":o?"Hide password":"Show 
password",children:o?jsxRuntimeExports.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 
24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[jsxRuntimeExports.jsx("path",{d:"M17.94 17.94A10.07 
10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 
1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"}),jsxRuntimeExports.jsx("line",{x1:"1",y1:"1",x2:"23",y2:"23"})]}):jsxRunti
meExports.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 
24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[jsxRuntimeExports.jsx("path",{d:"M1 12s4-8 11-8 11 8 
11 8-4 8-11 8-11-8-11-8z"}),jsxRuntimeExports.jsx("circle",{cx:"12",cy:"12",r:"3"})]})})]})]}),jsxRuntimeExports.jsx("b
utton",{type:"submit",disabled:j||$,className:"email-login-button",children:j?"Logging in...":"Login with Email"})]})]}
),tt&&jsxRuntimeExports.jsx("div",{className:"password-change-modal-backdrop",children:jsxRuntimeExports.jsxs("div",{cl
assName:"password-change-modal",children:[jsxRuntimeExports.jsx("h2",{children:"Password Change 
Required"}),jsxRuntimeExports.jsx("p",{children:"For security reasons, you must change your password before continuing.
"}),d&&jsxRuntimeExports.jsx("div",{className:"error-message",children:d}),jsxRuntimeExports.jsxs("form",{onSubmit:Rt,c
hildren:[jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"newPass
word",children:"New Password"}),jsxRuntimeExports.jsx("input",{type:"password",id:"newPassword",value:vt,onChange:st=>_
t(st.target.value),required:!0,placeholder:"Enter new password (min 6 characters)",disabled:dt,minLength:6})]}),jsxRunt
imeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"confirmNewPassword",chi
ldren:"Confirm New Password"}),jsxRuntimeExports.jsx("input",{type:"password",id:"confirmNewPassword",value:wt,onChange
:st=>ht(st.target.value),required:!0,placeholder:"Confirm new password",disabled:dt,minLength:6})]}),jsxRuntimeExports.
jsx("button",{type:"submit",disabled:dt,className:"email-login-button",children:dt?"Changing Password...":"Change 
Password"})]})]})})]})},Layout=()=>{var 
zt,Ct,Pt,$t,Bt,Lt,Xt,Dt,Ht,os,Qt,Ft,xs,Cs,gs,Os,qt,js,es,vs,Rs,Tn,Hs,En,Hn;const s=useLocation(),e=useNavigate(),{isSys
temAdmin:i,currentTenant:a,getTenantId:o,isSalesHead:c}=useTenant(),d=o(),h=c?c():!1,[j,_]=reactExports.useState(null),
[$,rt]=reactExports.useState(null),[tt,mt]=reactExports.useState(!1),[vt,_t]=reactExports.useState(0),[wt,ht]=reactExpo
rts.useState(!1),[dt,jt]=reactExports.useState([]),[bt,ut]=reactExports.useState(""),[Rt,st]=reactExports.useState("gen
eral"),[it,nt]=reactExports.useState([]),[ct,xt]=reactExports.useState(null),[yt,Tt]=reactExports.useState(0),[fs,cs]=r
eactExports.useState(null),Es=reactExports.useRef(null),ls=reactExports.useRef(null);reactExports.useEffect(()=>{Yt();c
onst Ps=localStorage.getItem("lastSeenChatTime");Ps&&cs(parseInt(Ps,10))},[]),reactExports.useEffect(()=>{const 
Ps=auth.currentUser;if(!Ps)return;const Ts=collection(db,"messages"),ks=query(Ts,where("recipients","array-contains",Ps
.email),where("status","==","unread")),Ln=onSnapshot(ks,hn=>{_t(hn.size)},hn=>{console.error("Error listening to 
unread messages:",hn)});return()=>Ln()},[]),reactExports.useEffect(()=>{const Ps=auth.currentUser;if(!Ps)return;const T
s=localStorage.getItem("lastSeenChatTime"),ks=Ts?parseInt(Ts,10):0,Ln=collection(db,"chatroom"),hn=query(Ln,limit(100))
,Jn=collection(db,"directMessages"),nr=query(Jn,where("receiverId","==",Ps.uid),limit(100));let Ls=0,Vn=0;const 
Yn=()=>{Tt(Ls+Vn)},Kn=onSnapshot(hn,Cn=>{Ls=Cn.docs.map(Xs=>({id:Xs.id,...Xs.data()})).filter(Xs=>{var 
On,As,Zt;return(((As=(On=Xs.createdAt)==null?void 0:On.toMillis)==null?void 
0:As.call(On))||((Zt=Xs.createdAt)==null?void 
0:Zt.seconds)*1e3||0)>ks&&Xs.userId!==Ps.uid}).length,Yn()},Cn=>{console.error("Error listening to chatroom for unread 
count:",Cn)}),$n=onSnapshot(nr,Cn=>{Vn=Cn.docs.map(Xs=>({id:Xs.id,...Xs.data()})).filter(Xs=>{var 
On,As,Zt;return(((As=(On=Xs.createdAt)==null?void 0:On.toMillis)==null?void 
0:As.call(On))||((Zt=Xs.createdAt)==null?void 0:Zt.seconds)*1e3||0)>ks}).length,Yn()},Cn=>{console.error("Error 
listening to direct messages for unread 
count:",Cn)});return()=>{Kn(),$n()}},[fs]),reactExports.useEffect(()=>{wt&&(async()=>{try{const Ln=(await 
getUsersByTenant(i?null:d)).filter(hn=>{var Jn;return hn.id!==((Jn=auth.currentUser)==null?void 
0:Jn.uid)});nt(Ln)}catch(Ts){console.error("Error loading chat 
users:",Ts)}})()},[wt,d,i]),reactExports.useEffect(()=>{var hn;if(!wt)return;const Ps=(hn=auth.currentUser)==null?void 
0:hn.uid;if(!Ps)return;let Ts,ks;if(Rt==="general")Ts=collection(db,"chatroom"),ks=query(Ts,limit(100));else 
if(ct)Ts=collection(db,"directMessages"),ks=query(Ts,where("participants","array-contains",Ps),limit(100));else 
return;const Ln=onSnapshot(ks,Jn=>{let 
nr=Jn.docs.map(Ls=>({id:Ls.id,...Ls.data()}));Rt!=="general"&&ct&&(nr=nr.filter(Ls=>{var 
Vn;return(Vn=Ls.participants)==null?void 0:Vn.includes(ct.id)})),nr.sort((Ls,Vn)=>{var $n,Cn,zs,Xs,mn,On;const 
Yn=((Cn=($n=Ls.createdAt)==null?void 0:$n.toMillis)==null?void 0:Cn.call($n))||((zs=Ls.createdAt)==null?void 
0:zs.seconds)*1e3||0,Kn=((mn=(Xs=Vn.createdAt)==null?void 0:Xs.toMillis)==null?void 
0:mn.call(Xs))||((On=Vn.createdAt)==null?void 0:On.seconds)*1e3||0;return Yn-Kn}),jt(nr),setTimeout(()=>{var 
Ls;(Ls=ls.current)==null||Ls.scrollIntoView({behavior:"smooth"})},100)},Jn=>{console.error("Error listening to chat 
messages:",Jn)});return()=>Ln()},[wt,Rt,ct]),reactExports.useEffect(()=>{const 
Ps=Ts=>{Es.current&&!Es.current.contains(Ts.target)&&mt(!1)};return 
tt&&document.addEventListener("mousedown",Ps),()=>{document.removeEventListener("mousedown",Ps)}},[tt]);const 
Yt=async()=>{try{const Ps=auth.currentUser;if(Ps){const Ts=await getUserData(Ps.uid);if(Ts){_(Ts);const ks=await 
getRole(Ts.role||"salesperson");ks&&rt(ks)}}}catch(Ps){console.error("Error loading user 
profile:",Ps)}},Mt=async()=>{try{await signOut(auth),e("/login")}catch(Ps){console.error("Error signing 
out:",Ps)}},Gt=async Ps=>{if(Ps.preventDefault(),!bt.trim())return;const Ts=bt.trim();ut("");try{const 
ks=auth.currentUser;Rt==="general"?await addDoc(collection(db,"chatroom"),{text:Ts,userId:(ks==null?void 
0:ks.uid)||"anonymous",userName:(j==null?void 0:j.displayName)||(ks==null?void 0:ks.displayName)||(ks==null?void 
0:ks.email)||"Anonymous",userEmail:(ks==null?void 0:ks.email)||"anonymous",createdAt:serverTimestamp()}):ct&&await 
addDoc(collection(db,"directMessages"),{text:Ts,senderId:ks==null?void 0:ks.uid,senderName:(j==null?void 
0:j.displayName)||(ks==null?void 0:ks.displayName)||(ks==null?void 0:ks.email)||"Anonymous",senderEmail:ks==null?void 
0:ks.email,receiverId:ct.id,receiverName:ct.displayName||ct.email,participants:[ks==null?void 
0:ks.uid,ct.id],createdAt:serverTimestamp()})}catch(ks){console.error("Error sending chat 
message:",ks),ut(Ts),alert("Failed to send message. Please try again.")}},Wt=Ps=>{xt(Ps),st("direct"),jt([])},ms=()=>{x
t(null),st("users"),jt([])},ss=Ps=>Ps?(Ps.toDate?Ps.toDate():new 
Date(Ps)).toLocaleTimeString("en-ZA",{hour:"2-digit",minute:"2-digit"}):"",ys=()=>{const Ps=Date.now();localStorage.set
Item("lastSeenChatTime",Ps.toString()),cs(Ps),Tt(0)},Et=()=>{wt||ys(),ht(!wt)},gt=Ps=>s.pathname===Ps,ft=Ps=>{var 
Ts;return!$||((Ts=$.permissions)==null?void 0:Ts.includes(Ps))};return jsxRuntimeExports.jsxs("div",{className:"layout"
,children:[jsxRuntimeExports.jsx("header",{className:"top-header",children:jsxRuntimeExports.jsxs("div",{className:"hea
der-content",children:[jsxRuntimeExports.jsx("h1",{className:"brand-title",children:"Speccon 
CRM"}),jsxRuntimeExports.jsxs("nav",{className:"top-nav",children:[ft("view_dashboard")&&($==null?void 0:$.id)!=="accou
ntant"&&jsxRuntimeExports.jsx(Link,{to:"/dashboard",className:gt("/dashboard")?"active":"",children:"Dashboard"}),ft("v
iew_dashboard")&&jsxRuntimeExports.jsx(Link,{to:"/financial-dashboard",className:gt("/financial-dashboard")?"active":""
,children:"Financials"}),ft("view_clients")&&jsxRuntimeExports.jsx(Link,{to:"/clients",className:gt("/clients")?"active
":"",children:"Clients"}),ft("view_sales_pipeline")&&jsxRuntimeExports.jsx(Link,{to:"/sales-pipeline",className:gt("/sa
les-pipeline")?"active":"",children:"Sales Pipeline"}),ft("view_follow_up_tasks")&&($==null?void 0:$.id)!=="salesperson
"&&jsxRuntimeExports.jsx(Link,{to:"/follow-up-tasks",className:gt("/follow-up-tasks")?"active":"",children:"Follow-Up 
Tasks"}),ft("view_messages")&&jsxRuntimeExports.jsxs(Link,{to:"/messages",className:`nav-link-with-badge ${gt("/message
s")?"active":""}`,children:["Messages",vt>0&&jsxRuntimeExports.jsx("span",{className:"nav-badge",children:vt})]}),((zt=
$==null?void 0:$.permissions)==null?void 0:zt.includes("manage_roles"))&&((Ct=$==null?void 0:$.permissions)==null?void 
0:Ct.includes("manage_users"))&&((Pt=$==null?void 0:$.permissions)==null?void 0:Pt.includes("manage_financial_year"))&&
jsxRuntimeExports.jsx(Link,{to:"/seed-data",className:gt("/seed-data")?"active":"",children:"Seed 
Data"}),$&&((($t=$.permissions)==null?void 0:$t.includes("manage_roles"))||((Bt=$.permissions)==null?void 
0:Bt.includes("manage_users"))||((Lt=$.permissions)==null?void 
0:Lt.includes("manage_financial_year"))||((Xt=$.permissions)==null?void 
0:Xt.includes("manage_clients"))||h)&&jsxRuntimeExports.jsxs("div",{className:`admin-dropdown 
${tt?"open":""}`,ref:Es,children:[jsxRuntimeExports.jsxs("button",{className:`admin-dropdown-toggle ${gt("/role-managem
ent")||gt("/user-management")||gt("/financial-year-end")||gt("/skills-partners")||gt("/skills-partner-commissions")||gt
("/product-management")||gt("/budget-management")||gt("/pipeline-statuses")||gt("/legal-documents")||gt("/enabled-produ
cts")||gt("/calculation-templates")||gt("/sales-team")||gt("/accountant-upload")?"active":""}`,onClick:()=>mt(!tt),chil
dren:["Admin",jsxRuntimeExports.jsx("span",{className:"dropdown-arrow",children:"â–¼"})]}),jsxRuntimeExports.jsxs("div"
,{className:"admin-dropdown-menu",children:[((Dt=$.permissions)==null?void 0:Dt.includes("manage_users"))&&jsxRuntimeEx
ports.jsx(Link,{to:"/user-management",className:gt("/user-management")?"active":"",onClick:()=>mt(!1),children:"Users"}
),((Ht=$.permissions)==null?void 0:Ht.includes("manage_roles"))&&jsxRuntimeExports.jsx(Link,{to:"/role-management",clas
sName:gt("/role-management")?"active":"",onClick:()=>mt(!1),children:"Roles"}),((os=$.permissions)==null?void 0:os.incl
udes("manage_financial_year"))&&jsxRuntimeExports.jsx(Link,{to:"/financial-year-end",className:gt("/financial-year-end"
)?"active":"",onClick:()=>mt(!1),children:"Financial Year"}),(((Qt=$.permissions)==null?void 
0:Qt.includes("manage_users"))||((Ft=$.permissions)==null?void 0:Ft.includes("manage_clients")))&&jsxRuntimeExports.jsx
(Link,{to:"/skills-partners",className:gt("/skills-partners")?"active":"",onClick:()=>mt(!1),children:"Skills 
Partners"}),(((xs=$.permissions)==null?void 0:xs.includes("manage_users"))||((Cs=$.permissions)==null?void 0:Cs.include
s("manage_roles")))&&jsxRuntimeExports.jsx(Link,{to:"/product-management",className:gt("/product-management")?"active":
"",onClick:()=>mt(!1),children:"Products"}),(gs=$.permissions)!=null&&gs.includes("manage_users")&&!((Os=$.permissions)
!=null&&Os.includes("manage_roles"))||h?jsxRuntimeExports.jsx(Link,{to:"/budget-management",className:gt("/budget-manag
ement")?"active":"",onClick:()=>mt(!1),children:"Budgets"}):null,(((qt=$.permissions)==null?void 
0:qt.includes("manage_financial_year"))||((js=$.permissions)==null?void 0:js.includes("manage_users")))&&jsxRuntimeExpo
rts.jsx(Link,{to:"/accountant-upload",className:gt("/accountant-upload")?"active":"",onClick:()=>mt(!1),children:"Finan
cial Upload"}),((es=$.permissions)==null?void 0:es.includes("manage_roles"))&&jsxRuntimeExports.jsx(Link,{to:"/pipeline
-statuses",className:gt("/pipeline-statuses")?"active":"",onClick:()=>mt(!1),children:"Pipeline 
Statuses"}),((vs=$.permissions)==null?void 0:vs.includes("manage_roles"))&&jsxRuntimeExports.jsx(Link,{to:"/legal-docum
ents",className:gt("/legal-documents")?"active":"",onClick:()=>mt(!1),children:"Legal Documents"}),i&&jsxRuntimeExports
.jsx(Link,{to:"/seta-management",className:gt("/seta-management")?"active":"",onClick:()=>mt(!1),children:"SETA Managem
ent"}),i&&jsxRuntimeExports.jsx(Link,{to:"/job-titles-management",className:gt("/job-titles-management")?"active":"",on
Click:()=>mt(!1),children:"Job Titles Management"}),(((Rs=$.permissions)==null?void 
0:Rs.includes("manage_users"))||((Tn=$.permissions)==null?void 0:Tn.includes("manage_clients")))&&jsxRuntimeExports.jsx
(Link,{to:"/enabled-products",className:gt("/enabled-products")?"active":"",onClick:()=>mt(!1),children:"Enabled 
Products"}),(((Hs=$.permissions)==null?void 0:Hs.includes("manage_all_teams"))||((En=$.permissions)==null?void 
0:En.includes("manage_team"))||((Hn=$.permissions)==null?void 0:Hn.includes("manage_users")))&&jsxRuntimeExports.jsx(Li
nk,{to:"/sales-team",className:gt("/sales-team")?"active":"",onClick:()=>mt(!1),children:"Sales Team"}),i&&jsxRuntimeEx
ports.jsx(Link,{to:"/tenants",className:gt("/tenants")?"active":"",onClick:()=>mt(!1),children:"Tenant Management"}),i&
&jsxRuntimeExports.jsx(Link,{to:"/calculation-templates",className:gt("/calculation-templates")?"active":"",onClick:()=
>mt(!1),children:"Calculation Templates"})]})]}),jsxRuntimeExports.jsxs("button",{className:`team-chat-btn 
${wt?"active":""}`,onClick:Et,children:["Team Chat",yt>0&&!wt&&jsxRuntimeExports.jsx("span",{className:"chat-badge",chi
ldren:yt>99?"99+":yt})]})]}),jsxRuntimeExports.jsxs("div",{className:"header-right",children:[a&&jsxRuntimeExports.jsxs
("div",{className:"tenant-indicator",children:[jsxRuntimeExports.jsx("span",{className:"tenant-label",children:"Tenant:
"}),jsxRuntimeExports.jsx("span",{className:"tenant-name",children:a.name})]}),i&&!a&&jsxRuntimeExports.jsx("div",{clas
sName:"tenant-indicator system-admin",children:jsxRuntimeExports.jsx("span",{className:"tenant-name",children:"System 
Admin"})}),j&&jsxRuntimeExports.jsxs(Link,{to:"/profile",className:`user-profile-header ${gt("/profile")?"active":""}`,
children:[jsxRuntimeExports.jsx("div",{className:"user-avatar",children:j.photoURL?jsxRuntimeExports.jsx("img",{src:j.p
hotoURL,alt:j.displayName||"User"}):jsxRuntimeExports.jsx("div",{className:"avatar-placeholder",children:(j.displayName
||j.email||"U").charAt(0).toUpperCase()})}),$?jsxRuntimeExports.jsx("div",{className:"user-role",children:$.name}):j!=n
ull&&j.role?jsxRuntimeExports.jsx("div",{className:"user-role",children:j.role}):jsxRuntimeExports.jsx("div",{className
:"user-role",children:"User"})]}),jsxRuntimeExports.jsx("button",{onClick:Mt,className:"logout-btn",children:"Logout"})
]})]})}),jsxRuntimeExports.jsx("main",{className:"main-content",children:jsxRuntimeExports.jsx(Outlet,{})}),wt&&jsxRunt
imeExports.jsxs("div",{className:"team-chat-popup",children:[jsxRuntimeExports.jsxs("div",{className:"chat-popup-header
",children:[Rt==="direct"&&ct?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("butto
n",{className:"chat-back-btn",onClick:ms,children:"â†"}),jsxRuntimeExports.jsx("h3",{children:ct.displayName||ct.email
})]}):jsxRuntimeExports.jsx("h3",{children:Rt==="general"?"Team Chat":"Direct Messages"}),jsxRuntimeExports.jsx("button
",{className:"chat-close-btn",onClick:()=>ht(!1),children:"Ã—"})]}),Rt!=="direct"&&jsxRuntimeExports.jsxs("div",{classN
ame:"chat-tabs",children:[jsxRuntimeExports.jsx("button",{className:`chat-tab ${Rt==="general"?"active":""}`,onClick:()
=>{st("general"),xt(null)},children:"General"}),jsxRuntimeExports.jsx("button",{className:`chat-tab 
${Rt==="users"?"active":""}`,onClick:()=>st("users"),children:"Direct Messages"})]}),Rt==="users"&&jsxRuntimeExports.js
x("div",{className:"chat-users-list",children:it.length>0?it.map(Ps=>jsxRuntimeExports.jsxs("div",{className:"chat-user
-item",onClick:()=>Wt(Ps),children:[jsxRuntimeExports.jsx("div",{className:"chat-user-avatar",children:(Ps.displayName|
|Ps.email||"U").charAt(0).toUpperCase()}),jsxRuntimeExports.jsxs("div",{className:"chat-user-info",children:[jsxRuntime
Exports.jsx("span",{className:"chat-user-name",children:Ps.displayName||Ps.email}),jsxRuntimeExports.jsx("span",{classN
ame:"chat-user-role",children:Ps.role||"User"})]})]},Ps.id)):jsxRuntimeExports.jsx("div",{className:"no-chat-users",chi
ldren:"No other users found"})}),(Rt==="general"||Rt==="direct")&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{ch
ildren:[jsxRuntimeExports.jsxs("div",{className:"chat-popup-messages",children:[dt.length>0?dt.map(Ps=>{var 
Ln,hn;const Ts=Rt==="general"?Ps.userEmail===((Ln=auth.currentUser)==null?void 
0:Ln.email):Ps.senderId===((hn=auth.currentUser)==null?void 
0:hn.uid),ks=Rt==="general"?Ps.userName:Ps.senderName;return 
jsxRuntimeExports.jsxs("div",{className:`chat-popup-message ${Ts?"own-message":""}`,children:[jsxRuntimeExports.jsxs("d
iv",{className:"chat-popup-message-header",children:[jsxRuntimeExports.jsx("span",{className:"chat-popup-user",children
:ks}),jsxRuntimeExports.jsx("span",{className:"chat-popup-time",children:ss(Ps.createdAt)})]}),jsxRuntimeExports.jsx("d
iv",{className:"chat-popup-text",children:Ps.text})]},Ps.id)}):jsxRuntimeExports.jsx("div",{className:"no-chat-popup-me
ssages",children:"No messages yet. Start the conversation!"}),jsxRuntimeExports.jsx("div",{ref:ls})]}),jsxRuntimeExport
s.jsxs("form",{className:"chat-popup-input-form",onSubmit:Gt,children:[jsxRuntimeExports.jsx("input",{type:"text",value
:bt,onChange:Ps=>ut(Ps.target.value),placeholder:"Type a message...",className:"chat-popup-input"}),jsxRuntimeExports.j
sx("button",{type:"submit",className:"chat-popup-send-btn",children:"Send"})]})]})]})]})};function 
App(){const[s,e]=reactExports.useState(null),[i,a]=reactExports.useState(!0),o=getAuth(app);return 
reactExports.useEffect(()=>{const c=onAuthStateChanged(o,async d=>{if(d)try{await 
createOrUpdateUser(d)}catch(h){console.error("Failed to create/update user document:",h)}e(d),a(!1)});return()=>c()},[o
]),i?jsxRuntimeExports.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},chi
ldren:jsxRuntimeExports.jsx("div",{children:"Loading..."})}):jsxRuntimeExports.jsx(TenantProvider,{children:jsxRuntimeE
xports.jsx(BrowserRouter,{future:{v7_relativeSplatPath:!0},children:jsxRuntimeExports.jsxs(Routes,{children:[jsxRuntime
Exports.jsx(Route,{path:"/login",element:s?jsxRuntimeExports.jsx(Navigate,{to:"/dashboard"}):jsxRuntimeExports.jsx(Logi
n,{})}),jsxRuntimeExports.jsxs(Route,{path:"/",element:s?jsxRuntimeExports.jsx(Layout,{}):jsxRuntimeExports.jsx(Navigat
e,{to:"/login"}),children:[jsxRuntimeExports.jsx(Route,{index:!0,element:jsxRuntimeExports.jsx(Navigate,{to:"/dashboard
",replace:!0})}),jsxRuntimeExports.jsx(Route,{path:"dashboard",element:jsxRuntimeExports.jsx(Dashboard,{})}),jsxRuntime
Exports.jsx(Route,{path:"dashboard/edit-financial",element:jsxRuntimeExports.jsx(EditFinancial,{})}),jsxRuntimeExports.
jsx(Route,{path:"financial-editor/:clientId",element:jsxRuntimeExports.jsx(EditFinancial,{})}),jsxRuntimeExports.jsx(Ro
ute,{path:"clients",element:jsxRuntimeExports.jsx(Clients,{})}),jsxRuntimeExports.jsx(Route,{path:"clients/new",element
:jsxRuntimeExports.jsx(NewClient,{})}),jsxRuntimeExports.jsx(Route,{path:"clients/:id",element:jsxRuntimeExports.jsx(Cl
ientDetail,{})}),jsxRuntimeExports.jsx(Route,{path:"clients/:id/edit",element:jsxRuntimeExports.jsx(EditClient,{})}),js
xRuntimeExports.jsx(Route,{path:"messages",element:jsxRuntimeExports.jsx(Messages,{})}),jsxRuntimeExports.jsx(Route,{pa
th:"profile",element:jsxRuntimeExports.jsx(Profile,{})}),jsxRuntimeExports.jsx(Route,{path:"sales-pipeline",element:jsx
RuntimeExports.jsx(SalesPipeline,{})}),jsxRuntimeExports.jsx(Route,{path:"follow-up-tasks",element:jsxRuntimeExports.js
x(FollowUpTasks,{})}),jsxRuntimeExports.jsx(Route,{path:"reports",element:jsxRuntimeExports.jsx(Reports,{})}),jsxRuntim
eExports.jsx(Route,{path:"role-management",element:jsxRuntimeExports.jsx(RoleManagement,{})}),jsxRuntimeExports.jsx(Rou
te,{path:"user-management",element:jsxRuntimeExports.jsx(UserManagement,{})}),jsxRuntimeExports.jsx(Route,{path:"financ
ial-year-end",element:jsxRuntimeExports.jsx(FinancialYearEnd,{})}),jsxRuntimeExports.jsx(Route,{path:"skills-partners",
element:jsxRuntimeExports.jsx(SkillsPartners,{})}),jsxRuntimeExports.jsx(Route,{path:"product-management",element:jsxRu
ntimeExports.jsx(ProductManagement,{})}),jsxRuntimeExports.jsx(Route,{path:"budget-management",element:jsxRuntimeExport
s.jsx(BudgetManagement,{})}),jsxRuntimeExports.jsx(Route,{path:"pipeline-statuses",element:jsxRuntimeExports.jsx(Pipeli
neStatusManagement,{})}),jsxRuntimeExports.jsx(Route,{path:"legal-documents",element:jsxRuntimeExports.jsx(LegalDocumen
tManagement,{})}),jsxRuntimeExports.jsx(Route,{path:"seta-management",element:jsxRuntimeExports.jsx(SetaManagement,{})}
),jsxRuntimeExports.jsx(Route,{path:"job-titles-management",element:jsxRuntimeExports.jsx(JobTitlesManagement,{})}),jsx
RuntimeExports.jsx(Route,{path:"tenants",element:jsxRuntimeExports.jsx(TenantManagement,{})}),jsxRuntimeExports.jsx(Rou
te,{path:"tenants/:tenantId/users",element:jsxRuntimeExports.jsx(TenantUsers,{})}),jsxRuntimeExports.jsx(Route,{path:"s
eed-data",element:jsxRuntimeExports.jsx(SeedData,{})}),jsxRuntimeExports.jsx(Route,{path:"calculation-templates",elemen
t:jsxRuntimeExports.jsx(CalculationTemplateManagement,{})}),jsxRuntimeExports.jsx(Route,{path:"enabled-products",elemen
t:jsxRuntimeExports.jsx(TenantProductManagement,{})}),jsxRuntimeExports.jsx(Route,{path:"sales-team",element:jsxRuntime
Exports.jsx(SalesTeamManagement,{})}),jsxRuntimeExports.jsx(Route,{path:"accountant-upload",element:jsxRuntimeExports.j
sx(AccountantUpload,{})}),jsxRuntimeExports.jsx(Route,{path:"financial-dashboard",element:jsxRuntimeExports.jsx(Financi
alDashboard,{})}),jsxRuntimeExports.jsx(Route,{path:"tenant-fix",element:jsxRuntimeExports.jsx(TenantFixAdmin,{})})]})]
})})})}client.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(React.StrictMode,{children:jsxRu
ntimeExports.jsx(App,{})}));


